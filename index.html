<!DOCTYPE html><html class="default" lang="en" data-base="."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script><script async src="assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>backtest-kit</h1></div><div class="tsd-panel tsd-typography"><a id="backtest-kit" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Backtest Kit<a href="#backtest-kit" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>A production-ready TypeScript framework for backtesting and live trading strategies with crash-safe state persistence, signal validation, and memory-optimized architecture.</p>
<p><a href=""><img src="https://img.shields.io/badge/TypeScript-5.0+-blue" alt="TypeScript"></a>
<a href=""><img src="https://img.shields.io/badge/architecture-clean-orange" alt="Architecture"></a></p>
<a id="features" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Features<a href="#features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>üöÄ <strong>Production-Ready Architecture</strong> - 8.5/10 rating with robust error recovery</li>
<li>üíæ <strong>Crash-Safe Persistence</strong> - Atomic file writes with automatic state recovery</li>
<li>‚úÖ <strong>Signal Validation</strong> - Comprehensive validation prevents invalid trades</li>
<li>üîÑ <strong>Async Generators</strong> - Memory-efficient streaming for backtest and live execution</li>
<li>üìä <strong>VWAP Pricing</strong> - Volume-weighted average price from last 5 1m candles</li>
<li>üéØ <strong>Signal Lifecycle</strong> - Type-safe state machine (idle ‚Üí opened ‚Üí active ‚Üí closed)</li>
<li>üìâ <strong>Accurate PNL</strong> - Calculation with fees (0.1%) and slippage (0.1%)</li>
<li>üß† <strong>Interval Throttling</strong> - Prevents signal spam at strategy level</li>
<li>‚ö° <strong>Memory Optimized</strong> - Prototype methods + memoization + streaming</li>
<li>üîå <strong>Flexible Architecture</strong> - Plug your own exchanges and strategies</li>
</ul>
<a id="installation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Installation<a href="#installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span>
</code><button type="button">Copy</button></pre>

<a id="quick-start" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Quick Start<a href="#quick-start" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="1-register-exchange-data-source" class="tsd-anchor"></a><h3 class="tsd-anchor-link">1. Register Exchange Data Source<a href="#1-register-exchange-data-source" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addExchange</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit/function/add&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addExchange</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getCandles</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">// Fetch candle data from your exchange API or database</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> [</span><br/><span class="hl-1">      {</span><br/><span class="hl-1">        </span><span class="hl-4">timestamp:</span><span class="hl-1"> </span><span class="hl-4">Date</span><span class="hl-1">.</span><span class="hl-0">now</span><span class="hl-1">(),</span><br/><span class="hl-1">        </span><span class="hl-4">open:</span><span class="hl-1"> </span><span class="hl-7">50000</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">high:</span><span class="hl-1"> </span><span class="hl-7">51000</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">low:</span><span class="hl-1"> </span><span class="hl-7">49000</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">close:</span><span class="hl-1"> </span><span class="hl-7">50500</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">volume:</span><span class="hl-1"> </span><span class="hl-7">1000</span><span class="hl-1">,</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    ];</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">formatPrice</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">price</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-7">2</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-0">formatQuantity</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">quantity</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-7">8</span><span class="hl-1">),</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="2-register-trading-strategy" class="tsd-anchor"></a><h3 class="tsd-anchor-link">2. Register Trading Strategy<a href="#2-register-trading-strategy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addStrategy</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit/function/add&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">, </span><span class="hl-6">// Throttling: signals generated max once per 5 minutes</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">// Your signal generation logic</span><br/><span class="hl-1">    </span><span class="hl-6">// Validation happens automatically (prices, TP/SL logic, timestamps)</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">position:</span><span class="hl-1"> </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;BTC breakout&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">priceOpen:</span><span class="hl-1"> </span><span class="hl-7">50000</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">priceTakeProfit:</span><span class="hl-1"> </span><span class="hl-7">51000</span><span class="hl-1">,  </span><span class="hl-6">// Must be &gt; priceOpen for long</span><br/><span class="hl-1">      </span><span class="hl-4">priceStopLoss:</span><span class="hl-1"> </span><span class="hl-7">49000</span><span class="hl-1">,     </span><span class="hl-6">// Must be &lt; priceOpen for long</span><br/><span class="hl-1">      </span><span class="hl-4">minuteEstimatedTime:</span><span class="hl-1"> </span><span class="hl-7">60</span><span class="hl-1">,  </span><span class="hl-6">// Signal duration in minutes</span><br/><span class="hl-1">      </span><span class="hl-4">timestamp:</span><span class="hl-1"> </span><span class="hl-4">Date</span><span class="hl-1">.</span><span class="hl-0">now</span><span class="hl-1">(),</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onOpen</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">backtest</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[</span><span class="hl-5">${</span><span class="hl-4">backtest</span><span class="hl-8"> </span><span class="hl-1">?</span><span class="hl-8"> </span><span class="hl-2">&quot;BT&quot;</span><span class="hl-8"> </span><span class="hl-1">:</span><span class="hl-8"> </span><span class="hl-2">&quot;LIVE&quot;</span><span class="hl-5">}</span><span class="hl-2">] Signal opened:`</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">id</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">onClose</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">backtest</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">priceClose</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[</span><span class="hl-5">${</span><span class="hl-4">backtest</span><span class="hl-8"> </span><span class="hl-1">?</span><span class="hl-8"> </span><span class="hl-2">&quot;BT&quot;</span><span class="hl-8"> </span><span class="hl-1">:</span><span class="hl-8"> </span><span class="hl-2">&quot;LIVE&quot;</span><span class="hl-5">}</span><span class="hl-2">] Signal closed:`</span><span class="hl-1">, </span><span class="hl-4">priceClose</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="3-add-timeframe-generator" class="tsd-anchor"></a><h3 class="tsd-anchor-link">3. Add Timeframe Generator<a href="#3-add-timeframe-generator" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addFrame</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit/function/add&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addFrame</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-backtest&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;1m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-01T00:00:00Z&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-02T00:00:00Z&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onTimeframe</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">timeframe</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Generated </span><span class="hl-5">${</span><span class="hl-4">timeframe</span><span class="hl-8">.</span><span class="hl-4">length</span><span class="hl-5">}</span><span class="hl-2"> timeframes from </span><span class="hl-5">${</span><span class="hl-4">startDate</span><span class="hl-5">}</span><span class="hl-2"> to </span><span class="hl-5">${</span><span class="hl-4">endDate</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="4-run-backtest-with-async-generator" class="tsd-anchor"></a><h3 class="tsd-anchor-link">4. Run Backtest with Async Generator<a href="#4-run-backtest-with-async-generator" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">backtest</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit/lib&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">// Stream backtest results without memory accumulation</span><br/><span class="hl-3">for</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> (</span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-9">result</span><span class="hl-1"> </span><span class="hl-5">of</span><span class="hl-1"> </span><span class="hl-4">backtest</span><span class="hl-1">.</span><span class="hl-4">backtestLogicPublicService</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;1d-backtest&quot;</span><br/><span class="hl-1">)) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">action:</span><span class="hl-1"> </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1">,           </span><span class="hl-6">// &quot;closed&quot;</span><br/><span class="hl-1">    </span><span class="hl-4">reason:</span><span class="hl-1"> </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">closeReason</span><span class="hl-1">,      </span><span class="hl-6">// &quot;take_profit&quot; | &quot;stop_loss&quot; | &quot;time_expired&quot;</span><br/><span class="hl-1">    </span><span class="hl-4">pnl:</span><span class="hl-1"> </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1">,  </span><span class="hl-6">// e.g., +1.98%</span><br/><span class="hl-1">    </span><span class="hl-4">closePrice:</span><span class="hl-1"> </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">currentPrice</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">closeTime:</span><span class="hl-1"> </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">closeTimestamp</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// Early termination possible</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1"> &lt; -</span><span class="hl-7">5</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Stopping backtest - too many losses&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">break</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="5-live-trading-with-crash-recovery" class="tsd-anchor"></a><h3 class="tsd-anchor-link">5. Live Trading with Crash Recovery<a href="#5-live-trading-with-crash-recovery" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">backtest</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit/lib&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">// Infinite async generator - streams live results</span><br/><span class="hl-3">for</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> (</span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-9">result</span><span class="hl-1"> </span><span class="hl-5">of</span><span class="hl-1"> </span><span class="hl-4">backtest</span><span class="hl-1">.</span><span class="hl-4">liveLogicPublicService</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;binance&quot;</span><br/><span class="hl-1">)) {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;opened&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;New signal opened:&quot;</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">signal</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-6">// Signal automatically persisted to disk</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Signal closed:&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">      </span><span class="hl-4">reason:</span><span class="hl-1"> </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">closeReason</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">pnl:</span><span class="hl-1"> </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">closePrice:</span><span class="hl-1"> </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">currentPrice</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-6">// State automatically persisted</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// If process crashes, restart will resume from last saved state</span><br/><span class="hl-1">  </span><span class="hl-6">// No duplicate signals, no lost trades</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Crash Recovery Example:</strong></p>
<pre><code class="typescript"><span class="hl-6">// First run</span><br/><span class="hl-3">for</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> (</span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-9">result</span><span class="hl-1"> </span><span class="hl-5">of</span><span class="hl-1"> </span><span class="hl-4">liveLogic</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">)) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">result</span><span class="hl-1">); </span><span class="hl-6">// { action: &quot;opened&quot;, signal: {...} }</span><br/><span class="hl-1">  </span><span class="hl-6">// Process crashes here ‚ùå</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-6">// After restart - automatic recovery ‚úÖ</span><br/><span class="hl-3">for</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> (</span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-9">result</span><span class="hl-1"> </span><span class="hl-5">of</span><span class="hl-1"> </span><span class="hl-4">liveLogic</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">)) {</span><br/><span class="hl-1">  </span><span class="hl-6">// Reads persisted state from disk</span><br/><span class="hl-1">  </span><span class="hl-6">// Continues monitoring from where it left off</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">result</span><span class="hl-1">); </span><span class="hl-6">// { action: &quot;active&quot;, signal: {...}, currentPrice: 50100 }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="architecture-overview" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Architecture Overview<a href="#architecture-overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The framework follows <strong>clean architecture</strong> with:</p>
<ul>
<li><strong>Client Layer</strong> - Pure business logic without DI (ClientStrategy, ClientExchange, ClientFrame)</li>
<li><strong>Service Layer</strong> - DI-based services organized by responsibility
<ul>
<li><strong>Schema Services</strong> - Registry pattern for configuration</li>
<li><strong>Connection Services</strong> - Memoized client instance creators</li>
<li><strong>Global Services</strong> - Context wrappers for public API</li>
<li><strong>Logic Services</strong> - Async generator orchestration (backtest/live)</li>
</ul>
</li>
<li><strong>Persistence Layer</strong> - Crash-safe atomic file writes with <code>PersistSignalAdaper</code></li>
</ul>
<p>See <a href="media/ARCHITECTURE.md">ARCHITECTURE.md</a> for detailed documentation.</p>
<a id="signal-validation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Signal Validation<a href="#signal-validation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>All signals are validated automatically before execution:</p>
<pre><code class="typescript"><span class="hl-6">// ‚úÖ Valid long signal</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-10">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">priceOpen</span><span class="hl-1">: </span><span class="hl-7">50000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-7">51000</span><span class="hl-1">,  </span><span class="hl-6">// ‚úÖ 51000 &gt; 50000</span><br/><span class="hl-1">  </span><span class="hl-10">priceStopLoss</span><span class="hl-1">: </span><span class="hl-7">49000</span><span class="hl-1">,     </span><span class="hl-6">// ‚úÖ 49000 &lt; 50000</span><br/><span class="hl-1">  </span><span class="hl-10">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-7">60</span><span class="hl-1">,  </span><span class="hl-6">// ‚úÖ positive</span><br/><span class="hl-1">  </span><span class="hl-10">timestamp</span><span class="hl-1">: </span><span class="hl-4">Date</span><span class="hl-1">.</span><span class="hl-0">now</span><span class="hl-1">(),    </span><span class="hl-6">// ‚úÖ positive</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-6">// ‚ùå Invalid long signal - throws error</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-10">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">priceOpen</span><span class="hl-1">: </span><span class="hl-7">50000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-7">49000</span><span class="hl-1">,  </span><span class="hl-6">// ‚ùå 49000 &lt; 50000 (must be higher for long)</span><br/><span class="hl-1">  </span><span class="hl-10">priceStopLoss</span><span class="hl-1">: </span><span class="hl-7">51000</span><span class="hl-1">,    </span><span class="hl-6">// ‚ùå 51000 &gt; 50000 (must be lower for long)</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-6">// ‚úÖ Valid short signal</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-10">position</span><span class="hl-1">: </span><span class="hl-2">&quot;short&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">priceOpen</span><span class="hl-1">: </span><span class="hl-7">50000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-7">49000</span><span class="hl-1">,  </span><span class="hl-6">// ‚úÖ 49000 &lt; 50000 (profit goes down for short)</span><br/><span class="hl-1">  </span><span class="hl-10">priceStopLoss</span><span class="hl-1">: </span><span class="hl-7">51000</span><span class="hl-1">,    </span><span class="hl-6">// ‚úÖ 51000 &gt; 50000 (stop loss goes up for short)</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Validation errors include detailed messages for debugging.</p>
<a id="interval-throttling" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Interval Throttling<a href="#interval-throttling" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Prevent signal spam with automatic throttling:</p>
<pre><code class="typescript"><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">, </span><span class="hl-6">// Signals generated max once per 5 minutes</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">// This function will be called max once per 5 minutes</span><br/><span class="hl-1">    </span><span class="hl-6">// Even if tick() is called every second</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">signal</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>Supported intervals: <code>&quot;1m&quot;</code>, <code>&quot;3m&quot;</code>, <code>&quot;5m&quot;</code>, <code>&quot;15m&quot;</code>, <code>&quot;30m&quot;</code>, <code>&quot;1h&quot;</code></p>
<a id="api-reference" class="tsd-anchor"></a><h2 class="tsd-anchor-link">API Reference<a href="#api-reference" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="high-level-functions" class="tsd-anchor"></a><h3 class="tsd-anchor-link">High-Level Functions<a href="#high-level-functions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><a id="schema-registration" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Schema Registration<a href="#schema-registration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-6">// Register exchange</span><br/><span class="hl-0">addExchange</span><span class="hl-1">(</span><span class="hl-4">exchangeSchema</span><span class="hl-1">: </span><span class="hl-4">IExchangeSchema</span><span class="hl-1">): </span><span class="hl-5">void</span><br/><br/><span class="hl-6">// Register strategy</span><br/><span class="hl-0">addStrategy</span><span class="hl-1">(</span><span class="hl-4">strategySchema</span><span class="hl-1">: </span><span class="hl-4">IStrategySchema</span><span class="hl-1">): </span><span class="hl-5">void</span><br/><br/><span class="hl-6">// Register timeframe generator</span><br/><span class="hl-0">addFrame</span><span class="hl-1">(</span><span class="hl-4">frameSchema</span><span class="hl-1">: </span><span class="hl-4">IFrameSchema</span><span class="hl-1">): </span><span class="hl-5">void</span>
</code><button type="button">Copy</button></pre>

<a id="exchange-data" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Exchange Data<a href="#exchange-data" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-6">// Get historical candles</span><br/><span class="hl-0">getCandles</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-4">CandleInterval</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">ICandleData</span><span class="hl-1">[]&gt;</span><br/><br/><span class="hl-6">// Get VWAP from last 5 1m candles</span><br/><span class="hl-0">getAveragePrice</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">number</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-6">// Get current date in execution context</span><br/><span class="hl-0">getDate</span><span class="hl-1">(): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">Date</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-6">// Get current mode (&quot;backtest&quot; | &quot;live&quot;)</span><br/><span class="hl-0">getMode</span><span class="hl-1">(): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-6">// Format price/quantity for exchange</span><br/><span class="hl-0">formatPrice</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span><br/><span class="hl-0">formatQuantity</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<a id="service-apis" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Service APIs<a href="#service-apis" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><a id="backtest-logic" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Backtest Logic<a href="#backtest-logic" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-6">// Stream backtest results</span><br/><span class="hl-4">backtest</span><span class="hl-1">.</span><span class="hl-4">backtestLogicPublicService</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">StrategyName</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-4">ExchangeName</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName</span><span class="hl-1">: </span><span class="hl-4">FrameName</span><br/><span class="hl-1">): </span><span class="hl-4">AsyncIterableIterator</span><span class="hl-1">&lt;</span><span class="hl-4">IStrategyTickResultClosed</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<a id="live-logic" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Live Logic<a href="#live-logic" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-6">// Stream live results (infinite)</span><br/><span class="hl-4">backtest</span><span class="hl-1">.</span><span class="hl-4">liveLogicPublicService</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">StrategyName</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-4">ExchangeName</span><br/><span class="hl-1">): </span><span class="hl-4">AsyncIterableIterator</span><span class="hl-1">&lt;</span><span class="hl-4">IStrategyTickResult</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<a id="advanced-reduce-pattern" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Advanced: Reduce Pattern<a href="#advanced-reduce-pattern" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">reduce</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit/function/reduce&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">interface</span><span class="hl-1"> </span><span class="hl-11">Context</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">totalPnl</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">trades</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-9">result</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">reduce</span><span class="hl-1">&lt;</span><span class="hl-11">Context</span><span class="hl-1">&gt;(</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">timeframes</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-4">acc</span><span class="hl-1">, </span><span class="hl-4">index</span><span class="hl-1">, </span><span class="hl-4">when</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">// Custom logic at each timeframe</span><br/><span class="hl-1">    </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-9">result</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">backtest</span><span class="hl-1">.</span><span class="hl-4">strategyGlobalService</span><span class="hl-1">.</span><span class="hl-0">tick</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">when</span><span class="hl-1">, </span><span class="hl-5">true</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">acc</span><span class="hl-1">.</span><span class="hl-4">totalPnl</span><span class="hl-1"> += </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">acc</span><span class="hl-1">.</span><span class="hl-4">trades</span><span class="hl-1">++;</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">acc</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  { </span><span class="hl-4">totalPnl:</span><span class="hl-1"> </span><span class="hl-7">0</span><span class="hl-1">, </span><span class="hl-4">trades:</span><span class="hl-1"> </span><span class="hl-7">0</span><span class="hl-1"> }</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">accumulator</span><span class="hl-1">); </span><span class="hl-6">// { totalPnl: 15.3, trades: 42 }</span>
</code><button type="button">Copy</button></pre>

<a id="type-definitions" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Type Definitions<a href="#type-definitions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="signal-data" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Signal Data<a href="#signal-data" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">interface</span><span class="hl-1"> </span><span class="hl-11">ISignalRow</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">id</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;                    </span><span class="hl-6">// Auto-generated</span><br/><span class="hl-1">  </span><span class="hl-4">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1"> | </span><span class="hl-2">&quot;short&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">priceOpen</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">priceStopLoss</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">timestamp</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="tick-results-discriminated-union" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Tick Results (Discriminated Union)<a href="#tick-results-discriminated-union" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">type</span><span class="hl-1"> </span><span class="hl-11">IStrategyTickResult</span><span class="hl-1"> =</span><br/><span class="hl-1">  | { </span><span class="hl-4">action</span><span class="hl-1">: </span><span class="hl-2">&quot;idle&quot;</span><span class="hl-1">; </span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-11">null</span><span class="hl-1"> }</span><br/><span class="hl-1">  | { </span><span class="hl-4">action</span><span class="hl-1">: </span><span class="hl-2">&quot;opened&quot;</span><span class="hl-1">; </span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-11">ISignalRow</span><span class="hl-1"> }</span><br/><span class="hl-1">  | { </span><span class="hl-4">action</span><span class="hl-1">: </span><span class="hl-2">&quot;active&quot;</span><span class="hl-1">; </span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-11">ISignalRow</span><span class="hl-1">; </span><span class="hl-4">currentPrice</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1"> }</span><br/><span class="hl-1">  | {</span><br/><span class="hl-1">      </span><span class="hl-4">action</span><span class="hl-1">: </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-11">ISignalRow</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">currentPrice</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">closeReason</span><span class="hl-1">: </span><span class="hl-2">&quot;take_profit&quot;</span><span class="hl-1"> | </span><span class="hl-2">&quot;stop_loss&quot;</span><span class="hl-1"> | </span><span class="hl-2">&quot;time_expired&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">closeTimestamp</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">pnl</span><span class="hl-1">: {</span><br/><span class="hl-1">        </span><span class="hl-4">priceOpenWithCosts</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">priceCloseWithCosts</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">pnlPercentage</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">      };</span><br/><span class="hl-1">    };</span>
</code><button type="button">Copy</button></pre>

<a id="pnl-calculation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">PNL Calculation<a href="#pnl-calculation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-6">// Constants</span><br/><span class="hl-9">PERCENT_SLIPPAGE</span><span class="hl-1"> = </span><span class="hl-7">0.1</span><span class="hl-1">% </span><span class="hl-6">// 0.001</span><br/><span class="hl-9">PERCENT_FEE</span><span class="hl-1"> = </span><span class="hl-7">0.1</span><span class="hl-1">%      </span><span class="hl-6">// 0.001</span><br/><br/><span class="hl-6">// LONG position</span><br/><span class="hl-4">priceOpenWithCosts</span><span class="hl-1"> = </span><span class="hl-4">priceOpen</span><span class="hl-1"> * (</span><span class="hl-7">1</span><span class="hl-1"> + </span><span class="hl-4">slippage</span><span class="hl-1"> + </span><span class="hl-4">fee</span><span class="hl-1">)</span><br/><span class="hl-4">priceCloseWithCosts</span><span class="hl-1"> = </span><span class="hl-4">priceClose</span><span class="hl-1"> * (</span><span class="hl-7">1</span><span class="hl-1"> - </span><span class="hl-4">slippage</span><span class="hl-1"> - </span><span class="hl-4">fee</span><span class="hl-1">)</span><br/><span class="hl-4">pnl</span><span class="hl-1">% = (</span><span class="hl-4">priceCloseWithCosts</span><span class="hl-1"> - </span><span class="hl-4">priceOpenWithCosts</span><span class="hl-1">) / </span><span class="hl-4">priceOpenWithCosts</span><span class="hl-1"> * </span><span class="hl-7">100</span><br/><br/><span class="hl-6">// SHORT position</span><br/><span class="hl-4">priceOpenWithCosts</span><span class="hl-1"> = </span><span class="hl-4">priceOpen</span><span class="hl-1"> * (</span><span class="hl-7">1</span><span class="hl-1"> - </span><span class="hl-4">slippage</span><span class="hl-1"> + </span><span class="hl-4">fee</span><span class="hl-1">)</span><br/><span class="hl-4">priceCloseWithCosts</span><span class="hl-1"> = </span><span class="hl-4">priceClose</span><span class="hl-1"> * (</span><span class="hl-7">1</span><span class="hl-1"> + </span><span class="hl-4">slippage</span><span class="hl-1"> + </span><span class="hl-4">fee</span><span class="hl-1">)</span><br/><span class="hl-4">pnl</span><span class="hl-1">% = (</span><span class="hl-4">priceOpenWithCosts</span><span class="hl-1"> - </span><span class="hl-4">priceCloseWithCosts</span><span class="hl-1">) / </span><span class="hl-4">priceOpenWithCosts</span><span class="hl-1"> * </span><span class="hl-7">100</span>
</code><button type="button">Copy</button></pre>

<a id="production-readiness-8510" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Production Readiness (8.5/10)<a href="#production-readiness-8510" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="‚úÖ-production-ready-features" class="tsd-anchor"></a><h3 class="tsd-anchor-link">‚úÖ Production-Ready Features<a href="#‚úÖ-production-ready-features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ol>
<li><strong>Crash-Safe Persistence</strong> - Atomic file writes with automatic recovery</li>
<li><strong>Signal Validation</strong> - Comprehensive validation prevents invalid trades</li>
<li><strong>Type Safety</strong> - Discriminated unions eliminate runtime type errors</li>
<li><strong>Memory Efficiency</strong> - Prototype methods + async generators + memoization</li>
<li><strong>Interval Throttling</strong> - Prevents signal spam</li>
<li><strong>Live Trading Ready</strong> - Full implementation with real-time progression</li>
<li><strong>Error Recovery</strong> - Stateless process with disk-based state</li>
</ol>
<a id="‚ö†Ô∏è-remaining-gaps" class="tsd-anchor"></a><h3 class="tsd-anchor-link">‚ö†Ô∏è Remaining Gaps<a href="#‚ö†Ô∏è-remaining-gaps" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ol>
<li><strong>Exchange Integration</strong> - Need real Binance/Bybit API connectors</li>
<li><strong>Order Execution</strong> - No actual trade execution logic yet</li>
<li><strong>Network Error Handling</strong> - Need retry logic for API failures</li>
<li><strong>Monitoring/Alerting</strong> - No observability layer</li>
<li><strong>Testing Coverage</strong> - Need comprehensive tests</li>
</ol>
<a id="recommended-next-steps" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Recommended Next Steps<a href="#recommended-next-steps" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ol>
<li>Implement exchange connectors with retry logic</li>
<li>Add order execution service</li>
<li>Build monitoring dashboard</li>
<li>Add integration tests</li>
<li>Implement portfolio risk management</li>
</ol>
<a id="file-structure" class="tsd-anchor"></a><h2 class="tsd-anchor-link">File Structure<a href="#file-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code><span class="hl-4">src</span><span class="hl-1">/</span><br/><span class="hl-1">‚îú‚îÄ‚îÄ </span><span class="hl-4">client</span><span class="hl-1">/                      # </span><span class="hl-4">Pure</span><span class="hl-1"> </span><span class="hl-4">business</span><span class="hl-1"> </span><span class="hl-0">logic</span><span class="hl-1"> (</span><span class="hl-4">no</span><span class="hl-1"> </span><span class="hl-9">DI</span><span class="hl-1">)</span><br/><span class="hl-1">‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-4">ClientStrategy</span><span class="hl-1">.</span><span class="hl-4">ts</span><span class="hl-1">       # </span><span class="hl-4">Signal</span><span class="hl-1"> </span><span class="hl-4">lifecycle</span><span class="hl-1"> + </span><span class="hl-4">validation</span><span class="hl-1"> + </span><span class="hl-4">persistence</span><br/><span class="hl-1">‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-4">ClientExchange</span><span class="hl-1">.</span><span class="hl-4">ts</span><span class="hl-1">       # </span><span class="hl-9">VWAP</span><span class="hl-1"> </span><span class="hl-4">calculation</span><br/><span class="hl-1">‚îÇ   ‚îî‚îÄ‚îÄ </span><span class="hl-4">ClientFrame</span><span class="hl-1">.</span><span class="hl-4">ts</span><span class="hl-1">          # </span><span class="hl-4">Timeframe</span><span class="hl-1"> </span><span class="hl-4">generation</span><br/><span class="hl-1">‚îú‚îÄ‚îÄ </span><span class="hl-4">classes</span><span class="hl-1">/</span><br/><span class="hl-1">‚îÇ   ‚îî‚îÄ‚îÄ </span><span class="hl-4">Persist</span><span class="hl-1">.</span><span class="hl-4">ts</span><span class="hl-1">              # </span><span class="hl-4">Atomic</span><span class="hl-1"> </span><span class="hl-4">file</span><span class="hl-1"> </span><span class="hl-4">persistence</span><br/><span class="hl-1">‚îú‚îÄ‚îÄ </span><span class="hl-5">function</span><span class="hl-1">/                   # </span><span class="hl-0">High</span><span class="hl-1">-</span><span class="hl-0">level</span><span class="hl-1"> </span><span class="hl-0">API</span><br/><span class="hl-1">‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-0">add</span><span class="hl-1">.</span><span class="hl-0">ts</span><span class="hl-1">                  # </span><span class="hl-0">addStrategy</span><span class="hl-1">, </span><span class="hl-0">addExchange</span><span class="hl-1">, </span><span class="hl-0">addFrame</span><br/><span class="hl-1">‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-0">backtest</span><span class="hl-1">.</span><span class="hl-0">ts</span><span class="hl-1">             # </span><span class="hl-0">Legacy</span><span class="hl-1"> </span><span class="hl-0">backtest</span><span class="hl-1"> </span><span class="hl-0">API</span><br/><span class="hl-1">‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-0">exchange</span><span class="hl-1">.</span><span class="hl-0">ts</span><span class="hl-1">             # </span><span class="hl-0">getCandles</span><span class="hl-1">, </span><span class="hl-0">getAveragePrice</span><span class="hl-1">, </span><span class="hl-0">getDate</span><span class="hl-1">, </span><span class="hl-0">getMode</span><br/><span class="hl-1">‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-0">reduce</span><span class="hl-1">.</span><span class="hl-0">ts</span><span class="hl-1">               # </span><span class="hl-0">Reduce</span><span class="hl-1"> </span><span class="hl-0">pattern</span><br/><span class="hl-1">‚îÇ   ‚îî‚îÄ‚îÄ </span><span class="hl-0">run</span><span class="hl-1">.</span><span class="hl-0">ts</span><span class="hl-1">                  # </span><span class="hl-0">DEPRECATED</span><span class="hl-1"> - </span><span class="hl-0">use</span><span class="hl-1"> </span><span class="hl-0">logic</span><span class="hl-1"> </span><span class="hl-0">services</span><span class="hl-1"> </span><span class="hl-0">instead</span><br/><span class="hl-1">‚îú‚îÄ‚îÄ </span><span class="hl-0">interfaces</span><span class="hl-1">/                 # </span><span class="hl-0">TypeScript</span><span class="hl-1"> </span><span class="hl-0">interfaces</span><br/><span class="hl-1">‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-0">Strategy</span><span class="hl-1">.</span><span class="hl-0">interface</span><span class="hl-1">.</span><span class="hl-0">ts</span><br/><span class="hl-1">‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-0">Exchange</span><span class="hl-1">.</span><span class="hl-0">interface</span><span class="hl-1">.</span><span class="hl-0">ts</span><br/><span class="hl-1">‚îÇ   ‚îî‚îÄ‚îÄ </span><span class="hl-0">Frame</span><span class="hl-1">.</span><span class="hl-0">interface</span><span class="hl-1">.</span><span class="hl-0">ts</span><br/><span class="hl-1">‚îú‚îÄ‚îÄ </span><span class="hl-0">lib</span><span class="hl-1">/</span><br/><span class="hl-1">‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-0">core</span><span class="hl-1">/                   # </span><span class="hl-0">DI</span><span class="hl-1"> </span><span class="hl-0">container</span><br/><span class="hl-1">‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-0">services</span><span class="hl-1">/</span><br/><span class="hl-1">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-0">base</span><span class="hl-1">/              # </span><span class="hl-0">LoggerService</span><br/><span class="hl-1">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-0">context</span><span class="hl-1">/           # </span><span class="hl-0">ExecutionContext</span><span class="hl-1">, </span><span class="hl-0">MethodContext</span><br/><span class="hl-1">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-0">connection</span><span class="hl-1">/        # </span><span class="hl-0">Client</span><span class="hl-1"> </span><span class="hl-0">instance</span><span class="hl-1"> </span><span class="hl-0">creators</span><br/><span class="hl-1">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-0">global</span><span class="hl-1">/            # </span><span class="hl-0">Context</span><span class="hl-1"> </span><span class="hl-0">wrappers</span><br/><span class="hl-1">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-0">schema</span><span class="hl-1">/            # </span><span class="hl-0">Registry</span><span class="hl-1"> </span><span class="hl-0">services</span><br/><span class="hl-1">‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ </span><span class="hl-0">logic</span><span class="hl-1">/</span><br/><span class="hl-1">‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ </span><span class="hl-0">private</span><span class="hl-1">/       # </span><span class="hl-0">Async</span><span class="hl-1"> </span><span class="hl-0">generator</span><span class="hl-1"> </span><span class="hl-0">orchestration</span><br/><span class="hl-1">‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ </span><span class="hl-0">BacktestLogicPrivateService</span><span class="hl-1">.</span><span class="hl-0">ts</span><br/><span class="hl-1">‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ </span><span class="hl-0">LiveLogicPrivateService</span><span class="hl-1">.</span><span class="hl-0">ts</span><br/><span class="hl-1">‚îÇ   ‚îî‚îÄ‚îÄ </span><span class="hl-0">index</span><span class="hl-1">.</span><span class="hl-0">ts</span><span class="hl-1">               # </span><span class="hl-0">Public</span><span class="hl-1"> </span><span class="hl-0">API</span><br/><span class="hl-1">‚îî‚îÄ‚îÄ </span><span class="hl-0">helpers</span><span class="hl-1">/</span><br/><span class="hl-1">    ‚îî‚îÄ‚îÄ </span><span class="hl-0">toProfitLossDto</span><span class="hl-1">.</span><span class="hl-0">ts</span><span class="hl-1">     # </span><span class="hl-0">PNL</span><span class="hl-1"> </span><span class="hl-0">calculation</span>
</code><button>Copy</button></pre>

<a id="advanced-examples" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Advanced Examples<a href="#advanced-examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="custom-persistence-adapter" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Custom Persistence Adapter<a href="#custom-persistence-adapter" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">PersistSignalAdaper</span><span class="hl-1">, </span><span class="hl-4">PersistBase</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit/classes/Persist&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">class</span><span class="hl-1"> </span><span class="hl-11">RedisPersist</span><span class="hl-1"> </span><span class="hl-5">extends</span><span class="hl-1"> </span><span class="hl-11">PersistBase</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">readValue</span><span class="hl-1">(</span><span class="hl-4">entityId</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-9">JSON</span><span class="hl-1">.</span><span class="hl-0">parse</span><span class="hl-1">(</span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">redis</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-4">entityId</span><span class="hl-1">));</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">writeValue</span><span class="hl-1">(</span><span class="hl-4">entityId</span><span class="hl-1">, </span><span class="hl-4">entity</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">redis</span><span class="hl-1">.</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-4">entityId</span><span class="hl-1">, </span><span class="hl-9">JSON</span><span class="hl-1">.</span><span class="hl-0">stringify</span><span class="hl-1">(</span><span class="hl-4">entity</span><span class="hl-1">));</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">PersistSignalAdaper</span><span class="hl-1">.</span><span class="hl-0">usePersistSignalAdapter</span><span class="hl-1">(</span><span class="hl-4">RedisPersist</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="multi-symbol-live-trading" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Multi-Symbol Live Trading<a href="#multi-symbol-live-trading" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-9">symbols</span><span class="hl-1"> = [</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;ETHUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;SOLUSDT&quot;</span><span class="hl-1">];</span><br/><br/><span class="hl-6">// Run all symbols in parallel</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-11">Promise</span><span class="hl-1">.</span><span class="hl-0">all</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbols</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">for</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> (</span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-9">result</span><span class="hl-1"> </span><span class="hl-5">of</span><span class="hl-1"> </span><span class="hl-4">liveLogic</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">)) {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[</span><span class="hl-5">${</span><span class="hl-4">symbol</span><span class="hl-5">}</span><span class="hl-2">]`</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="early-termination" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Early Termination<a href="#early-termination" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">for</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> (</span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-9">result</span><span class="hl-1"> </span><span class="hl-5">of</span><span class="hl-1"> </span><span class="hl-4">backtestLogic</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">)) {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">closeReason</span><span class="hl-1"> === </span><span class="hl-2">&quot;stop_loss&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Stop loss hit - terminating backtest&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">break</span><span class="hl-1">; </span><span class="hl-6">// Generator stops immediately</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="deprecated-apis" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Deprecated APIs<a href="#deprecated-apis" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong><code>src/function/run.ts</code></strong> - Use <code>liveLogicPublicService.run()</code> instead</li>
<li>Global mutable state (<code>startRun</code>, <code>stopRun</code>) - Prefer explicit service instantiation</li>
</ul>
<a id="use-cases" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Use Cases<a href="#use-cases" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Algorithmic Trading</strong> - Backtest and deploy strategies with crash recovery</li>
<li><strong>Strategy Research</strong> - Test hypotheses on historical data</li>
<li><strong>Signal Generation</strong> - Use with ML models or technical indicators</li>
<li><strong>Portfolio Management</strong> - Track multiple strategies across symbols</li>
<li><strong>Educational Projects</strong> - Learn trading system architecture</li>
</ul>
<a id="contributing" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Contributing<a href="#contributing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Pull requests are welcome. For major changes, please open an issue first.</p>
<a id="license" class="tsd-anchor"></a><h2 class="tsd-anchor-link">License<a href="#license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>MIT</p>
<a id="links" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Links<a href="#links" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><a href="media/ARCHITECTURE.md">Architecture Documentation</a></li>
<li><a href="https://www.typescriptlang.org/">TypeScript Documentation</a></li>
<li><a href="https://github.com/tripolskypetr/di-kit">Dependency Injection</a></li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#backtest-kit"><span>Backtest <wbr/>Kit</span></a><ul><li><a href="#features"><span>Features</span></a></li><li><a href="#installation"><span>Installation</span></a></li><li><a href="#quick-start"><span>Quick <wbr/>Start</span></a></li><li><ul><li><a href="#1-register-exchange-data-source"><span>1. <wbr/>Register <wbr/>Exchange <wbr/>Data <wbr/>Source</span></a></li><li><a href="#2-register-trading-strategy"><span>2. <wbr/>Register <wbr/>Trading <wbr/>Strategy</span></a></li><li><a href="#3-add-timeframe-generator"><span>3. <wbr/>Add <wbr/>Timeframe <wbr/>Generator</span></a></li><li><a href="#4-run-backtest-with-async-generator"><span>4. <wbr/>Run <wbr/>Backtest with <wbr/>Async <wbr/>Generator</span></a></li><li><a href="#5-live-trading-with-crash-recovery"><span>5. <wbr/>Live <wbr/>Trading with <wbr/>Crash <wbr/>Recovery</span></a></li></ul></li><li><a href="#architecture-overview"><span>Architecture <wbr/>Overview</span></a></li><li><a href="#signal-validation"><span>Signal <wbr/>Validation</span></a></li><li><a href="#interval-throttling"><span>Interval <wbr/>Throttling</span></a></li><li><a href="#api-reference"><span>API <wbr/>Reference</span></a></li><li><ul><li><a href="#high-level-functions"><span>High-<wbr/>Level <wbr/>Functions</span></a></li><li><ul><li><a href="#schema-registration"><span>Schema <wbr/>Registration</span></a></li><li><a href="#exchange-data"><span>Exchange <wbr/>Data</span></a></li></ul></li><li><a href="#service-apis"><span>Service APIs</span></a></li><li><ul><li><a href="#backtest-logic"><span>Backtest <wbr/>Logic</span></a></li><li><a href="#live-logic"><span>Live <wbr/>Logic</span></a></li><li><a href="#advanced-reduce-pattern"><span>Advanced: <wbr/>Reduce <wbr/>Pattern</span></a></li></ul></li></ul></li><li><a href="#type-definitions"><span>Type <wbr/>Definitions</span></a></li><li><ul><li><a href="#signal-data"><span>Signal <wbr/>Data</span></a></li><li><a href="#tick-results-discriminated-union"><span>Tick <wbr/>Results (<wbr/>Discriminated <wbr/>Union)</span></a></li><li><a href="#pnl-calculation"><span>PNL <wbr/>Calculation</span></a></li></ul></li><li><a href="#production-readiness-8510"><span>Production <wbr/>Readiness (8.5/10)</span></a></li><li><ul><li><a href="#‚úÖ-production-ready-features"><span>‚úÖ <wbr/>Production-<wbr/>Ready <wbr/>Features</span></a></li><li><a href="#‚ö†Ô∏è-remaining-gaps"><span>‚ö†Ô∏è <wbr/>Remaining <wbr/>Gaps</span></a></li><li><a href="#recommended-next-steps"><span>Recommended <wbr/>Next <wbr/>Steps</span></a></li></ul></li><li><a href="#file-structure"><span>File <wbr/>Structure</span></a></li><li><a href="#advanced-examples"><span>Advanced <wbr/>Examples</span></a></li><li><ul><li><a href="#custom-persistence-adapter"><span>Custom <wbr/>Persistence <wbr/>Adapter</span></a></li><li><a href="#multi-symbol-live-trading"><span>Multi-<wbr/>Symbol <wbr/>Live <wbr/>Trading</span></a></li><li><a href="#early-termination"><span>Early <wbr/>Termination</span></a></li></ul></li><li><a href="#deprecated-apis"><span>Deprecated APIs</span></a></li><li><a href="#use-cases"><span>Use <wbr/>Cases</span></a></li><li><a href="#contributing"><span>Contributing</span></a></li><li><a href="#license"><span>License</span></a></li><li><a href="#links"><span>Links</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
