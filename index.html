<!DOCTYPE html><html class="default" lang="en" data-base="."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script><script async src="assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>backtest-kit</h1></div><div class="tsd-panel tsd-typography"><a id="üßø-backtest-kit" class="tsd-anchor"></a><h1 class="tsd-anchor-link">üßø Backtest Kit<a href="#üßø-backtest-kit" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><blockquote>
<p>A production-ready TypeScript framework for backtesting and live trading strategies with crash-safe state persistence, signal validation, and memory-optimized architecture.</p>
</blockquote>
<p><a href="https://deepwiki.com/tripolskypetr/backtest-kit"><img src="https://deepwiki.com/badge.svg" alt="Ask DeepWiki"></a>
<a href=""><img src="https://img.shields.io/badge/TypeScript-5.0+-blue" alt="TypeScript"></a>
<a href=""><img src="https://img.shields.io/badge/architecture-clean-orange" alt="Architecture"></a></p>
<a id="features" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Features<a href="#features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>üöÄ <strong>Production-Ready Architecture</strong> - Backtest/live mode, robust error recovery</li>
<li>üíæ <strong>Crash-Safe Persistence</strong> - Atomic file writes with automatic state recovery</li>
<li>‚úÖ <strong>Signal Validation</strong> - Comprehensive validation prevents invalid trades</li>
<li>üîÑ <strong>Async Generators</strong> - Memory-efficient streaming for backtest and live execution</li>
<li>üìä <strong>VWAP Pricing</strong> - Volume-weighted average price from last 5 1m candles</li>
<li>üéØ <strong>Signal Lifecycle</strong> - Type-safe state machine (idle ‚Üí opened ‚Üí active ‚Üí closed)</li>
<li>üìà <strong>Accurate PNL</strong> - Calculation with fees (0.1%) and slippage (0.1%)</li>
<li>üß† <strong>Interval Throttling</strong> - Prevents signal spam at strategy level</li>
<li>‚ö° <strong>Memory Optimized</strong> - Prototype methods + memoization + streaming</li>
<li>üîå <strong>Flexible Architecture</strong> - Plug your own exchanges and strategies</li>
<li>üìù <strong>Markdown Reports</strong> - Auto-generated trading reports with statistics (win rate, avg PNL, Sharpe Ratio, Standard Deviation, Certainty Ratio, Expected Yearly Returns, Risk-Adjusted Returns)</li>
<li>üìä <strong>Revenue Profiling</strong> - Built-in performance tracking with aggregated statistics (avg, min, max, stdDev, P95, P99) for bottleneck analysis</li>
<li>üõë <strong>Graceful Shutdown</strong> - Live.background() waits for open positions to close before stopping</li>
<li>üíâ <strong>Strategy Dependency Injection</strong> - addStrategy() enables DI pattern for trading strategies</li>
<li>üîç <strong>Schema Reflection API</strong> - listExchanges(), listStrategies(), listFrames() for runtime introspection</li>
<li>üèÉ <strong>Strategy Comparison (Walker)</strong> - Compare multiple strategies in parallel with automatic ranking and statistical analysis</li>
<li>üî• <strong>Portfolio Heatmap</strong> - Multi-symbol performance analysis with extended metrics (Profit Factor, Expectancy, Win/Loss Streaks, Avg Win/Loss) sorted by Sharpe Ratio</li>
<li>üß™ <strong>Comprehensive Test Coverage</strong> - 89 unit tests covering validation, PNL, callbacks, reports, performance tracking, walker, heatmap, position sizing, and event system</li>
<li>üí∞ <strong>Position Sizing Calculator</strong> - Built-in position sizing methods (Fixed Percentage, Kelly Criterion, ATR-based) with risk management constraints</li>
<li>üíæ <strong>Zero Data Download</strong> - Unlike Freqtrade, no need to download gigabytes of historical data - plug any data source (CCXT, database, API)</li>
<li>üîí <strong>Safe Math &amp; Robustness</strong> - All metrics protected against NaN/Infinity with unsafe numeric checks, returns N/A for invalid calculations</li>
</ul>
<a id="installation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Installation<a href="#installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">backtest-kit</span>
</code><button type="button">Copy</button></pre>

<a id="quick-start" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Quick Start<a href="#quick-start" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="1-register-exchange-data-source" class="tsd-anchor"></a><h3 class="tsd-anchor-link">1. Register Exchange Data Source<a href="#1-register-exchange-data-source" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addExchange</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">ccxt</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ccxt&quot;</span><span class="hl-1">; </span><span class="hl-5">// Example using CCXT library</span><br/><br/><span class="hl-0">addExchange</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><br/><span class="hl-1">  </span><span class="hl-5">// Fetch historical candles</span><br/><span class="hl-1">  </span><span class="hl-0">getCandles</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">exchange</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-4">ccxt</span><span class="hl-1">.</span><span class="hl-0">binance</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">ohlcv</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">fetchOHLCV</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">.</span><span class="hl-0">getTime</span><span class="hl-1">(), </span><span class="hl-4">limit</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">ohlcv</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(([</span><span class="hl-4">timestamp</span><span class="hl-1">, </span><span class="hl-4">open</span><span class="hl-1">, </span><span class="hl-4">high</span><span class="hl-1">, </span><span class="hl-4">low</span><span class="hl-1">, </span><span class="hl-4">close</span><span class="hl-1">, </span><span class="hl-4">volume</span><span class="hl-1">]) </span><span class="hl-6">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">      </span><span class="hl-4">timestamp</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">open</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">high</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">low</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">close</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">volume</span><span class="hl-1">,</span><br/><span class="hl-1">    }));</span><br/><span class="hl-1">  },</span><br/><br/><span class="hl-1">  </span><span class="hl-5">// Format price according to exchange rules (e.g., 2 decimals for BTC)</span><br/><span class="hl-1">  </span><span class="hl-0">formatPrice</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">exchange</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-4">ccxt</span><span class="hl-1">.</span><span class="hl-0">binance</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">market</span><span class="hl-1"> = </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">market</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">priceToPrecision</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><br/><span class="hl-1">  </span><span class="hl-5">// Format quantity according to exchange rules (e.g., 8 decimals)</span><br/><span class="hl-1">  </span><span class="hl-0">formatQuantity</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">exchange</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-4">ccxt</span><span class="hl-1">.</span><span class="hl-0">binance</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">amountToPrecision</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Alternative: Database implementation</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addExchange</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">db</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./database&quot;</span><span class="hl-1">; </span><span class="hl-5">// Your database client</span><br/><br/><span class="hl-0">addExchange</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance-db&quot;</span><span class="hl-1">,</span><br/><br/><span class="hl-1">  </span><span class="hl-0">getCandles</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// Fetch from database for faster backtesting</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">db</span><span class="hl-1">.</span><span class="hl-0">query</span><span class="hl-1">(</span><span class="hl-2">`</span><br/><span class="hl-2">      SELECT timestamp, open, high, low, close, volume</span><br/><span class="hl-2">      FROM candles</span><br/><span class="hl-2">      WHERE symbol = $1 AND interval = $2 AND timestamp &gt;= $3</span><br/><span class="hl-2">      ORDER BY timestamp ASC</span><br/><span class="hl-2">      LIMIT $4</span><br/><span class="hl-2">    `</span><span class="hl-1">, [</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">]);</span><br/><span class="hl-1">  },</span><br/><br/><span class="hl-1">  </span><span class="hl-0">formatPrice</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">price</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-0">formatQuantity</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">quantity</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-8">8</span><span class="hl-1">),</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="2-register-trading-strategy" class="tsd-anchor"></a><h3 class="tsd-anchor-link">2. Register Trading Strategy<a href="#2-register-trading-strategy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addStrategy</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">, </span><span class="hl-5">// Throttling: signals generated max once per 5 minutes</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// Your signal generation logic</span><br/><span class="hl-1">    </span><span class="hl-5">// Validation happens automatically (prices, TP/SL logic)</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">position:</span><span class="hl-1"> </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;BTC breakout&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">priceOpen:</span><span class="hl-1"> </span><span class="hl-8">50000</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">priceTakeProfit:</span><span class="hl-1"> </span><span class="hl-8">51000</span><span class="hl-1">,  </span><span class="hl-5">// Must be &gt; priceOpen for long</span><br/><span class="hl-1">      </span><span class="hl-4">priceStopLoss:</span><span class="hl-1"> </span><span class="hl-8">49000</span><span class="hl-1">,     </span><span class="hl-5">// Must be &lt; priceOpen for long</span><br/><span class="hl-1">      </span><span class="hl-4">minuteEstimatedTime:</span><span class="hl-1"> </span><span class="hl-8">60</span><span class="hl-1">,  </span><span class="hl-5">// Signal duration in minutes</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onOpen</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">, </span><span class="hl-4">currentPrice</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[</span><span class="hl-6">${</span><span class="hl-4">backtest</span><span class="hl-9"> </span><span class="hl-1">?</span><span class="hl-9"> </span><span class="hl-2">&quot;BT&quot;</span><span class="hl-9"> </span><span class="hl-1">:</span><span class="hl-9"> </span><span class="hl-2">&quot;LIVE&quot;</span><span class="hl-6">}</span><span class="hl-2">] Signal opened:`</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">id</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">onClose</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">, </span><span class="hl-4">priceClose</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[</span><span class="hl-6">${</span><span class="hl-4">backtest</span><span class="hl-9"> </span><span class="hl-1">?</span><span class="hl-9"> </span><span class="hl-2">&quot;BT&quot;</span><span class="hl-9"> </span><span class="hl-1">:</span><span class="hl-9"> </span><span class="hl-2">&quot;LIVE&quot;</span><span class="hl-6">}</span><span class="hl-2">] Signal closed:`</span><span class="hl-1">, </span><span class="hl-4">priceClose</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="3-add-timeframe-generator" class="tsd-anchor"></a><h3 class="tsd-anchor-link">3. Add Timeframe Generator<a href="#3-add-timeframe-generator" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addFrame</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addFrame</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-backtest&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;1m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-01T00:00:00Z&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-02T00:00:00Z&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onTimeframe</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">timeframe</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Generated </span><span class="hl-6">${</span><span class="hl-4">timeframe</span><span class="hl-9">.</span><span class="hl-4">length</span><span class="hl-6">}</span><span class="hl-2"> timeframes from </span><span class="hl-6">${</span><span class="hl-4">startDate</span><span class="hl-6">}</span><span class="hl-2"> to </span><span class="hl-6">${</span><span class="hl-4">endDate</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="4-run-backtest" class="tsd-anchor"></a><h3 class="tsd-anchor-link">4. Run Backtest<a href="#4-run-backtest" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Backtest</span><span class="hl-1">, </span><span class="hl-4">listenSignalBacktest</span><span class="hl-1">, </span><span class="hl-4">listenError</span><span class="hl-1">, </span><span class="hl-4">listenDoneBacktest</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Run backtest in background</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stopBacktest</span><span class="hl-1"> = </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-backtest&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Listen to closed signals</span><br/><span class="hl-0">listenSignalBacktest</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;PNL:&quot;</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Listen to errors</span><br/><span class="hl-0">listenError</span><span class="hl-1">((</span><span class="hl-4">error</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">&quot;Error:&quot;</span><span class="hl-1">, </span><span class="hl-4">error</span><span class="hl-1">.</span><span class="hl-4">message</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Listen to backtest completion</span><br/><span class="hl-0">listenDoneBacktest</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Backtest completed:&quot;</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-5">// Generate and save report</span><br/><span class="hl-1">  </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">); </span><span class="hl-5">// ./logs/backtest/my-strategy.md</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="5-run-live-trading-crash-safe" class="tsd-anchor"></a><h3 class="tsd-anchor-link">5. Run Live Trading (Crash-Safe)<a href="#5-run-live-trading-crash-safe" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Live</span><span class="hl-1">, </span><span class="hl-4">listenSignalLive</span><span class="hl-1">, </span><span class="hl-4">listenError</span><span class="hl-1">, </span><span class="hl-4">listenDoneLive</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Run live trading in background (infinite loop, crash-safe)</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stop</span><span class="hl-1"> = </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Listen to all signal events</span><br/><span class="hl-0">listenSignalLive</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;opened&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Signal opened:&quot;</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">id</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Signal closed:&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">      </span><span class="hl-4">reason:</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">closeReason</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">pnl:</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><br/><span class="hl-1">    </span><span class="hl-5">// Auto-save report</span><br/><span class="hl-1">    </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Listen to errors</span><br/><span class="hl-0">listenError</span><span class="hl-1">((</span><span class="hl-4">error</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">&quot;Error:&quot;</span><span class="hl-1">, </span><span class="hl-4">error</span><span class="hl-1">.</span><span class="hl-4">message</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Listen to live trading completion</span><br/><span class="hl-0">listenDoneLive</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Live trading stopped:&quot;</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Stop when needed: stop();</span>
</code><button type="button">Copy</button></pre>

<p><strong>Crash Recovery:</strong> If process crashes, restart with same code - state automatically recovered from disk (no duplicate signals).</p>
<a id="6-alternative-async-generators-optional" class="tsd-anchor"></a><h3 class="tsd-anchor-link">6. Alternative: Async Generators (Optional)<a href="#6-alternative-async-generators-optional" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>For manual control over execution flow:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Backtest</span><span class="hl-1">, </span><span class="hl-4">Live</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Manual backtest iteration</span><br/><span class="hl-3">for</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">result</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-backtest&quot;</span><br/><span class="hl-1">})) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;PNL:&quot;</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1"> &lt; -</span><span class="hl-8">5</span><span class="hl-1">) </span><span class="hl-3">break</span><span class="hl-1">; </span><span class="hl-5">// Early termination</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Manual live iteration (infinite loop)</span><br/><span class="hl-3">for</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">result</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><br/><span class="hl-1">})) {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;PNL:&quot;</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="7-strategy-comparison-with-walker-optional" class="tsd-anchor"></a><h3 class="tsd-anchor-link">7. Strategy Comparison with Walker (Optional)<a href="#7-strategy-comparison-with-walker-optional" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Walker runs multiple strategies in parallel and compares their performance to find the best one. It automatically pulls configuration from walker schema.</p>
<a id="register-walker-schema" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Register Walker Schema<a href="#register-walker-schema" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addWalker</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addWalker</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">walkerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;btc-walker&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-backtest&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">strategies:</span><span class="hl-1"> [</span><span class="hl-2">&quot;strategy-a&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;strategy-b&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;strategy-c&quot;</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">metric:</span><span class="hl-1"> </span><span class="hl-2">&quot;sharpeRatio&quot;</span><span class="hl-1">, </span><span class="hl-5">// Metric to compare strategies</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onStrategyStart</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Starting strategy: </span><span class="hl-6">${</span><span class="hl-4">strategyName</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">onStrategyComplete</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">stats</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`</span><span class="hl-6">${</span><span class="hl-4">strategyName</span><span class="hl-6">}</span><span class="hl-2"> completed:`</span><span class="hl-1">, </span><span class="hl-4">stats</span><span class="hl-1">.</span><span class="hl-4">sharpeRatio</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">onComplete</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">results</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Best strategy:&quot;</span><span class="hl-1">, </span><span class="hl-4">results</span><span class="hl-1">.</span><span class="hl-4">bestStrategy</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Best metric:&quot;</span><span class="hl-1">, </span><span class="hl-4">results</span><span class="hl-1">.</span><span class="hl-4">bestMetric</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="run-walker-comparison" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Run Walker Comparison<a href="#run-walker-comparison" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Walker</span><span class="hl-1">, </span><span class="hl-4">listenWalker</span><span class="hl-1">, </span><span class="hl-4">listenDoneWalker</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Listen to walker progress</span><br/><span class="hl-0">listenWalker</span><span class="hl-1">((</span><span class="hl-4">progress</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Progress: </span><span class="hl-6">${</span><span class="hl-4">progress</span><span class="hl-9">.</span><span class="hl-4">strategiesTested</span><span class="hl-6">}</span><span class="hl-2">/</span><span class="hl-6">${</span><span class="hl-4">progress</span><span class="hl-9">.</span><span class="hl-4">totalStrategies</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Current best: </span><span class="hl-6">${</span><span class="hl-4">progress</span><span class="hl-9">.</span><span class="hl-4">bestStrategy</span><span class="hl-6">}</span><span class="hl-2"> (</span><span class="hl-6">${</span><span class="hl-4">progress</span><span class="hl-9">.</span><span class="hl-4">bestMetric</span><span class="hl-6">}</span><span class="hl-2">)`</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Listen to walker completion</span><br/><span class="hl-0">listenDoneWalker</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Walker completed:&quot;</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">); </span><span class="hl-5">// Save report</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Run walker in background</span><br/><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">walkerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;btc-walker&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Or manually iterate</span><br/><span class="hl-3">for</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">progress</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">walkerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;btc-walker&quot;</span><br/><span class="hl-1">})) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Progress:&quot;</span><span class="hl-1">, </span><span class="hl-4">progress</span><span class="hl-1">.</span><span class="hl-4">strategiesTested</span><span class="hl-1">, </span><span class="hl-2">&quot;/&quot;</span><span class="hl-1">, </span><span class="hl-4">progress</span><span class="hl-1">.</span><span class="hl-4">totalStrategies</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Best so far:&quot;</span><span class="hl-1">, </span><span class="hl-4">progress</span><span class="hl-1">.</span><span class="hl-4">bestStrategy</span><span class="hl-1">, </span><span class="hl-4">progress</span><span class="hl-1">.</span><span class="hl-4">bestMetric</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="get-walker-results" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Get Walker Results<a href="#get-walker-results" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Walker</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Get raw comparison data (Controller)</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">results</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;btc-walker&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">results</span><span class="hl-1">);</span><br/><span class="hl-5">// Returns:</span><br/><span class="hl-5">// {</span><br/><span class="hl-5">//   bestStrategy: &quot;strategy-b&quot;,</span><br/><span class="hl-5">//   bestMetric: 1.85,</span><br/><span class="hl-5">//   strategies: [</span><br/><span class="hl-5">//     {</span><br/><span class="hl-5">//       strategyName: &quot;strategy-a&quot;,</span><br/><span class="hl-5">//       stats: { sharpeRatio: 1.23, winRate: 65.5, ... },</span><br/><span class="hl-5">//       metric: 1.23</span><br/><span class="hl-5">//     },</span><br/><span class="hl-5">//     {</span><br/><span class="hl-5">//       strategyName: &quot;strategy-b&quot;,</span><br/><span class="hl-5">//       stats: { sharpeRatio: 1.85, winRate: 72.3, ... },</span><br/><span class="hl-5">//       metric: 1.85</span><br/><span class="hl-5">//     },</span><br/><span class="hl-5">//     {</span><br/><span class="hl-5">//       strategyName: &quot;strategy-c&quot;,</span><br/><span class="hl-5">//       stats: { sharpeRatio: 0.98, winRate: 58.2, ... },</span><br/><span class="hl-5">//       metric: 0.98</span><br/><span class="hl-5">//     }</span><br/><span class="hl-5">//   ]</span><br/><span class="hl-5">// }</span><br/><br/><span class="hl-5">// Generate markdown report (View)</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">markdown</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;btc-walker&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">markdown</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Save to disk (default: ./logs/walker/btc-walker.md)</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;btc-walker&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Save to custom path</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;btc-walker&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;./custom/path&quot;</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Walker Report Example:</strong></p>
<pre><code class="markdown"># Walker Report: btc-walker

Symbol: BTCUSDT
Comparison metric: Sharpe Ratio (higher is better)
Total strategies tested: 3

## Best Strategy: strategy-b
Metric value: 1.85

## All Strategies Ranked

| Rank | Strategy | Metric | Win Rate | Avg PNL | Total PNL | Std Dev |
|------|----------|--------|----------|---------|-----------|---------|
| 1    | strategy-b | 1.85 | 72.3% | +2.15% | +43.00% | 1.16% |
| 2    | strategy-a | 1.23 | 65.5% | +1.85% | +37.00% | 1.50% |
| 3    | strategy-c | 0.98 | 58.2% | +1.45% | +29.00% | 1.48% |
</code><button type="button">Copy</button></pre>

<p><strong>Available metrics for comparison:</strong></p>
<ul>
<li><code>sharpeRatio</code> - Risk-adjusted return (default)</li>
<li><code>winRate</code> - Win percentage</li>
<li><code>avgPnl</code> - Average PNL percentage</li>
<li><code>totalPnl</code> - Total PNL percentage</li>
<li><code>certaintyRatio</code> - avgWin / |avgLoss|</li>
</ul>
<a id="8-portfolio-heatmap-optional" class="tsd-anchor"></a><h3 class="tsd-anchor-link">8. Portfolio Heatmap (Optional)<a href="#8-portfolio-heatmap-optional" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Heat provides portfolio-wide performance analysis across multiple symbols with extended metrics. Automatically collects data from all closed signals per strategy.</p>
<a id="get-heatmap-data" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Get Heatmap Data<a href="#get-heatmap-data" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Heat</span><span class="hl-1">, </span><span class="hl-4">Backtest</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Run backtests for multiple symbols</span><br/><span class="hl-3">for</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">symbol</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> [</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;ETHUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;SOLUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;BNBUSDT&quot;</span><span class="hl-1">]) {</span><br/><span class="hl-1">  </span><span class="hl-3">for</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">_</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;2024-backtest&quot;</span><br/><span class="hl-1">  })) {}</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Get raw heatmap data (Controller)</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">stats</span><span class="hl-1">);</span><br/><span class="hl-5">// Returns:</span><br/><span class="hl-5">// {</span><br/><span class="hl-5">//   symbols: [</span><br/><span class="hl-5">//     {</span><br/><span class="hl-5">//       symbol: &quot;BTCUSDT&quot;,</span><br/><span class="hl-5">//       totalPnl: 15.5,           // Total profit/loss %</span><br/><span class="hl-5">//       sharpeRatio: 2.10,        // Risk-adjusted return</span><br/><span class="hl-5">//       profitFactor: 2.50,       // Wins / Losses ratio</span><br/><span class="hl-5">//       expectancy: 1.85,         // Expected value per trade</span><br/><span class="hl-5">//       winRate: 72.3,            // Win percentage</span><br/><span class="hl-5">//       avgWin: 2.45,             // Average win %</span><br/><span class="hl-5">//       avgLoss: -0.95,           // Average loss %</span><br/><span class="hl-5">//       maxDrawdown: -2.5,        // Maximum drawdown %</span><br/><span class="hl-5">//       maxWinStreak: 5,          // Consecutive wins</span><br/><span class="hl-5">//       maxLossStreak: 2,         // Consecutive losses</span><br/><span class="hl-5">//       totalTrades: 45,</span><br/><span class="hl-5">//       winCount: 32,</span><br/><span class="hl-5">//       lossCount: 13,</span><br/><span class="hl-5">//       avgPnl: 0.34,</span><br/><span class="hl-5">//       stdDev: 1.62</span><br/><span class="hl-5">//     },</span><br/><span class="hl-5">//     // ... more symbols sorted by Sharpe Ratio</span><br/><span class="hl-5">//   ],</span><br/><span class="hl-5">//   totalSymbols: 4,</span><br/><span class="hl-5">//   portfolioTotalPnl: 45.3,      // Portfolio-wide total PNL</span><br/><span class="hl-5">//   portfolioSharpeRatio: 1.85,   // Portfolio-wide Sharpe</span><br/><span class="hl-5">//   portfolioTotalTrades: 120</span><br/><span class="hl-5">// }</span><br/><br/><span class="hl-5">// Generate markdown report (View)</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">markdown</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">markdown</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Save to disk (default: ./logs/heatmap/my-strategy.md)</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Save to custom path</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;./reports&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Clear accumulated data</span><br/><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Clear all strategies</span><br/><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">();</span>
</code><button type="button">Copy</button></pre>

<a id="heatmap-report-example" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Heatmap Report Example<a href="#heatmap-report-example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="markdown"># Portfolio Heatmap: my-strategy

**Total Symbols:** 4 | **Portfolio PNL:** +45.30% | **Portfolio Sharpe:** 1.85 | **Total Trades:** 120

| Symbol | Total PNL | Sharpe | PF | Expect | WR | Avg Win | Avg Loss | Max DD | W Streak | L Streak | Trades |
|--------|-----------|--------|-------|--------|-----|---------|----------|--------|----------|----------|--------|
| BTCUSDT | +15.50% | 2.10 | 2.50 | +1.85% | 72.3% | +2.45% | -0.95% | -2.50% | 5 | 2 | 45 |
| ETHUSDT | +12.30% | 1.85 | 2.15 | +1.45% | 68.5% | +2.10% | -1.05% | -3.10% | 4 | 2 | 38 |
| SOLUSDT | +10.20% | 1.65 | 1.95 | +1.20% | 65.2% | +1.95% | -1.15% | -4.20% | 3 | 3 | 25 |
| BNBUSDT | +7.30% | 1.40 | 1.75 | +0.95% | 62.5% | +1.75% | -1.20% | -3.80% | 3 | 2 | 12 |
</code><button type="button">Copy</button></pre>

<p><strong>Column Descriptions:</strong></p>
<ul>
<li><strong>Total PNL</strong> - Total profit/loss percentage across all trades</li>
<li><strong>Sharpe</strong> - Risk-adjusted return (higher is better)</li>
<li><strong>PF</strong> - Profit Factor: sum of wins / sum of losses (&gt;1.0 is profitable)</li>
<li><strong>Expect</strong> - Expectancy: expected value per trade</li>
<li><strong>WR</strong> - Win Rate: percentage of winning trades</li>
<li><strong>Avg Win</strong> - Average profit on winning trades</li>
<li><strong>Avg Loss</strong> - Average loss on losing trades</li>
<li><strong>Max DD</strong> - Maximum drawdown (largest peak-to-trough decline)</li>
<li><strong>W Streak</strong> - Maximum consecutive winning trades</li>
<li><strong>L Streak</strong> - Maximum consecutive losing trades</li>
<li><strong>Trades</strong> - Total number of trades for this symbol</li>
</ul>
<p><strong>Note:</strong> Symbols are sorted by Sharpe Ratio descending (best performers first).</p>
<a id="use-cases" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Use Cases<a href="#use-cases" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><ul>
<li><strong>Multi-Symbol Portfolio Analysis</strong> - Compare performance across different trading pairs</li>
<li><strong>Symbol Selection</strong> - Identify which symbols work best with your strategy</li>
<li><strong>Risk Management</strong> - Monitor drawdowns and streaks across the portfolio</li>
<li><strong>Strategy Optimization</strong> - Focus on symbols with highest Sharpe Ratio</li>
<li><strong>Performance Tracking</strong> - Track long-term portfolio health with expectancy and profit factor</li>
</ul>
<a id="9-position-sizing-calculator-optional" class="tsd-anchor"></a><h3 class="tsd-anchor-link">9. Position Sizing Calculator (Optional)<a href="#9-position-sizing-calculator-optional" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Position Sizing Calculator helps determine optimal position sizes based on risk management rules. Three calculation methods are available with constraint enforcement.</p>
<a id="register-position-sizing-schemas" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Register Position Sizing Schemas<a href="#register-position-sizing-schemas" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addSizing</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Fixed Percentage Risk - risk fixed % of account per trade</span><br/><span class="hl-0">addSizing</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;conservative&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Conservative 2% risk per trade&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-2">&quot;fixed-percentage&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">riskPercentage:</span><span class="hl-1"> </span><span class="hl-8">2</span><span class="hl-1">,                </span><span class="hl-5">// Risk 2% of account per trade</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionPercentage:</span><span class="hl-1"> </span><span class="hl-8">10</span><span class="hl-1">,        </span><span class="hl-5">// Max 10% of account in single position (optional)</span><br/><span class="hl-1">  </span><span class="hl-4">minPositionSize:</span><span class="hl-1"> </span><span class="hl-8">0.001</span><span class="hl-1">,           </span><span class="hl-5">// Min 0.001 BTC position (optional)</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionSize:</span><span class="hl-1"> </span><span class="hl-8">1.0</span><span class="hl-1">,             </span><span class="hl-5">// Max 1.0 BTC position (optional)</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Kelly Criterion - optimal bet sizing based on edge</span><br/><span class="hl-0">addSizing</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;kelly-quarter&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Kelly Criterion with 25% multiplier for safety&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-2">&quot;kelly-criterion&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">kellyMultiplier:</span><span class="hl-1"> </span><span class="hl-8">0.25</span><span class="hl-1">,            </span><span class="hl-5">// Use 25% of full Kelly (recommended for safety)</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionPercentage:</span><span class="hl-1"> </span><span class="hl-8">15</span><span class="hl-1">,        </span><span class="hl-5">// Cap position at 15% of account (optional)</span><br/><span class="hl-1">  </span><span class="hl-4">minPositionSize:</span><span class="hl-1"> </span><span class="hl-8">0.001</span><span class="hl-1">,           </span><span class="hl-5">// Min 0.001 BTC position (optional)</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionSize:</span><span class="hl-1"> </span><span class="hl-8">2.0</span><span class="hl-1">,             </span><span class="hl-5">// Max 2.0 BTC position (optional)</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// ATR-based - volatility-adjusted position sizing</span><br/><span class="hl-0">addSizing</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;atr-dynamic&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;ATR-based sizing with 2x multiplier&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-2">&quot;atr-based&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">riskPercentage:</span><span class="hl-1"> </span><span class="hl-8">2</span><span class="hl-1">,                </span><span class="hl-5">// Risk 2% of account</span><br/><span class="hl-1">  </span><span class="hl-4">atrMultiplier:</span><span class="hl-1"> </span><span class="hl-8">2</span><span class="hl-1">,                 </span><span class="hl-5">// Use 2x ATR as stop distance</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionPercentage:</span><span class="hl-1"> </span><span class="hl-8">12</span><span class="hl-1">,        </span><span class="hl-5">// Max 12% of account (optional)</span><br/><span class="hl-1">  </span><span class="hl-4">minPositionSize:</span><span class="hl-1"> </span><span class="hl-8">0.001</span><span class="hl-1">,           </span><span class="hl-5">// Min 0.001 BTC position (optional)</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionSize:</span><span class="hl-1"> </span><span class="hl-8">1.5</span><span class="hl-1">,             </span><span class="hl-5">// Max 1.5 BTC position (optional)</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="calculate-position-sizes" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Calculate Position Sizes<a href="#calculate-position-sizes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">PositionSize</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Fixed Percentage Method</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">quantity1</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">PositionSize</span><span class="hl-1">.</span><span class="hl-0">fixedPercentage</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">10000</span><span class="hl-1">,      </span><span class="hl-5">// Account balance: $10,000</span><br/><span class="hl-1">  </span><span class="hl-8">50000</span><span class="hl-1">,      </span><span class="hl-5">// Entry price: $50,000</span><br/><span class="hl-1">  </span><span class="hl-8">49000</span><span class="hl-1">,      </span><span class="hl-5">// Stop loss: $49,000</span><br/><span class="hl-1">  { </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;conservative&quot;</span><span class="hl-1"> }</span><br/><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Position size: </span><span class="hl-6">${</span><span class="hl-4">quantity1</span><span class="hl-6">}</span><span class="hl-2"> BTC`</span><span class="hl-1">);</span><br/><span class="hl-5">// Formula: (accountBalance * riskPercentage / 100) / |priceOpen - priceStopLoss|</span><br/><span class="hl-5">// Example: (10000 * 0.02) / |50000 - 49000| = 0.2 BTC</span><br/><br/><span class="hl-5">// Kelly Criterion Method</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">quantity2</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">PositionSize</span><span class="hl-1">.</span><span class="hl-0">kellyCriterion</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">10000</span><span class="hl-1">,      </span><span class="hl-5">// Account balance: $10,000</span><br/><span class="hl-1">  </span><span class="hl-8">50000</span><span class="hl-1">,      </span><span class="hl-5">// Entry price: $50,000</span><br/><span class="hl-1">  </span><span class="hl-8">0.55</span><span class="hl-1">,       </span><span class="hl-5">// Win rate: 55%</span><br/><span class="hl-1">  </span><span class="hl-8">1.5</span><span class="hl-1">,        </span><span class="hl-5">// Win/loss ratio: 1.5</span><br/><span class="hl-1">  { </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;kelly-quarter&quot;</span><span class="hl-1"> }</span><br/><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Position size: </span><span class="hl-6">${</span><span class="hl-4">quantity2</span><span class="hl-6">}</span><span class="hl-2"> BTC`</span><span class="hl-1">);</span><br/><span class="hl-5">// Formula: (winRate - (1 - winRate) / winLossRatio) * kellyMultiplier * accountBalance / priceOpen</span><br/><span class="hl-5">// Example: (0.55 - 0.45/1.5) * 0.25 * 10000 / 50000 = 0.0125 BTC</span><br/><br/><span class="hl-5">// ATR-based Method</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">quantity3</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">PositionSize</span><span class="hl-1">.</span><span class="hl-0">atrBased</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">10000</span><span class="hl-1">,      </span><span class="hl-5">// Account balance: $10,000</span><br/><span class="hl-1">  </span><span class="hl-8">50000</span><span class="hl-1">,      </span><span class="hl-5">// Entry price: $50,000</span><br/><span class="hl-1">  </span><span class="hl-8">500</span><span class="hl-1">,        </span><span class="hl-5">// ATR: $500</span><br/><span class="hl-1">  { </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;atr-dynamic&quot;</span><span class="hl-1"> }</span><br/><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Position size: </span><span class="hl-6">${</span><span class="hl-4">quantity3</span><span class="hl-6">}</span><span class="hl-2"> BTC`</span><span class="hl-1">);</span><br/><span class="hl-5">// Formula: (accountBalance * riskPercentage / 100) / (atr * atrMultiplier)</span><br/><span class="hl-5">// Example: (10000 * 0.02) / (500 * 2) = 0.2 BTC</span>
</code><button type="button">Copy</button></pre>

<a id="integration-with-strategy" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Integration with Strategy<a href="#integration-with-strategy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addStrategy</span><span class="hl-1">, </span><span class="hl-4">PositionSize</span><span class="hl-1">, </span><span class="hl-4">getCandles</span><span class="hl-1">, </span><span class="hl-4">listenSignalLive</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Mock Binance exchange client</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">binance</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-0">marketBuy</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[BINANCE] Market BUY: </span><span class="hl-6">${</span><span class="hl-4">quantity</span><span class="hl-6">}</span><span class="hl-2"> </span><span class="hl-6">${</span><span class="hl-4">symbol</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-5">// return await exchange.createOrder(symbol, &quot;market&quot;, &quot;buy&quot;, quantity);</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> { </span><span class="hl-4">orderId:</span><span class="hl-1"> </span><span class="hl-4">Math</span><span class="hl-1">.</span><span class="hl-0">random</span><span class="hl-1">().</span><span class="hl-0">toString</span><span class="hl-1">(), </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">side:</span><span class="hl-1"> </span><span class="hl-2">&quot;buy&quot;</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1"> };</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">marketSell</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[BINANCE] Market SELL: </span><span class="hl-6">${</span><span class="hl-4">quantity</span><span class="hl-6">}</span><span class="hl-2"> </span><span class="hl-6">${</span><span class="hl-4">symbol</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-5">// return await exchange.createOrder(symbol, &quot;market&quot;, &quot;sell&quot;, quantity);</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> { </span><span class="hl-4">orderId:</span><span class="hl-1"> </span><span class="hl-4">Math</span><span class="hl-1">.</span><span class="hl-0">random</span><span class="hl-1">().</span><span class="hl-0">toString</span><span class="hl-1">(), </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">side:</span><span class="hl-1"> </span><span class="hl-2">&quot;sell&quot;</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1"> };</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">getBalance</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">asset</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[BINANCE] Get balance: </span><span class="hl-6">${</span><span class="hl-4">asset</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-5">// return await exchange.fetchBalance();</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> { </span><span class="hl-4">free:</span><span class="hl-1"> </span><span class="hl-8">10000</span><span class="hl-1">, </span><span class="hl-4">used:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-4">total:</span><span class="hl-1"> </span><span class="hl-8">10000</span><span class="hl-1"> };</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;sma-crossover-sized&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">position:</span><span class="hl-1"> </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">priceOpen:</span><span class="hl-1"> </span><span class="hl-8">50000</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">priceTakeProfit:</span><span class="hl-1"> </span><span class="hl-8">51000</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">priceStopLoss:</span><span class="hl-1"> </span><span class="hl-8">49000</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">minuteEstimatedTime:</span><span class="hl-1"> </span><span class="hl-8">60</span><span class="hl-1">,</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onOpen</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">, </span><span class="hl-4">currentPrice</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">backtest</span><span class="hl-1">) </span><span class="hl-3">return</span><span class="hl-1">; </span><span class="hl-5">// Skip execution in backtest mode</span><br/><br/><span class="hl-1">      </span><span class="hl-5">// Calculate ATR for dynamic sizing</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">candles</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getCandles</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-2">&quot;1h&quot;</span><span class="hl-1">, </span><span class="hl-8">14</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">atr</span><span class="hl-1"> = </span><span class="hl-0">calculateATR</span><span class="hl-1">(</span><span class="hl-4">candles</span><span class="hl-1">); </span><span class="hl-5">// Your ATR calculation</span><br/><br/><span class="hl-1">      </span><span class="hl-5">// Get account balance from exchange</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">balance</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">binance</span><span class="hl-1">.</span><span class="hl-0">getBalance</span><span class="hl-1">(</span><span class="hl-2">&quot;USDT&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">accountBalance</span><span class="hl-1"> = </span><span class="hl-4">balance</span><span class="hl-1">.</span><span class="hl-4">free</span><span class="hl-1">;</span><br/><br/><span class="hl-1">      </span><span class="hl-5">// Calculate position size based on volatility</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">quantity</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">PositionSize</span><span class="hl-1">.</span><span class="hl-0">atrBased</span><span class="hl-1">(</span><br/><span class="hl-1">        </span><span class="hl-4">symbol</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">accountBalance</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">atr</span><span class="hl-1">,</span><br/><span class="hl-1">        { </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;atr-dynamic&quot;</span><span class="hl-1"> }</span><br/><span class="hl-1">      );</span><br/><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[LIVE] Opening position: </span><span class="hl-6">${</span><span class="hl-4">quantity</span><span class="hl-6">}</span><span class="hl-2"> BTC at </span><span class="hl-6">${</span><span class="hl-4">currentPrice</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><br/><span class="hl-1">      </span><span class="hl-5">// Execute market buy order</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">order</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">binance</span><span class="hl-1">.</span><span class="hl-0">marketBuy</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Order executed:`</span><span class="hl-1">, </span><span class="hl-4">order</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">onClose</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">, </span><span class="hl-4">priceClose</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">backtest</span><span class="hl-1">) </span><span class="hl-3">return</span><span class="hl-1">; </span><span class="hl-5">// Skip execution in backtest mode</span><br/><br/><span class="hl-1">      </span><span class="hl-5">// Get actual BTC balance from exchange</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">balance</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">binance</span><span class="hl-1">.</span><span class="hl-0">getBalance</span><span class="hl-1">(</span><span class="hl-2">&quot;BTC&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">quantity</span><span class="hl-1"> = </span><span class="hl-4">balance</span><span class="hl-1">.</span><span class="hl-4">free</span><span class="hl-1">; </span><span class="hl-5">// Sell all available BTC</span><br/><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[LIVE] Closing position: </span><span class="hl-6">${</span><span class="hl-4">quantity</span><span class="hl-6">}</span><span class="hl-2"> BTC at </span><span class="hl-6">${</span><span class="hl-4">priceClose</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Entry: </span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceOpen</span><span class="hl-6">}</span><span class="hl-2">, Exit: </span><span class="hl-6">${</span><span class="hl-4">priceClose</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`P&amp;L: </span><span class="hl-6">${</span><span class="hl-9">((</span><span class="hl-4">priceClose</span><span class="hl-9"> </span><span class="hl-1">-</span><span class="hl-9"> </span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceOpen</span><span class="hl-9">) </span><span class="hl-1">/</span><span class="hl-9"> </span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceOpen</span><span class="hl-9"> </span><span class="hl-1">*</span><span class="hl-9"> </span><span class="hl-8">100</span><span class="hl-9">).</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-8">2</span><span class="hl-9">)</span><span class="hl-6">}</span><span class="hl-2">%`</span><span class="hl-1">);</span><br/><br/><span class="hl-1">      </span><span class="hl-5">// Execute market sell order to close entire position</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">order</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">binance</span><span class="hl-1">.</span><span class="hl-0">marketSell</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Order executed:`</span><span class="hl-1">, </span><span class="hl-4">order</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Alternative: Calculate in listener</span><br/><span class="hl-0">listenSignalLive</span><span class="hl-1">(</span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;opened&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">// Calculate position size when signal opens</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">candles</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getCandles</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-2">&quot;1h&quot;</span><span class="hl-1">, </span><span class="hl-8">14</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">atr</span><span class="hl-1"> = </span><span class="hl-0">calculateATR</span><span class="hl-1">(</span><span class="hl-4">candles</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-5">// Get account balance from exchange</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">balance</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">binance</span><span class="hl-1">.</span><span class="hl-0">getBalance</span><span class="hl-1">(</span><span class="hl-2">&quot;USDT&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">accountBalance</span><span class="hl-1"> = </span><span class="hl-4">balance</span><span class="hl-1">.</span><span class="hl-4">free</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">quantity</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">PositionSize</span><span class="hl-1">.</span><span class="hl-0">atrBased</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">accountBalance</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">atr</span><span class="hl-1">,</span><br/><span class="hl-1">      { </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;atr-dynamic&quot;</span><span class="hl-1"> }</span><br/><span class="hl-1">    );</span><br/><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Position opened: </span><span class="hl-6">${</span><span class="hl-4">quantity</span><span class="hl-6">}</span><span class="hl-2"> BTC at </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">currentPrice</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-5">// Execute market buy order</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">order</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">binance</span><span class="hl-1">.</span><span class="hl-0">marketBuy</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Order executed:`</span><span class="hl-1">, </span><span class="hl-4">order</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">// Get actual BTC balance from exchange</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">balance</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">binance</span><span class="hl-1">.</span><span class="hl-0">getBalance</span><span class="hl-1">(</span><span class="hl-2">&quot;BTC&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">quantity</span><span class="hl-1"> = </span><span class="hl-4">balance</span><span class="hl-1">.</span><span class="hl-4">free</span><span class="hl-1">; </span><span class="hl-5">// Sell all available BTC</span><br/><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Position closed: </span><span class="hl-6">${</span><span class="hl-4">quantity</span><span class="hl-6">}</span><span class="hl-2"> BTC at </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">currentPrice</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Close reason: </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">closeReason</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`P&amp;L: </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">pnl</span><span class="hl-9">.</span><span class="hl-4">pnlPercentage</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-8">2</span><span class="hl-9">)</span><span class="hl-6">}</span><span class="hl-2">%`</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-5">// Execute market sell order to close entire position with profit/loss</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">order</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">binance</span><span class="hl-1">.</span><span class="hl-0">marketSell</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Order executed:`</span><span class="hl-1">, </span><span class="hl-4">order</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="list-available-sizing-schemas" class="tsd-anchor"></a><h4 class="tsd-anchor-link">List Available Sizing Schemas<a href="#list-available-sizing-schemas" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">listSizings</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">sizings</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">listSizings</span><span class="hl-1">();</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Available sizing methods:&quot;</span><span class="hl-1">, </span><span class="hl-4">sizings</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">s</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">  </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-4">s</span><span class="hl-1">.</span><span class="hl-4">sizingName</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-4">s</span><span class="hl-1">.</span><span class="hl-4">method</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-4">s</span><span class="hl-1">.</span><span class="hl-4">note</span><br/><span class="hl-1">})));</span><br/><span class="hl-5">// Output:</span><br/><span class="hl-5">// [</span><br/><span class="hl-5">//   { name: &quot;conservative&quot;, method: &quot;fixed-percentage&quot;, note: &quot;Conservative 2% risk...&quot; },</span><br/><span class="hl-5">//   { name: &quot;kelly-quarter&quot;, method: &quot;kelly-criterion&quot;, note: &quot;Kelly Criterion with 25%...&quot; },</span><br/><span class="hl-5">//   { name: &quot;atr-dynamic&quot;, method: &quot;atr-based&quot;, note: &quot;ATR-based sizing with 2x...&quot; }</span><br/><span class="hl-5">// ]</span>
</code><button type="button">Copy</button></pre>

<a id="position-sizing-callbacks" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Position Sizing Callbacks<a href="#position-sizing-callbacks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addSizing</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addSizing</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;monitored&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-2">&quot;fixed-percentage&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">riskPercentage:</span><span class="hl-1"> </span><span class="hl-8">2</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onCalculate</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">quantity</span><span class="hl-1">, </span><span class="hl-4">params</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Calculated position size: </span><span class="hl-6">${</span><span class="hl-4">quantity</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Symbol: </span><span class="hl-6">${</span><span class="hl-4">params</span><span class="hl-9">.</span><span class="hl-4">symbol</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Account balance: </span><span class="hl-6">${</span><span class="hl-4">params</span><span class="hl-9">.</span><span class="hl-4">accountBalance</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Entry price: </span><span class="hl-6">${</span><span class="hl-4">params</span><span class="hl-9">.</span><span class="hl-4">priceOpen</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><br/><span class="hl-1">      </span><span class="hl-5">// Log to monitoring system, send alerts, etc.</span><br/><span class="hl-1">      </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">quantity</span><span class="hl-1"> &gt; </span><span class="hl-8">1.0</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">warn</span><span class="hl-1">(</span><span class="hl-2">&quot;Large position size detected!&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="constraint-enforcement" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Constraint Enforcement<a href="#constraint-enforcement" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><p>All sizing methods enforce optional constraints automatically:</p>
<pre><code class="typescript"><span class="hl-0">addSizing</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;constrained&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-2">&quot;fixed-percentage&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">riskPercentage:</span><span class="hl-1"> </span><span class="hl-8">10</span><span class="hl-1">,               </span><span class="hl-5">// High risk percentage</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionPercentage:</span><span class="hl-1"> </span><span class="hl-8">5</span><span class="hl-1">,         </span><span class="hl-5">// But cap at 5% of account</span><br/><span class="hl-1">  </span><span class="hl-4">minPositionSize:</span><span class="hl-1"> </span><span class="hl-8">0.01</span><span class="hl-1">,            </span><span class="hl-5">// Minimum 0.01 BTC</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionSize:</span><span class="hl-1"> </span><span class="hl-8">0.5</span><span class="hl-1">,             </span><span class="hl-5">// Maximum 0.5 BTC</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">quantity</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">PositionSize</span><span class="hl-1">.</span><span class="hl-0">fixedPercentage</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">10000</span><span class="hl-1">,      </span><span class="hl-5">// $10,000 account</span><br/><span class="hl-1">  </span><span class="hl-8">50000</span><span class="hl-1">,      </span><span class="hl-5">// $50,000 entry</span><br/><span class="hl-1">  </span><span class="hl-8">49000</span><span class="hl-1">,      </span><span class="hl-5">// $49,000 stop</span><br/><span class="hl-1">  { </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;constrained&quot;</span><span class="hl-1"> }</span><br/><span class="hl-1">);</span><br/><span class="hl-5">// Without constraints: (10000 * 0.10) / 1000 = 1.0 BTC</span><br/><span class="hl-5">// With maxPositionPercentage: min(1.0, 10000 * 0.05 / 50000) = 0.01 BTC</span><br/><span class="hl-5">// With maxPositionSize: min(0.01, 0.5) = 0.01 BTC</span><br/><span class="hl-5">// Result: 0.01 BTC (enforces all constraints)</span>
</code><button type="button">Copy</button></pre>

<p><strong>Available Constraints:</strong></p>
<ul>
<li><code>maxPositionPercentage</code> - Maximum percentage of account in single position</li>
<li><code>minPositionSize</code> - Minimum position size in base currency</li>
<li><code>maxPositionSize</code> - Maximum position size in base currency</li>
</ul>
<p><strong>When to Use Each Method:</strong></p>
<ol>
<li>
<p><strong>Fixed Percentage</strong> - Simple risk management, consistent risk per trade</p>
<ul>
<li>Best for: Beginners, conservative strategies</li>
<li>Risk: Fixed 1-2% per trade</li>
</ul>
</li>
<li>
<p><strong>Kelly Criterion</strong> - Optimal bet sizing based on win rate and win/loss ratio</p>
<ul>
<li>Best for: Strategies with known edge, statistical advantage</li>
<li>Risk: Use fractional Kelly (0.25-0.5) to reduce volatility</li>
</ul>
</li>
<li>
<p><strong>ATR-based</strong> - Volatility-adjusted sizing, accounts for market conditions</p>
<ul>
<li>Best for: Swing trading, volatile markets</li>
<li>Risk: Position size scales with volatility</li>
</ul>
</li>
</ol>
<a id="10-schema-reflection-api-optional" class="tsd-anchor"></a><h3 class="tsd-anchor-link">10. Schema Reflection API (Optional)<a href="#10-schema-reflection-api-optional" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Retrieve registered schemas at runtime for debugging, documentation, or building dynamic UIs:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">addExchange</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">addStrategy</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">addFrame</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">addSizing</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">listExchanges</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">listStrategies</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">listFrames</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">listSizings</span><br/><span class="hl-1">} </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Register schemas with notes</span><br/><span class="hl-0">addExchange</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Binance cryptocurrency exchange with database backend&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getCandles</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> [...],</span><br/><span class="hl-1">  </span><span class="hl-0">formatPrice</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">price</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-0">formatQuantity</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">quantity</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-8">8</span><span class="hl-1">),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;sma-crossover&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Simple moving average crossover strategy (50/200)&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> ({...}),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">addFrame</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;january-2024&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Full month backtest for January 2024&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;1m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-01&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-02-01&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">addSizing</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;conservative&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Conservative 2% risk per trade&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-2">&quot;fixed-percentage&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">riskPercentage:</span><span class="hl-1"> </span><span class="hl-8">2</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionPercentage:</span><span class="hl-1"> </span><span class="hl-8">10</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// List all registered schemas</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">exchanges</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">listExchanges</span><span class="hl-1">();</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Available exchanges:&quot;</span><span class="hl-1">, </span><span class="hl-4">exchanges</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">e</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">  </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-4">e</span><span class="hl-1">.</span><span class="hl-4">exchangeName</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-4">e</span><span class="hl-1">.</span><span class="hl-4">note</span><br/><span class="hl-1">})));</span><br/><span class="hl-5">// Output: [{ name: &quot;binance&quot;, note: &quot;Binance cryptocurrency exchange...&quot; }]</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">strategies</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">listStrategies</span><span class="hl-1">();</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Available strategies:&quot;</span><span class="hl-1">, </span><span class="hl-4">strategies</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">s</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">  </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-4">s</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-4">s</span><span class="hl-1">.</span><span class="hl-4">note</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-4">s</span><span class="hl-1">.</span><span class="hl-4">interval</span><br/><span class="hl-1">})));</span><br/><span class="hl-5">// Output: [{ name: &quot;sma-crossover&quot;, note: &quot;Simple moving average...&quot;, interval: &quot;5m&quot; }]</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">frames</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">listFrames</span><span class="hl-1">();</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Available frames:&quot;</span><span class="hl-1">, </span><span class="hl-4">frames</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">f</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">  </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-4">f</span><span class="hl-1">.</span><span class="hl-4">frameName</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-4">f</span><span class="hl-1">.</span><span class="hl-4">note</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">period:</span><span class="hl-1"> </span><span class="hl-2">`</span><span class="hl-6">${</span><span class="hl-4">f</span><span class="hl-9">.</span><span class="hl-4">startDate</span><span class="hl-9">.</span><span class="hl-0">toISOString</span><span class="hl-9">()</span><span class="hl-6">}</span><span class="hl-2"> - </span><span class="hl-6">${</span><span class="hl-4">f</span><span class="hl-9">.</span><span class="hl-4">endDate</span><span class="hl-9">.</span><span class="hl-0">toISOString</span><span class="hl-9">()</span><span class="hl-6">}</span><span class="hl-2">`</span><br/><span class="hl-1">})));</span><br/><span class="hl-5">// Output: [{ name: &quot;january-2024&quot;, note: &quot;Full month backtest...&quot;, period: &quot;2024-01-01...&quot; }]</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">sizings</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">listSizings</span><span class="hl-1">();</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Available sizings:&quot;</span><span class="hl-1">, </span><span class="hl-4">sizings</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">s</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">  </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-4">s</span><span class="hl-1">.</span><span class="hl-4">sizingName</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-4">s</span><span class="hl-1">.</span><span class="hl-4">note</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-4">s</span><span class="hl-1">.</span><span class="hl-4">method</span><br/><span class="hl-1">})));</span><br/><span class="hl-5">// Output: [{ name: &quot;conservative&quot;, note: &quot;Conservative 2% risk...&quot;, method: &quot;fixed-percentage&quot; }]</span>
</code><button type="button">Copy</button></pre>

<p><strong>Use cases:</strong></p>
<ul>
<li>Generate documentation automatically from registered schemas</li>
<li>Build admin dashboards showing available strategies and exchanges</li>
<li>Create CLI tools with auto-completion based on registered schemas</li>
<li>Validate configuration files against registered schemas</li>
</ul>
<a id="architecture-overview" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Architecture Overview<a href="#architecture-overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The framework follows <strong>clean architecture</strong> with:</p>
<ul>
<li><strong>Client Layer</strong> - Pure business logic without DI (ClientStrategy, ClientExchange, ClientFrame)</li>
<li><strong>Service Layer</strong> - DI-based services organized by responsibility
<ul>
<li><strong>Schema Services</strong> - Registry pattern for configuration</li>
<li><strong>Connection Services</strong> - Memoized client instance creators</li>
<li><strong>Global Services</strong> - Context wrappers for public API</li>
<li><strong>Logic Services</strong> - Async generator orchestration (backtest/live)</li>
</ul>
</li>
<li><strong>Persistence Layer</strong> - Crash-safe atomic file writes with <code>PersistSignalAdaper</code></li>
</ul>
<p>See <a href="media/ARCHITECTURE.md">ARCHITECTURE.md</a> for detailed documentation.</p>
<a id="signal-validation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Signal Validation<a href="#signal-validation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>All signals are validated automatically before execution:</p>
<pre><code class="typescript"><span class="hl-5">// ‚úÖ Valid long signal</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-11">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceOpen</span><span class="hl-1">: </span><span class="hl-8">50000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-8">51000</span><span class="hl-1">,  </span><span class="hl-5">// ‚úÖ 51000 &gt; 50000</span><br/><span class="hl-1">  </span><span class="hl-11">priceStopLoss</span><span class="hl-1">: </span><span class="hl-8">49000</span><span class="hl-1">,     </span><span class="hl-5">// ‚úÖ 49000 &lt; 50000</span><br/><span class="hl-1">  </span><span class="hl-11">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-8">60</span><span class="hl-1">,  </span><span class="hl-5">// ‚úÖ positive</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// ‚ùå Invalid long signal - throws error</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-11">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceOpen</span><span class="hl-1">: </span><span class="hl-8">50000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-8">49000</span><span class="hl-1">,  </span><span class="hl-5">// ‚ùå 49000 &lt; 50000 (must be higher for long)</span><br/><span class="hl-1">  </span><span class="hl-11">priceStopLoss</span><span class="hl-1">: </span><span class="hl-8">51000</span><span class="hl-1">,    </span><span class="hl-5">// ‚ùå 51000 &gt; 50000 (must be lower for long)</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// ‚úÖ Valid short signal</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-11">position</span><span class="hl-1">: </span><span class="hl-2">&quot;short&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceOpen</span><span class="hl-1">: </span><span class="hl-8">50000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-8">49000</span><span class="hl-1">,  </span><span class="hl-5">// ‚úÖ 49000 &lt; 50000 (profit goes down for short)</span><br/><span class="hl-1">  </span><span class="hl-11">priceStopLoss</span><span class="hl-1">: </span><span class="hl-8">51000</span><span class="hl-1">,    </span><span class="hl-5">// ‚úÖ 51000 &gt; 50000 (stop loss goes up for short)</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Validation errors include detailed messages for debugging.</p>
<a id="custom-persistence-adapter" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Custom Persistence Adapter<a href="#custom-persistence-adapter" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>By default, signals are persisted to disk using atomic file writes (<code>./logs/data/signal/</code>). You can override the persistence layer with a custom adapter (e.g., Redis, MongoDB):</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">PersistBase</span><span class="hl-1">, </span><span class="hl-4">PersistSignalAdaper</span><span class="hl-1">, </span><span class="hl-4">ISignalData</span><span class="hl-1">, </span><span class="hl-4">EntityId</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">Redis</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ioredis&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Create custom Redis adapter</span><br/><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-10">RedisPersist</span><span class="hl-1"> </span><span class="hl-6">extends</span><span class="hl-1"> </span><span class="hl-10">PersistBase</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">private</span><span class="hl-1"> </span><span class="hl-4">redis</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Redis</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">host:</span><span class="hl-1"> </span><span class="hl-2">&quot;localhost&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">port:</span><span class="hl-1"> </span><span class="hl-8">6379</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-0">waitForInit</span><span class="hl-1">(</span><span class="hl-4">initial</span><span class="hl-1">: </span><span class="hl-10">boolean</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-10">void</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">    </span><span class="hl-5">// Initialize Redis connection if needed</span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">redis</span><span class="hl-1">.</span><span class="hl-0">ping</span><span class="hl-1">();</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-0">readValue</span><span class="hl-1">(</span><span class="hl-4">entityId</span><span class="hl-1">: </span><span class="hl-10">EntityId</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-10">ISignalData</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">key</span><span class="hl-1"> = </span><span class="hl-2">`</span><span class="hl-6">${</span><span class="hl-6">this</span><span class="hl-9">.</span><span class="hl-4">entityName</span><span class="hl-6">}</span><span class="hl-2">:</span><span class="hl-6">${</span><span class="hl-4">entityId</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">data</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">redis</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-4">key</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (!</span><span class="hl-4">data</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-3">throw</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><span class="hl-2">`Entity </span><span class="hl-6">${</span><span class="hl-6">this</span><span class="hl-9">.</span><span class="hl-4">entityName</span><span class="hl-6">}</span><span class="hl-2">:</span><span class="hl-6">${</span><span class="hl-4">entityId</span><span class="hl-6">}</span><span class="hl-2"> not found`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-0">parse</span><span class="hl-1">(</span><span class="hl-4">data</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-0">hasValue</span><span class="hl-1">(</span><span class="hl-4">entityId</span><span class="hl-1">: </span><span class="hl-10">EntityId</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-10">boolean</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">key</span><span class="hl-1"> = </span><span class="hl-2">`</span><span class="hl-6">${</span><span class="hl-6">this</span><span class="hl-9">.</span><span class="hl-4">entityName</span><span class="hl-6">}</span><span class="hl-2">:</span><span class="hl-6">${</span><span class="hl-4">entityId</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">exists</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">redis</span><span class="hl-1">.</span><span class="hl-0">exists</span><span class="hl-1">(</span><span class="hl-4">key</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">exists</span><span class="hl-1"> === </span><span class="hl-8">1</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-0">writeValue</span><span class="hl-1">(</span><span class="hl-4">entityId</span><span class="hl-1">: </span><span class="hl-10">EntityId</span><span class="hl-1">, </span><span class="hl-4">entity</span><span class="hl-1">: </span><span class="hl-10">ISignalData</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-10">void</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">key</span><span class="hl-1"> = </span><span class="hl-2">`</span><span class="hl-6">${</span><span class="hl-6">this</span><span class="hl-9">.</span><span class="hl-4">entityName</span><span class="hl-6">}</span><span class="hl-2">:</span><span class="hl-6">${</span><span class="hl-4">entityId</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">redis</span><span class="hl-1">.</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-4">key</span><span class="hl-1">, </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-0">stringify</span><span class="hl-1">(</span><span class="hl-4">entity</span><span class="hl-1">));</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Register custom adapter</span><br/><span class="hl-4">PersistSignalAdaper</span><span class="hl-1">.</span><span class="hl-0">usePersistSignalAdapter</span><span class="hl-1">(</span><span class="hl-4">RedisPersist</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Now all signal persistence uses Redis</span><br/><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Key methods to implement:</strong></p>
<ul>
<li><code>waitForInit(initial)</code> - Initialize storage connection</li>
<li><code>readValue(entityId)</code> - Read entity from storage</li>
<li><code>hasValue(entityId)</code> - Check if entity exists</li>
<li><code>writeValue(entityId, entity)</code> - Write entity to storage</li>
</ul>
<p>The adapter is registered globally and applies to all strategies.</p>
<a id="interval-throttling" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Interval Throttling<a href="#interval-throttling" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Prevent signal spam with automatic throttling:</p>
<pre><code class="typescript"><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">, </span><span class="hl-5">// Signals generated max once per 5 minutes</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// This function will be called max once per 5 minutes</span><br/><span class="hl-1">    </span><span class="hl-5">// Even if tick() is called every second</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">signal</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>Supported intervals: <code>&quot;1m&quot;</code>, <code>&quot;3m&quot;</code>, <code>&quot;5m&quot;</code>, <code>&quot;15m&quot;</code>, <code>&quot;30m&quot;</code>, <code>&quot;1h&quot;</code></p>
<a id="markdown-reports" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Markdown Reports<a href="#markdown-reports" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Generate detailed trading reports with statistics:</p>
<a id="backtest-reports" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Backtest Reports<a href="#backtest-reports" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Backtest</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Run backtest</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stopBacktest</span><span class="hl-1"> = </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-backtest&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Get raw statistical data (Controller)</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">stats</span><span class="hl-1">);</span><br/><span class="hl-5">// Returns:</span><br/><span class="hl-5">// {</span><br/><span class="hl-5">//   signalList: [...],           // All closed signals</span><br/><span class="hl-5">//   totalSignals: 10,</span><br/><span class="hl-5">//   winCount: 7,</span><br/><span class="hl-5">//   lossCount: 3,</span><br/><span class="hl-5">//   winRate: 70.0,               // Percentage (higher is better)</span><br/><span class="hl-5">//   avgPnl: 1.23,                // Average PNL % (higher is better)</span><br/><span class="hl-5">//   totalPnl: 12.30,             // Total PNL % (higher is better)</span><br/><span class="hl-5">//   stdDev: 2.45,                // Standard deviation (lower is better)</span><br/><span class="hl-5">//   sharpeRatio: 0.50,           // Risk-adjusted return (higher is better)</span><br/><span class="hl-5">//   annualizedSharpeRatio: 9.55, // Sharpe √ó ‚àö365 (higher is better)</span><br/><span class="hl-5">//   certaintyRatio: 1.75,        // avgWin / |avgLoss| (higher is better)</span><br/><span class="hl-5">//   expectedYearlyReturns: 156   // Estimated yearly trades (higher is better)</span><br/><span class="hl-5">// }</span><br/><br/><span class="hl-5">// Generate markdown report (View)</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">markdown</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">markdown</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Save to disk (default: ./logs/backtest/my-strategy.md)</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Save to custom path</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;./custom/path&quot;</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>getData() returns BacktestStatistics:</strong></p>
<ul>
<li><code>signalList</code> - Array of all closed signals</li>
<li><code>totalSignals</code> - Total number of closed signals</li>
<li><code>winCount</code> / <code>lossCount</code> - Number of winning/losing trades</li>
<li><code>winRate</code> - Win percentage (higher is better)</li>
<li><code>avgPnl</code> - Average PNL percentage (higher is better)</li>
<li><code>totalPnl</code> - Total PNL percentage (higher is better)</li>
<li><code>stdDev</code> - Standard deviation / volatility (lower is better)</li>
<li><code>sharpeRatio</code> - Risk-adjusted return (higher is better)</li>
<li><code>annualizedSharpeRatio</code> - Sharpe Ratio √ó ‚àö365 (higher is better)</li>
<li><code>certaintyRatio</code> - avgWin / |avgLoss| (higher is better)</li>
<li><code>expectedYearlyReturns</code> - Estimated number of trades per year (higher is better)</li>
</ul>
<p><strong>getReport() includes:</strong></p>
<ul>
<li>All metrics from getData() formatted as markdown</li>
<li>All signal details (prices, TP/SL, PNL, duration, close reason)</li>
<li>Timestamps for each signal</li>
<li>&quot;Higher is better&quot; / &quot;Lower is better&quot; annotations</li>
</ul>
<a id="live-trading-reports" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Live Trading Reports<a href="#live-trading-reports" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Live</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Get raw statistical data (Controller)</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">stats</span><span class="hl-1">);</span><br/><span class="hl-5">// Returns:</span><br/><span class="hl-5">// {</span><br/><span class="hl-5">//   eventList: [...],            // All events (idle, opened, active, closed)</span><br/><span class="hl-5">//   totalEvents: 15,</span><br/><span class="hl-5">//   totalClosed: 5,</span><br/><span class="hl-5">//   winCount: 3,</span><br/><span class="hl-5">//   lossCount: 2,</span><br/><span class="hl-5">//   winRate: 60.0,               // Percentage (higher is better)</span><br/><span class="hl-5">//   avgPnl: 1.23,                // Average PNL % (higher is better)</span><br/><span class="hl-5">//   totalPnl: 6.15,              // Total PNL % (higher is better)</span><br/><span class="hl-5">//   stdDev: 1.85,                // Standard deviation (lower is better)</span><br/><span class="hl-5">//   sharpeRatio: 0.66,           // Risk-adjusted return (higher is better)</span><br/><span class="hl-5">//   annualizedSharpeRatio: 12.61,// Sharpe √ó ‚àö365 (higher is better)</span><br/><span class="hl-5">//   certaintyRatio: 2.10,        // avgWin / |avgLoss| (higher is better)</span><br/><span class="hl-5">//   expectedYearlyReturns: 365   // Estimated yearly trades (higher is better)</span><br/><span class="hl-5">// }</span><br/><br/><span class="hl-5">// Generate markdown report (View)</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">markdown</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Save to disk (default: ./logs/live/my-strategy.md)</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>getData() returns LiveStatistics:</strong></p>
<ul>
<li><code>eventList</code> - Array of all events (idle, opened, active, closed)</li>
<li><code>totalEvents</code> - Total number of events</li>
<li><code>totalClosed</code> - Total number of closed signals</li>
<li><code>winCount</code> / <code>lossCount</code> - Number of winning/losing trades</li>
<li><code>winRate</code> - Win percentage (higher is better)</li>
<li><code>avgPnl</code> - Average PNL percentage (higher is better)</li>
<li><code>totalPnl</code> - Total PNL percentage (higher is better)</li>
<li><code>stdDev</code> - Standard deviation / volatility (lower is better)</li>
<li><code>sharpeRatio</code> - Risk-adjusted return (higher is better)</li>
<li><code>annualizedSharpeRatio</code> - Sharpe Ratio √ó ‚àö365 (higher is better)</li>
<li><code>certaintyRatio</code> - avgWin / |avgLoss| (higher is better)</li>
<li><code>expectedYearlyReturns</code> - Estimated number of trades per year (higher is better)</li>
</ul>
<p><strong>getReport() includes:</strong></p>
<ul>
<li>All metrics from getData() formatted as markdown</li>
<li>Signal-by-signal details with current state</li>
<li>&quot;Higher is better&quot; / &quot;Lower is better&quot; annotations</li>
</ul>
<p><strong>Report example:</strong></p>
<pre><code class="markdown"># Live Trading Report: my-strategy

Total events: 15
Closed signals: 5
Win rate: 60.00% (3W / 2L) (higher is better)
Average PNL: +1.23% (higher is better)
Total PNL: +6.15% (higher is better)
Standard Deviation: 1.85% (lower is better)
Sharpe Ratio: 0.66 (higher is better)
Annualized Sharpe Ratio: 12.61 (higher is better)
Certainty Ratio: 2.10 (higher is better)
Expected Yearly Returns: 365 trades (higher is better)

| Timestamp | Action | Symbol | Signal ID | Position | ... | PNL (net) | Close Reason |
|-----------|--------|--------|-----------|----------|-----|-----------|--------------|
| ...       | CLOSED | BTCUSD | abc-123   | LONG     | ... | +2.45%    | take_profit  |
</code><button type="button">Copy</button></pre>

<a id="event-listeners" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Event Listeners<a href="#event-listeners" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Subscribe to signal events with filtering support. Useful for running strategies in background while reacting to specific events.</p>
<a id="background-execution-with-event-listeners" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Background Execution with Event Listeners<a href="#background-execution-with-event-listeners" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Backtest</span><span class="hl-1">, </span><span class="hl-4">listenSignalBacktest</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Run backtest in background (doesn&#39;t yield results)</span><br/><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-backtest&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Listen to all backtest events</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">unsubscribe</span><span class="hl-1"> = </span><span class="hl-0">listenSignalBacktest</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Signal closed:&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">      </span><span class="hl-4">pnl:</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">reason:</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">closeReason</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Stop listening when done</span><br/><span class="hl-5">// unsubscribe();</span>
</code><button type="button">Copy</button></pre>

<a id="listen-once-with-filter" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Listen Once with Filter<a href="#listen-once-with-filter" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Backtest</span><span class="hl-1">, </span><span class="hl-4">listenSignalBacktestOnce</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Run backtest in background</span><br/><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-backtest&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Wait for first take profit event</span><br/><span class="hl-0">listenSignalBacktestOnce</span><span class="hl-1">(</span><br/><span class="hl-1">  (</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1"> &amp;&amp; </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">closeReason</span><span class="hl-1"> === </span><span class="hl-2">&quot;take_profit&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  (</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;First take profit hit!&quot;</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-5">// Automatically unsubscribes after first match</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="live-trading-with-event-listeners" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Live Trading with Event Listeners<a href="#live-trading-with-event-listeners" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Live</span><span class="hl-1">, </span><span class="hl-4">listenSignalLive</span><span class="hl-1">, </span><span class="hl-4">listenSignalLiveOnce</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Run live trading in background (infinite loop)</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">cancel</span><span class="hl-1"> = </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Listen to all live events</span><br/><span class="hl-0">listenSignalLive</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;opened&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Signal opened:&quot;</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">id</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Signal closed:&quot;</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// React to first stop loss once</span><br/><span class="hl-0">listenSignalLiveOnce</span><span class="hl-1">(</span><br/><span class="hl-1">  (</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1"> &amp;&amp; </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">closeReason</span><span class="hl-1"> === </span><span class="hl-2">&quot;stop_loss&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  (</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">&quot;Stop loss hit!&quot;</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-5">// Send alert, dump report, etc.</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-5">// Stop live trading after some condition</span><br/><span class="hl-5">// cancel();</span>
</code><button type="button">Copy</button></pre>

<a id="listen-to-all-signals-backtest--live" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Listen to All Signals (Backtest + Live)<a href="#listen-to-all-signals-backtest--live" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">listenSignal</span><span class="hl-1">, </span><span class="hl-4">listenSignalOnce</span><span class="hl-1">, </span><span class="hl-4">Backtest</span><span class="hl-1">, </span><span class="hl-4">Live</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Listen to both backtest and live events</span><br/><span class="hl-0">listenSignal</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Event:&quot;</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Wait for first loss from any source</span><br/><span class="hl-0">listenSignalOnce</span><span class="hl-1">(</span><br/><span class="hl-1">  (</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1"> &amp;&amp; </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1"> &lt; </span><span class="hl-8">0</span><span class="hl-1">,</span><br/><span class="hl-1">  (</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;First loss detected:&quot;</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-5">// Run both modes</span><br/><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-backtest&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Available event listeners:</strong></p>
<ul>
<li><code>listenSignal(callback)</code> - Subscribe to all signal events (backtest + live)</li>
<li><code>listenSignalOnce(filter, callback)</code> - Subscribe once with filter predicate</li>
<li><code>listenSignalBacktest(callback)</code> - Subscribe to backtest signals only</li>
<li><code>listenSignalBacktestOnce(filter, callback)</code> - Subscribe to backtest signals once</li>
<li><code>listenSignalLive(callback)</code> - Subscribe to live signals only</li>
<li><code>listenSignalLiveOnce(filter, callback)</code> - Subscribe to live signals once</li>
<li><code>listenPerformance(callback)</code> - Subscribe to performance metrics (backtest + live)</li>
<li><code>listenProgress(callback)</code> - Subscribe to backtest progress events</li>
<li><code>listenError(callback)</code> - Subscribe to background execution errors</li>
<li><code>listenDoneLive(callback)</code> - Subscribe to live background completion events</li>
<li><code>listenDoneLiveOnce(filter, callback)</code> - Subscribe to live background completion once</li>
<li><code>listenDoneBacktest(callback)</code> - Subscribe to backtest background completion events</li>
<li><code>listenDoneBacktestOnce(filter, callback)</code> - Subscribe to backtest background completion once</li>
<li><code>listenDoneWalker(callback)</code> - Subscribe to walker background completion events</li>
<li><code>listenDoneWalkerOnce(filter, callback)</code> - Subscribe to walker background completion once</li>
<li><code>listenWalker(callback)</code> - Subscribe to walker progress events (each strategy completion)</li>
<li><code>listenWalkerOnce(filter, callback)</code> - Subscribe to walker progress events once</li>
<li><code>listenWalkerComplete(callback)</code> - Subscribe to final walker results (all strategies compared)</li>
</ul>
<p>All listeners return an <code>unsubscribe</code> function. All callbacks are processed sequentially using queued async execution.</p>
<a id="listen-to-background-completion" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Listen to Background Completion<a href="#listen-to-background-completion" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">listenDoneBacktest</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">listenDoneBacktestOnce</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">listenDoneLive</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">Backtest</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">Live</span><br/><span class="hl-1">} </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Listen to backtest completion events</span><br/><span class="hl-0">listenDoneBacktest</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Backtest completed:&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-4">symbol:</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">strategy:</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">exchange:</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">exchangeName</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-5">// Auto-generate report on completion</span><br/><span class="hl-1">  </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Listen to live completion events</span><br/><span class="hl-0">listenDoneLive</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Live trading stopped:&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-4">symbol:</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">strategy:</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">exchange:</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">exchangeName</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-5">// Auto-generate report on completion</span><br/><span class="hl-1">  </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Wait for specific backtest to complete</span><br/><span class="hl-0">listenDoneBacktestOnce</span><span class="hl-1">(</span><br/><span class="hl-1">  (</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1"> === </span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  (</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT backtest finished&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-5">// Start next backtest or live trading</span><br/><span class="hl-1">    </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1">, {</span><br/><span class="hl-1">      </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">exchangeName</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-5">// Run backtests</span><br/><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-backtest&quot;</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="api-reference" class="tsd-anchor"></a><h2 class="tsd-anchor-link">API Reference<a href="#api-reference" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="high-level-functions" class="tsd-anchor"></a><h3 class="tsd-anchor-link">High-Level Functions<a href="#high-level-functions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><a id="schema-registration" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Schema Registration<a href="#schema-registration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-5">// Register exchange</span><br/><span class="hl-0">addExchange</span><span class="hl-1">(</span><span class="hl-4">exchangeSchema</span><span class="hl-1">: </span><span class="hl-4">IExchangeSchema</span><span class="hl-1">): </span><span class="hl-6">void</span><br/><br/><span class="hl-5">// Register strategy</span><br/><span class="hl-0">addStrategy</span><span class="hl-1">(</span><span class="hl-4">strategySchema</span><span class="hl-1">: </span><span class="hl-4">IStrategySchema</span><span class="hl-1">): </span><span class="hl-6">void</span><br/><br/><span class="hl-5">// Register timeframe generator</span><br/><span class="hl-0">addFrame</span><span class="hl-1">(</span><span class="hl-4">frameSchema</span><span class="hl-1">: </span><span class="hl-4">IFrameSchema</span><span class="hl-1">): </span><span class="hl-6">void</span><br/><br/><span class="hl-5">// Register walker for strategy comparison</span><br/><span class="hl-0">addWalker</span><span class="hl-1">(</span><span class="hl-4">walkerSchema</span><span class="hl-1">: </span><span class="hl-4">IWalkerSchema</span><span class="hl-1">): </span><span class="hl-6">void</span><br/><br/><span class="hl-5">// Register position sizing configuration</span><br/><span class="hl-0">addSizing</span><span class="hl-1">(</span><span class="hl-4">sizingSchema</span><span class="hl-1">: </span><span class="hl-4">ISizingSchema</span><span class="hl-1">): </span><span class="hl-6">void</span>
</code><button type="button">Copy</button></pre>

<a id="exchange-data" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Exchange Data<a href="#exchange-data" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-5">// Get historical candles</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">candles</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getCandles</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;1h&quot;</span><span class="hl-1">, </span><span class="hl-8">5</span><span class="hl-1">);</span><br/><span class="hl-5">// Returns: [</span><br/><span class="hl-5">//   { timestamp: 1704067200000, open: 42150.5, high: 42380.2, low: 42100.0, close: 42250.8, volume: 125.43 },</span><br/><span class="hl-5">//   { timestamp: 1704070800000, open: 42250.8, high: 42500.0, low: 42200.0, close: 42450.3, volume: 98.76 },</span><br/><span class="hl-5">//   { timestamp: 1704074400000, open: 42450.3, high: 42600.0, low: 42400.0, close: 42580.5, volume: 110.22 },</span><br/><span class="hl-5">//   { timestamp: 1704078000000, open: 42580.5, high: 42700.0, low: 42550.0, close: 42650.0, volume: 95.18 },</span><br/><span class="hl-5">//   { timestamp: 1704081600000, open: 42650.0, high: 42750.0, low: 42600.0, close: 42720.0, volume: 102.35 }</span><br/><span class="hl-5">// ]</span><br/><br/><span class="hl-5">// Get VWAP from last 5 1m candles</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">vwap</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getAveragePrice</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">);</span><br/><span class="hl-5">// Returns: 42685.34</span><br/><br/><span class="hl-5">// Get current date in execution context</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">date</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getDate</span><span class="hl-1">();</span><br/><span class="hl-5">// Returns: 2024-01-01T12:00:00.000Z (in backtest mode, returns frame&#39;s current timestamp)</span><br/><span class="hl-5">// Returns: 2024-01-15T10:30:45.123Z (in live mode, returns current wall clock time)</span><br/><br/><span class="hl-5">// Get current mode</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">mode</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getMode</span><span class="hl-1">();</span><br/><span class="hl-5">// Returns: &quot;backtest&quot; or &quot;live&quot;</span><br/><br/><span class="hl-5">// Format price/quantity for exchange</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">price</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">formatPrice</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-8">42685.3456789</span><span class="hl-1">);</span><br/><span class="hl-5">// Returns: &quot;42685.35&quot; (formatted to exchange precision)</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">quantity</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">formatQuantity</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-8">0.123456789</span><span class="hl-1">);</span><br/><span class="hl-5">// Returns: &quot;0.12345&quot; (formatted to exchange precision)</span>
</code><button type="button">Copy</button></pre>

<a id="service-apis" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Service APIs<a href="#service-apis" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><a id="backtest-api" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Backtest API<a href="#backtest-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Backtest</span><span class="hl-1">, </span><span class="hl-4">BacktestStatistics</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Stream backtest results</span><br/><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">context</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-4">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">frameName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">): </span><span class="hl-4">AsyncIterableIterator</span><span class="hl-1">&lt;</span><span class="hl-4">IStrategyTickResultClosed</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Run in background without yielding results</span><br/><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">context</span><span class="hl-1">: { </span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">exchangeName</span><span class="hl-1">, </span><span class="hl-4">frameName</span><span class="hl-1"> }</span><br/><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;() </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-6">void</span><span class="hl-1">&gt; </span><span class="hl-5">// Returns cancellation function</span><br/><br/><span class="hl-5">// Get raw statistical data (Controller)</span><br/><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">BacktestStatistics</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Generate markdown report (View)</span><br/><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Save report to disk</span><br/><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">path</span><span class="hl-1">?: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-6">void</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<a id="live-trading-api" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Live Trading API<a href="#live-trading-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Live</span><span class="hl-1">, </span><span class="hl-4">LiveStatistics</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Stream live results (infinite)</span><br/><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">context</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-4">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">): </span><span class="hl-4">AsyncIterableIterator</span><span class="hl-1">&lt;</span><span class="hl-4">IStrategyTickResult</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Run in background without yielding results</span><br/><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">context</span><span class="hl-1">: { </span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">exchangeName</span><span class="hl-1"> }</span><br/><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;() </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-6">void</span><span class="hl-1">&gt; </span><span class="hl-5">// Returns cancellation function</span><br/><br/><span class="hl-5">// Get raw statistical data (Controller)</span><br/><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">LiveStatistics</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Generate markdown report (View)</span><br/><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Save report to disk</span><br/><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">path</span><span class="hl-1">?: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-6">void</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<a id="walker-api" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Walker API<a href="#walker-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Walker</span><span class="hl-1">, </span><span class="hl-4">WalkerResults</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Stream walker progress (yields after each strategy)</span><br/><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">context</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-4">walkerName:</span><span class="hl-1"> </span><span class="hl-4">string</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">): </span><span class="hl-4">AsyncIterableIterator</span><span class="hl-1">&lt;</span><span class="hl-4">WalkerContract</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Run in background without yielding results</span><br/><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">context</span><span class="hl-1">: { </span><span class="hl-4">walkerName</span><span class="hl-1"> }</span><br/><span class="hl-1">): () </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-6">void</span><span class="hl-1"> </span><span class="hl-5">// Returns cancellation function</span><br/><br/><span class="hl-5">// Get raw comparison data (Controller)</span><br/><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">walkerName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">IWalkerResults</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Generate markdown report (View)</span><br/><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">walkerName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Save report to disk (default: ./logs/walker)</span><br/><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">walkerName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">path</span><span class="hl-1">?: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-6">void</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<a id="heat-api" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Heat API<a href="#heat-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Heat</span><span class="hl-1">, </span><span class="hl-4">IHeatmapStatistics</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Get raw heatmap statistics (Controller)</span><br/><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">IHeatmapStatistics</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Generate markdown report (View)</span><br/><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Save heatmap report to disk (default: ./logs/heatmap)</span><br/><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">path</span><span class="hl-1">?: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-6">void</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Clear accumulated heatmap data</span><br/><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">?: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-6">void</span>
</code><button type="button">Copy</button></pre>

<a id="position-sizing-api" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Position Sizing API<a href="#position-sizing-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">PositionSize</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Calculate position size using fixed percentage risk</span><br/><span class="hl-4">PositionSize</span><span class="hl-1">.</span><span class="hl-0">fixedPercentage</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">accountBalance</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">priceOpen</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">priceStopLoss</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">context</span><span class="hl-1">: { </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-4">string</span><span class="hl-1"> }</span><br/><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">number</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Calculate position size using Kelly Criterion</span><br/><span class="hl-4">PositionSize</span><span class="hl-1">.</span><span class="hl-0">kellyCriterion</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">accountBalance</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">priceOpen</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">winRate</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">winLossRatio</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">context</span><span class="hl-1">: { </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-4">string</span><span class="hl-1"> }</span><br/><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">number</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Calculate position size using ATR-based method</span><br/><span class="hl-4">PositionSize</span><span class="hl-1">.</span><span class="hl-0">atrBased</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">accountBalance</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">priceOpen</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">atr</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">context</span><span class="hl-1">: { </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-4">string</span><span class="hl-1"> }</span><br/><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">number</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<a id="performance-profiling-api" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Performance Profiling API<a href="#performance-profiling-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Performance</span><span class="hl-1">, </span><span class="hl-4">PerformanceStatistics</span><span class="hl-1">, </span><span class="hl-4">listenPerformance</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Get raw performance statistics (Controller)</span><br/><span class="hl-4">Performance</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">PerformanceStatistics</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Generate markdown report with bottleneck analysis (View)</span><br/><span class="hl-4">Performance</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Save performance report to disk (default: ./logs/performance)</span><br/><span class="hl-4">Performance</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">path</span><span class="hl-1">?: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-6">void</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Clear accumulated performance data</span><br/><span class="hl-4">Performance</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">?: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-6">void</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Listen to real-time performance events</span><br/><span class="hl-0">listenPerformance</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`</span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">metricType</span><span class="hl-6">}</span><span class="hl-2">: </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">duration</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-8">2</span><span class="hl-9">)</span><span class="hl-6">}</span><span class="hl-2">ms`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Strategy: </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">strategyName</span><span class="hl-6">}</span><span class="hl-2"> @ </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">exchangeName</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Symbol: </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">symbol</span><span class="hl-6">}</span><span class="hl-2">, Backtest: </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">backtest</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="type-definitions" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Type Definitions<a href="#type-definitions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="statistics-types" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Statistics Types<a href="#statistics-types" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// Backtest statistics (exported from &quot;backtest-kit&quot;)</span><br/><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-10">BacktestStatistics</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">signalList</span><span class="hl-1">: </span><span class="hl-10">IStrategyTickResultClosed</span><span class="hl-1">[];  </span><span class="hl-5">// All closed signals</span><br/><span class="hl-1">  </span><span class="hl-4">totalSignals</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">winCount</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">lossCount</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">winRate</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;               </span><span class="hl-5">// Win percentage (higher is better)</span><br/><span class="hl-1">  </span><span class="hl-4">avgPnl</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;                </span><span class="hl-5">// Average PNL % (higher is better)</span><br/><span class="hl-1">  </span><span class="hl-4">totalPnl</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;              </span><span class="hl-5">// Total PNL % (higher is better)</span><br/><span class="hl-1">  </span><span class="hl-4">stdDev</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;                </span><span class="hl-5">// Standard deviation (lower is better)</span><br/><span class="hl-1">  </span><span class="hl-4">sharpeRatio</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;           </span><span class="hl-5">// Risk-adjusted return (higher is better)</span><br/><span class="hl-1">  </span><span class="hl-4">annualizedSharpeRatio</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">; </span><span class="hl-5">// Sharpe √ó ‚àö365 (higher is better)</span><br/><span class="hl-1">  </span><span class="hl-4">certaintyRatio</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;        </span><span class="hl-5">// avgWin / |avgLoss| (higher is better)</span><br/><span class="hl-1">  </span><span class="hl-4">expectedYearlyReturns</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">; </span><span class="hl-5">// Estimated yearly trades (higher is better)</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Live statistics (exported from &quot;backtest-kit&quot;)</span><br/><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-10">LiveStatistics</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">eventList</span><span class="hl-1">: </span><span class="hl-10">TickEvent</span><span class="hl-1">[];               </span><span class="hl-5">// All events (idle, opened, active, closed)</span><br/><span class="hl-1">  </span><span class="hl-4">totalEvents</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">totalClosed</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">winCount</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">lossCount</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">winRate</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;               </span><span class="hl-5">// Win percentage (higher is better)</span><br/><span class="hl-1">  </span><span class="hl-4">avgPnl</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;                </span><span class="hl-5">// Average PNL % (higher is better)</span><br/><span class="hl-1">  </span><span class="hl-4">totalPnl</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;              </span><span class="hl-5">// Total PNL % (higher is better)</span><br/><span class="hl-1">  </span><span class="hl-4">stdDev</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;                </span><span class="hl-5">// Standard deviation (lower is better)</span><br/><span class="hl-1">  </span><span class="hl-4">sharpeRatio</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;           </span><span class="hl-5">// Risk-adjusted return (higher is better)</span><br/><span class="hl-1">  </span><span class="hl-4">annualizedSharpeRatio</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">; </span><span class="hl-5">// Sharpe √ó ‚àö365 (higher is better)</span><br/><span class="hl-1">  </span><span class="hl-4">certaintyRatio</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;        </span><span class="hl-5">// avgWin / |avgLoss| (higher is better)</span><br/><span class="hl-1">  </span><span class="hl-4">expectedYearlyReturns</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">; </span><span class="hl-5">// Estimated yearly trades (higher is better)</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Performance statistics (exported from &quot;backtest-kit&quot;)</span><br/><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-10">PerformanceStatistics</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;                 </span><span class="hl-5">// Strategy name</span><br/><span class="hl-1">  </span><span class="hl-4">totalEvents</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                  </span><span class="hl-5">// Total number of performance events</span><br/><span class="hl-1">  </span><span class="hl-4">totalDuration</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                </span><span class="hl-5">// Total execution time (ms)</span><br/><span class="hl-1">  </span><span class="hl-4">metricStats</span><span class="hl-1">: </span><span class="hl-10">Record</span><span class="hl-1">&lt;</span><span class="hl-10">string</span><span class="hl-1">, {         </span><span class="hl-5">// Statistics by metric type</span><br/><span class="hl-1">    </span><span class="hl-4">metricType</span><span class="hl-1">: </span><span class="hl-10">PerformanceMetricType</span><span class="hl-1">;  </span><span class="hl-5">// backtest_total | backtest_timeframe | backtest_signal | live_tick</span><br/><span class="hl-1">    </span><span class="hl-4">count</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                      </span><span class="hl-5">// Number of samples</span><br/><span class="hl-1">    </span><span class="hl-4">totalDuration</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;              </span><span class="hl-5">// Total duration (ms)</span><br/><span class="hl-1">    </span><span class="hl-4">avgDuration</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                </span><span class="hl-5">// Average duration (ms)</span><br/><span class="hl-1">    </span><span class="hl-4">minDuration</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                </span><span class="hl-5">// Minimum duration (ms)</span><br/><span class="hl-1">    </span><span class="hl-4">maxDuration</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                </span><span class="hl-5">// Maximum duration (ms)</span><br/><span class="hl-1">    </span><span class="hl-4">stdDev</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                     </span><span class="hl-5">// Standard deviation (ms)</span><br/><span class="hl-1">    </span><span class="hl-4">median</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                     </span><span class="hl-5">// Median duration (ms)</span><br/><span class="hl-1">    </span><span class="hl-4">p95</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                        </span><span class="hl-5">// 95th percentile (ms)</span><br/><span class="hl-1">    </span><span class="hl-4">p99</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                        </span><span class="hl-5">// 99th percentile (ms)</span><br/><span class="hl-1">  }&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">events</span><span class="hl-1">: </span><span class="hl-10">PerformanceContract</span><span class="hl-1">[];        </span><span class="hl-5">// All raw performance events</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Performance event (exported from &quot;backtest-kit&quot;)</span><br/><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-10">PerformanceContract</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">timestamp</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                    </span><span class="hl-5">// When metric was recorded (epoch ms)</span><br/><span class="hl-1">  </span><span class="hl-4">metricType</span><span class="hl-1">: </span><span class="hl-10">PerformanceMetricType</span><span class="hl-1">;    </span><span class="hl-5">// Type of operation measured</span><br/><span class="hl-1">  </span><span class="hl-4">duration</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                     </span><span class="hl-5">// Operation duration (ms)</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;                 </span><span class="hl-5">// Strategy name</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;                 </span><span class="hl-5">// Exchange name</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;                       </span><span class="hl-5">// Trading symbol</span><br/><span class="hl-1">  </span><span class="hl-4">backtest</span><span class="hl-1">: </span><span class="hl-10">boolean</span><span class="hl-1">;                    </span><span class="hl-5">// true = backtest, false = live</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Performance metric types (exported from &quot;backtest-kit&quot;)</span><br/><span class="hl-6">type</span><span class="hl-1"> </span><span class="hl-10">PerformanceMetricType</span><span class="hl-1"> =</span><br/><span class="hl-1">  | </span><span class="hl-2">&quot;backtest_total&quot;</span><span class="hl-1">      </span><span class="hl-5">// Total backtest duration</span><br/><span class="hl-1">  | </span><span class="hl-2">&quot;backtest_timeframe&quot;</span><span class="hl-1">  </span><span class="hl-5">// Single timeframe processing</span><br/><span class="hl-1">  | </span><span class="hl-2">&quot;backtest_signal&quot;</span><span class="hl-1">     </span><span class="hl-5">// Signal processing (tick + getNextCandles + backtest)</span><br/><span class="hl-1">  | </span><span class="hl-2">&quot;live_tick&quot;</span><span class="hl-1">;          </span><span class="hl-5">// Single live tick duration</span><br/><br/><span class="hl-5">// Walker results (exported from &quot;backtest-kit&quot;)</span><br/><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-10">IWalkerResults</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">bestStrategy</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;                     </span><span class="hl-5">// Name of best performing strategy</span><br/><span class="hl-1">  </span><span class="hl-4">bestMetric</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                       </span><span class="hl-5">// Metric value of best strategy</span><br/><span class="hl-1">  </span><span class="hl-4">strategies</span><span class="hl-1">: </span><span class="hl-10">Array</span><span class="hl-1">&lt;{</span><br/><span class="hl-1">    </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;                   </span><span class="hl-5">// Strategy name</span><br/><span class="hl-1">    </span><span class="hl-4">stats</span><span class="hl-1">: </span><span class="hl-10">BacktestStatistics</span><span class="hl-1">;              </span><span class="hl-5">// Full backtest statistics</span><br/><span class="hl-1">    </span><span class="hl-4">metric</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                         </span><span class="hl-5">// Metric value used for comparison</span><br/><span class="hl-1">  }&gt;;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Walker progress event (exported from &quot;backtest-kit&quot;)</span><br/><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-10">WalkerContract</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">strategiesTested</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                 </span><span class="hl-5">// Number of strategies tested so far</span><br/><span class="hl-1">  </span><span class="hl-4">totalStrategies</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                  </span><span class="hl-5">// Total number of strategies to test</span><br/><span class="hl-1">  </span><span class="hl-4">currentStrategy</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;                  </span><span class="hl-5">// Currently testing strategy name</span><br/><span class="hl-1">  </span><span class="hl-4">bestStrategy</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;              </span><span class="hl-5">// Current best strategy (null if first)</span><br/><span class="hl-1">  </span><span class="hl-4">bestMetric</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;                </span><span class="hl-5">// Current best metric value</span><br/><span class="hl-1">  </span><span class="hl-4">stats</span><span class="hl-1">: </span><span class="hl-10">BacktestStatistics</span><span class="hl-1">;                </span><span class="hl-5">// Full statistics for current strategy</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Heatmap statistics (exported from &quot;backtest-kit&quot;)</span><br/><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-10">IHeatmapStatistics</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">symbols</span><span class="hl-1">: </span><span class="hl-10">IHeatmapRow</span><span class="hl-1">[];                   </span><span class="hl-5">// Array of per-symbol statistics</span><br/><span class="hl-1">  </span><span class="hl-4">totalSymbols</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                     </span><span class="hl-5">// Total number of symbols tracked</span><br/><span class="hl-1">  </span><span class="hl-4">portfolioTotalPnl</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;         </span><span class="hl-5">// Portfolio-wide total PNL</span><br/><span class="hl-1">  </span><span class="hl-4">portfolioSharpeRatio</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;      </span><span class="hl-5">// Portfolio-wide Sharpe Ratio</span><br/><span class="hl-1">  </span><span class="hl-4">portfolioTotalTrades</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;             </span><span class="hl-5">// Portfolio-wide total trades</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Heatmap row (exported from &quot;backtest-kit&quot;)</span><br/><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-10">IHeatmapRow</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;                           </span><span class="hl-5">// Trading pair symbol (e.g., &quot;BTCUSDT&quot;)</span><br/><span class="hl-1">  </span><span class="hl-4">totalPnl</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;                  </span><span class="hl-5">// Total profit/loss % across all trades</span><br/><span class="hl-1">  </span><span class="hl-4">sharpeRatio</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;               </span><span class="hl-5">// Risk-adjusted return</span><br/><span class="hl-1">  </span><span class="hl-4">profitFactor</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;              </span><span class="hl-5">// Sum of wins / sum of losses</span><br/><span class="hl-1">  </span><span class="hl-4">expectancy</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;                </span><span class="hl-5">// Expected value per trade</span><br/><span class="hl-1">  </span><span class="hl-4">winRate</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;                   </span><span class="hl-5">// Win percentage</span><br/><span class="hl-1">  </span><span class="hl-4">avgWin</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;                    </span><span class="hl-5">// Average profit % on winning trades</span><br/><span class="hl-1">  </span><span class="hl-4">avgLoss</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;                   </span><span class="hl-5">// Average loss % on losing trades</span><br/><span class="hl-1">  </span><span class="hl-4">maxDrawdown</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;               </span><span class="hl-5">// Maximum drawdown %</span><br/><span class="hl-1">  </span><span class="hl-4">maxWinStreak</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                     </span><span class="hl-5">// Maximum consecutive winning trades</span><br/><span class="hl-1">  </span><span class="hl-4">maxLossStreak</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                    </span><span class="hl-5">// Maximum consecutive losing trades</span><br/><span class="hl-1">  </span><span class="hl-4">totalTrades</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                      </span><span class="hl-5">// Total number of closed trades</span><br/><span class="hl-1">  </span><span class="hl-4">winCount</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                         </span><span class="hl-5">// Number of winning trades</span><br/><span class="hl-1">  </span><span class="hl-4">lossCount</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;                        </span><span class="hl-5">// Number of losing trades</span><br/><span class="hl-1">  </span><span class="hl-4">avgPnl</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;                    </span><span class="hl-5">// Average PNL per trade</span><br/><span class="hl-1">  </span><span class="hl-4">stdDev</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">;                    </span><span class="hl-5">// Standard deviation of PNL</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="signal-data" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Signal Data<a href="#signal-data" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-10">ISignalRow</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">id</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;                     </span><span class="hl-5">// UUID v4 auto-generated</span><br/><span class="hl-1">  </span><span class="hl-4">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1"> | </span><span class="hl-2">&quot;short&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-10">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">priceOpen</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">priceStopLoss</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">timestamp</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;              </span><span class="hl-5">// Signal creation timestamp</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;                 </span><span class="hl-5">// Trading pair (e.g., &quot;BTCUSDT&quot;)</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="tick-results-discriminated-union" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Tick Results (Discriminated Union)<a href="#tick-results-discriminated-union" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-6">type</span><span class="hl-1"> </span><span class="hl-10">IStrategyTickResult</span><span class="hl-1"> =</span><br/><span class="hl-1">  | {</span><br/><span class="hl-1">      </span><span class="hl-4">action</span><span class="hl-1">: </span><span class="hl-2">&quot;idle&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-10">null</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">currentPrice</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  | {</span><br/><span class="hl-1">      </span><span class="hl-4">action</span><span class="hl-1">: </span><span class="hl-2">&quot;opened&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-10">ISignalRow</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">currentPrice</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  | {</span><br/><span class="hl-1">      </span><span class="hl-4">action</span><span class="hl-1">: </span><span class="hl-2">&quot;active&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-10">ISignalRow</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">currentPrice</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  | {</span><br/><span class="hl-1">      </span><span class="hl-4">action</span><span class="hl-1">: </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-10">ISignalRow</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">currentPrice</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">closeReason</span><span class="hl-1">: </span><span class="hl-2">&quot;take_profit&quot;</span><span class="hl-1"> | </span><span class="hl-2">&quot;stop_loss&quot;</span><span class="hl-1"> | </span><span class="hl-2">&quot;time_expired&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">closeTimestamp</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">pnl</span><span class="hl-1">: {</span><br/><span class="hl-1">        </span><span class="hl-4">pnlPercentage</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">priceOpen</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;        </span><span class="hl-5">// Entry price adjusted with slippage and fees</span><br/><span class="hl-1">        </span><span class="hl-4">priceClose</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;       </span><span class="hl-5">// Exit price adjusted with slippage and fees</span><br/><span class="hl-1">      };</span><br/><span class="hl-1">      </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;</span><br/><span class="hl-1">    };</span>
</code><button type="button">Copy</button></pre>

<a id="pnl-calculation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">PNL Calculation<a href="#pnl-calculation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// Constants</span><br/><span class="hl-7">PERCENT_SLIPPAGE</span><span class="hl-1"> = </span><span class="hl-8">0.1</span><span class="hl-1">% </span><span class="hl-5">// 0.001</span><br/><span class="hl-7">PERCENT_FEE</span><span class="hl-1"> = </span><span class="hl-8">0.1</span><span class="hl-1">%      </span><span class="hl-5">// 0.001</span><br/><br/><span class="hl-5">// LONG position</span><br/><span class="hl-4">priceOpenWithCosts</span><span class="hl-1"> = </span><span class="hl-4">priceOpen</span><span class="hl-1"> * (</span><span class="hl-8">1</span><span class="hl-1"> + </span><span class="hl-4">slippage</span><span class="hl-1"> + </span><span class="hl-4">fee</span><span class="hl-1">)</span><br/><span class="hl-4">priceCloseWithCosts</span><span class="hl-1"> = </span><span class="hl-4">priceClose</span><span class="hl-1"> * (</span><span class="hl-8">1</span><span class="hl-1"> - </span><span class="hl-4">slippage</span><span class="hl-1"> - </span><span class="hl-4">fee</span><span class="hl-1">)</span><br/><span class="hl-4">pnl</span><span class="hl-1">% = (</span><span class="hl-4">priceCloseWithCosts</span><span class="hl-1"> - </span><span class="hl-4">priceOpenWithCosts</span><span class="hl-1">) / </span><span class="hl-4">priceOpenWithCosts</span><span class="hl-1"> * </span><span class="hl-8">100</span><br/><br/><span class="hl-5">// SHORT position</span><br/><span class="hl-4">priceOpenWithCosts</span><span class="hl-1"> = </span><span class="hl-4">priceOpen</span><span class="hl-1"> * (</span><span class="hl-8">1</span><span class="hl-1"> - </span><span class="hl-4">slippage</span><span class="hl-1"> + </span><span class="hl-4">fee</span><span class="hl-1">)</span><br/><span class="hl-4">priceCloseWithCosts</span><span class="hl-1"> = </span><span class="hl-4">priceClose</span><span class="hl-1"> * (</span><span class="hl-8">1</span><span class="hl-1"> + </span><span class="hl-4">slippage</span><span class="hl-1"> + </span><span class="hl-4">fee</span><span class="hl-1">)</span><br/><span class="hl-4">pnl</span><span class="hl-1">% = (</span><span class="hl-4">priceOpenWithCosts</span><span class="hl-1"> - </span><span class="hl-4">priceCloseWithCosts</span><span class="hl-1">) / </span><span class="hl-4">priceOpenWithCosts</span><span class="hl-1"> * </span><span class="hl-8">100</span>
</code><button type="button">Copy</button></pre>

<a id="production-readiness" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Production Readiness<a href="#production-readiness" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="‚úÖ-production-ready-features" class="tsd-anchor"></a><h3 class="tsd-anchor-link">‚úÖ Production-Ready Features<a href="#‚úÖ-production-ready-features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ol>
<li><strong>Crash-Safe Persistence</strong> - Atomic file writes with automatic recovery</li>
<li><strong>Signal Validation</strong> - Comprehensive validation prevents invalid trades</li>
<li><strong>Type Safety</strong> - Discriminated unions eliminate runtime type errors</li>
<li><strong>Memory Efficiency</strong> - Prototype methods + async generators + memoization</li>
<li><strong>Interval Throttling</strong> - Prevents signal spam</li>
<li><strong>Live Trading Ready</strong> - Full implementation with real-time progression</li>
<li><strong>Error Recovery</strong> - Stateless process with disk-based state</li>
</ol>
<a id="advanced-examples" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Advanced Examples<a href="#advanced-examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="multi-symbol-live-trading" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Multi-Symbol Live Trading<a href="#multi-symbol-live-trading" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Live</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">symbols</span><span class="hl-1"> = [</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;ETHUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;SOLUSDT&quot;</span><span class="hl-1">];</span><br/><br/><span class="hl-5">// Run all symbols in parallel</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-10">Promise</span><span class="hl-1">.</span><span class="hl-0">all</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbols</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">for</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">result</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, {</span><br/><span class="hl-1">      </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><br/><span class="hl-1">    })) {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[</span><span class="hl-6">${</span><span class="hl-4">symbol</span><span class="hl-6">}</span><span class="hl-2">]`</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1">);</span><br/><br/><span class="hl-1">      </span><span class="hl-5">// Generate reports periodically</span><br/><span class="hl-1">      </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="backtest-progress-listener" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Backtest Progress Listener<a href="#backtest-progress-listener" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">listenProgress</span><span class="hl-1">, </span><span class="hl-4">Backtest</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">listenProgress</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Progress: </span><span class="hl-6">${</span><span class="hl-9">(</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">progress</span><span class="hl-9"> </span><span class="hl-1">*</span><span class="hl-9"> </span><span class="hl-8">100</span><span class="hl-9">).</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-8">2</span><span class="hl-9">)</span><span class="hl-6">}</span><span class="hl-2">%`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`</span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">processedFrames</span><span class="hl-6">}</span><span class="hl-2"> / </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">totalFrames</span><span class="hl-6">}</span><span class="hl-2"> frames`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Strategy: </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">strategyName</span><span class="hl-6">}</span><span class="hl-2">, Symbol: </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">symbol</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-backtest&quot;</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="performance-profiling" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Performance Profiling<a href="#performance-profiling" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Performance</span><span class="hl-1">, </span><span class="hl-4">listenPerformance</span><span class="hl-1">, </span><span class="hl-4">Backtest</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Listen to real-time performance metrics</span><br/><span class="hl-0">listenPerformance</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[</span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">metricType</span><span class="hl-6">}</span><span class="hl-2">] </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">duration</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-8">2</span><span class="hl-9">)</span><span class="hl-6">}</span><span class="hl-2">ms`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`  Strategy: </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">strategyName</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`  Symbol: </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">symbol</span><span class="hl-6">}</span><span class="hl-2">, Backtest: </span><span class="hl-6">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">backtest</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Run backtest</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-backtest&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Get aggregated performance statistics</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">perfStats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Performance</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Performance Statistics:&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`  Total events: </span><span class="hl-6">${</span><span class="hl-4">perfStats</span><span class="hl-9">.</span><span class="hl-4">totalEvents</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`  Total duration: </span><span class="hl-6">${</span><span class="hl-4">perfStats</span><span class="hl-9">.</span><span class="hl-4">totalDuration</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-8">2</span><span class="hl-9">)</span><span class="hl-6">}</span><span class="hl-2">ms`</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`  Metrics tracked: </span><span class="hl-6">${</span><span class="hl-4">Object</span><span class="hl-9">.</span><span class="hl-0">keys</span><span class="hl-9">(</span><span class="hl-4">perfStats</span><span class="hl-9">.</span><span class="hl-4">metricStats</span><span class="hl-9">).</span><span class="hl-0">join</span><span class="hl-9">(</span><span class="hl-2">&quot;, &quot;</span><span class="hl-9">)</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Analyze bottlenecks</span><br/><span class="hl-3">for</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> [</span><span class="hl-7">type</span><span class="hl-1">, </span><span class="hl-7">stats</span><span class="hl-1">] </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-4">Object</span><span class="hl-1">.</span><span class="hl-0">entries</span><span class="hl-1">(</span><span class="hl-4">perfStats</span><span class="hl-1">.</span><span class="hl-4">metricStats</span><span class="hl-1">)) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`</span><span class="hl-12">\n</span><span class="hl-6">${</span><span class="hl-4">type</span><span class="hl-6">}</span><span class="hl-2">:`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`  Count: </span><span class="hl-6">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">count</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`  Average: </span><span class="hl-6">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">avgDuration</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-8">2</span><span class="hl-9">)</span><span class="hl-6">}</span><span class="hl-2">ms`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`  Min/Max: </span><span class="hl-6">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">minDuration</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-8">2</span><span class="hl-9">)</span><span class="hl-6">}</span><span class="hl-2">ms / </span><span class="hl-6">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">maxDuration</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-8">2</span><span class="hl-9">)</span><span class="hl-6">}</span><span class="hl-2">ms`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`  P95/P99: </span><span class="hl-6">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">p95</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-8">2</span><span class="hl-9">)</span><span class="hl-6">}</span><span class="hl-2">ms / </span><span class="hl-6">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">p99</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-8">2</span><span class="hl-9">)</span><span class="hl-6">}</span><span class="hl-2">ms`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`  Std Dev: </span><span class="hl-6">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">stdDev</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-8">2</span><span class="hl-9">)</span><span class="hl-6">}</span><span class="hl-2">ms`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Generate and save performance report</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">markdown</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Performance</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Performance</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">); </span><span class="hl-5">// Saves to ./logs/performance/my-strategy.md</span>
</code><button type="button">Copy</button></pre>

<p><strong>Performance Report Example:</strong></p>
<pre><code class="markdown"># Performance Report: my-strategy

**Total events:** 1440
**Total execution time:** 12345.67ms
**Number of metric types:** 3

## Time Distribution

- **backtest_timeframe**: 65.4% (8074.32ms total)
- **backtest_signal**: 28.3% (3493.85ms total)
- **backtest_total**: 6.3% (777.50ms total)

## Detailed Metrics

| Metric Type | Count | Total (ms) | Avg (ms) | Min (ms) | Max (ms) | Std Dev (ms) | Median (ms) | P95 (ms) | P99 (ms) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| backtest_timeframe | 1440 | 8074.32 | 5.61 | 2.10 | 12.45 | 1.85 | 5.20 | 8.90 | 10.50 |
| backtest_signal | 45 | 3493.85 | 77.64 | 45.20 | 125.80 | 18.32 | 75.10 | 110.20 | 120.15 |
| backtest_total | 1 | 777.50 | 777.50 | 777.50 | 777.50 | 0.00 | 777.50 | 777.50 | 777.50 |

**Note:** All durations are in milliseconds. P95/P99 represent 95th and 99th percentile response times.
</code><button type="button">Copy</button></pre>

<a id="early-termination" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Early Termination<a href="#early-termination" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Using async generator with break:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Backtest</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-3">for</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">result</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-backtest&quot;</span><br/><span class="hl-1">})) {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">closeReason</span><span class="hl-1"> === </span><span class="hl-2">&quot;stop_loss&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Stop loss hit - terminating backtest&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-5">// Save final report before exit</span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">break</span><span class="hl-1">; </span><span class="hl-5">// Generator stops immediately</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Using background mode with stop() function:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Backtest</span><span class="hl-1">, </span><span class="hl-4">Live</span><span class="hl-1">, </span><span class="hl-4">listenSignalLiveOnce</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Backtest.background returns a stop function</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stopBacktest</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-backtest&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Stop backtest after some condition</span><br/><span class="hl-0">setTimeout</span><span class="hl-1">(() </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Stopping backtest...&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">stopBacktest</span><span class="hl-1">(); </span><span class="hl-5">// Stops the background execution</span><br/><span class="hl-1">}, </span><span class="hl-8">5000</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Live.background also returns a stop function</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stopLive</span><span class="hl-1"> = </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Stop live trading after detecting stop loss</span><br/><span class="hl-0">listenSignalLiveOnce</span><span class="hl-1">(</span><br/><span class="hl-1">  (</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1"> &amp;&amp; </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">closeReason</span><span class="hl-1"> === </span><span class="hl-2">&quot;stop_loss&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  (</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Stop loss detected - stopping live trading&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-0">stopLive</span><span class="hl-1">(); </span><span class="hl-5">// Stops the infinite loop</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="use-cases-1" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Use Cases<a href="#use-cases-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Algorithmic Trading</strong> - Backtest and deploy strategies with crash recovery</li>
<li><strong>Strategy Research</strong> - Test hypotheses on historical data</li>
<li><strong>Signal Generation</strong> - Use with ML models or technical indicators</li>
<li><strong>Portfolio Management</strong> - Track multiple strategies across symbols</li>
<li><strong>Educational Projects</strong> - Learn trading system architecture</li>
</ul>
<a id="contributing" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Contributing<a href="#contributing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Pull requests are welcome. For major changes, please open an issue first.</p>
<a id="license" class="tsd-anchor"></a><h2 class="tsd-anchor-link">License<a href="#license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>MIT</p>
<a id="links" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Links<a href="#links" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><a href="media/ARCHITECTURE.md">Architecture Documentation</a></li>
<li><a href="https://www.typescriptlang.org/">TypeScript Documentation</a></li>
<li><a href="https://github.com/tripolskypetr/di-kit">Dependency Injection</a></li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#üßø-backtest-kit"><span>üßø <wbr/>Backtest <wbr/>Kit</span></a><ul><li><a href="#features"><span>Features</span></a></li><li><a href="#installation"><span>Installation</span></a></li><li><a href="#quick-start"><span>Quick <wbr/>Start</span></a></li><li><ul><li><a href="#1-register-exchange-data-source"><span>1. <wbr/>Register <wbr/>Exchange <wbr/>Data <wbr/>Source</span></a></li><li><a href="#2-register-trading-strategy"><span>2. <wbr/>Register <wbr/>Trading <wbr/>Strategy</span></a></li><li><a href="#3-add-timeframe-generator"><span>3. <wbr/>Add <wbr/>Timeframe <wbr/>Generator</span></a></li><li><a href="#4-run-backtest"><span>4. <wbr/>Run <wbr/>Backtest</span></a></li><li><a href="#5-run-live-trading-crash-safe"><span>5. <wbr/>Run <wbr/>Live <wbr/>Trading (<wbr/>Crash-<wbr/>Safe)</span></a></li><li><a href="#6-alternative-async-generators-optional"><span>6. <wbr/>Alternative: <wbr/>Async <wbr/>Generators (<wbr/>Optional)</span></a></li><li><a href="#7-strategy-comparison-with-walker-optional"><span>7. <wbr/>Strategy <wbr/>Comparison with <wbr/>Walker (<wbr/>Optional)</span></a></li><li><ul><li><a href="#register-walker-schema"><span>Register <wbr/>Walker <wbr/>Schema</span></a></li><li><a href="#run-walker-comparison"><span>Run <wbr/>Walker <wbr/>Comparison</span></a></li><li><a href="#get-walker-results"><span>Get <wbr/>Walker <wbr/>Results</span></a></li></ul></li><li><a href="#8-portfolio-heatmap-optional"><span>8. <wbr/>Portfolio <wbr/>Heatmap (<wbr/>Optional)</span></a></li><li><ul><li><a href="#get-heatmap-data"><span>Get <wbr/>Heatmap <wbr/>Data</span></a></li><li><a href="#heatmap-report-example"><span>Heatmap <wbr/>Report <wbr/>Example</span></a></li><li><a href="#use-cases"><span>Use <wbr/>Cases</span></a></li></ul></li><li><a href="#9-position-sizing-calculator-optional"><span>9. <wbr/>Position <wbr/>Sizing <wbr/>Calculator (<wbr/>Optional)</span></a></li><li><ul><li><a href="#register-position-sizing-schemas"><span>Register <wbr/>Position <wbr/>Sizing <wbr/>Schemas</span></a></li><li><a href="#calculate-position-sizes"><span>Calculate <wbr/>Position <wbr/>Sizes</span></a></li><li><a href="#integration-with-strategy"><span>Integration with <wbr/>Strategy</span></a></li><li><a href="#list-available-sizing-schemas"><span>List <wbr/>Available <wbr/>Sizing <wbr/>Schemas</span></a></li><li><a href="#position-sizing-callbacks"><span>Position <wbr/>Sizing <wbr/>Callbacks</span></a></li><li><a href="#constraint-enforcement"><span>Constraint <wbr/>Enforcement</span></a></li></ul></li><li><a href="#10-schema-reflection-api-optional"><span>10. <wbr/>Schema <wbr/>Reflection API (<wbr/>Optional)</span></a></li></ul></li><li><a href="#architecture-overview"><span>Architecture <wbr/>Overview</span></a></li><li><a href="#signal-validation"><span>Signal <wbr/>Validation</span></a></li><li><a href="#custom-persistence-adapter"><span>Custom <wbr/>Persistence <wbr/>Adapter</span></a></li><li><a href="#interval-throttling"><span>Interval <wbr/>Throttling</span></a></li><li><a href="#markdown-reports"><span>Markdown <wbr/>Reports</span></a></li><li><ul><li><a href="#backtest-reports"><span>Backtest <wbr/>Reports</span></a></li><li><a href="#live-trading-reports"><span>Live <wbr/>Trading <wbr/>Reports</span></a></li></ul></li><li><a href="#event-listeners"><span>Event <wbr/>Listeners</span></a></li><li><ul><li><a href="#background-execution-with-event-listeners"><span>Background <wbr/>Execution with <wbr/>Event <wbr/>Listeners</span></a></li><li><a href="#listen-once-with-filter"><span>Listen <wbr/>Once with <wbr/>Filter</span></a></li><li><a href="#live-trading-with-event-listeners"><span>Live <wbr/>Trading with <wbr/>Event <wbr/>Listeners</span></a></li><li><a href="#listen-to-all-signals-backtest--live"><span>Listen to <wbr/>All <wbr/>Signals (<wbr/>Backtest + <wbr/>Live)</span></a></li><li><a href="#listen-to-background-completion"><span>Listen to <wbr/>Background <wbr/>Completion</span></a></li></ul></li><li><a href="#api-reference"><span>API <wbr/>Reference</span></a></li><li><ul><li><a href="#high-level-functions"><span>High-<wbr/>Level <wbr/>Functions</span></a></li><li><ul><li><a href="#schema-registration"><span>Schema <wbr/>Registration</span></a></li><li><a href="#exchange-data"><span>Exchange <wbr/>Data</span></a></li></ul></li><li><a href="#service-apis"><span>Service APIs</span></a></li><li><ul><li><a href="#backtest-api"><span>Backtest API</span></a></li><li><a href="#live-trading-api"><span>Live <wbr/>Trading API</span></a></li><li><a href="#walker-api"><span>Walker API</span></a></li><li><a href="#heat-api"><span>Heat API</span></a></li><li><a href="#position-sizing-api"><span>Position <wbr/>Sizing API</span></a></li><li><a href="#performance-profiling-api"><span>Performance <wbr/>Profiling API</span></a></li></ul></li></ul></li><li><a href="#type-definitions"><span>Type <wbr/>Definitions</span></a></li><li><ul><li><a href="#statistics-types"><span>Statistics <wbr/>Types</span></a></li><li><a href="#signal-data"><span>Signal <wbr/>Data</span></a></li><li><a href="#tick-results-discriminated-union"><span>Tick <wbr/>Results (<wbr/>Discriminated <wbr/>Union)</span></a></li><li><a href="#pnl-calculation"><span>PNL <wbr/>Calculation</span></a></li></ul></li><li><a href="#production-readiness"><span>Production <wbr/>Readiness</span></a></li><li><ul><li><a href="#‚úÖ-production-ready-features"><span>‚úÖ <wbr/>Production-<wbr/>Ready <wbr/>Features</span></a></li></ul></li><li><a href="#advanced-examples"><span>Advanced <wbr/>Examples</span></a></li><li><ul><li><a href="#multi-symbol-live-trading"><span>Multi-<wbr/>Symbol <wbr/>Live <wbr/>Trading</span></a></li><li><a href="#backtest-progress-listener"><span>Backtest <wbr/>Progress <wbr/>Listener</span></a></li><li><a href="#performance-profiling"><span>Performance <wbr/>Profiling</span></a></li><li><a href="#early-termination"><span>Early <wbr/>Termination</span></a></li></ul></li><li><a href="#use-cases-1"><span>Use <wbr/>Cases</span></a></li><li><a href="#contributing"><span>Contributing</span></a></li><li><a href="#license"><span>License</span></a></li><li><a href="#links"><span>Links</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
