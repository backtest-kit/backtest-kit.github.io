<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/29_sizing_schemas | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_29_sizing_schemas.html">design/29_sizing_schemas</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="sizing-schemas" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Sizing Schemas<a href="#sizing-schemas" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>Sizing schemas define position sizing methods for calculating trade quantities based on account balance, risk parameters, and market conditions. The framework provides three built-in sizing methods via a discriminated union: fixed-percentage, Kelly Criterion, and ATR-based. Strategies reference sizing schemas by name via the <code>sizingName</code> field in <code>IStrategySchema</code>.</p>
<p>For information about how strategies reference sizing, see <a href="design_25_strategy_schemas.html">Strategy Schemas</a>. For risk management that controls whether positions are allowed, see <a href="design_28_risk_schemas.html">Risk Schemas</a>.</p>
<hr>
<a id="discriminated-union-architecture" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Discriminated Union Architecture<a href="#discriminated-union-architecture" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>ISizingSchema</code> type is a discriminated union using the <code>method</code> field as the discriminator. Each method has specific required and optional parameters suited to its calculation algorithm.</p>
<p><img src="../media/29_Sizing_Schemas_0.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="schema-registration-flow" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Schema Registration Flow<a href="#schema-registration-flow" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Sizing schemas are registered via <code>addSizing()</code>, which stores them in <code>SizingSchemaService</code> and validates them through <code>SizingValidationService</code>. Strategies reference sizing configurations by name, triggering lazy instantiation of <code>ClientSizing</code> via <code>SizingConnectionService</code>.</p>
<p><img src="../media/29_Sizing_Schemas_1.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="fixed-percentage-sizing" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Fixed Percentage Sizing<a href="#fixed-percentage-sizing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Fixed percentage sizing risks a constant percentage of account balance per trade. Position size is calculated as:</p>
<pre><code><span class="hl-6">Position</span><span class="hl-2"> </span><span class="hl-6">Size</span><span class="hl-2"> = (</span><span class="hl-6">Account</span><span class="hl-2"> </span><span class="hl-6">Balance</span><span class="hl-2"> × </span><span class="hl-6">Risk</span><span class="hl-2"> </span><span class="hl-6">Percentage</span><span class="hl-2">) / </span><span class="hl-6">Distance</span><span class="hl-2"> </span><span class="hl-6">to</span><span class="hl-2"> </span><span class="hl-6">Stop</span><span class="hl-2"> </span><span class="hl-6">Loss</span>
</code><button>Copy</button></pre>

<a id="schema-structure" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schema Structure<a href="#schema-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sizingName</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Unique identifier for this sizing configuration</td>
</tr>
<tr>
<td><code>method</code></td>
<td><code>&quot;fixed-percentage&quot;</code></td>
<td>Yes</td>
<td>Discriminator for fixed percentage method</td>
</tr>
<tr>
<td><code>riskPercentage</code></td>
<td><code>number</code></td>
<td>Yes</td>
<td>Percentage of account balance to risk per trade</td>
</tr>
<tr>
<td><code>maxPositionPercentage</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Maximum position size as percentage of account (default: no limit)</td>
</tr>
<tr>
<td><code>minPositionSize</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Minimum position size (default: no limit)</td>
</tr>
<tr>
<td><code>maxPositionSize</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Maximum position size (default: no limit)</td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td><code>Partial&lt;ISizingCallbacks&gt;</code></td>
<td>No</td>
<td>Optional lifecycle callbacks</td>
</tr>
<tr>
<td><code>note</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Optional developer documentation</td>
</tr>
</tbody>
</table>
<a id="example" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example<a href="#example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-1">addSizing</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">sizingName:</span><span class="hl-2"> </span><span class="hl-4">&quot;conservative&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">method:</span><span class="hl-2"> </span><span class="hl-4">&quot;fixed-percentage&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">riskPercentage:</span><span class="hl-2"> </span><span class="hl-7">1</span><span class="hl-2">, </span><span class="hl-0">// Risk 1% per trade</span><br/><span class="hl-2">  </span><span class="hl-6">maxPositionPercentage:</span><span class="hl-2"> </span><span class="hl-7">10</span><span class="hl-2">, </span><span class="hl-0">// Max 10% of account per position</span><br/><span class="hl-2">  </span><span class="hl-6">minPositionSize:</span><span class="hl-2"> </span><span class="hl-7">0.001</span><span class="hl-2">, </span><span class="hl-0">// Minimum 0.001 BTC</span><br/><span class="hl-2">  </span><span class="hl-6">callbacks:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-1">onCalculate</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">quantity</span><span class="hl-2">, </span><span class="hl-6">params</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Position size: </span><span class="hl-3">${</span><span class="hl-6">quantity</span><span class="hl-3">}</span><span class="hl-4"> for </span><span class="hl-3">${</span><span class="hl-6">params</span><span class="hl-9">.</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="kelly-criterion-sizing" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Kelly Criterion Sizing<a href="#kelly-criterion-sizing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Kelly Criterion sizing calculates optimal position size based on win probability and win/loss ratio using the Kelly formula:</p>
<pre><code><span class="hl-6">Kelly</span><span class="hl-2"> % = (</span><span class="hl-6">Win</span><span class="hl-2"> </span><span class="hl-6">Rate</span><span class="hl-2"> × </span><span class="hl-6">Avg</span><span class="hl-2"> </span><span class="hl-6">Win</span><span class="hl-2">) / </span><span class="hl-6">Avg</span><span class="hl-2"> </span><span class="hl-6">Loss</span><span class="hl-2"> - (</span><span class="hl-7">1</span><span class="hl-2"> - </span><span class="hl-6">Win</span><span class="hl-2"> </span><span class="hl-6">Rate</span><span class="hl-2">)</span><br/><span class="hl-6">Position</span><span class="hl-2"> </span><span class="hl-6">Size</span><span class="hl-2"> = </span><span class="hl-6">Account</span><span class="hl-2"> </span><span class="hl-6">Balance</span><span class="hl-2"> × </span><span class="hl-6">Kelly</span><span class="hl-2"> % × </span><span class="hl-6">Kelly</span><span class="hl-2"> </span><span class="hl-6">Multiplier</span>
</code><button>Copy</button></pre>

<p>The <code>kellyMultiplier</code> (default: 0.25) reduces the Kelly percentage to manage risk, as full Kelly can be aggressive.</p>
<a id="schema-structure-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schema Structure<a href="#schema-structure-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sizingName</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Unique identifier for this sizing configuration</td>
</tr>
<tr>
<td><code>method</code></td>
<td><code>&quot;kelly-criterion&quot;</code></td>
<td>Yes</td>
<td>Discriminator for Kelly Criterion method</td>
</tr>
<tr>
<td><code>kellyMultiplier</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Multiplier to reduce Kelly percentage (default: 0.25)</td>
</tr>
<tr>
<td><code>maxPositionPercentage</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Maximum position size as percentage of account (default: no limit)</td>
</tr>
<tr>
<td><code>minPositionSize</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Minimum position size (default: no limit)</td>
</tr>
<tr>
<td><code>maxPositionSize</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Maximum position size (default: no limit)</td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td><code>Partial&lt;ISizingCallbacks&gt;</code></td>
<td>No</td>
<td>Optional lifecycle callbacks</td>
</tr>
<tr>
<td><code>note</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Optional developer documentation</td>
</tr>
</tbody>
</table>
<a id="example-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example<a href="#example-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-1">addSizing</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">sizingName:</span><span class="hl-2"> </span><span class="hl-4">&quot;kelly-quarter&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">method:</span><span class="hl-2"> </span><span class="hl-4">&quot;kelly-criterion&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">kellyMultiplier:</span><span class="hl-2"> </span><span class="hl-7">0.25</span><span class="hl-2">, </span><span class="hl-0">// Use quarter Kelly (conservative)</span><br/><span class="hl-2">  </span><span class="hl-6">maxPositionPercentage:</span><span class="hl-2"> </span><span class="hl-7">20</span><span class="hl-2">, </span><span class="hl-0">// Max 20% of account</span><br/><span class="hl-2">  </span><span class="hl-6">callbacks:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-1">onCalculate</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">quantity</span><span class="hl-2">, </span><span class="hl-6">params</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Kelly size: </span><span class="hl-3">${</span><span class="hl-6">quantity</span><span class="hl-3">}</span><span class="hl-4"> (win rate: </span><span class="hl-3">${</span><span class="hl-6">params</span><span class="hl-9">.</span><span class="hl-6">winRate</span><span class="hl-3">}</span><span class="hl-4">)`</span><span class="hl-2">);</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="atr-based-sizing" class="tsd-anchor"></a><h2 class="tsd-anchor-link">ATR-Based Sizing<a href="#atr-based-sizing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>ATR-based sizing uses Average True Range to dynamically adjust position size based on market volatility. Position size is calculated as:</p>
<pre><code><span class="hl-6">Position</span><span class="hl-2"> </span><span class="hl-6">Size</span><span class="hl-2"> = (</span><span class="hl-6">Account</span><span class="hl-2"> </span><span class="hl-6">Balance</span><span class="hl-2"> × </span><span class="hl-6">Risk</span><span class="hl-2"> </span><span class="hl-6">Percentage</span><span class="hl-2">) / (</span><span class="hl-8">ATR</span><span class="hl-2"> × </span><span class="hl-8">ATR</span><span class="hl-2"> </span><span class="hl-6">Multiplier</span><span class="hl-2">)</span>
</code><button>Copy</button></pre>

<p>Higher ATR (more volatile markets) results in smaller position sizes to maintain consistent risk.</p>
<a id="schema-structure-2" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schema Structure<a href="#schema-structure-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sizingName</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Unique identifier for this sizing configuration</td>
</tr>
<tr>
<td><code>method</code></td>
<td><code>&quot;atr-based&quot;</code></td>
<td>Yes</td>
<td>Discriminator for ATR-based method</td>
</tr>
<tr>
<td><code>riskPercentage</code></td>
<td><code>number</code></td>
<td>Yes</td>
<td>Percentage of account balance to risk per trade</td>
</tr>
<tr>
<td><code>atrMultiplier</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Multiplier for ATR value (default: 2)</td>
</tr>
<tr>
<td><code>maxPositionPercentage</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Maximum position size as percentage of account (default: no limit)</td>
</tr>
<tr>
<td><code>minPositionSize</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Minimum position size (default: no limit)</td>
</tr>
<tr>
<td><code>maxPositionSize</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Maximum position size (default: no limit)</td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td><code>Partial&lt;ISizingCallbacks&gt;</code></td>
<td>No</td>
<td>Optional lifecycle callbacks</td>
</tr>
<tr>
<td><code>note</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Optional developer documentation</td>
</tr>
</tbody>
</table>
<a id="example-2" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example<a href="#example-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-1">addSizing</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">sizingName:</span><span class="hl-2"> </span><span class="hl-4">&quot;atr-dynamic&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">method:</span><span class="hl-2"> </span><span class="hl-4">&quot;atr-based&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">riskPercentage:</span><span class="hl-2"> </span><span class="hl-7">2</span><span class="hl-2">, </span><span class="hl-0">// Risk 2% per trade</span><br/><span class="hl-2">  </span><span class="hl-6">atrMultiplier:</span><span class="hl-2"> </span><span class="hl-7">2</span><span class="hl-2">, </span><span class="hl-0">// Stop loss at 2× ATR</span><br/><span class="hl-2">  </span><span class="hl-6">maxPositionPercentage:</span><span class="hl-2"> </span><span class="hl-7">15</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">callbacks:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-1">onCalculate</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">quantity</span><span class="hl-2">, </span><span class="hl-6">params</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`ATR size: </span><span class="hl-3">${</span><span class="hl-6">quantity</span><span class="hl-3">}</span><span class="hl-4"> (ATR: </span><span class="hl-3">${</span><span class="hl-6">params</span><span class="hl-9">.</span><span class="hl-6">atr</span><span class="hl-3">}</span><span class="hl-4">)`</span><span class="hl-2">);</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="position-size-constraints" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Position Size Constraints<a href="#position-size-constraints" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>All sizing methods support optional position size constraints to enforce portfolio-level limits:</p>
<p><img src="../media/29_Sizing_Schemas_2.svg" alt="Mermaid Diagram"></p>
<a id="constraint-parameters" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Constraint Parameters<a href="#constraint-parameters" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>maxPositionPercentage</code></td>
<td><code>number</code></td>
<td>Maximum position as % of account balance (prevents over-concentration)</td>
</tr>
<tr>
<td><code>minPositionSize</code></td>
<td><code>number</code></td>
<td>Minimum position size in base asset (prevents dust trades)</td>
</tr>
<tr>
<td><code>maxPositionSize</code></td>
<td><code>number</code></td>
<td>Maximum position size in base asset (absolute limit)</td>
</tr>
</tbody>
</table>
<hr>
<a id="calculation-parameters-flow" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Calculation Parameters Flow<a href="#calculation-parameters-flow" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>When calculating position size, <code>ClientSizing</code> receives method-specific parameters through the discriminated union <code>ISizingCalculateParams</code>:</p>
<p><img src="../media/29_Sizing_Schemas_3.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="sizing-callbacks" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Sizing Callbacks<a href="#sizing-callbacks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>ISizingCallbacks</code> interface provides lifecycle hooks for monitoring sizing calculations:</p>
<pre><code class="typescript"><span class="hl-3">interface</span><span class="hl-2"> </span><span class="hl-11">ISizingCallbacks</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-1">onCalculate</span><span class="hl-2">: (</span><br/><span class="hl-2">    </span><span class="hl-6">quantity</span><span class="hl-2">: </span><span class="hl-11">number</span><span class="hl-2">, </span><br/><span class="hl-2">    </span><span class="hl-6">params</span><span class="hl-2">: </span><span class="hl-11">ISizingCalculateParams</span><br/><span class="hl-2">  ) </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-11">void</span><span class="hl-2">;</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<a id="callback-invocation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Callback Invocation<a href="#callback-invocation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/29_Sizing_Schemas_4.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="integration-with-strategy-schemas" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Integration with Strategy Schemas<a href="#integration-with-strategy-schemas" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Strategies reference sizing schemas via the optional <code>sizingName</code> field. If omitted, no position sizing is applied (strategy must manage quantities manually).</p>
<a id="strategy-schema-reference" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Strategy Schema Reference<a href="#strategy-schema-reference" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-1">addStrategy</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">strategyName:</span><span class="hl-2"> </span><span class="hl-4">&quot;my-strategy&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">interval:</span><span class="hl-2"> </span><span class="hl-4">&quot;5m&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">sizingName:</span><span class="hl-2"> </span><span class="hl-4">&quot;conservative&quot;</span><span class="hl-2">, </span><span class="hl-0">// References sizing schema</span><br/><span class="hl-2">  </span><span class="hl-1">getSignal</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> ({</span><br/><span class="hl-2">    </span><span class="hl-6">position:</span><span class="hl-2"> </span><span class="hl-4">&quot;long&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-6">priceTakeProfit:</span><span class="hl-2"> </span><span class="hl-7">51000</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-6">priceStopLoss:</span><span class="hl-2"> </span><span class="hl-7">49000</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-6">minuteEstimatedTime:</span><span class="hl-2"> </span><span class="hl-7">60</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-0">// No quantity specified - calculated by sizing</span><br/><span class="hl-2">  }),</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="service-interaction" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Service Interaction<a href="#service-interaction" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/29_Sizing_Schemas_5.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="service-layer-components" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Service Layer Components<a href="#service-layer-components" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The sizing system follows the standard service layer pattern with Schema, Validation, Connection, and Client services:</p>
<table>
<thead>
<tr>
<th>Service</th>
<th>File Pattern</th>
<th>Responsibility</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SizingSchemaService</code></td>
<td><code>services/schema/SizingSchemaService</code></td>
<td>Stores sizing schemas in <code>ToolRegistry</code> by <code>sizingName</code></td>
</tr>
<tr>
<td><code>SizingValidationService</code></td>
<td><code>services/validation/SizingValidationService</code></td>
<td>Validates sizing schemas during registration</td>
</tr>
<tr>
<td><code>SizingConnectionService</code></td>
<td><code>services/connection/SizingConnectionService</code></td>
<td>Memoizes <code>ClientSizing</code> instances (one per <code>sizingName</code>)</td>
</tr>
<tr>
<td><code>ClientSizing</code></td>
<td><code>classes/ClientSizing</code></td>
<td>Executes sizing algorithms and applies constraints</td>
</tr>
</tbody>
</table>
<a id="memoization-pattern" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Memoization Pattern<a href="#memoization-pattern" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><code>SizingConnectionService</code> memoizes <code>ClientSizing</code> instances to ensure singleton behavior per sizing name:</p>
<p><img src="../media/29_Sizing_Schemas_6.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="listing-registered-sizing-schemas" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Listing Registered Sizing Schemas<a href="#listing-registered-sizing-schemas" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>listSizings()</code> function retrieves all registered sizing schemas for inspection or debugging:</p>
<pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">listSizings</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">sizings</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">listSizings</span><span class="hl-2">();</span><br/><br/><span class="hl-6">sizings</span><span class="hl-2">.</span><span class="hl-1">forEach</span><span class="hl-2">(</span><span class="hl-6">schema</span><span class="hl-2"> </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`</span><span class="hl-3">${</span><span class="hl-6">schema</span><span class="hl-9">.</span><span class="hl-6">sizingName</span><span class="hl-3">}</span><span class="hl-4">: </span><span class="hl-3">${</span><span class="hl-6">schema</span><span class="hl-9">.</span><span class="hl-6">method</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><br/><span class="hl-2">  </span><span class="hl-5">if</span><span class="hl-2"> (</span><span class="hl-6">schema</span><span class="hl-2">.</span><span class="hl-6">method</span><span class="hl-2"> === </span><span class="hl-4">&quot;fixed-percentage&quot;</span><span class="hl-2">) {</span><br/><span class="hl-2">    </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`  Risk: </span><span class="hl-3">${</span><span class="hl-6">schema</span><span class="hl-9">.</span><span class="hl-6">riskPercentage</span><span class="hl-3">}</span><span class="hl-4">%`</span><span class="hl-2">);</span><br/><span class="hl-2">  } </span><span class="hl-5">else</span><span class="hl-2"> </span><span class="hl-5">if</span><span class="hl-2"> (</span><span class="hl-6">schema</span><span class="hl-2">.</span><span class="hl-6">method</span><span class="hl-2"> === </span><span class="hl-4">&quot;kelly-criterion&quot;</span><span class="hl-2">) {</span><br/><span class="hl-2">    </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`  Multiplier: </span><span class="hl-3">${</span><span class="hl-6">schema</span><span class="hl-9">.</span><span class="hl-6">kellyMultiplier</span><span class="hl-9"> </span><span class="hl-2">||</span><span class="hl-9"> </span><span class="hl-7">0.25</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">  } </span><span class="hl-5">else</span><span class="hl-2"> </span><span class="hl-5">if</span><span class="hl-2"> (</span><span class="hl-6">schema</span><span class="hl-2">.</span><span class="hl-6">method</span><span class="hl-2"> === </span><span class="hl-4">&quot;atr-based&quot;</span><span class="hl-2">) {</span><br/><span class="hl-2">    </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`  Risk: </span><span class="hl-3">${</span><span class="hl-6">schema</span><span class="hl-9">.</span><span class="hl-6">riskPercentage</span><span class="hl-3">}</span><span class="hl-4">%, ATR: </span><span class="hl-3">${</span><span class="hl-6">schema</span><span class="hl-9">.</span><span class="hl-6">atrMultiplier</span><span class="hl-9"> </span><span class="hl-2">||</span><span class="hl-9"> </span><span class="hl-7">2</span><span class="hl-3">}</span><span class="hl-4">×`</span><span class="hl-2">);</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="complete-registration-examples" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Complete Registration Examples<a href="#complete-registration-examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="conservative-fixed-percentage" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Conservative Fixed Percentage<a href="#conservative-fixed-percentage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-1">addSizing</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">sizingName:</span><span class="hl-2"> </span><span class="hl-4">&quot;conservative-fixed&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">note:</span><span class="hl-2"> </span><span class="hl-4">&quot;Low risk fixed percentage for stable strategies&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">method:</span><span class="hl-2"> </span><span class="hl-4">&quot;fixed-percentage&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">riskPercentage:</span><span class="hl-2"> </span><span class="hl-7">1</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">maxPositionPercentage:</span><span class="hl-2"> </span><span class="hl-7">10</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">minPositionSize:</span><span class="hl-2"> </span><span class="hl-7">0.001</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">maxPositionSize:</span><span class="hl-2"> </span><span class="hl-7">1</span><span class="hl-2">,</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="aggressive-kelly-criterion" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Aggressive Kelly Criterion<a href="#aggressive-kelly-criterion" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-1">addSizing</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">sizingName:</span><span class="hl-2"> </span><span class="hl-4">&quot;aggressive-kelly&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">note:</span><span class="hl-2"> </span><span class="hl-4">&quot;Half Kelly for high-conviction trades&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">method:</span><span class="hl-2"> </span><span class="hl-4">&quot;kelly-criterion&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">kellyMultiplier:</span><span class="hl-2"> </span><span class="hl-7">0.5</span><span class="hl-2">, </span><span class="hl-0">// Half Kelly (more aggressive)</span><br/><span class="hl-2">  </span><span class="hl-6">maxPositionPercentage:</span><span class="hl-2"> </span><span class="hl-7">25</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">callbacks:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-1">onCalculate</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">quantity</span><span class="hl-2">, </span><span class="hl-6">params</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-5">if</span><span class="hl-2"> (</span><span class="hl-6">params</span><span class="hl-2">.</span><span class="hl-6">method</span><span class="hl-2"> === </span><span class="hl-4">&quot;kelly-criterion&quot;</span><span class="hl-2">) {</span><br/><span class="hl-2">        </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Win rate: </span><span class="hl-3">${</span><span class="hl-6">params</span><span class="hl-9">.</span><span class="hl-6">winRate</span><span class="hl-3">}</span><span class="hl-4">, Size: </span><span class="hl-3">${</span><span class="hl-6">quantity</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">      }</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="volatility-adjusted-atr" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Volatility-Adjusted ATR<a href="#volatility-adjusted-atr" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-1">addSizing</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">sizingName:</span><span class="hl-2"> </span><span class="hl-4">&quot;volatility-adjusted&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">note:</span><span class="hl-2"> </span><span class="hl-4">&quot;ATR-based sizing for volatile markets&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">method:</span><span class="hl-2"> </span><span class="hl-4">&quot;atr-based&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">riskPercentage:</span><span class="hl-2"> </span><span class="hl-7">2</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">atrMultiplier:</span><span class="hl-2"> </span><span class="hl-7">1.5</span><span class="hl-2">, </span><span class="hl-0">// Tighter stop loss</span><br/><span class="hl-2">  </span><span class="hl-6">maxPositionPercentage:</span><span class="hl-2"> </span><span class="hl-7">15</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">minPositionSize:</span><span class="hl-2"> </span><span class="hl-7">0.001</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">callbacks:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-1">onCalculate</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">quantity</span><span class="hl-2">, </span><span class="hl-6">params</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-5">if</span><span class="hl-2"> (</span><span class="hl-6">params</span><span class="hl-2">.</span><span class="hl-6">method</span><span class="hl-2"> === </span><span class="hl-4">&quot;atr-based&quot;</span><span class="hl-2">) {</span><br/><span class="hl-2">        </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`ATR: </span><span class="hl-3">${</span><span class="hl-6">params</span><span class="hl-9">.</span><span class="hl-6">atr</span><span class="hl-3">}</span><span class="hl-4">, Size: </span><span class="hl-3">${</span><span class="hl-6">quantity</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">      }</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#sizing-schemas"><span>Sizing <wbr/>Schemas</span></a><ul><li><a href="#discriminated-union-architecture"><span>Discriminated <wbr/>Union <wbr/>Architecture</span></a></li><li><a href="#schema-registration-flow"><span>Schema <wbr/>Registration <wbr/>Flow</span></a></li><li><a href="#fixed-percentage-sizing"><span>Fixed <wbr/>Percentage <wbr/>Sizing</span></a></li><li><ul><li><a href="#schema-structure"><span>Schema <wbr/>Structure</span></a></li><li><a href="#example"><span>Example</span></a></li></ul></li><li><a href="#kelly-criterion-sizing"><span>Kelly <wbr/>Criterion <wbr/>Sizing</span></a></li><li><ul><li><a href="#schema-structure-1"><span>Schema <wbr/>Structure</span></a></li><li><a href="#example-1"><span>Example</span></a></li></ul></li><li><a href="#atr-based-sizing"><span>ATR-<wbr/>Based <wbr/>Sizing</span></a></li><li><ul><li><a href="#schema-structure-2"><span>Schema <wbr/>Structure</span></a></li><li><a href="#example-2"><span>Example</span></a></li></ul></li><li><a href="#position-size-constraints"><span>Position <wbr/>Size <wbr/>Constraints</span></a></li><li><ul><li><a href="#constraint-parameters"><span>Constraint <wbr/>Parameters</span></a></li></ul></li><li><a href="#calculation-parameters-flow"><span>Calculation <wbr/>Parameters <wbr/>Flow</span></a></li><li><a href="#sizing-callbacks"><span>Sizing <wbr/>Callbacks</span></a></li><li><ul><li><a href="#callback-invocation"><span>Callback <wbr/>Invocation</span></a></li></ul></li><li><a href="#integration-with-strategy-schemas"><span>Integration with <wbr/>Strategy <wbr/>Schemas</span></a></li><li><ul><li><a href="#strategy-schema-reference"><span>Strategy <wbr/>Schema <wbr/>Reference</span></a></li><li><a href="#service-interaction"><span>Service <wbr/>Interaction</span></a></li></ul></li><li><a href="#service-layer-components"><span>Service <wbr/>Layer <wbr/>Components</span></a></li><li><ul><li><a href="#memoization-pattern"><span>Memoization <wbr/>Pattern</span></a></li></ul></li><li><a href="#listing-registered-sizing-schemas"><span>Listing <wbr/>Registered <wbr/>Sizing <wbr/>Schemas</span></a></li><li><a href="#complete-registration-examples"><span>Complete <wbr/>Registration <wbr/>Examples</span></a></li><li><ul><li><a href="#conservative-fixed-percentage"><span>Conservative <wbr/>Fixed <wbr/>Percentage</span></a></li><li><a href="#aggressive-kelly-criterion"><span>Aggressive <wbr/>Kelly <wbr/>Criterion</span></a></li><li><a href="#volatility-adjusted-atr"><span>Volatility-<wbr/>Adjusted ATR</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
