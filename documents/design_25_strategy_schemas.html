<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/25_strategy_schemas | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_25_strategy_schemas.html">design/25_strategy_schemas</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="strategy-schemas" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Strategy Schemas<a href="#strategy-schemas" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><a id="purpose-and-scope" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Purpose and Scope<a href="#purpose-and-scope" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This page documents the <code>IStrategySchema</code> interface, which defines the configuration structure for trading strategies in backtest-kit. Strategy schemas specify signal generation logic, throttling intervals, lifecycle callbacks, and optional risk management integration.</p>
<p>For information about risk management configuration, see <a href="design_28_risk_schemas.html">Risk Schemas</a>. For exchange data source configuration, see <a href="design_26_exchange_schemas.html">Exchange Schemas</a>. For strategy execution patterns, see <a href="design_33_clientstrategy.html">ClientStrategy</a>.</p>
<hr>
<a id="schema-structure-overview" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Schema Structure Overview<a href="#schema-structure-overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>IStrategySchema</code> interface defines the complete configuration for a trading strategy. When registered via <code>addStrategy()</code>, the schema is stored in <code>StrategySchemaService</code> and validated by <code>StrategyValidationService</code>.</p>
<p><img src="../media/25_Strategy_Schemas_0.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="core-required-fields" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Core Required Fields<a href="#core-required-fields" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="strategyname" class="tsd-anchor"></a><h3 class="tsd-anchor-link">strategyName<a href="#strategyname" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Type:</strong> <code>StrategyName</code> (string)</p>
<p>Unique identifier for the strategy. Used throughout the framework for:</p>
<ul>
<li>Schema storage and retrieval in <code>StrategySchemaService</code></li>
<li>Context propagation via <code>MethodContextService</code></li>
<li>Persistence file naming (e.g., <code>signal-{strategyName}-{symbol}.json</code>)</li>
<li>Risk position tracking (key format: <code>strategyName:symbol</code>)</li>
<li>Report generation and markdown output</li>
</ul>
<p>The strategy name must be unique across all registered strategies. Multiple calls to <code>addStrategy()</code> with the same <code>strategyName</code> will overwrite the previous registration.</p>
<hr>
<a id="interval" class="tsd-anchor"></a><h3 class="tsd-anchor-link">interval<a href="#interval" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Type:</strong> <code>SignalInterval</code> = <code>&quot;1m&quot; | &quot;3m&quot; | &quot;5m&quot; | &quot;15m&quot; | &quot;30m&quot; | &quot;1h&quot;</code></p>
<p>Minimum time interval between <code>getSignal()</code> invocations. Implements throttling to prevent signal spam and reduce computational overhead.</p>
<p>The framework enforces this interval using <code>_lastSignalTimestamp</code> tracking in <code>ClientStrategy</code>. When <code>tick()</code> is called, the framework checks elapsed time since last signal generation:</p>
<p><img src="../media/25_Strategy_Schemas_1.svg" alt="Mermaid Diagram"></p>
<p><strong>Interval Mappings (INTERVAL_MINUTES):</strong></p>
<table>
<thead>
<tr>
<th>Interval</th>
<th>Minutes</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>1m</code></td>
<td>1</td>
<td>High-frequency strategies, live monitoring</td>
</tr>
<tr>
<td><code>3m</code></td>
<td>3</td>
<td>Short-term scalping strategies</td>
</tr>
<tr>
<td><code>5m</code></td>
<td>5</td>
<td>Standard intraday strategies</td>
</tr>
<tr>
<td><code>15m</code></td>
<td>15</td>
<td>Medium-term swing strategies</td>
</tr>
<tr>
<td><code>30m</code></td>
<td>30</td>
<td>Longer-term position strategies</td>
</tr>
<tr>
<td><code>1h</code></td>
<td>60</td>
<td>Low-frequency strategies</td>
</tr>
</tbody>
</table>
<hr>
<a id="getsignal" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getSignal<a href="#getsignal" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Type:</strong> <code>(symbol: string) =&gt; Promise&lt;ISignalDto | null&gt;</code></p>
<p>Async function that generates trading signals. Called by <code>ClientStrategy.tick()</code> when:</p>
<ol>
<li>No active signal exists (idle state)</li>
<li>Interval throttling period has elapsed</li>
<li>Strategy has not been stopped via <code>stop()</code></li>
</ol>
<p><strong>Return Values:</strong></p>
<ul>
<li><code>ISignalDto</code> object: Creates new signal (opened or scheduled)</li>
<li><code>null</code>: No signal, remains in idle state</li>
</ul>
<p><strong>Function Signature:</strong></p>
<pre><code class="typescript"><span class="hl-4">async</span><span class="hl-1"> </span><span class="hl-0">getSignal</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">ISignalDto</span><span class="hl-1"> | </span><span class="hl-7">null</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">  </span><span class="hl-5">// Access to:</span><br/><span class="hl-1">  </span><span class="hl-5">// - symbol: trading pair (e.g., &quot;BTCUSDT&quot;)</span><br/><span class="hl-1">  </span><span class="hl-5">// - Implicit context via ExecutionContextService (when, backtest)</span><br/><span class="hl-1">  </span><span class="hl-5">// - Exchange functions: getCandles(), getAveragePrice(), etc.</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Return signal or null</span><br/><span class="hl-1">  return {</span><br/><span class="hl-1">    </span><span class="hl-10">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-10">priceOpen</span><span class="hl-1">: </span><span class="hl-6">50000</span><span class="hl-1">,        </span><span class="hl-5">// Optional: scheduled signal</span><br/><span class="hl-1">    </span><span class="hl-10">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-6">51000</span><span class="hl-1">,  </span><span class="hl-5">// Required</span><br/><span class="hl-1">    </span><span class="hl-10">priceStopLoss</span><span class="hl-1">: </span><span class="hl-6">49000</span><span class="hl-1">,    </span><span class="hl-5">// Required</span><br/><span class="hl-1">    </span><span class="hl-10">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-6">60</span><span class="hl-1">, </span><span class="hl-5">// Required</span><br/><span class="hl-1">    </span><span class="hl-10">note</span><span class="hl-1">: </span><span class="hl-2">&quot;MA crossover&quot;</span><span class="hl-1">,    </span><span class="hl-5">// Optional</span><br/><span class="hl-1">  };</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Context Availability:</strong></p>
<p>The <code>getSignal</code> function executes within <code>ExecutionContextService.runInContext()</code>, providing implicit access to:</p>
<ul>
<li>Current timestamp via <code>executionContext.when</code></li>
<li>Backtest flag via <code>executionContext.backtest</code></li>
<li>Exchange operations via <code>getCandles(symbol, interval, limit)</code></li>
<li>Price formatting via <code>formatPrice(symbol, price)</code></li>
</ul>
<hr>
<a id="signal-data-transfer-object" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Signal Data Transfer Object<a href="#signal-data-transfer-object" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>ISignalDto</code> interface defines the structure returned by <code>getSignal()</code>. It is validated by <code>VALIDATE_SIGNAL_FN</code> before conversion to <code>ISignalRow</code>.</p>
<a id="isignaldto-fields" class="tsd-anchor"></a><h3 class="tsd-anchor-link">ISignalDto Fields<a href="#isignaldto-fields" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/25_Strategy_Schemas_2.svg" alt="Mermaid Diagram"></p>
<p><strong>Field Details:</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>No</td>
<td>UUID v4, auto-generated if not provided</td>
</tr>
<tr>
<td><code>position</code></td>
<td><code>&quot;long&quot; | &quot;short&quot;</code></td>
<td>Yes</td>
<td>Trade direction</td>
</tr>
<tr>
<td><code>note</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Human-readable signal description</td>
</tr>
<tr>
<td><code>priceOpen</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Entry price. If provided, creates scheduled signal</td>
</tr>
<tr>
<td><code>priceTakeProfit</code></td>
<td><code>number</code></td>
<td>Yes</td>
<td>Exit price for profit target</td>
</tr>
<tr>
<td><code>priceStopLoss</code></td>
<td><code>number</code></td>
<td>Yes</td>
<td>Exit price for stop loss</td>
</tr>
<tr>
<td><code>minuteEstimatedTime</code></td>
<td><code>number</code></td>
<td>Yes</td>
<td>Expected signal lifetime in minutes</td>
</tr>
</tbody>
</table>
<p><strong>Scheduled vs Immediate Entry:</strong></p>
<ul>
<li><strong><code>priceOpen</code> provided:</strong> Signal enters <code>scheduled</code> state, waits for price activation</li>
<li><strong><code>priceOpen</code> omitted:</strong> Signal enters <code>opened</code> state immediately at current VWAP</li>
</ul>
<hr>
<a id="optional-configuration-fields" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Optional Configuration Fields<a href="#optional-configuration-fields" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="callbacks" class="tsd-anchor"></a><h3 class="tsd-anchor-link">callbacks<a href="#callbacks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Type:</strong> <code>Partial&lt;IStrategyCallbacks&gt;</code></p>
<p>Lifecycle event handlers called during signal state transitions. All callbacks are optional.</p>
<p><img src="../media/25_Strategy_Schemas_3.svg" alt="Mermaid Diagram"></p>
<p><strong>Callback Signatures:</strong></p>
<pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-11">IStrategyCallbacks</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">// Called on every tick with unified result</span><br/><span class="hl-1">  </span><span class="hl-0">onTick</span><span class="hl-1">: (</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">: </span><span class="hl-11">IStrategyTickResult</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">: </span><span class="hl-11">boolean</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-11">void</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Called when signal opens (immediate entry)</span><br/><span class="hl-1">  </span><span class="hl-0">onOpen</span><span class="hl-1">: (</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">: </span><span class="hl-11">ISignalRow</span><span class="hl-1">, </span><span class="hl-4">currentPrice</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">: </span><span class="hl-11">boolean</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-11">void</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Called when signal is monitoring TP/SL</span><br/><span class="hl-1">  </span><span class="hl-0">onActive</span><span class="hl-1">: (</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">: </span><span class="hl-11">ISignalRow</span><span class="hl-1">, </span><span class="hl-4">currentPrice</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">: </span><span class="hl-11">boolean</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-11">void</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Called when no active signal exists</span><br/><span class="hl-1">  </span><span class="hl-0">onIdle</span><span class="hl-1">: (</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">, </span><span class="hl-4">currentPrice</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">: </span><span class="hl-11">boolean</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-11">void</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Called when signal closes (TP/SL/time)</span><br/><span class="hl-1">  </span><span class="hl-0">onClose</span><span class="hl-1">: (</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">: </span><span class="hl-11">ISignalRow</span><span class="hl-1">, </span><span class="hl-4">priceClose</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">: </span><span class="hl-11">boolean</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-11">void</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Called when scheduled signal is created</span><br/><span class="hl-1">  </span><span class="hl-0">onSchedule</span><span class="hl-1">: (</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">: </span><span class="hl-11">IScheduledSignalRow</span><span class="hl-1">, </span><span class="hl-4">currentPrice</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">: </span><span class="hl-11">boolean</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-11">void</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Called when scheduled signal cancelled</span><br/><span class="hl-1">  </span><span class="hl-0">onCancel</span><span class="hl-1">: (</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">: </span><span class="hl-11">IScheduledSignalRow</span><span class="hl-1">, </span><span class="hl-4">currentPrice</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">: </span><span class="hl-11">boolean</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-11">void</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Execution Order:</strong></p>
<ol>
<li>State-specific callback (<code>onIdle</code>, <code>onOpen</code>, <code>onActive</code>, <code>onClose</code>, <code>onSchedule</code>, <code>onCancel</code>)</li>
<li>Universal <code>onTick</code> callback (receives discriminated union result)</li>
</ol>
<p><strong>Common Use Cases:</strong></p>
<ul>
<li><strong>Logging:</strong> Record signal events with timestamps and prices</li>
<li><strong>Notifications:</strong> Alert external systems on signal creation/closure</li>
<li><strong>Metrics:</strong> Track custom performance indicators</li>
<li><strong>Debugging:</strong> Inspect signal lifecycle during development</li>
<li><strong>Integration:</strong> Connect to external monitoring systems</li>
</ul>
<hr>
<a id="riskname" class="tsd-anchor"></a><h3 class="tsd-anchor-link">riskName<a href="#riskname" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Type:</strong> <code>RiskName</code> (string, optional)</p>
<p>Reference to a registered risk profile via <code>addRisk()</code>. When specified, the strategy's signals are validated against the risk profile's constraints before opening positions.</p>
<p><strong>Risk Integration Flow:</strong></p>
<p><img src="../media/25_Strategy_Schemas_4.svg" alt="Mermaid Diagram"></p>
<p><strong>Cross-Strategy Position Tracking:</strong></p>
<p>Multiple strategies sharing the same <code>riskName</code> share a single <code>ClientRisk</code> instance, enabling portfolio-level risk management:</p>
<ul>
<li>Concurrent position limits enforced across all strategies</li>
<li>Custom validations receive all active positions</li>
<li>Position tracking via <code>addSignal()</code> / <code>removeSignal()</code></li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-5">// Register risk profile</span><br/><span class="hl-0">addRisk</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">riskName:</span><span class="hl-1"> </span><span class="hl-2">&quot;conservative&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">validations:</span><span class="hl-1"> [</span><br/><span class="hl-1">    ({ </span><span class="hl-4">activePositionCount</span><span class="hl-1"> }) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">activePositionCount</span><span class="hl-1"> &gt;= </span><span class="hl-6">5</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">throw</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><span class="hl-2">&quot;Max 5 concurrent positions&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  ]</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Register strategy with risk profile</span><br/><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">riskName:</span><span class="hl-1"> </span><span class="hl-2">&quot;conservative&quot;</span><span class="hl-1">,  </span><span class="hl-5">// Links to risk profile</span><br/><span class="hl-1">  </span><span class="hl-5">// ... other fields</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>For detailed risk management configuration, see <a href="design_28_risk_schemas.html">Risk Schemas</a>.</p>
<hr>
<a id="note" class="tsd-anchor"></a><h3 class="tsd-anchor-link">note<a href="#note" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Type:</strong> <code>string</code> (optional)</p>
<p>Developer documentation string. Used for:</p>
<ul>
<li>In-code documentation</li>
<li>Report generation metadata</li>
<li>UI display in strategy selection interfaces</li>
</ul>
<p>Not used by framework logic, purely informational.</p>
<hr>
<a id="strategy-registration-process" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Strategy Registration Process<a href="#strategy-registration-process" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Strategies are registered via the <code>addStrategy()</code> function, which performs validation and storage in two services.</p>
<p><img src="../media/25_Strategy_Schemas_5.svg" alt="Mermaid Diagram"></p>
<p><strong>Registration Code Path:</strong></p>
<ol>
<li>User calls <code>addStrategy(schema)</code> <a href="">src/function/add.ts:50</a></li>
<li><code>LoggerService.info()</code> logs registration <a href="">src/function/add.ts:51-53</a></li>
<li><code>StrategyValidationService.addStrategy()</code> stores for validation <a href="">src/function/add.ts:54-57</a></li>
<li><code>StrategySchemaService.register()</code> stores in registry <a href="">src/function/add.ts:58-61</a></li>
</ol>
<p><strong>Connection Service Instantiation:</strong></p>
<p>When strategy is first used (during <code>Backtest.run()</code> or <code>Live.run()</code>):</p>
<ol>
<li><code>StrategyConnectionService.get(strategyName)</code> resolves schema</li>
<li>Creates <code>ClientStrategy</code> instance with injected dependencies:
<ul>
<li><code>IStrategySchema</code> (schema from registry)</li>
<li><code>LoggerService</code> (for debug output)</li>
<li><code>ExecutionContextService</code> (symbol, when, backtest)</li>
<li><code>TExchangeGlobalService</code> (exchange operations)</li>
<li><code>TRiskGlobalService</code> (risk checking, if <code>riskName</code> specified)</li>
</ul>
</li>
<li>Instance is memoized (one per strategy name)</li>
</ol>
<hr>
<a id="integration-with-framework-components" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Integration with Framework Components<a href="#integration-with-framework-components" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="relationship-with-exchange" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Relationship with Exchange<a href="#relationship-with-exchange" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/25_Strategy_Schemas_6.svg" alt="Mermaid Diagram"></p>
<p>The <code>getSignal</code> function has implicit access to exchange operations via context propagation. No explicit parameters needed.</p>
<hr>
<a id="relationship-with-risk-management" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Relationship with Risk Management<a href="#relationship-with-risk-management" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/25_Strategy_Schemas_7.svg" alt="Mermaid Diagram"></p>
<p><strong>Risk Check Flow:</strong></p>
<ol>
<li>Strategy returns <code>ISignalDto</code> from <code>getSignal()</code></li>
<li>If <code>riskName</code> specified, <code>ClientRisk.checkSignal()</code> invoked</li>
<li>Risk validations execute with access to:
<ul>
<li><code>activePositionCount</code>: Current open positions</li>
<li><code>activePositions</code>: Array of all active signals</li>
<li><code>params</code>: Signal details (symbol, price, timestamp)</li>
</ul>
</li>
<li>If validation passes, signal opens and <code>addSignal()</code> called</li>
<li>On signal close, <code>removeSignal()</code> called to update portfolio state</li>
</ol>
<hr>
<a id="complete-registration-example" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Complete Registration Example<a href="#complete-registration-example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addStrategy</span><span class="hl-1">, </span><span class="hl-4">getCandles</span><span class="hl-1">, </span><span class="hl-4">getAveragePrice</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">// Required: Unique identifier</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;sma-crossover&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Optional: Documentation</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Simple moving average crossover strategy with 20/50 period EMAs&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Required: Throttling interval</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Required: Signal generation logic</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// Fetch historical data</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">candles</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getCandles</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-2">&quot;1h&quot;</span><span class="hl-1">, </span><span class="hl-6">100</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-5">// Calculate indicators</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">sma20</span><span class="hl-1"> = </span><span class="hl-0">calculateSMA</span><span class="hl-1">(</span><span class="hl-4">candles</span><span class="hl-1">, </span><span class="hl-6">20</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">sma50</span><span class="hl-1"> = </span><span class="hl-0">calculateSMA</span><span class="hl-1">(</span><span class="hl-4">candles</span><span class="hl-1">, </span><span class="hl-6">50</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-5">// Generate signal based on crossover</span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">sma20</span><span class="hl-1"> &gt; </span><span class="hl-4">sma50</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">currentPrice</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getAveragePrice</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><br/><span class="hl-1">      </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">position:</span><span class="hl-1"> </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">priceTakeProfit:</span><span class="hl-1"> </span><span class="hl-4">currentPrice</span><span class="hl-1"> * </span><span class="hl-6">1.02</span><span class="hl-1">,  </span><span class="hl-5">// 2% profit target</span><br/><span class="hl-1">        </span><span class="hl-4">priceStopLoss:</span><span class="hl-1"> </span><span class="hl-4">currentPrice</span><span class="hl-1"> * </span><span class="hl-6">0.98</span><span class="hl-1">,    </span><span class="hl-5">// 2% stop loss</span><br/><span class="hl-1">        </span><span class="hl-4">minuteEstimatedTime:</span><span class="hl-1"> </span><span class="hl-6">240</span><span class="hl-1">,              </span><span class="hl-5">// 4 hours</span><br/><span class="hl-1">        </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;SMA20 crossed above SMA50&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      };</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-5">// No signal</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-7">null</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Optional: Lifecycle callbacks</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onOpen</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[OPEN] </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2"> @ </span><span class="hl-7">${</span><span class="hl-4">price</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-0">onClose</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[CLOSE] </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2"> @ </span><span class="hl-7">${</span><span class="hl-4">price</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-0">onTick</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`PnL: </span><span class="hl-7">${</span><span class="hl-4">result</span><span class="hl-9">.</span><span class="hl-4">pnl</span><span class="hl-9">.</span><span class="hl-4">pnlPercentage</span><span class="hl-7">}</span><span class="hl-2">%`</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Optional: Link to risk profile</span><br/><span class="hl-1">  </span><span class="hl-4">riskName:</span><span class="hl-1"> </span><span class="hl-2">&quot;conservative&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="related-interfaces-reference" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Related Interfaces Reference<a href="#related-interfaces-reference" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="strategyname-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">StrategyName<a href="#strategyname-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Type alias: <code>string</code></p>
<p>Unique identifier for strategy schemas. Used as registry key in <code>StrategySchemaService</code>.</p>
<hr>
<a id="signalinterval" class="tsd-anchor"></a><h3 class="tsd-anchor-link">SignalInterval<a href="#signalinterval" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Type: <code>&quot;1m&quot; | &quot;3m&quot; | &quot;5m&quot; | &quot;15m&quot; | &quot;30m&quot; | &quot;1h&quot;</code></p>
<p>Throttling intervals for signal generation. Enforced by <code>ClientStrategy._lastSignalTimestamp</code> tracking.</p>
<hr>
<a id="isignalrow" class="tsd-anchor"></a><h3 class="tsd-anchor-link">ISignalRow<a href="#isignalrow" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Extended version of <code>ISignalDto</code> with auto-generated fields:</p>
<ul>
<li><code>id</code>: UUID v4 (always present)</li>
<li><code>exchangeName</code>: From context</li>
<li><code>strategyName</code>: From context</li>
<li><code>scheduledAt</code>: Creation timestamp</li>
<li><code>pendingAt</code>: Activation timestamp</li>
<li><code>symbol</code>: Trading pair</li>
<li><code>_isScheduled</code>: Internal runtime flag</li>
</ul>
<p>Used internally by <code>ClientStrategy</code> and emitted in callbacks.</p>
<hr>
<a id="istrategytickresult" class="tsd-anchor"></a><h3 class="tsd-anchor-link">IStrategyTickResult<a href="#istrategytickresult" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Discriminated union of tick results:</p>
<ul>
<li><code>IStrategyTickResultIdle</code>: No signal, idle state</li>
<li><code>IStrategyTickResultScheduled</code>: Scheduled signal created</li>
<li><code>IStrategyTickResultOpened</code>: New signal opened</li>
<li><code>IStrategyTickResultActive</code>: Signal monitoring TP/SL</li>
<li><code>IStrategyTickResultClosed</code>: Signal closed with PnL</li>
<li><code>IStrategyTickResultCancelled</code>: Scheduled signal cancelled</li>
</ul>
<p>Use discriminant <code>result.action</code> for type-safe handling.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#strategy-schemas"><span>Strategy <wbr/>Schemas</span></a><ul><li><a href="#purpose-and-scope"><span>Purpose and <wbr/>Scope</span></a></li><li><a href="#schema-structure-overview"><span>Schema <wbr/>Structure <wbr/>Overview</span></a></li><li><a href="#core-required-fields"><span>Core <wbr/>Required <wbr/>Fields</span></a></li><li><ul><li><a href="#strategyname"><span>strategy<wbr/>Name</span></a></li><li><a href="#interval"><span>interval</span></a></li><li><a href="#getsignal"><span>get<wbr/>Signal</span></a></li></ul></li><li><a href="#signal-data-transfer-object"><span>Signal <wbr/>Data <wbr/>Transfer <wbr/>Object</span></a></li><li><ul><li><a href="#isignaldto-fields"><span>ISignal<wbr/>Dto <wbr/>Fields</span></a></li></ul></li><li><a href="#optional-configuration-fields"><span>Optional <wbr/>Configuration <wbr/>Fields</span></a></li><li><ul><li><a href="#callbacks"><span>callbacks</span></a></li><li><a href="#riskname"><span>risk<wbr/>Name</span></a></li><li><a href="#note"><span>note</span></a></li></ul></li><li><a href="#strategy-registration-process"><span>Strategy <wbr/>Registration <wbr/>Process</span></a></li><li><a href="#integration-with-framework-components"><span>Integration with <wbr/>Framework <wbr/>Components</span></a></li><li><ul><li><a href="#relationship-with-exchange"><span>Relationship with <wbr/>Exchange</span></a></li><li><a href="#relationship-with-risk-management"><span>Relationship with <wbr/>Risk <wbr/>Management</span></a></li></ul></li><li><a href="#complete-registration-example"><span>Complete <wbr/>Registration <wbr/>Example</span></a></li><li><a href="#related-interfaces-reference"><span>Related <wbr/>Interfaces <wbr/>Reference</span></a></li><li><ul><li><a href="#strategyname-1"><span>Strategy<wbr/>Name</span></a></li><li><a href="#signalinterval"><span>Signal<wbr/>Interval</span></a></li><li><a href="#isignalrow"><span>ISignal<wbr/>Row</span></a></li><li><a href="#istrategytickresult"><span>IStrategy<wbr/>Tick<wbr/>Result</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
