<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/73_validation_parameters | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_73_validation_parameters.html">design/73_validation_parameters</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="validation-parameters" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Validation Parameters<a href="#validation-parameters" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>This document describes the global validation parameters that control financial safety constraints in signal generation. These parameters enforce minimum take profit distances, maximum stop loss distances, and signal lifetime limits to protect capital from unprofitable trades, catastrophic losses, and strategy deadlock.</p>
<p>For information about other configuration parameters like timeout and timing constraints, see <a href="design_74_timing_parameters.html">Timing Parameters</a>. For an overview of the configuration system, see <a href="design_72_global_configuration.html">Global Configuration</a>. For details on how signals are validated during generation, see <a href="design_46_signal_generation_and_validation.html">Signal Generation and Validation</a>.</p>
<hr>
<a id="overview-of-validation-parameters" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Overview of Validation Parameters<a href="#overview-of-validation-parameters" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The framework enforces three critical validation parameters that act as financial guardrails during signal generation. These parameters are part of <code>GLOBAL_CONFIG</code> and can be modified via <code>setConfig()</code> at runtime.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</code></td>
<td>number</td>
<td>0.1</td>
<td>Minimum percentage distance between <code>priceOpen</code> and <code>priceTakeProfit</code> to ensure profit exceeds trading fees</td>
</tr>
<tr>
<td><code>CC_MAX_STOPLOSS_DISTANCE_PERCENT</code></td>
<td>number</td>
<td>20</td>
<td>Maximum percentage distance between <code>priceOpen</code> and <code>priceStopLoss</code> to prevent catastrophic losses</td>
</tr>
<tr>
<td><code>CC_MAX_SIGNAL_LIFETIME_MINUTES</code></td>
<td>number</td>
<td>1440</td>
<td>Maximum signal duration in minutes to prevent eternal signals blocking risk limits</td>
</tr>
</tbody>
</table>
<p>These validations occur in the <code>VALIDATE_SIGNAL_FN</code> function within <code>ClientStrategy</code>, which is called before every signal is created. Signals that fail validation are rejected immediately with descriptive error messages.</p>
<hr>
<a id="take-profit-distance-validation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Take Profit Distance Validation<a href="#take-profit-distance-validation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="problem-statement" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Problem Statement<a href="#problem-statement" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Trading fees (typically 0.1% per side) create a minimum profit threshold. If <code>priceTakeProfit</code> is too close to <code>priceOpen</code>, the gross profit will be consumed by fees, resulting in a net loss despite hitting the take profit target.</p>
<p><strong>Example Scenario:</strong></p>
<ul>
<li>Long position: <code>priceOpen = 42000</code>, <code>priceTakeProfit = 42010</code> (0.024% profit)</li>
<li>Fees: 2 × 0.1% = 0.2% total</li>
<li>Net PNL: 0.024% - 0.2% = <strong>-0.176% loss</strong></li>
</ul>
<a id="validation-logic" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Validation Logic<a href="#validation-logic" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/73_Validation_Parameters_0.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Take Profit Distance Validation Flow</strong></p>
<p>The validation calculates the percentage distance between entry price and take profit target, then compares it against <code>CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</code>. For long positions, TP must be above entry. For short positions, TP must be below entry.</p>
<p><strong>Long Position Validation</strong> (lines 87-97):</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">tpDistancePercent</span><span class="hl-1"> = ((</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceTakeProfit</span><span class="hl-1"> - </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">) / </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">) * </span><span class="hl-8">100</span><span class="hl-1">;</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">tpDistancePercent</span><span class="hl-1"> &lt; </span><span class="hl-7">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-7">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-2">`Long: TakeProfit too close to priceOpen...`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Short Position Validation</strong> (lines 127-137):</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">tpDistancePercent</span><span class="hl-1"> = ((</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1"> - </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceTakeProfit</span><span class="hl-1">) / </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">) * </span><span class="hl-8">100</span><span class="hl-1">;</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">tpDistancePercent</span><span class="hl-1"> &lt; </span><span class="hl-7">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-7">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-2">`Short: TakeProfit too close to priceOpen...`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="default-value-justification" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Default Value Justification<a href="#default-value-justification" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The default value of <code>0.1%</code> is intentionally conservative:</p>
<ul>
<li>Covers standard exchange fees: 2 × 0.1% = 0.2% total</li>
<li>Provides small profit margin after fees</li>
<li>Can be increased to enforce larger minimum profits</li>
<li>Can be set to <code>0</code> to disable validation (not recommended for production)</li>
</ul>
<hr>
<a id="stop-loss-distance-validation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Stop Loss Distance Validation<a href="#stop-loss-distance-validation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="problem-statement-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Problem Statement<a href="#problem-statement-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Excessively wide stop losses can expose the portfolio to catastrophic single-trade losses. A stop loss positioned 50% below entry would lose half the position size in one trade, potentially destroying the strategy's expected value.</p>
<p><strong>Example Scenario:</strong></p>
<ul>
<li>Long position: <code>priceOpen = 42000</code>, <code>priceStopLoss = 20000</code> (52.4% loss)</li>
<li>With 10% position sizing: -5.24% portfolio loss on one signal</li>
<li>After 4 consecutive stop loss hits: portfolio down -20%</li>
</ul>
<a id="validation-logic-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Validation Logic<a href="#validation-logic-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/73_Validation_Parameters_1.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Stop Loss Distance Validation Flow</strong></p>
<p>The validation calculates the percentage distance between entry price and stop loss target, then compares it against <code>CC_MAX_STOPLOSS_DISTANCE_PERCENT</code>. For long positions, SL must be below entry. For short positions, SL must be above entry.</p>
<p><strong>Long Position Validation</strong> (lines 100-110):</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">slDistancePercent</span><span class="hl-1"> = ((</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1"> - </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceStopLoss</span><span class="hl-1">) / </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">) * </span><span class="hl-8">100</span><span class="hl-1">;</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">slDistancePercent</span><span class="hl-1"> &gt; </span><span class="hl-7">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-7">CC_MAX_STOPLOSS_DISTANCE_PERCENT</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-2">`Long: StopLoss too far from priceOpen...`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Short Position Validation</strong> (lines 140-150):</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">slDistancePercent</span><span class="hl-1"> = ((</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceStopLoss</span><span class="hl-1"> - </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">) / </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">) * </span><span class="hl-8">100</span><span class="hl-1">;</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">slDistancePercent</span><span class="hl-1"> &gt; </span><span class="hl-7">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-7">CC_MAX_STOPLOSS_DISTANCE_PERCENT</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-2">`Short: StopLoss too far from priceOpen...`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="default-value-justification-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Default Value Justification<a href="#default-value-justification-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The default value of <code>20%</code> represents a reasonable maximum loss per signal:</p>
<ul>
<li>Prevents single-trade portfolio destruction</li>
<li>Allows flexibility for volatile markets</li>
<li>Enforces risk discipline at the signal level</li>
<li>Can be tightened to <code>5-10%</code> for conservative strategies</li>
<li>Should not be disabled (set to <code>100+%</code>) in production</li>
</ul>
<hr>
<a id="signal-lifetime-validation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Signal Lifetime Validation<a href="#signal-lifetime-validation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="problem-statement-2" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Problem Statement<a href="#problem-statement-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Signals with excessively long <code>minuteEstimatedTime</code> can create strategy deadlock by occupying risk limits indefinitely. If a signal expects to remain active for 30+ days, it blocks new signals from being generated, effectively freezing the strategy.</p>
<p><strong>Example Scenario:</strong></p>
<ul>
<li>Signal with <code>minuteEstimatedTime = 50000</code> minutes (34.7 days)</li>
<li>Risk profile allows <code>maxConcurrentPositions = 3</code></li>
<li>After 3 such signals open: strategy cannot generate new signals for weeks</li>
<li>Strategy becomes non-responsive to market changes</li>
</ul>
<a id="validation-logic-2" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Validation Logic<a href="#validation-logic-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/73_Validation_Parameters_2.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Signal Lifetime Validation Flow</strong></p>
<p>The validation compares <code>minuteEstimatedTime</code> directly against <code>CC_MAX_SIGNAL_LIFETIME_MINUTES</code>. Error messages include human-readable day conversions for clarity.</p>
<p><strong>Validation Implementation</strong> (lines 161-171):</p>
<pre><code class="typescript"><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">minuteEstimatedTime</span><span class="hl-1"> &gt; </span><span class="hl-7">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-7">CC_MAX_SIGNAL_LIFETIME_MINUTES</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">days</span><span class="hl-1"> = (</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">minuteEstimatedTime</span><span class="hl-1"> / </span><span class="hl-8">60</span><span class="hl-1"> / </span><span class="hl-8">24</span><span class="hl-1">).</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">maxDays</span><span class="hl-1"> = (</span><span class="hl-7">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-7">CC_MAX_SIGNAL_LIFETIME_MINUTES</span><span class="hl-1"> / </span><span class="hl-8">60</span><span class="hl-1"> / </span><span class="hl-8">24</span><span class="hl-1">).</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-2">`minuteEstimatedTime too large (</span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">minuteEstimatedTime</span><span class="hl-6">}</span><span class="hl-2"> minutes = </span><span class="hl-6">${</span><span class="hl-4">days</span><span class="hl-6">}</span><span class="hl-2"> days). `</span><span class="hl-1"> +</span><br/><span class="hl-1">    </span><span class="hl-2">`Maximum: </span><span class="hl-6">${</span><span class="hl-7">GLOBAL_CONFIG</span><span class="hl-9">.</span><span class="hl-7">CC_MAX_SIGNAL_LIFETIME_MINUTES</span><span class="hl-6">}</span><span class="hl-2"> minutes (</span><span class="hl-6">${</span><span class="hl-4">maxDays</span><span class="hl-6">}</span><span class="hl-2"> days) to prevent strategy deadlock. `</span><span class="hl-1"> +</span><br/><span class="hl-1">    </span><span class="hl-2">`Eternal signals block risk limits and prevent new trades.`</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="default-value-justification-2" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Default Value Justification<a href="#default-value-justification-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The default value of <code>1440 minutes</code> (1 day):</p>
<ul>
<li>Balances flexibility with risk management</li>
<li>Prevents week-long signals from blocking strategy execution</li>
<li>Aligns with typical intraday/swing trading timeframes</li>
<li>Can be increased for longer-term strategies (e.g., 10080 minutes = 1 week)</li>
<li>Should not be disabled (set to <code>999999</code>) in production</li>
</ul>
<hr>
<a id="complete-validation-flow" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Complete Validation Flow<a href="#complete-validation-flow" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The following diagram shows how validation parameters integrate into the signal generation pipeline:</p>
<p><img src="../media/73_Validation_Parameters_3.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Complete Signal Validation Flow with Validation Parameters</strong></p>
<p>The validation occurs in <code>VALIDATE_SIGNAL_FN</code> at <a href="">src/client/ClientStrategy.ts:40-185</a>. The function accumulates all validation errors into an array, then throws a single descriptive error if any validations fail. This provides comprehensive feedback to strategy developers.</p>
<p><strong>Key Validation Stages:</strong></p>
<ol>
<li><strong>Price Sanity Checks</strong> (lines 43-71): Validates that all prices are finite, positive numbers</li>
<li><strong>Position Logic Checks</strong> (lines 74-151): Ensures TP/SL are on correct side of entry for long/short</li>
<li><strong>TP Distance Validation</strong> (lines 87-97, 127-137): Uses <code>CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</code></li>
<li><strong>SL Distance Validation</strong> (lines 100-110, 140-150): Uses <code>CC_MAX_STOPLOSS_DISTANCE_PERCENT</code></li>
<li><strong>Lifetime Validation</strong> (lines 161-171): Uses <code>CC_MAX_SIGNAL_LIFETIME_MINUTES</code></li>
<li><strong>Error Aggregation</strong> (lines 180-184): Throws single error with all validation failures</li>
</ol>
<hr>
<a id="configuration-via-setconfig" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Configuration via setConfig<a href="#configuration-via-setconfig" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Validation parameters can be modified at runtime using the <code>setConfig()</code> function. This is typically done during initialization or in test environments.</p>
<a id="configuration-syntax" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Configuration Syntax<a href="#configuration-syntax" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">setConfig</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">setConfig</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-8">0.5</span><span class="hl-1">,  </span><span class="hl-5">// Require 0.5% minimum profit</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MAX_STOPLOSS_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-8">10</span><span class="hl-1">,     </span><span class="hl-5">// Allow max 10% stop loss</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MAX_SIGNAL_LIFETIME_MINUTES:</span><span class="hl-1"> </span><span class="hl-8">720</span><span class="hl-1">,       </span><span class="hl-5">// Max 12 hours per signal</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="configuration-patterns" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Configuration Patterns<a href="#configuration-patterns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Use Case</th>
<th>Configuration</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Disable Validation (Testing)</strong></td>
<td>Set to <code>0</code>, <code>100</code>, <code>999999</code> respectively</td>
<td>Allows testing edge cases without validation constraints</td>
</tr>
<tr>
<td><strong>Conservative Trading</strong></td>
<td>Set to <code>0.5%</code>, <code>5%</code>, <code>360 min</code></td>
<td>Tighter constraints for risk-averse strategies</td>
</tr>
<tr>
<td><strong>Volatile Markets</strong></td>
<td>Set to <code>0.2%</code>, <code>30%</code>, <code>2880 min</code></td>
<td>Looser constraints for high-volatility assets</td>
</tr>
<tr>
<td><strong>Long-term Holding</strong></td>
<td>Set to <code>1%</code>, <code>20%</code>, <code>10080 min</code></td>
<td>Allow multi-day positions with wider stops</td>
</tr>
</tbody>
</table>
<a id="test-environment-configuration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Test Environment Configuration<a href="#test-environment-configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Test files disable validation by default to isolate signal logic testing from validation constraints:</p>
<pre><code class="typescript"><span class="hl-5">// test/config/setup.mjs</span><br/><span class="hl-0">setConfig</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">,      </span><span class="hl-5">// No TP distance check</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MAX_STOPLOSS_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-8">100</span><span class="hl-1">,      </span><span class="hl-5">// Allow any SL</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MAX_SIGNAL_LIFETIME_MINUTES:</span><span class="hl-1"> </span><span class="hl-8">999999</span><span class="hl-1">,     </span><span class="hl-5">// No lifetime limit</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>Specific validation tests override these defaults:</p>
<pre><code class="typescript"><span class="hl-5">// test/e2e/sanitize.test.mjs</span><br/><span class="hl-0">test</span><span class="hl-1">(</span><span class="hl-2">&quot;Micro-profit validation&quot;</span><span class="hl-1">, </span><span class="hl-6">async</span><span class="hl-1"> () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">setConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-8">0.3</span><span class="hl-1">,  </span><span class="hl-5">// Enable TP validation</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><span class="hl-5">// ... test code</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="validation-error-messages" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Validation Error Messages<a href="#validation-error-messages" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Validation failures produce detailed error messages that help strategy developers diagnose issues:</p>
<a id="take-profit-error-message-format" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Take Profit Error Message Format<a href="#take-profit-error-message-format" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code><span class="hl-11">Long</span><span class="hl-1">: </span><span class="hl-4">TakeProfit</span><span class="hl-1"> </span><span class="hl-4">too</span><span class="hl-1"> </span><span class="hl-4">close</span><span class="hl-1"> </span><span class="hl-4">to</span><span class="hl-1"> </span><span class="hl-0">priceOpen</span><span class="hl-1"> (</span><span class="hl-8">0.024</span><span class="hl-1">%). </span><br/><span class="hl-4">Minimum</span><span class="hl-1"> </span><span class="hl-11">distance</span><span class="hl-1">: </span><span class="hl-8">0.3</span><span class="hl-1">% </span><span class="hl-4">to</span><span class="hl-1"> </span><span class="hl-4">cover</span><span class="hl-1"> </span><span class="hl-4">trading</span><span class="hl-1"> </span><span class="hl-4">fees</span><span class="hl-1">. </span><br/><span class="hl-11">Current</span><span class="hl-1">: </span><span class="hl-7">TP</span><span class="hl-1">=</span><span class="hl-8">42010</span><span class="hl-1">, </span><span class="hl-4">Open</span><span class="hl-1">=</span><span class="hl-8">42000</span>
</code><button>Copy</button></pre>

<a id="stop-loss-error-message-format" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Stop Loss Error Message Format<a href="#stop-loss-error-message-format" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code><span class="hl-11">Long</span><span class="hl-1">: </span><span class="hl-4">StopLoss</span><span class="hl-1"> </span><span class="hl-4">too</span><span class="hl-1"> </span><span class="hl-4">far</span><span class="hl-1"> </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-0">priceOpen</span><span class="hl-1"> (</span><span class="hl-8">52.381</span><span class="hl-1">%). </span><br/><span class="hl-4">Maximum</span><span class="hl-1"> </span><span class="hl-11">distance</span><span class="hl-1">: </span><span class="hl-8">20</span><span class="hl-1">% </span><span class="hl-4">to</span><span class="hl-1"> </span><span class="hl-4">protect</span><span class="hl-1"> </span><span class="hl-4">capital</span><span class="hl-1">. </span><br/><span class="hl-11">Current</span><span class="hl-1">: </span><span class="hl-7">SL</span><span class="hl-1">=</span><span class="hl-8">20000</span><span class="hl-1">, </span><span class="hl-4">Open</span><span class="hl-1">=</span><span class="hl-8">42000</span>
</code><button>Copy</button></pre>

<a id="signal-lifetime-error-message-format" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Signal Lifetime Error Message Format<a href="#signal-lifetime-error-message-format" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code><span class="hl-4">minuteEstimatedTime</span><span class="hl-1"> </span><span class="hl-4">too</span><span class="hl-1"> </span><span class="hl-0">large</span><span class="hl-1"> (</span><span class="hl-8">50000</span><span class="hl-1"> </span><span class="hl-4">minutes</span><span class="hl-1"> = </span><span class="hl-8">34.7</span><span class="hl-1"> </span><span class="hl-4">days</span><span class="hl-1">). </span><br/><span class="hl-11">Maximum</span><span class="hl-1">: </span><span class="hl-8">1440</span><span class="hl-1"> </span><span class="hl-0">minutes</span><span class="hl-1"> (</span><span class="hl-8">1</span><span class="hl-1"> </span><span class="hl-4">days</span><span class="hl-1">) </span><span class="hl-4">to</span><span class="hl-1"> </span><span class="hl-4">prevent</span><span class="hl-1"> </span><span class="hl-4">strategy</span><span class="hl-1"> </span><span class="hl-4">deadlock</span><span class="hl-1">. </span><br/><span class="hl-4">Eternal</span><span class="hl-1"> </span><span class="hl-4">signals</span><span class="hl-1"> </span><span class="hl-4">block</span><span class="hl-1"> </span><span class="hl-4">risk</span><span class="hl-1"> </span><span class="hl-4">limits</span><span class="hl-1"> </span><span class="hl-4">and</span><span class="hl-1"> </span><span class="hl-4">prevent</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-4">trades</span><span class="hl-1">.</span>
</code><button>Copy</button></pre>

<a id="error-aggregation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Error Aggregation<a href="#error-aggregation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Multiple validation failures are combined into a single error message:</p>
<pre><code><span class="hl-4">Invalid</span><span class="hl-1"> </span><span class="hl-4">signal</span><span class="hl-1"> </span><span class="hl-4">for</span><span class="hl-1"> </span><span class="hl-4">long</span><span class="hl-1"> </span><span class="hl-11">position</span><span class="hl-1">:</span><br/><span class="hl-11">Long</span><span class="hl-1">: </span><span class="hl-4">TakeProfit</span><span class="hl-1"> </span><span class="hl-4">too</span><span class="hl-1"> </span><span class="hl-4">close</span><span class="hl-1"> </span><span class="hl-4">to</span><span class="hl-1"> </span><span class="hl-0">priceOpen</span><span class="hl-1"> (</span><span class="hl-8">0.024</span><span class="hl-1">%). </span><span class="hl-4">Minimum</span><span class="hl-1"> </span><span class="hl-11">distance</span><span class="hl-1">: </span><span class="hl-8">0.3</span><span class="hl-1">% </span><span class="hl-4">to</span><span class="hl-1"> </span><span class="hl-4">cover</span><span class="hl-1"> </span><span class="hl-4">trading</span><span class="hl-1"> </span><span class="hl-4">fees</span><span class="hl-1">. </span><span class="hl-4">Current</span><span class="hl-1">: </span><span class="hl-7">TP</span><span class="hl-1">=</span><span class="hl-8">42010</span><span class="hl-1">, </span><span class="hl-4">Open</span><span class="hl-1">=</span><span class="hl-8">42000</span><br/><span class="hl-11">Long</span><span class="hl-1">: </span><span class="hl-4">StopLoss</span><span class="hl-1"> </span><span class="hl-4">too</span><span class="hl-1"> </span><span class="hl-4">far</span><span class="hl-1"> </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-0">priceOpen</span><span class="hl-1"> (</span><span class="hl-8">52.381</span><span class="hl-1">%). </span><span class="hl-4">Maximum</span><span class="hl-1"> </span><span class="hl-11">distance</span><span class="hl-1">: </span><span class="hl-8">20</span><span class="hl-1">% </span><span class="hl-4">to</span><span class="hl-1"> </span><span class="hl-4">protect</span><span class="hl-1"> </span><span class="hl-4">capital</span><span class="hl-1">. </span><span class="hl-4">Current</span><span class="hl-1">: </span><span class="hl-7">SL</span><span class="hl-1">=</span><span class="hl-8">20000</span><span class="hl-1">, </span><span class="hl-4">Open</span><span class="hl-1">=</span><span class="hl-8">42000</span><br/><span class="hl-4">minuteEstimatedTime</span><span class="hl-1"> </span><span class="hl-4">too</span><span class="hl-1"> </span><span class="hl-0">large</span><span class="hl-1"> (</span><span class="hl-8">50000</span><span class="hl-1"> </span><span class="hl-4">minutes</span><span class="hl-1"> = </span><span class="hl-8">34.7</span><span class="hl-1"> </span><span class="hl-4">days</span><span class="hl-1">). </span><span class="hl-4">Maximum</span><span class="hl-1">: </span><span class="hl-8">1440</span><span class="hl-1"> </span><span class="hl-0">minutes</span><span class="hl-1"> (</span><span class="hl-8">1</span><span class="hl-1"> </span><span class="hl-4">days</span><span class="hl-1">) </span><span class="hl-4">to</span><span class="hl-1"> </span><span class="hl-4">prevent</span><span class="hl-1"> </span><span class="hl-4">strategy</span><span class="hl-1"> </span><span class="hl-4">deadlock</span><span class="hl-1">. </span><span class="hl-4">Eternal</span><span class="hl-1"> </span><span class="hl-4">signals</span><span class="hl-1"> </span><span class="hl-4">block</span><span class="hl-1"> </span><span class="hl-4">risk</span><span class="hl-1"> </span><span class="hl-4">limits</span><span class="hl-1"> </span><span class="hl-4">and</span><span class="hl-1"> </span><span class="hl-4">prevent</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-4">trades</span><span class="hl-1">.</span>
</code><button>Copy</button></pre>

<p>This comprehensive error output allows developers to fix all validation issues in a single iteration.</p>
<hr>
<a id="default-values-and-trade-offs" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Default Values and Trade-offs<a href="#default-values-and-trade-offs" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The table below summarizes default values, their safety guarantees, and when to adjust them:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Safety Guarantee</th>
<th>When to Increase</th>
<th>When to Decrease</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</code></td>
<td>0.1%</td>
<td>Prevents fee-eating micro-profits</td>
<td>Higher fee exchanges (0.2%+)</td>
<td>Lower fee exchanges or maker rebates</td>
</tr>
<tr>
<td><code>CC_MAX_STOPLOSS_DISTANCE_PERCENT</code></td>
<td>20%</td>
<td>Prevents catastrophic single-trade losses</td>
<td>High-volatility assets (crypto, meme coins)</td>
<td>Stable assets, conservative risk appetite</td>
</tr>
<tr>
<td><code>CC_MAX_SIGNAL_LIFETIME_MINUTES</code></td>
<td>1440 (1 day)</td>
<td>Prevents strategy deadlock from eternal signals</td>
<td>Swing trading (1 week), position trading (1 month)</td>
<td>Intraday strategies (2-4 hours)</td>
</tr>
</tbody>
</table>
<a id="interaction-with-risk-management" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Interaction with Risk Management<a href="#interaction-with-risk-management" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>These validation parameters work in conjunction with risk profile limits (see <a href="design_64_risk_profiles.html">Risk Profiles</a>):</p>
<p><img src="../media/73_Validation_Parameters_4.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Validation Parameters as First Line of Defense</strong></p>
<p>Validation parameters act as the first line of defense, rejecting signals before they reach the risk management layer. This prevents invalid signals from consuming risk limit slots or triggering custom validations.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#validation-parameters"><span>Validation <wbr/>Parameters</span></a><ul><li><a href="#overview-of-validation-parameters"><span>Overview of <wbr/>Validation <wbr/>Parameters</span></a></li><li><a href="#take-profit-distance-validation"><span>Take <wbr/>Profit <wbr/>Distance <wbr/>Validation</span></a></li><li><ul><li><a href="#problem-statement"><span>Problem <wbr/>Statement</span></a></li><li><a href="#validation-logic"><span>Validation <wbr/>Logic</span></a></li><li><a href="#default-value-justification"><span>Default <wbr/>Value <wbr/>Justification</span></a></li></ul></li><li><a href="#stop-loss-distance-validation"><span>Stop <wbr/>Loss <wbr/>Distance <wbr/>Validation</span></a></li><li><ul><li><a href="#problem-statement-1"><span>Problem <wbr/>Statement</span></a></li><li><a href="#validation-logic-1"><span>Validation <wbr/>Logic</span></a></li><li><a href="#default-value-justification-1"><span>Default <wbr/>Value <wbr/>Justification</span></a></li></ul></li><li><a href="#signal-lifetime-validation"><span>Signal <wbr/>Lifetime <wbr/>Validation</span></a></li><li><ul><li><a href="#problem-statement-2"><span>Problem <wbr/>Statement</span></a></li><li><a href="#validation-logic-2"><span>Validation <wbr/>Logic</span></a></li><li><a href="#default-value-justification-2"><span>Default <wbr/>Value <wbr/>Justification</span></a></li></ul></li><li><a href="#complete-validation-flow"><span>Complete <wbr/>Validation <wbr/>Flow</span></a></li><li><a href="#configuration-via-setconfig"><span>Configuration via set<wbr/>Config</span></a></li><li><ul><li><a href="#configuration-syntax"><span>Configuration <wbr/>Syntax</span></a></li><li><a href="#configuration-patterns"><span>Configuration <wbr/>Patterns</span></a></li><li><a href="#test-environment-configuration"><span>Test <wbr/>Environment <wbr/>Configuration</span></a></li></ul></li><li><a href="#validation-error-messages"><span>Validation <wbr/>Error <wbr/>Messages</span></a></li><li><ul><li><a href="#take-profit-error-message-format"><span>Take <wbr/>Profit <wbr/>Error <wbr/>Message <wbr/>Format</span></a></li><li><a href="#stop-loss-error-message-format"><span>Stop <wbr/>Loss <wbr/>Error <wbr/>Message <wbr/>Format</span></a></li><li><a href="#signal-lifetime-error-message-format"><span>Signal <wbr/>Lifetime <wbr/>Error <wbr/>Message <wbr/>Format</span></a></li><li><a href="#error-aggregation"><span>Error <wbr/>Aggregation</span></a></li></ul></li><li><a href="#default-values-and-trade-offs"><span>Default <wbr/>Values and <wbr/>Trade-<wbr/>offs</span></a></li><li><ul><li><a href="#interaction-with-risk-management"><span>Interaction with <wbr/>Risk <wbr/>Management</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
