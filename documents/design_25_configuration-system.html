<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/25_configuration-system | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_25_configuration-system.html">design/25_configuration-system</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="configuration-system" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Configuration System<a href="#configuration-system" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>The Configuration System provides centralized management of global parameters that control framework behavior, economic constraints, and safety limits. It enforces economic viability validation to prevent unprofitable trading configurations and provides runtime configuration updates with automatic rollback on validation failure.</p>
<p>For strategy-specific configuration, see <a href="design_12_defining-strategies.html">Defining Strategies</a>. For risk management configuration, see <a href="design_14_risk-management.html">Risk Management</a>. For exchange and frame configuration, see <a href="design_22_exchange-configuration.html">Exchange Configuration</a> and <a href="design_24_timeframes-and-frames.html">Timeframes and Frames</a>.</p>
<hr>
<a id="architecture-overview" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Architecture Overview<a href="#architecture-overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The configuration system consists of a global configuration object, validation service, and API functions that ensure type safety and economic viability.</p>
<p><img src="../media/25-configuration-system_0.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="global-configuration-parameters" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Global Configuration Parameters<a href="#global-configuration-parameters" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>GLOBAL_CONFIG</code> object contains 14 parameters organized into four categories:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Economic Parameters</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>CC_PERCENT_SLIPPAGE</code></td>
<td><code>number</code></td>
<td><code>0.1</code></td>
<td>Slippage percentage per transaction (applied twice: entry + exit)</td>
</tr>
<tr>
<td><code>CC_PERCENT_FEE</code></td>
<td><code>number</code></td>
<td><code>0.1</code></td>
<td>Fee percentage per transaction (applied twice: entry + exit)</td>
</tr>
<tr>
<td><code>CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</code></td>
<td><code>number</code></td>
<td><code>0.5</code></td>
<td>Minimum TP distance from priceOpen (must cover slippage + fees)</td>
</tr>
<tr>
<td><code>CC_MIN_STOPLOSS_DISTANCE_PERCENT</code></td>
<td><code>number</code></td>
<td><code>0.5</code></td>
<td>Minimum SL distance from priceOpen (prevents instant stops)</td>
</tr>
<tr>
<td><code>CC_MAX_STOPLOSS_DISTANCE_PERCENT</code></td>
<td><code>number</code></td>
<td><code>20.0</code></td>
<td>Maximum SL distance from priceOpen (caps risk per signal)</td>
</tr>
<tr>
<td><strong>Time-Based Parameters</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>CC_SCHEDULE_AWAIT_MINUTES</code></td>
<td><code>number</code></td>
<td><code>120</code></td>
<td>Time to wait for scheduled signal activation before cancellation</td>
</tr>
<tr>
<td><code>CC_MAX_SIGNAL_LIFETIME_MINUTES</code></td>
<td><code>number</code></td>
<td><code>1440</code></td>
<td>Maximum signal lifetime (prevents eternal positions)</td>
</tr>
<tr>
<td><code>CC_MAX_SIGNAL_GENERATION_SECONDS</code></td>
<td><code>number</code></td>
<td><code>180</code></td>
<td>Maximum time allowed for signal generation (prevents hangs)</td>
</tr>
<tr>
<td><strong>Data Fetching Parameters</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>CC_AVG_PRICE_CANDLES_COUNT</code></td>
<td><code>number</code></td>
<td><code>5</code></td>
<td>Number of candles for VWAP calculation</td>
</tr>
<tr>
<td><code>CC_GET_CANDLES_RETRY_COUNT</code></td>
<td><code>number</code></td>
<td><code>3</code></td>
<td>Number of retries for failed candle fetches</td>
</tr>
<tr>
<td><code>CC_GET_CANDLES_RETRY_DELAY_MS</code></td>
<td><code>number</code></td>
<td><code>5000</code></td>
<td>Delay between retry attempts (milliseconds)</td>
</tr>
<tr>
<td><code>CC_GET_CANDLES_PRICE_ANOMALY_THRESHOLD_FACTOR</code></td>
<td><code>number</code></td>
<td><code>1000</code></td>
<td>Maximum deviation factor for anomaly detection (catches incomplete candles)</td>
</tr>
<tr>
<td><code>CC_GET_CANDLES_MIN_CANDLES_FOR_MEDIAN</code></td>
<td><code>number</code></td>
<td><code>5</code></td>
<td>Minimum candles required for median calculation (use average below this)</td>
</tr>
<tr>
<td><strong>Reporting Parameters</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>CC_REPORT_SHOW_SIGNAL_NOTE</code></td>
<td><code>boolean</code></td>
<td><code>false</code></td>
<td>Controls visibility of signal notes in markdown reports</td>
</tr>
</tbody>
</table>
<hr>
<a id="economic-parameters-and-cost-model" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Economic Parameters and Cost Model<a href="#economic-parameters-and-cost-model" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The framework uses a realistic cost model that applies slippage and fees to both entry and exit prices. The economic parameters ensure that signals are profitable when TakeProfit is hit.</p>
<p><img src="../media/25-configuration-system_1.svg" alt="Mermaid Diagram"></p>
<a id="cost-breakdown-example" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Cost Breakdown Example<a href="#cost-breakdown-example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>For default configuration (<code>CC_PERCENT_SLIPPAGE = 0.1%</code>, <code>CC_PERCENT_FEE = 0.1%</code>):</p>
<ul>
<li><strong>Slippage Effect</strong>: 0.1% × 2 = 0.2% (entry + exit)</li>
<li><strong>Total Fees</strong>: 0.1% × 2 = 0.2% (entry + exit)</li>
<li><strong>Total Cost</strong>: 0.4%</li>
<li><strong>Minimum TP Distance</strong>: 0.5% (default, covers costs + 0.1% profit buffer)</li>
</ul>
<p>This ensures that when TakeProfit is hit, the signal yields at least 0.1% net profit after all costs.</p>
<hr>
<a id="economic-viability-validation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Economic Viability Validation<a href="#economic-viability-validation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>ConfigValidationService</code> enforces constraints that prevent mathematically unprofitable configurations. Validation occurs automatically when <code>setConfig()</code> is called (unless <code>_unsafe</code> flag is set).</p>
<a id="validation-rules" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Validation Rules<a href="#validation-rules" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/25-configuration-system_2.svg" alt="Mermaid Diagram"></p>
<a id="key-validation-economic-viability" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Key Validation: Economic Viability<a href="#key-validation-economic-viability" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The most critical validation ensures <code>CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</code> covers all trading costs:</p>
<pre><code class="typescript"><span class="hl-5">// From ConfigValidationService</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">slippageEffect</span><span class="hl-1"> = </span><span class="hl-8">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-8">CC_PERCENT_SLIPPAGE</span><span class="hl-1"> * </span><span class="hl-6">2</span><span class="hl-1">; </span><span class="hl-5">// Entry + exit</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">feesTotal</span><span class="hl-1"> = </span><span class="hl-8">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-8">CC_PERCENT_FEE</span><span class="hl-1"> * </span><span class="hl-6">2</span><span class="hl-1">; </span><span class="hl-5">// Entry + exit</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">minRequiredTpDistance</span><span class="hl-1"> = </span><span class="hl-4">slippageEffect</span><span class="hl-1"> + </span><span class="hl-4">feesTotal</span><span class="hl-1">;</span><br/><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-8">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-8">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</span><span class="hl-1"> &lt; </span><span class="hl-4">minRequiredTpDistance</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-3">throw</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-2">`CC_MIN_TAKEPROFIT_DISTANCE_PERCENT (</span><span class="hl-7">${</span><span class="hl-8">GLOBAL_CONFIG</span><span class="hl-9">.</span><span class="hl-8">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</span><span class="hl-7">}</span><span class="hl-2">%) `</span><span class="hl-1"> +</span><br/><span class="hl-1">    </span><span class="hl-2">`is too low to cover trading costs.</span><span class="hl-12">\n</span><span class="hl-2">`</span><span class="hl-1"> +</span><br/><span class="hl-1">    </span><span class="hl-2">`Required minimum: </span><span class="hl-7">${</span><span class="hl-4">minRequiredTpDistance</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-6">2</span><span class="hl-9">)</span><span class="hl-7">}</span><span class="hl-2">%</span><span class="hl-12">\n</span><span class="hl-2">`</span><span class="hl-1"> +</span><br/><span class="hl-1">    </span><span class="hl-2">`All TakeProfit signals will be unprofitable with current settings!`</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Example Error Output</strong>:</p>
<pre><code><span class="hl-8">GLOBAL_CONFIG</span><span class="hl-1"> </span><span class="hl-4">validation</span><span class="hl-1"> </span><span class="hl-10">failed</span><span class="hl-1">:</span><br/><span class="hl-1">  </span><span class="hl-0">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</span><span class="hl-1"> (</span><span class="hl-6">0.3</span><span class="hl-1">%) </span><span class="hl-4">is</span><span class="hl-1"> </span><span class="hl-4">too</span><span class="hl-1"> </span><span class="hl-4">low</span><span class="hl-1"> </span><span class="hl-4">to</span><span class="hl-1"> </span><span class="hl-4">cover</span><span class="hl-1"> </span><span class="hl-4">trading</span><span class="hl-1"> </span><span class="hl-4">costs</span><span class="hl-1">.</span><br/><span class="hl-1">  </span><span class="hl-4">Required</span><span class="hl-1"> </span><span class="hl-10">minimum</span><span class="hl-1">: </span><span class="hl-6">0.40</span><span class="hl-1">%</span><br/><span class="hl-1">  </span><span class="hl-10">Breakdown</span><span class="hl-1">:</span><br/><span class="hl-1">    - </span><span class="hl-4">Slippage</span><span class="hl-1"> </span><span class="hl-10">effect</span><span class="hl-1">: </span><span class="hl-6">0.20</span><span class="hl-1">% (</span><span class="hl-6">0.1</span><span class="hl-1">% × </span><span class="hl-6">2</span><span class="hl-1"> </span><span class="hl-4">transactions</span><span class="hl-1">)</span><br/><span class="hl-1">    - </span><span class="hl-10">Fees</span><span class="hl-1">: </span><span class="hl-6">0.20</span><span class="hl-1">% (</span><span class="hl-6">0.1</span><span class="hl-1">% × </span><span class="hl-6">2</span><span class="hl-1"> </span><span class="hl-4">transactions</span><span class="hl-1">)</span><br/><span class="hl-1">  </span><span class="hl-4">All</span><span class="hl-1"> </span><span class="hl-4">TakeProfit</span><span class="hl-1"> </span><span class="hl-4">signals</span><span class="hl-1"> </span><span class="hl-4">will</span><span class="hl-1"> </span><span class="hl-4">be</span><span class="hl-1"> </span><span class="hl-4">unprofitable</span><span class="hl-1"> </span><span class="hl-3">with</span><span class="hl-1"> </span><span class="hl-4">current</span><span class="hl-1"> </span><span class="hl-4">settings</span><span class="hl-1">!</span>
</code><button>Copy</button></pre>

<hr>
<a id="configuration-api" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Configuration API<a href="#configuration-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The framework provides three functions for configuration management:</p>
<a id="setconfigconfig-_unsafe" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code>setConfig(config, _unsafe?)</code><a href="#setconfigconfig-_unsafe" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Updates global configuration with validation. On validation failure, automatically rolls back to previous configuration.</p>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>config</code>: <code>Partial&lt;GlobalConfig&gt;</code> - Parameters to update (only specified fields are changed)</li>
<li><code>_unsafe</code>: <code>boolean</code> - Skip validation (used in test environments)</li>
</ul>
<p><strong>Behavior</strong>:</p>
<ol>
<li>Saves current configuration for rollback</li>
<li>Applies partial update to <code>GLOBAL_CONFIG</code></li>
<li>Runs <code>ConfigValidationService.validate()</code> (unless <code>_unsafe</code> is true)</li>
<li>On error: restores previous configuration and re-throws error</li>
<li>On success: new configuration is active</li>
</ol>
<p><strong>Example</strong>:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">setConfig</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Update slippage and fees</span><br/><span class="hl-0">setConfig</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">CC_PERCENT_SLIPPAGE:</span><span class="hl-1"> </span><span class="hl-6">0.15</span><span class="hl-1">,  </span><span class="hl-5">// Increase slippage to 0.15%</span><br/><span class="hl-1">  </span><span class="hl-4">CC_PERCENT_FEE:</span><span class="hl-1"> </span><span class="hl-6">0.12</span><span class="hl-1">,       </span><span class="hl-5">// Increase fees to 0.12%</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Validation will fail if TP distance is too low</span><br/><span class="hl-3">try</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">setConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-6">0.2</span><span class="hl-1">,  </span><span class="hl-5">// Too low for new costs</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">} </span><span class="hl-3">catch</span><span class="hl-1"> (</span><span class="hl-4">error</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">&#39;Config rejected:&#39;</span><span class="hl-1">, </span><span class="hl-4">error</span><span class="hl-1">.</span><span class="hl-4">message</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-5">// GLOBAL_CONFIG remains unchanged</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="getconfig" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code>getConfig()</code><a href="#getconfig" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Returns a shallow copy of the current configuration. Use this to inspect current settings without modifying them.</p>
<p><strong>Returns</strong>: <code>GlobalConfig</code> - Copy of current configuration</p>
<p><strong>Example</strong>:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">getConfig</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">currentConfig</span><span class="hl-1"> = </span><span class="hl-0">getConfig</span><span class="hl-1">();</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Current slippage:&#39;</span><span class="hl-1">, </span><span class="hl-4">currentConfig</span><span class="hl-1">.</span><span class="hl-8">CC_PERCENT_SLIPPAGE</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Current fee:&#39;</span><span class="hl-1">, </span><span class="hl-4">currentConfig</span><span class="hl-1">.</span><span class="hl-8">CC_PERCENT_FEE</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Modifying the returned object does NOT affect GLOBAL_CONFIG</span><br/><span class="hl-4">currentConfig</span><span class="hl-1">.</span><span class="hl-8">CC_PERCENT_SLIPPAGE</span><span class="hl-1"> = </span><span class="hl-6">999</span><span class="hl-1">; </span><span class="hl-5">// No effect on actual config</span>
</code><button type="button">Copy</button></pre>

<a id="getdefaultconfig" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code>getDefaultConfig()</code><a href="#getdefaultconfig" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Returns a frozen reference to the default configuration. Use this to see all available parameters and their default values.</p>
<p><strong>Returns</strong>: <code>Readonly&lt;GlobalConfig&gt;</code> - Frozen reference to defaults</p>
<p><strong>Example</strong>:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">getDefaultConfig</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">defaults</span><span class="hl-1"> = </span><span class="hl-0">getDefaultConfig</span><span class="hl-1">();</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Default slippage:&#39;</span><span class="hl-1">, </span><span class="hl-4">defaults</span><span class="hl-1">.</span><span class="hl-8">CC_PERCENT_SLIPPAGE</span><span class="hl-1">); </span><span class="hl-5">// 0.1</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Default fee:&#39;</span><span class="hl-1">, </span><span class="hl-4">defaults</span><span class="hl-1">.</span><span class="hl-8">CC_PERCENT_FEE</span><span class="hl-1">); </span><span class="hl-5">// 0.1</span><br/><br/><span class="hl-5">// Cannot modify (frozen object)</span><br/><span class="hl-4">defaults</span><span class="hl-1">.</span><span class="hl-8">CC_PERCENT_SLIPPAGE</span><span class="hl-1"> = </span><span class="hl-6">999</span><span class="hl-1">; </span><span class="hl-5">// TypeError in strict mode</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="validation-rule-reference" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Validation Rule Reference<a href="#validation-rule-reference" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Complete list of validation rules enforced by <code>ConfigValidationService</code>:</p>
<a id="percentage-parameters" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Percentage Parameters<a href="#percentage-parameters" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Parameter</th>
<th>Rule</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CC_PERCENT_SLIPPAGE</code></td>
<td>Must be ≥ 0</td>
<td>Negative slippage is meaningless</td>
</tr>
<tr>
<td><code>CC_PERCENT_FEE</code></td>
<td>Must be ≥ 0</td>
<td>Negative fees are impossible</td>
</tr>
<tr>
<td><code>CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</code></td>
<td>Must be &gt; 0</td>
<td>Zero TP distance is invalid</td>
</tr>
<tr>
<td><code>CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</code></td>
<td>Must be ≥ (slippage×2 + fees×2)</td>
<td><strong>Critical</strong>: Ensures profitable trades</td>
</tr>
<tr>
<td><code>CC_MIN_STOPLOSS_DISTANCE_PERCENT</code></td>
<td>Must be &gt; 0</td>
<td>Zero SL distance causes instant stops</td>
</tr>
<tr>
<td><code>CC_MAX_STOPLOSS_DISTANCE_PERCENT</code></td>
<td>Must be &gt; 0</td>
<td>Caps maximum risk per signal</td>
</tr>
<tr>
<td><code>CC_MIN_STOPLOSS_DISTANCE_PERCENT</code></td>
<td>Must be &lt; <code>CC_MAX_STOPLOSS_DISTANCE_PERCENT</code></td>
<td>Range consistency</td>
</tr>
</tbody>
</table>
<a id="integer-parameters" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Integer Parameters<a href="#integer-parameters" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Parameter</th>
<th>Rule</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CC_SCHEDULE_AWAIT_MINUTES</code></td>
<td>Must be positive integer</td>
<td>Prevents eternal scheduled signals</td>
</tr>
<tr>
<td><code>CC_MAX_SIGNAL_LIFETIME_MINUTES</code></td>
<td>Must be positive integer</td>
<td>Prevents eternal open positions</td>
</tr>
<tr>
<td><code>CC_MAX_SIGNAL_GENERATION_SECONDS</code></td>
<td>Must be positive integer</td>
<td>Prevents hanging signal generation</td>
</tr>
<tr>
<td><code>CC_AVG_PRICE_CANDLES_COUNT</code></td>
<td>Must be positive integer</td>
<td>VWAP requires at least 1 candle</td>
</tr>
<tr>
<td><code>CC_GET_CANDLES_RETRY_COUNT</code></td>
<td>Must be non-negative integer</td>
<td>0 retries = no retry, ≥1 = retry N times</td>
</tr>
<tr>
<td><code>CC_GET_CANDLES_RETRY_DELAY_MS</code></td>
<td>Must be positive integer</td>
<td>Retry delay must be positive</td>
</tr>
<tr>
<td><code>CC_GET_CANDLES_PRICE_ANOMALY_THRESHOLD_FACTOR</code></td>
<td>Must be positive number</td>
<td>Anomaly detection requires threshold</td>
</tr>
<tr>
<td><code>CC_GET_CANDLES_MIN_CANDLES_FOR_MEDIAN</code></td>
<td>Must be positive integer</td>
<td>Median calculation requires data points</td>
</tr>
</tbody>
</table>
<a id="boolean-parameters" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Boolean Parameters<a href="#boolean-parameters" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Parameter</th>
<th>Rule</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CC_REPORT_SHOW_SIGNAL_NOTE</code></td>
<td>Must be boolean</td>
<td>Controls report formatting</td>
</tr>
</tbody>
</table>
<hr>
<a id="integration-with-signal-validation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Integration with Signal Validation<a href="#integration-with-signal-validation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Configuration parameters are used throughout signal validation to enforce economic constraints and safety limits.</p>
<p><img src="../media/25-configuration-system_3.svg" alt="Mermaid Diagram"></p>
<p><strong>Example Validation Errors</strong>:</p>
<pre><code class="typescript"><span class="hl-5">// TP distance too close (below CC_MIN_TAKEPROFIT_DISTANCE_PERCENT)</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-10">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">priceOpen</span><span class="hl-1">: </span><span class="hl-6">50000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-6">50200</span><span class="hl-1">,  </span><span class="hl-5">// Only 0.4% profit</span><br/><span class="hl-1">  </span><span class="hl-10">priceStopLoss</span><span class="hl-1">: </span><span class="hl-6">49000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-6">60</span><br/><span class="hl-1">}</span><br/><span class="hl-5">// Error: &quot;TP distance (0.40%) is below minimum (0.50%)&quot;</span><br/><br/><span class="hl-5">// SL distance too large (above CC_MAX_STOPLOSS_DISTANCE_PERCENT)</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-10">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">priceOpen</span><span class="hl-1">: </span><span class="hl-6">50000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-6">55000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">priceStopLoss</span><span class="hl-1">: </span><span class="hl-6">30000</span><span class="hl-1">,  </span><span class="hl-5">// 40% risk - exceeds 20% max</span><br/><span class="hl-1">  </span><span class="hl-10">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-6">60</span><br/><span class="hl-1">}</span><br/><span class="hl-5">// Error: &quot;SL distance (40.00%) exceeds maximum (20.00%)&quot;</span><br/><br/><span class="hl-5">// Signal lifetime too long (above CC_MAX_SIGNAL_LIFETIME_MINUTES)</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-10">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">priceOpen</span><span class="hl-1">: </span><span class="hl-6">50000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-6">55000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">priceStopLoss</span><span class="hl-1">: </span><span class="hl-6">45000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-6">50000</span><span class="hl-1">  </span><span class="hl-5">// &gt;34 days (exceeds 1440 min default)</span><br/><span class="hl-1">}</span><br/><span class="hl-5">// Error: &quot;Signal lifetime (50000 min) exceeds maximum (1440 min)&quot;</span>
</code><button type="button">Copy</button></pre>

<p>(inferred from test files), <a href="">test/e2e/sanitize.test.mjs:1-887</a></p>
<hr>
<a id="integration-with-vwap-calculation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Integration with VWAP Calculation<a href="#integration-with-vwap-calculation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>CC_AVG_PRICE_CANDLES_COUNT</code> parameter controls how many recent 1-minute candles are used for VWAP (Volume-Weighted Average Price) calculation.</p>
<p><img src="../media/25-configuration-system_4.svg" alt="Mermaid Diagram"></p>
<p><strong>Formula</strong>:</p>
<pre><code><span class="hl-8">VWAP</span><span class="hl-1"> = </span><span class="hl-0">Σ</span><span class="hl-1">(</span><span class="hl-4">Typical</span><span class="hl-1"> </span><span class="hl-4">Price</span><span class="hl-1"> × </span><span class="hl-4">Volume</span><span class="hl-1">) / </span><span class="hl-0">Σ</span><span class="hl-1">(</span><span class="hl-4">Volume</span><span class="hl-1">)</span><br/><br/><span class="hl-4">where</span><span class="hl-1"> </span><span class="hl-4">Typical</span><span class="hl-1"> </span><span class="hl-4">Price</span><span class="hl-1"> = (</span><span class="hl-4">High</span><span class="hl-1"> + </span><span class="hl-4">Low</span><span class="hl-1"> + </span><span class="hl-4">Close</span><span class="hl-1">) / </span><span class="hl-6">3</span>
</code><button>Copy</button></pre>

<p><strong>Example with default <code>CC_AVG_PRICE_CANDLES_COUNT = 5</code></strong>:</p>
<table>
<thead>
<tr>
<th>Candle</th>
<th>High</th>
<th>Low</th>
<th>Close</th>
<th>Volume</th>
<th>Typical Price</th>
<th>Weighted</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>50100</td>
<td>49900</td>
<td>50000</td>
<td>100</td>
<td>50000</td>
<td>5000000</td>
</tr>
<tr>
<td>2</td>
<td>50200</td>
<td>50000</td>
<td>50100</td>
<td>120</td>
<td>50100</td>
<td>6012000</td>
</tr>
<tr>
<td>3</td>
<td>50300</td>
<td>50100</td>
<td>50200</td>
<td>110</td>
<td>50200</td>
<td>5522000</td>
</tr>
<tr>
<td>4</td>
<td>50400</td>
<td>50200</td>
<td>50300</td>
<td>130</td>
<td>50300</td>
<td>6539000</td>
</tr>
<tr>
<td>5</td>
<td>50500</td>
<td>50300</td>
<td>50400</td>
<td>140</td>
<td>50400</td>
<td>7056000</td>
</tr>
<tr>
<td><strong>Total</strong></td>
<td></td>
<td></td>
<td></td>
<td><strong>600</strong></td>
<td></td>
<td><strong>30129000</strong></td>
</tr>
</tbody>
</table>
<p>VWAP = 30129000 / 600 = <strong>50215</strong></p>
<p>(inferred), <a href="">types.d.ts:404-412</a>, <a href="">src/config/params.ts:7-11</a></p>
<hr>
<a id="integration-with-retry-logic" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Integration with Retry Logic<a href="#integration-with-retry-logic" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Data fetching parameters control retry behavior and anomaly detection when fetching candles from exchanges.</p>
<p><img src="../media/25-configuration-system_5.svg" alt="Mermaid Diagram"></p>
<p><strong>Default Retry Configuration</strong>:</p>
<ul>
<li><code>CC_GET_CANDLES_RETRY_COUNT = 3</code>: Retry up to 3 times on failure</li>
<li><code>CC_GET_CANDLES_RETRY_DELAY_MS = 5000</code>: Wait 5 seconds between retries</li>
</ul>
<p><strong>Anomaly Detection Example</strong>:</p>
<pre><code class="typescript"><span class="hl-5">// Candles fetched: BTC at ~$50,000</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">candles</span><span class="hl-1"> = [</span><br/><span class="hl-1">  { </span><span class="hl-4">open:</span><span class="hl-1"> </span><span class="hl-6">50000</span><span class="hl-1">, </span><span class="hl-4">high:</span><span class="hl-1"> </span><span class="hl-6">50100</span><span class="hl-1">, </span><span class="hl-4">low:</span><span class="hl-1"> </span><span class="hl-6">49900</span><span class="hl-1">, </span><span class="hl-4">close:</span><span class="hl-1"> </span><span class="hl-6">50000</span><span class="hl-1">, </span><span class="hl-4">volume:</span><span class="hl-1"> </span><span class="hl-6">100</span><span class="hl-1"> },</span><br/><span class="hl-1">  { </span><span class="hl-4">open:</span><span class="hl-1"> </span><span class="hl-6">50100</span><span class="hl-1">, </span><span class="hl-4">high:</span><span class="hl-1"> </span><span class="hl-6">50200</span><span class="hl-1">, </span><span class="hl-4">low:</span><span class="hl-1"> </span><span class="hl-6">50000</span><span class="hl-1">, </span><span class="hl-4">close:</span><span class="hl-1"> </span><span class="hl-6">50100</span><span class="hl-1">, </span><span class="hl-4">volume:</span><span class="hl-1"> </span><span class="hl-6">110</span><span class="hl-1"> },</span><br/><span class="hl-1">  { </span><span class="hl-4">open:</span><span class="hl-1"> </span><span class="hl-6">0.01</span><span class="hl-1">, </span><span class="hl-4">high:</span><span class="hl-1"> </span><span class="hl-6">0.02</span><span class="hl-1">, </span><span class="hl-4">low:</span><span class="hl-1"> </span><span class="hl-6">0.01</span><span class="hl-1">, </span><span class="hl-4">close:</span><span class="hl-1"> </span><span class="hl-6">0.01</span><span class="hl-1">, </span><span class="hl-4">volume:</span><span class="hl-1"> </span><span class="hl-6">0</span><span class="hl-1"> }, </span><span class="hl-5">// ANOMALY!</span><br/><span class="hl-1">  { </span><span class="hl-4">open:</span><span class="hl-1"> </span><span class="hl-6">50200</span><span class="hl-1">, </span><span class="hl-4">high:</span><span class="hl-1"> </span><span class="hl-6">50300</span><span class="hl-1">, </span><span class="hl-4">low:</span><span class="hl-1"> </span><span class="hl-6">50100</span><span class="hl-1">, </span><span class="hl-4">close:</span><span class="hl-1"> </span><span class="hl-6">50200</span><span class="hl-1">, </span><span class="hl-4">volume:</span><span class="hl-1"> </span><span class="hl-6">120</span><span class="hl-1"> },</span><br/><span class="hl-1">  { </span><span class="hl-4">open:</span><span class="hl-1"> </span><span class="hl-6">50300</span><span class="hl-1">, </span><span class="hl-4">high:</span><span class="hl-1"> </span><span class="hl-6">50400</span><span class="hl-1">, </span><span class="hl-4">low:</span><span class="hl-1"> </span><span class="hl-6">50200</span><span class="hl-1">, </span><span class="hl-4">close:</span><span class="hl-1"> </span><span class="hl-6">50300</span><span class="hl-1">, </span><span class="hl-4">volume:</span><span class="hl-1"> </span><span class="hl-6">130</span><span class="hl-1"> },</span><br/><span class="hl-1">];</span><br/><br/><span class="hl-5">// Reference price (median): ~50000</span><br/><span class="hl-5">// Anomaly threshold: 50000 / 1000 = 50</span><br/><span class="hl-5">// Candle 3 has price 0.01 &lt; 50 → REJECTED</span><br/><span class="hl-5">// Error: &quot;VALIDATE_NO_INCOMPLETE_CANDLES_FN detected anomalously low price&quot;</span>
</code><button type="button">Copy</button></pre>

<p>This protects against incomplete candles from Binance API that sometimes have near-zero prices.</p>
<hr>
<a id="test-configuration" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Test Configuration<a href="#test-configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>For test environments, the <code>_unsafe</code> parameter allows skipping validation:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">setConfig</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Test setup: disable validations for old test compatibility</span><br/><span class="hl-0">setConfig</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-6">0</span><span class="hl-1">,  </span><span class="hl-5">// Normally invalid</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MIN_STOPLOSS_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-6">0</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MAX_STOPLOSS_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-6">100</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MAX_SIGNAL_LIFETIME_MINUTES:</span><span class="hl-1"> </span><span class="hl-6">999999</span><span class="hl-1">,</span><br/><span class="hl-1">}, </span><span class="hl-7">true</span><span class="hl-1">);  </span><span class="hl-5">// _unsafe = true, skip validation</span>
</code><button type="button">Copy</button></pre>

<p><strong>Warning</strong>: Never use <code>_unsafe = true</code> in production. It bypasses all safety checks including economic viability validation.</p>
<hr>
<a id="configuration-in-practice" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Configuration in Practice<a href="#configuration-in-practice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="example-conservative-trading-configuration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example: Conservative Trading Configuration<a href="#example-conservative-trading-configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">setConfig</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Conservative settings: higher costs, stricter limits</span><br/><span class="hl-0">setConfig</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">// Economic constraints</span><br/><span class="hl-1">  </span><span class="hl-4">CC_PERCENT_SLIPPAGE:</span><span class="hl-1"> </span><span class="hl-6">0.15</span><span class="hl-1">,              </span><span class="hl-5">// 0.15% slippage</span><br/><span class="hl-1">  </span><span class="hl-4">CC_PERCENT_FEE:</span><span class="hl-1"> </span><span class="hl-6">0.12</span><span class="hl-1">,                   </span><span class="hl-5">// 0.12% fees</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-6">1.0</span><span class="hl-1">, </span><span class="hl-5">// 1% minimum profit (well above 0.54% costs)</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MIN_STOPLOSS_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-6">0.8</span><span class="hl-1">,  </span><span class="hl-5">// 0.8% minimum SL distance</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MAX_STOPLOSS_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-6">10.0</span><span class="hl-1">, </span><span class="hl-5">// 10% maximum risk per signal</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Time constraints</span><br/><span class="hl-1">  </span><span class="hl-4">CC_SCHEDULE_AWAIT_MINUTES:</span><span class="hl-1"> </span><span class="hl-6">60</span><span class="hl-1">,          </span><span class="hl-5">// 1 hour max for limit orders</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MAX_SIGNAL_LIFETIME_MINUTES:</span><span class="hl-1"> </span><span class="hl-6">720</span><span class="hl-1">,    </span><span class="hl-5">// 12 hours max per signal</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Data quality</span><br/><span class="hl-1">  </span><span class="hl-4">CC_AVG_PRICE_CANDLES_COUNT:</span><span class="hl-1"> </span><span class="hl-6">10</span><span class="hl-1">,         </span><span class="hl-5">// Use 10 candles for VWAP (more stable)</span><br/><span class="hl-1">  </span><span class="hl-4">CC_GET_CANDLES_RETRY_COUNT:</span><span class="hl-1"> </span><span class="hl-6">5</span><span class="hl-1">,          </span><span class="hl-5">// 5 retries (more resilient)</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="example-aggressive-trading-configuration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example: Aggressive Trading Configuration<a href="#example-aggressive-trading-configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">setConfig</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Aggressive settings: lower costs, looser limits</span><br/><span class="hl-0">setConfig</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">// Economic constraints</span><br/><span class="hl-1">  </span><span class="hl-4">CC_PERCENT_SLIPPAGE:</span><span class="hl-1"> </span><span class="hl-6">0.05</span><span class="hl-1">,              </span><span class="hl-5">// 0.05% slippage</span><br/><span class="hl-1">  </span><span class="hl-4">CC_PERCENT_FEE:</span><span class="hl-1"> </span><span class="hl-6">0.05</span><span class="hl-1">,                   </span><span class="hl-5">// 0.05% fees</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-6">0.25</span><span class="hl-1">, </span><span class="hl-5">// 0.25% minimum profit (just above 0.2% costs)</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MIN_STOPLOSS_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-6">0.3</span><span class="hl-1">,  </span><span class="hl-5">// 0.3% minimum SL distance</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MAX_STOPLOSS_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-6">30.0</span><span class="hl-1">, </span><span class="hl-5">// 30% maximum risk per signal</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Time constraints</span><br/><span class="hl-1">  </span><span class="hl-4">CC_SCHEDULE_AWAIT_MINUTES:</span><span class="hl-1"> </span><span class="hl-6">240</span><span class="hl-1">,         </span><span class="hl-5">// 4 hours max for limit orders</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MAX_SIGNAL_LIFETIME_MINUTES:</span><span class="hl-1"> </span><span class="hl-6">2880</span><span class="hl-1">,   </span><span class="hl-5">// 48 hours max per signal</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Data quality</span><br/><span class="hl-1">  </span><span class="hl-4">CC_AVG_PRICE_CANDLES_COUNT:</span><span class="hl-1"> </span><span class="hl-6">3</span><span class="hl-1">,          </span><span class="hl-5">// Use 3 candles for VWAP (faster response)</span><br/><span class="hl-1">  </span><span class="hl-4">CC_GET_CANDLES_RETRY_COUNT:</span><span class="hl-1"> </span><span class="hl-6">2</span><span class="hl-1">,          </span><span class="hl-5">// 2 retries (fail faster)</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="summary" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Summary<a href="#summary" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The Configuration System provides:</p>
<ol>
<li><strong>Centralized Management</strong>: Single <code>GLOBAL_CONFIG</code> object for all framework parameters</li>
<li><strong>Economic Viability</strong>: Automatic validation ensures profitable trading configurations</li>
<li><strong>Type Safety</strong>: TypeScript types prevent invalid parameter values</li>
<li><strong>Rollback Protection</strong>: Failed configuration updates do not corrupt the system</li>
<li><strong>Runtime Updates</strong>: Configuration can be changed at any time with <code>setConfig()</code></li>
<li><strong>Default Values</strong>: Sensible defaults for production use (0.1% slippage, 0.1% fees, 0.5% min TP)</li>
</ol>
<p><strong>Key Design Principles</strong>:</p>
<ul>
<li><strong>Fail-Fast</strong>: Validation errors prevent system execution with invalid configuration</li>
<li><strong>Rollback Safety</strong>: On validation failure, previous configuration is restored</li>
<li><strong>Economic Correctness</strong>: Mathematical validation ensures profitable trades</li>
<li><strong>Test Flexibility</strong>: <code>_unsafe</code> flag allows test environments to bypass validation</li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#configuration-system"><span>Configuration <wbr/>System</span></a><ul><li><a href="#architecture-overview"><span>Architecture <wbr/>Overview</span></a></li><li><a href="#global-configuration-parameters"><span>Global <wbr/>Configuration <wbr/>Parameters</span></a></li><li><a href="#economic-parameters-and-cost-model"><span>Economic <wbr/>Parameters and <wbr/>Cost <wbr/>Model</span></a></li><li><ul><li><a href="#cost-breakdown-example"><span>Cost <wbr/>Breakdown <wbr/>Example</span></a></li></ul></li><li><a href="#economic-viability-validation"><span>Economic <wbr/>Viability <wbr/>Validation</span></a></li><li><ul><li><a href="#validation-rules"><span>Validation <wbr/>Rules</span></a></li><li><a href="#key-validation-economic-viability"><span>Key <wbr/>Validation: <wbr/>Economic <wbr/>Viability</span></a></li></ul></li><li><a href="#configuration-api"><span>Configuration API</span></a></li><li><ul><li><a href="#setconfigconfig-_unsafe"><span>set<wbr/>Config(config, _<wbr/>unsafe?)</span></a></li><li><a href="#getconfig"><span>get<wbr/>Config()</span></a></li><li><a href="#getdefaultconfig"><span>get<wbr/>Default<wbr/>Config()</span></a></li></ul></li><li><a href="#validation-rule-reference"><span>Validation <wbr/>Rule <wbr/>Reference</span></a></li><li><ul><li><a href="#percentage-parameters"><span>Percentage <wbr/>Parameters</span></a></li><li><a href="#integer-parameters"><span>Integer <wbr/>Parameters</span></a></li><li><a href="#boolean-parameters"><span>Boolean <wbr/>Parameters</span></a></li></ul></li><li><a href="#integration-with-signal-validation"><span>Integration with <wbr/>Signal <wbr/>Validation</span></a></li><li><a href="#integration-with-vwap-calculation"><span>Integration with VWAP <wbr/>Calculation</span></a></li><li><a href="#integration-with-retry-logic"><span>Integration with <wbr/>Retry <wbr/>Logic</span></a></li><li><a href="#test-configuration"><span>Test <wbr/>Configuration</span></a></li><li><a href="#configuration-in-practice"><span>Configuration in <wbr/>Practice</span></a></li><li><ul><li><a href="#example-conservative-trading-configuration"><span>Example: <wbr/>Conservative <wbr/>Trading <wbr/>Configuration</span></a></li><li><a href="#example-aggressive-trading-configuration"><span>Example: <wbr/>Aggressive <wbr/>Trading <wbr/>Configuration</span></a></li></ul></li><li><a href="#summary"><span>Summary</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
