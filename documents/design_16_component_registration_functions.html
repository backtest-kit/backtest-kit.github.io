<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/16_component_registration_functions | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_16_component_registration_functions.html">design/16_component_registration_functions</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="component-registration-functions" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Component Registration Functions<a href="#component-registration-functions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><a id="purpose-and-scope" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Purpose and Scope<a href="#purpose-and-scope" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This page documents the seven component registration functions that configure the backtest-kit framework. These functions (<code>addStrategy</code>, <code>addExchange</code>, <code>addFrame</code>, <code>addWalker</code>, <code>addSizing</code>, <code>addRisk</code>, <code>addOptimizer</code>) provide the primary user-facing API for defining trading strategies, data sources, backtesting parameters, comparison logic, position sizing, risk management, and AI-driven optimization.</p>
<p>Each registration function validates its input schema, stores it in a schema service, and makes it available for retrieval during execution. For details on the schema interfaces themselves, see <a href="design_23_component_types.html">Component Types</a>. For information on how registered components are instantiated during execution, see <a href="design_38_service_layer.html">Service Layer</a>.</p>
<hr>
<a id="registration-architecture" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Registration Architecture<a href="#registration-architecture" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The component registration system implements a three-stage pipeline that transforms user-provided configuration into executable framework components.</p>
<a id="registration-flow-diagram" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Registration Flow Diagram<a href="#registration-flow-diagram" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16_Component_Registration_Functions_0.svg" alt="Mermaid Diagram"></p>
<a id="component-lifecycle" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Component Lifecycle<a href="#component-lifecycle" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16_Component_Registration_Functions_1.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="registration-functions" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Registration Functions<a href="#registration-functions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="function-summary-table" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Function Summary Table<a href="#function-summary-table" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Function</th>
<th>Schema Type</th>
<th>Validation Service</th>
<th>Schema Service</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>addStrategy</code></td>
<td><code>IStrategySchema</code></td>
<td><code>StrategyValidationService</code></td>
<td><code>StrategySchemaService</code></td>
<td>Register signal generation logic</td>
</tr>
<tr>
<td><code>addExchange</code></td>
<td><code>IExchangeSchema</code></td>
<td><code>ExchangeValidationService</code></td>
<td><code>ExchangeSchemaService</code></td>
<td>Register data source for candles</td>
</tr>
<tr>
<td><code>addFrame</code></td>
<td><code>IFrameSchema</code></td>
<td><code>FrameValidationService</code></td>
<td><code>FrameSchemaService</code></td>
<td>Register backtest time period</td>
</tr>
<tr>
<td><code>addWalker</code></td>
<td><code>IWalkerSchema</code></td>
<td><code>WalkerValidationService</code></td>
<td><code>WalkerSchemaService</code></td>
<td>Register strategy comparison logic</td>
</tr>
<tr>
<td><code>addSizing</code></td>
<td><code>ISizingSchema</code></td>
<td><code>SizingValidationService</code></td>
<td><code>SizingSchemaService</code></td>
<td>Register position sizing method</td>
</tr>
<tr>
<td><code>addRisk</code></td>
<td><code>IRiskSchema</code></td>
<td><code>RiskValidationService</code></td>
<td><code>RiskSchemaService</code></td>
<td>Register risk management rules</td>
</tr>
<tr>
<td><code>addOptimizer</code></td>
<td><code>IOptimizerSchema</code></td>
<td><code>OptimizerValidationService</code></td>
<td><code>OptimizerSchemaService</code></td>
<td>Register AI strategy generator</td>
</tr>
</tbody>
</table>
<hr>
<a id="addstrategy" class="tsd-anchor"></a><h2 class="tsd-anchor-link">addStrategy<a href="#addstrategy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Registers a trading strategy that generates buy/sell signals based on market conditions. The strategy defines signal generation logic, interval throttling, and optional lifecycle callbacks.</p>
<a id="function-signature" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Function Signature<a href="#function-signature" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">function</span><span class="hl-1"> </span><span class="hl-0">addStrategy</span><span class="hl-1">(</span><span class="hl-4">strategySchema</span><span class="hl-1">: </span><span class="hl-13">IStrategySchema</span><span class="hl-1">): </span><span class="hl-13">void</span>
</code><button type="button">Copy</button></pre>

<a id="schema-interface" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schema Interface<a href="#schema-interface" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">IStrategySchema</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-13">StrategyName</span><span class="hl-1">;           </span><span class="hl-5">// Unique identifier</span><br/><span class="hl-1">  </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-13">SignalInterval</span><span class="hl-1">;             </span><span class="hl-5">// Throttling interval</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-1">: (</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">, </span><span class="hl-4">when</span><span class="hl-1">: </span><span class="hl-13">Date</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-13">ISignalDto</span><span class="hl-1"> | </span><span class="hl-13">null</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks</span><span class="hl-1">?: </span><span class="hl-13">Partial</span><span class="hl-1">&lt;</span><span class="hl-13">IStrategyCallbacks</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">riskName</span><span class="hl-1">?: </span><span class="hl-13">RiskName</span><span class="hl-1">;                  </span><span class="hl-5">// Optional risk profile</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-13">string</span><span class="hl-1">;                        </span><span class="hl-5">// Optional documentation</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="signal-intervals" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Signal Intervals<a href="#signal-intervals" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Valid throttling intervals that enforce minimum time between <code>getSignal</code> calls:</p>
<table>
<thead>
<tr>
<th>Interval</th>
<th>Duration</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&quot;1m&quot;</code></td>
<td>1 minute</td>
<td>High-frequency scalping</td>
</tr>
<tr>
<td><code>&quot;3m&quot;</code></td>
<td>3 minutes</td>
<td>Short-term momentum</td>
</tr>
<tr>
<td><code>&quot;5m&quot;</code></td>
<td>5 minutes</td>
<td>Standard intraday</td>
</tr>
<tr>
<td><code>&quot;15m&quot;</code></td>
<td>15 minutes</td>
<td>Swing trading</td>
</tr>
<tr>
<td><code>&quot;30m&quot;</code></td>
<td>30 minutes</td>
<td>Position trading</td>
</tr>
<tr>
<td><code>&quot;1h&quot;</code></td>
<td>1 hour</td>
<td>Long-term strategies</td>
</tr>
</tbody>
</table>
<a id="lifecycle-callbacks" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Lifecycle Callbacks<a href="#lifecycle-callbacks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Optional callbacks invoked during signal lifecycle transitions:</p>
<table>
<thead>
<tr>
<th>Callback</th>
<th>Trigger</th>
<th>Parameters</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>onTick</code></td>
<td>Every tick execution</td>
<td><code>symbol</code>, <code>result</code>, <code>backtest</code></td>
</tr>
<tr>
<td><code>onIdle</code></td>
<td>No active signal</td>
<td><code>symbol</code>, <code>currentPrice</code>, <code>backtest</code></td>
</tr>
<tr>
<td><code>onSchedule</code></td>
<td>Scheduled signal created</td>
<td><code>symbol</code>, <code>data</code>, <code>currentPrice</code>, <code>backtest</code></td>
</tr>
<tr>
<td><code>onOpen</code></td>
<td>Signal activated</td>
<td><code>symbol</code>, <code>data</code>, <code>currentPrice</code>, <code>backtest</code></td>
</tr>
<tr>
<td><code>onActive</code></td>
<td>Signal being monitored</td>
<td><code>symbol</code>, <code>data</code>, <code>currentPrice</code>, <code>backtest</code></td>
</tr>
<tr>
<td><code>onPartialProfit</code></td>
<td>Milestone profit reached</td>
<td><code>symbol</code>, <code>data</code>, <code>currentPrice</code>, <code>revenuePercent</code>, <code>backtest</code></td>
</tr>
<tr>
<td><code>onPartialLoss</code></td>
<td>Milestone loss reached</td>
<td><code>symbol</code>, <code>data</code>, <code>currentPrice</code>, <code>lossPercent</code>, <code>backtest</code></td>
</tr>
<tr>
<td><code>onClose</code></td>
<td>Signal completed</td>
<td><code>symbol</code>, <code>data</code>, <code>priceClose</code>, <code>backtest</code></td>
</tr>
<tr>
<td><code>onCancel</code></td>
<td>Scheduled signal cancelled</td>
<td><code>symbol</code>, <code>data</code>, <code>currentPrice</code>, <code>backtest</code></td>
</tr>
<tr>
<td><code>onWrite</code></td>
<td>Signal persisted</td>
<td><code>symbol</code>, <code>data</code>, <code>backtest</code></td>
</tr>
</tbody>
</table>
<a id="registration-process" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Registration Process<a href="#registration-process" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16_Component_Registration_Functions_2.svg" alt="Mermaid Diagram"></p>
<a id="example-usage" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example Usage<a href="#example-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;rsi-oversold&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Buy when RSI &lt; 30, sell at resistance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">riskName:</span><span class="hl-1"> </span><span class="hl-2">&quot;conservative&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">when</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">rsi</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">calculateRSI</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">when</span><span class="hl-1">, </span><span class="hl-6">14</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">rsi</span><span class="hl-1"> &lt; </span><span class="hl-6">30</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">currentPrice</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getCurrentPrice</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">position:</span><span class="hl-1"> </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">priceOpen:</span><span class="hl-1"> </span><span class="hl-4">currentPrice</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">priceTakeProfit:</span><span class="hl-1"> </span><span class="hl-4">currentPrice</span><span class="hl-1"> * </span><span class="hl-6">1.02</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">priceStopLoss:</span><span class="hl-1"> </span><span class="hl-4">currentPrice</span><span class="hl-1"> * </span><span class="hl-6">0.99</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">minuteEstimatedTime:</span><span class="hl-1"> </span><span class="hl-6">60</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">`RSI oversold at </span><span class="hl-7">${</span><span class="hl-4">rsi</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-6">2</span><span class="hl-9">)</span><span class="hl-7">}</span><span class="hl-2">`</span><br/><span class="hl-1">      };</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-7">null</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onOpen</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">, </span><span class="hl-4">currentPrice</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[OPEN] </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2"> </span><span class="hl-7">${</span><span class="hl-4">data</span><span class="hl-9">.</span><span class="hl-4">position</span><span class="hl-7">}</span><span class="hl-2"> @ </span><span class="hl-7">${</span><span class="hl-4">currentPrice</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">onClose</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">, </span><span class="hl-4">priceClose</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[CLOSE] </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2"> @ </span><span class="hl-7">${</span><span class="hl-4">priceClose</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="addexchange" class="tsd-anchor"></a><h2 class="tsd-anchor-link">addExchange<a href="#addexchange" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Registers a data source that provides historical candle data and price formatting. The exchange implementation can connect to CCXT, custom APIs, databases, or any other data provider.</p>
<a id="function-signature-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Function Signature<a href="#function-signature-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">function</span><span class="hl-1"> </span><span class="hl-0">addExchange</span><span class="hl-1">(</span><span class="hl-4">exchangeSchema</span><span class="hl-1">: </span><span class="hl-13">IExchangeSchema</span><span class="hl-1">): </span><span class="hl-13">void</span>
</code><button type="button">Copy</button></pre>

<a id="schema-interface-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schema Interface<a href="#schema-interface-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">IExchangeSchema</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-13">ExchangeName</span><span class="hl-1">;          </span><span class="hl-5">// Unique identifier</span><br/><span class="hl-1">  </span><span class="hl-0">getCandles</span><span class="hl-1">: (</span><br/><span class="hl-1">    </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-13">CandleInterval</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">since</span><span class="hl-1">: </span><span class="hl-13">Date</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">limit</span><span class="hl-1">: </span><span class="hl-13">number</span><br/><span class="hl-1">  ) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-13">ICandleData</span><span class="hl-1">[]&gt;;</span><br/><span class="hl-1">  </span><span class="hl-0">formatPrice</span><span class="hl-1">: (</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">: </span><span class="hl-13">number</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-13">string</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-0">formatQuantity</span><span class="hl-1">: (</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">: </span><span class="hl-13">number</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-13">string</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks</span><span class="hl-1">?: </span><span class="hl-13">Partial</span><span class="hl-1">&lt;</span><span class="hl-13">IExchangeCallbacks</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-13">string</span><span class="hl-1">;                       </span><span class="hl-5">// Optional documentation</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="candle-data-structure" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Candle Data Structure<a href="#candle-data-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">ICandleData</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">timestamp</span><span class="hl-1">: </span><span class="hl-13">number</span><span class="hl-1">;    </span><span class="hl-5">// Unix timestamp in milliseconds</span><br/><span class="hl-1">  </span><span class="hl-4">open</span><span class="hl-1">: </span><span class="hl-13">number</span><span class="hl-1">;         </span><span class="hl-5">// Opening price</span><br/><span class="hl-1">  </span><span class="hl-4">high</span><span class="hl-1">: </span><span class="hl-13">number</span><span class="hl-1">;         </span><span class="hl-5">// Highest price in period</span><br/><span class="hl-1">  </span><span class="hl-4">low</span><span class="hl-1">: </span><span class="hl-13">number</span><span class="hl-1">;          </span><span class="hl-5">// Lowest price in period</span><br/><span class="hl-1">  </span><span class="hl-4">close</span><span class="hl-1">: </span><span class="hl-13">number</span><span class="hl-1">;        </span><span class="hl-5">// Closing price</span><br/><span class="hl-1">  </span><span class="hl-4">volume</span><span class="hl-1">: </span><span class="hl-13">number</span><span class="hl-1">;       </span><span class="hl-5">// Trading volume in period</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="candle-intervals" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Candle Intervals<a href="#candle-intervals" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Valid intervals for candle data fetching:</p>
<table>
<thead>
<tr>
<th>Interval</th>
<th>Duration</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&quot;1m&quot;</code></td>
<td>1 minute</td>
<td>VWAP calculation, fine-grained backtesting</td>
</tr>
<tr>
<td><code>&quot;3m&quot;</code></td>
<td>3 minutes</td>
<td>Short-term pattern detection</td>
</tr>
<tr>
<td><code>&quot;5m&quot;</code></td>
<td>5 minutes</td>
<td>Intraday analysis</td>
</tr>
<tr>
<td><code>&quot;15m&quot;</code></td>
<td>15 minutes</td>
<td>Standard technical analysis</td>
</tr>
<tr>
<td><code>&quot;30m&quot;</code></td>
<td>30 minutes</td>
<td>Swing trading indicators</td>
</tr>
<tr>
<td><code>&quot;1h&quot;</code></td>
<td>1 hour</td>
<td>Hourly trends</td>
</tr>
<tr>
<td><code>&quot;2h&quot;</code></td>
<td>2 hours</td>
<td>Extended timeframe analysis</td>
</tr>
<tr>
<td><code>&quot;4h&quot;</code></td>
<td>4 hours</td>
<td>Multi-hour patterns</td>
</tr>
<tr>
<td><code>&quot;6h&quot;</code></td>
<td>6 hours</td>
<td>Daily cycle analysis</td>
</tr>
<tr>
<td><code>&quot;8h&quot;</code></td>
<td>8 hours</td>
<td>Three-shift patterns</td>
</tr>
</tbody>
</table>
<a id="registration-process-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Registration Process<a href="#registration-process-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>addExchange</code> function follows the same three-stage pipeline as other registration functions:</p>
<ol>
<li><strong>Logging</strong>: Records the exchange schema in LoggerService</li>
<li><strong>Validation</strong>: ExchangeValidationService checks required methods and data structure</li>
<li><strong>Registration</strong>: ExchangeSchemaService stores schema in Map</li>
</ol>
<a id="example-usage-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example Usage<a href="#example-usage-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// CCXT Integration</span><br/><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">ccxt</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;ccxt&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">exchange</span><span class="hl-1"> = </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-4">ccxt</span><span class="hl-1">.</span><span class="hl-0">binance</span><span class="hl-1">();</span><br/><br/><span class="hl-0">addExchange</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Binance via CCXT&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getCandles</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">ohlcv</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">fetchOHLCV</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-4">symbol</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">interval</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">since</span><span class="hl-1">.</span><span class="hl-0">getTime</span><span class="hl-1">(),</span><br/><span class="hl-1">      </span><span class="hl-4">limit</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">ohlcv</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(([</span><span class="hl-4">timestamp</span><span class="hl-1">, </span><span class="hl-4">open</span><span class="hl-1">, </span><span class="hl-4">high</span><span class="hl-1">, </span><span class="hl-4">low</span><span class="hl-1">, </span><span class="hl-4">close</span><span class="hl-1">, </span><span class="hl-4">volume</span><span class="hl-1">]) </span><span class="hl-7">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">      </span><span class="hl-4">timestamp</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">open</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">high</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">low</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">close</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">volume</span><br/><span class="hl-1">    }));</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">formatPrice</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">market</span><span class="hl-1"> = </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">market</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">priceToPrecision</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">formatQuantity</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">market</span><span class="hl-1"> = </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">market</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">amountToPrecision</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Database Integration</span><br/><span class="hl-0">addExchange</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;historical-db&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;PostgreSQL historical data&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getCandles</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">rows</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">db</span><span class="hl-1">.</span><span class="hl-0">query</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-2">`SELECT * FROM candles </span><br/><span class="hl-2">       WHERE symbol = $1 AND interval = $2 </span><br/><span class="hl-2">       AND timestamp &gt;= $3 </span><br/><span class="hl-2">       ORDER BY timestamp ASC </span><br/><span class="hl-2">       LIMIT $4`</span><span class="hl-1">,</span><br/><span class="hl-1">      [</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">]</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">rows</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">row</span><span class="hl-1"> </span><span class="hl-7">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">      </span><span class="hl-4">timestamp:</span><span class="hl-1"> </span><span class="hl-4">row</span><span class="hl-1">.</span><span class="hl-4">timestamp</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">open:</span><span class="hl-1"> </span><span class="hl-0">parseFloat</span><span class="hl-1">(</span><span class="hl-4">row</span><span class="hl-1">.</span><span class="hl-4">open</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-4">high:</span><span class="hl-1"> </span><span class="hl-0">parseFloat</span><span class="hl-1">(</span><span class="hl-4">row</span><span class="hl-1">.</span><span class="hl-4">high</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-4">low:</span><span class="hl-1"> </span><span class="hl-0">parseFloat</span><span class="hl-1">(</span><span class="hl-4">row</span><span class="hl-1">.</span><span class="hl-4">low</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-4">close:</span><span class="hl-1"> </span><span class="hl-0">parseFloat</span><span class="hl-1">(</span><span class="hl-4">row</span><span class="hl-1">.</span><span class="hl-4">close</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-4">volume:</span><span class="hl-1"> </span><span class="hl-0">parseFloat</span><span class="hl-1">(</span><span class="hl-4">row</span><span class="hl-1">.</span><span class="hl-4">volume</span><span class="hl-1">)</span><br/><span class="hl-1">    }));</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">formatPrice</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-4">price</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-6">2</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-0">formatQuantity</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-4">quantity</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-6">8</span><span class="hl-1">)</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="addframe" class="tsd-anchor"></a><h2 class="tsd-anchor-link">addFrame<a href="#addframe" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Registers a timeframe definition for backtesting. The frame specifies the date range and interval for generating timestamps that drive backtest execution.</p>
<a id="function-signature-2" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Function Signature<a href="#function-signature-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">function</span><span class="hl-1"> </span><span class="hl-0">addFrame</span><span class="hl-1">(</span><span class="hl-4">frameSchema</span><span class="hl-1">: </span><span class="hl-13">IFrameSchema</span><span class="hl-1">): </span><span class="hl-13">void</span>
</code><button type="button">Copy</button></pre>

<a id="schema-interface-2" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schema Interface<a href="#schema-interface-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">IFrameSchema</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">frameName</span><span class="hl-1">: </span><span class="hl-13">FrameName</span><span class="hl-1">;              </span><span class="hl-5">// Unique identifier</span><br/><span class="hl-1">  </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-13">FrameInterval</span><span class="hl-1">;           </span><span class="hl-5">// Timestamp generation interval</span><br/><span class="hl-1">  </span><span class="hl-4">startDate</span><span class="hl-1">: </span><span class="hl-13">Date</span><span class="hl-1">;                   </span><span class="hl-5">// Backtest start (inclusive)</span><br/><span class="hl-1">  </span><span class="hl-4">endDate</span><span class="hl-1">: </span><span class="hl-13">Date</span><span class="hl-1">;                     </span><span class="hl-5">// Backtest end (inclusive)</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks</span><span class="hl-1">?: </span><span class="hl-13">Partial</span><span class="hl-1">&lt;</span><span class="hl-13">IFrameCallbacks</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-13">string</span><span class="hl-1">;                     </span><span class="hl-5">// Optional documentation</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="frame-intervals" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Frame Intervals<a href="#frame-intervals" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Valid intervals for timeframe generation:</p>
<table>
<thead>
<tr>
<th>Interval</th>
<th>Duration</th>
<th>Timestamps Generated</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&quot;1m&quot;</code></td>
<td>1 minute</td>
<td>Every minute in range</td>
</tr>
<tr>
<td><code>&quot;3m&quot;</code></td>
<td>3 minutes</td>
<td>Every 3rd minute</td>
</tr>
<tr>
<td><code>&quot;5m&quot;</code></td>
<td>5 minutes</td>
<td>Every 5th minute</td>
</tr>
<tr>
<td><code>&quot;15m&quot;</code></td>
<td>15 minutes</td>
<td>Every 15th minute</td>
</tr>
<tr>
<td><code>&quot;30m&quot;</code></td>
<td>30 minutes</td>
<td>Every 30th minute</td>
</tr>
<tr>
<td><code>&quot;1h&quot;</code></td>
<td>1 hour</td>
<td>Every hour</td>
</tr>
<tr>
<td><code>&quot;2h&quot;</code></td>
<td>2 hours</td>
<td>Every 2nd hour</td>
</tr>
<tr>
<td><code>&quot;4h&quot;</code></td>
<td>4 hours</td>
<td>Every 4th hour</td>
</tr>
<tr>
<td><code>&quot;6h&quot;</code></td>
<td>6 hours</td>
<td>Every 6th hour</td>
</tr>
<tr>
<td><code>&quot;8h&quot;</code></td>
<td>8 hours</td>
<td>Every 8th hour</td>
</tr>
<tr>
<td><code>&quot;12h&quot;</code></td>
<td>12 hours</td>
<td>Every 12th hour</td>
</tr>
<tr>
<td><code>&quot;1d&quot;</code></td>
<td>1 day</td>
<td>Daily at midnight UTC</td>
</tr>
<tr>
<td><code>&quot;3d&quot;</code></td>
<td>3 days</td>
<td>Every 3rd day</td>
</tr>
</tbody>
</table>
<a id="timeframe-generation-process" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Timeframe Generation Process<a href="#timeframe-generation-process" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16_Component_Registration_Functions_3.svg" alt="Mermaid Diagram"></p>
<a id="example-usage-2" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example Usage<a href="#example-usage-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// Single day backtest with 1-minute granularity</span><br/><span class="hl-0">addFrame</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-minute&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;1m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-01T00:00:00Z&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-02T00:00:00Z&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;24 hours at 1-minute intervals = 1440 ticks&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onTimeframe</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">timeframe</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Generated </span><span class="hl-7">${</span><span class="hl-4">timeframe</span><span class="hl-9">.</span><span class="hl-4">length</span><span class="hl-7">}</span><span class="hl-2"> timestamps`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`First: </span><span class="hl-7">${</span><span class="hl-4">timeframe</span><span class="hl-9">[</span><span class="hl-6">0</span><span class="hl-9">].</span><span class="hl-0">toISOString</span><span class="hl-9">()</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Last: </span><span class="hl-7">${</span><span class="hl-4">timeframe</span><span class="hl-9">[</span><span class="hl-4">timeframe</span><span class="hl-9">.</span><span class="hl-4">length</span><span class="hl-9"> </span><span class="hl-1">-</span><span class="hl-9"> </span><span class="hl-6">1</span><span class="hl-9">].</span><span class="hl-0">toISOString</span><span class="hl-9">()</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Monthly backtest with 1-hour granularity</span><br/><span class="hl-0">addFrame</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;jan-2024&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;1h&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-01T00:00:00Z&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-31T23:59:59Z&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;January 2024 at hourly intervals&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Training period for optimizer</span><br/><span class="hl-0">addFrame</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;training-q1&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;15m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-01T00:00:00Z&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-03-31T23:59:59Z&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Q1 2024 training data&quot;</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="addwalker" class="tsd-anchor"></a><h2 class="tsd-anchor-link">addWalker<a href="#addwalker" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Registers a walker configuration that compares multiple strategies on the same historical data. Walkers execute strategies sequentially and rank them by a specified metric.</p>
<a id="function-signature-3" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Function Signature<a href="#function-signature-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">function</span><span class="hl-1"> </span><span class="hl-0">addWalker</span><span class="hl-1">(</span><span class="hl-4">walkerSchema</span><span class="hl-1">: </span><span class="hl-13">IWalkerSchema</span><span class="hl-1">): </span><span class="hl-13">void</span>
</code><button type="button">Copy</button></pre>

<a id="schema-interface-3" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schema Interface<a href="#schema-interface-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">IWalkerSchema</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">walkerName</span><span class="hl-1">: </span><span class="hl-13">WalkerName</span><span class="hl-1">;              </span><span class="hl-5">// Unique identifier</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-13">ExchangeName</span><span class="hl-1">;          </span><span class="hl-5">// Exchange for all strategies</span><br/><span class="hl-1">  </span><span class="hl-4">frameName</span><span class="hl-1">: </span><span class="hl-13">FrameName</span><span class="hl-1">;                </span><span class="hl-5">// Frame for all strategies</span><br/><span class="hl-1">  </span><span class="hl-4">strategies</span><span class="hl-1">: </span><span class="hl-13">StrategyName</span><span class="hl-1">[];          </span><span class="hl-5">// Strategies to compare</span><br/><span class="hl-1">  </span><span class="hl-4">metric</span><span class="hl-1">?: </span><span class="hl-13">WalkerMetric</span><span class="hl-1">;               </span><span class="hl-5">// Ranking metric (default: sharpeRatio)</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks</span><span class="hl-1">?: </span><span class="hl-13">Partial</span><span class="hl-1">&lt;</span><span class="hl-13">IWalkerCallbacks</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-13">string</span><span class="hl-1">;                       </span><span class="hl-5">// Optional documentation</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="walker-metrics" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Walker Metrics<a href="#walker-metrics" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Metrics available for strategy comparison:</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Full Name</th>
<th>Description</th>
<th>Formula</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sharpeRatio</code></td>
<td>Sharpe Ratio</td>
<td>Risk-adjusted returns</td>
<td><code>mean(returns) / stddev(returns)</code></td>
</tr>
<tr>
<td><code>annualizedSharpe</code></td>
<td>Annualized Sharpe</td>
<td>Annualized risk-adjusted returns</td>
<td><code>sharpeRatio * sqrt(periods_per_year)</code></td>
</tr>
<tr>
<td><code>winRate</code></td>
<td>Win Rate</td>
<td>Percentage of profitable signals</td>
<td><code>wins / total_signals * 100</code></td>
</tr>
<tr>
<td><code>avgPnl</code></td>
<td>Average PnL</td>
<td>Mean profit/loss per signal</td>
<td><code>sum(pnl) / total_signals</code></td>
</tr>
<tr>
<td><code>totalPnl</code></td>
<td>Total PnL</td>
<td>Cumulative profit/loss</td>
<td><code>sum(all_pnl)</code></td>
</tr>
<tr>
<td><code>certaintyRatio</code></td>
<td>Certainty Ratio</td>
<td>Win rate weighted by magnitude</td>
<td><code>(wins - losses) / total_signals</code></td>
</tr>
</tbody>
</table>
<a id="walker-execution-flow" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Walker Execution Flow<a href="#walker-execution-flow" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16_Component_Registration_Functions_4.svg" alt="Mermaid Diagram"></p>
<a id="example-usage-3" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example Usage<a href="#example-usage-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// Compare 3 RSI variants</span><br/><span class="hl-0">addWalker</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">walkerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;rsi-optimization&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;jan-2024&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">strategies:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;rsi-14-oversold&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;rsi-21-oversold&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;rsi-28-oversold&quot;</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-4">metric:</span><span class="hl-1"> </span><span class="hl-2">&quot;sharpeRatio&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Find optimal RSI period&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onStrategyComplete</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">stats</span><span class="hl-1">, </span><span class="hl-4">metric</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`</span><span class="hl-7">${</span><span class="hl-4">strategyName</span><span class="hl-7">}</span><span class="hl-2">: Sharpe=</span><span class="hl-7">${</span><span class="hl-4">metric</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-6">3</span><span class="hl-9">)</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">onComplete</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">results</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Winner: </span><span class="hl-7">${</span><span class="hl-4">results</span><span class="hl-9">.</span><span class="hl-4">bestStrategy</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Best Sharpe: </span><span class="hl-7">${</span><span class="hl-4">results</span><span class="hl-9">.</span><span class="hl-4">bestMetric</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-6">3</span><span class="hl-9">)</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Compare different strategy types</span><br/><span class="hl-0">addWalker</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">walkerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;strategy-comparison&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-minute&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">strategies:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;mean-reversion&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;momentum-breakout&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;bollinger-bands&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;macd-crossover&quot;</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-4">metric:</span><span class="hl-1"> </span><span class="hl-2">&quot;winRate&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Compare strategy families&quot;</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="addsizing" class="tsd-anchor"></a><h2 class="tsd-anchor-link">addSizing<a href="#addsizing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Registers a position sizing configuration that calculates trade quantities based on account balance, risk parameters, and market conditions. Supports fixed-percentage, Kelly criterion, and ATR-based methods.</p>
<a id="function-signature-4" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Function Signature<a href="#function-signature-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">function</span><span class="hl-1"> </span><span class="hl-0">addSizing</span><span class="hl-1">(</span><span class="hl-4">sizingSchema</span><span class="hl-1">: </span><span class="hl-13">ISizingSchema</span><span class="hl-1">): </span><span class="hl-13">void</span>
</code><button type="button">Copy</button></pre>

<a id="schema-interface-discriminated-union" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schema Interface (Discriminated Union)<a href="#schema-interface-discriminated-union" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">type</span><span class="hl-1"> </span><span class="hl-13">ISizingSchema</span><span class="hl-1"> =</span><br/><span class="hl-1">  | </span><span class="hl-13">ISizingSchemaFixedPercentage</span><br/><span class="hl-1">  | </span><span class="hl-13">ISizingSchemaKellyCriterion</span><br/><span class="hl-1">  | </span><span class="hl-13">ISizingSchemaATRBased</span><span class="hl-1">;</span><br/><br/><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">ISizingSchemaFixedPercentage</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">sizingName</span><span class="hl-1">: </span><span class="hl-13">SizingName</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">method</span><span class="hl-1">: </span><span class="hl-2">&quot;fixed-percentage&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">riskPercentage</span><span class="hl-1">: </span><span class="hl-13">number</span><span class="hl-1">;              </span><span class="hl-5">// % of account to risk per trade</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionPercentage</span><span class="hl-1">?: </span><span class="hl-13">number</span><span class="hl-1">;      </span><span class="hl-5">// Max % of account per position</span><br/><span class="hl-1">  </span><span class="hl-4">minPositionSize</span><span class="hl-1">?: </span><span class="hl-13">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionSize</span><span class="hl-1">?: </span><span class="hl-13">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks</span><span class="hl-1">?: </span><span class="hl-13">Partial</span><span class="hl-1">&lt;</span><span class="hl-13">ISizingCallbacks</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-13">string</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">ISizingSchemaKellyCriterion</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">sizingName</span><span class="hl-1">: </span><span class="hl-13">SizingName</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">method</span><span class="hl-1">: </span><span class="hl-2">&quot;kelly-criterion&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">kellyMultiplier</span><span class="hl-1">?: </span><span class="hl-13">number</span><span class="hl-1">;            </span><span class="hl-5">// Fraction of Kelly (default: 0.25)</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionPercentage</span><span class="hl-1">?: </span><span class="hl-13">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">minPositionSize</span><span class="hl-1">?: </span><span class="hl-13">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionSize</span><span class="hl-1">?: </span><span class="hl-13">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks</span><span class="hl-1">?: </span><span class="hl-13">Partial</span><span class="hl-1">&lt;</span><span class="hl-13">ISizingCallbacks</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-13">string</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">ISizingSchemaATRBased</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">sizingName</span><span class="hl-1">: </span><span class="hl-13">SizingName</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">method</span><span class="hl-1">: </span><span class="hl-2">&quot;atr-based&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">riskPercentage</span><span class="hl-1">: </span><span class="hl-13">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">atrMultiplier</span><span class="hl-1">?: </span><span class="hl-13">number</span><span class="hl-1">;              </span><span class="hl-5">// ATR multiplier for stop distance (default: 2)</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionPercentage</span><span class="hl-1">?: </span><span class="hl-13">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">minPositionSize</span><span class="hl-1">?: </span><span class="hl-13">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionSize</span><span class="hl-1">?: </span><span class="hl-13">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks</span><span class="hl-1">?: </span><span class="hl-13">Partial</span><span class="hl-1">&lt;</span><span class="hl-13">ISizingCallbacks</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-13">string</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="sizing-method-comparison" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Sizing Method Comparison<a href="#sizing-method-comparison" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16_Component_Registration_Functions_5.svg" alt="Mermaid Diagram"></p>
<a id="example-usage-4" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example Usage<a href="#example-usage-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// Fixed percentage risk</span><br/><span class="hl-0">addSizing</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;fixed-2pct&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-2">&quot;fixed-percentage&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">riskPercentage:</span><span class="hl-1"> </span><span class="hl-6">2</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionPercentage:</span><span class="hl-1"> </span><span class="hl-6">10</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Risk 2% per trade, max 10% position&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Kelly criterion with fractional Kelly</span><br/><span class="hl-0">addSizing</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;quarter-kelly&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-2">&quot;kelly-criterion&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">kellyMultiplier:</span><span class="hl-1"> </span><span class="hl-6">0.25</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionPercentage:</span><span class="hl-1"> </span><span class="hl-6">20</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Conservative Kelly sizing&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onCalculate</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">quantity</span><span class="hl-1">, </span><span class="hl-4">params</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Kelly size: </span><span class="hl-7">${</span><span class="hl-4">quantity</span><span class="hl-7">}</span><span class="hl-2"> for </span><span class="hl-7">${</span><span class="hl-4">params</span><span class="hl-9">.</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// ATR-based dynamic sizing</span><br/><span class="hl-0">addSizing</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;atr-dynamic&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-2">&quot;atr-based&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">riskPercentage:</span><span class="hl-1"> </span><span class="hl-6">1.5</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">atrMultiplier:</span><span class="hl-1"> </span><span class="hl-6">2</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">minPositionSize:</span><span class="hl-1"> </span><span class="hl-6">0.001</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionSize:</span><span class="hl-1"> </span><span class="hl-6">10</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Use 2ATR for stop distance&quot;</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="addrisk" class="tsd-anchor"></a><h2 class="tsd-anchor-link">addRisk<a href="#addrisk" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Registers a risk management profile that validates signals before execution. Supports maximum concurrent position limits and custom validation functions with access to portfolio state.</p>
<a id="function-signature-5" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Function Signature<a href="#function-signature-5" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">function</span><span class="hl-1"> </span><span class="hl-0">addRisk</span><span class="hl-1">(</span><span class="hl-4">riskSchema</span><span class="hl-1">: </span><span class="hl-13">IRiskSchema</span><span class="hl-1">): </span><span class="hl-13">void</span>
</code><button type="button">Copy</button></pre>

<a id="schema-interface-4" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schema Interface<a href="#schema-interface-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">IRiskSchema</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">riskName</span><span class="hl-1">: </span><span class="hl-13">RiskName</span><span class="hl-1">;                  </span><span class="hl-5">// Unique identifier</span><br/><span class="hl-1">  </span><span class="hl-4">validations</span><span class="hl-1">: (</span><span class="hl-13">IRiskValidation</span><span class="hl-1"> | </span><span class="hl-13">IRiskValidationFn</span><span class="hl-1">)[];</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks</span><span class="hl-1">?: </span><span class="hl-13">Partial</span><span class="hl-1">&lt;</span><span class="hl-13">IRiskCallbacks</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-13">string</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">IRiskValidation</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">validate</span><span class="hl-1">: </span><span class="hl-13">IRiskValidationFn</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-13">string</span><span class="hl-1">;                       </span><span class="hl-5">// Documentation for validation</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-7">type</span><span class="hl-1"> </span><span class="hl-13">IRiskValidationFn</span><span class="hl-1"> = (</span><br/><span class="hl-1">  </span><span class="hl-4">payload</span><span class="hl-1">: </span><span class="hl-13">IRiskValidationPayload</span><br/><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">void</span><span class="hl-1"> | </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-13">void</span><span class="hl-1">&gt;;             </span><span class="hl-5">// Throws error on rejection</span><br/><br/><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">IRiskValidationPayload</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-13">StrategyName</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-13">ExchangeName</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">currentPrice</span><span class="hl-1">: </span><span class="hl-13">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">timestamp</span><span class="hl-1">: </span><span class="hl-13">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">activePositionCount</span><span class="hl-1">: </span><span class="hl-13">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">activePositions</span><span class="hl-1">: </span><span class="hl-13">IRiskActivePosition</span><span class="hl-1">[];</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="risk-validation-flow" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Risk Validation Flow<a href="#risk-validation-flow" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16_Component_Registration_Functions_6.svg" alt="Mermaid Diagram"></p>
<a id="example-usage-5" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example Usage<a href="#example-usage-5" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// Simple concurrent position limit</span><br/><span class="hl-0">addRisk</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">riskName:</span><span class="hl-1"> </span><span class="hl-2">&quot;basic-limit&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">validations:</span><span class="hl-1"> [</span><br/><span class="hl-1">    ({ </span><span class="hl-4">activePositionCount</span><span class="hl-1"> }) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">activePositionCount</span><span class="hl-1"> &gt;= </span><span class="hl-6">5</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">throw</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><span class="hl-2">&quot;Maximum 5 concurrent positions&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onRejected</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">params</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[RISK] Rejected </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2">: Too many positions`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Advanced portfolio risk management</span><br/><span class="hl-0">addRisk</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">riskName:</span><span class="hl-1"> </span><span class="hl-2">&quot;advanced-portfolio&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">validations:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-5">// Max concurrent positions</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-0">validate</span><span class="hl-4">:</span><span class="hl-1"> ({ </span><span class="hl-4">activePositionCount</span><span class="hl-1"> }) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">activePositionCount</span><span class="hl-1"> &gt;= </span><span class="hl-6">10</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-3">throw</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><span class="hl-2">&quot;Max 10 positions&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">      </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Global position limit&quot;</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-5">// Max exposure per symbol</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-0">validate</span><span class="hl-4">:</span><span class="hl-1"> ({ </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">activePositions</span><span class="hl-1"> }) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">symbolPositions</span><span class="hl-1"> = </span><span class="hl-4">activePositions</span><span class="hl-1">.</span><span class="hl-0">filter</span><span class="hl-1">(</span><br/><span class="hl-1">          </span><span class="hl-4">pos</span><span class="hl-1"> </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-4">pos</span><span class="hl-1">.</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1"> === </span><span class="hl-4">symbol</span><br/><span class="hl-1">        );</span><br/><span class="hl-1">        </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">symbolPositions</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1"> &gt;= </span><span class="hl-6">2</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-3">throw</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><span class="hl-2">`Max 2 positions for </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">      </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Symbol concentration limit&quot;</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-5">// Portfolio drawdown check</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-0">validate</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> ({ </span><span class="hl-4">activePositions</span><span class="hl-1">, </span><span class="hl-4">currentPrice</span><span class="hl-1"> }) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">unrealizedPnL</span><span class="hl-1"> = </span><span class="hl-4">activePositions</span><span class="hl-1">.</span><span class="hl-0">reduce</span><span class="hl-1">((</span><span class="hl-4">sum</span><span class="hl-1">, </span><span class="hl-4">pos</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">pnl</span><span class="hl-1"> = </span><span class="hl-0">calculatePnL</span><span class="hl-1">(</span><span class="hl-4">pos</span><span class="hl-1">.</span><span class="hl-4">signal</span><span class="hl-1">, </span><span class="hl-4">currentPrice</span><span class="hl-1">);</span><br/><span class="hl-1">          </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">sum</span><span class="hl-1"> + </span><span class="hl-4">pnl</span><span class="hl-1">;</span><br/><span class="hl-1">        }, </span><span class="hl-6">0</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><br/><span class="hl-1">        </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">unrealizedPnL</span><span class="hl-1"> &lt; -</span><span class="hl-6">5000</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-3">throw</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><span class="hl-2">&quot;Portfolio drawdown exceeds $5,000&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">      </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Drawdown circuit breaker&quot;</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-5">// Time-based filter</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-0">validate</span><span class="hl-4">:</span><span class="hl-1"> ({ </span><span class="hl-4">timestamp</span><span class="hl-1"> }) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">hour</span><span class="hl-1"> = </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-4">timestamp</span><span class="hl-1">).</span><span class="hl-0">getUTCHours</span><span class="hl-1">();</span><br/><span class="hl-1">        </span><span class="hl-5">// Avoid trading during low liquidity hours</span><br/><span class="hl-1">        </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">hour</span><span class="hl-1"> &gt;= </span><span class="hl-6">0</span><span class="hl-1"> &amp;&amp; </span><span class="hl-4">hour</span><span class="hl-1"> &lt; </span><span class="hl-6">6</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-3">throw</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><span class="hl-2">&quot;No trading during 00:00-06:00 UTC&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">      </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Avoid low liquidity periods&quot;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  ]</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="addoptimizer" class="tsd-anchor"></a><h2 class="tsd-anchor-link">addOptimizer<a href="#addoptimizer" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Registers an AI-powered optimizer that generates trading strategies by analyzing historical data with LLM assistance. The optimizer collects multi-timeframe data, builds conversation history, and generates executable strategy code.</p>
<a id="function-signature-6" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Function Signature<a href="#function-signature-6" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">function</span><span class="hl-1"> </span><span class="hl-0">addOptimizer</span><span class="hl-1">(</span><span class="hl-4">optimizerSchema</span><span class="hl-1">: </span><span class="hl-13">IOptimizerSchema</span><span class="hl-1">): </span><span class="hl-13">void</span>
</code><button type="button">Copy</button></pre>

<a id="schema-interface-5" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schema Interface<a href="#schema-interface-5" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">IOptimizerSchema</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">optimizerName</span><span class="hl-1">: </span><span class="hl-13">OptimizerName</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">rangeTrain</span><span class="hl-1">: </span><span class="hl-13">IOptimizerRange</span><span class="hl-1">[];       </span><span class="hl-5">// Training periods</span><br/><span class="hl-1">  </span><span class="hl-4">rangeTest</span><span class="hl-1">: </span><span class="hl-13">IOptimizerRange</span><span class="hl-1">;          </span><span class="hl-5">// Validation period</span><br/><span class="hl-1">  </span><span class="hl-4">source</span><span class="hl-1">: (</span><span class="hl-13">IOptimizerSource</span><span class="hl-1"> | </span><span class="hl-13">IOptimizerSourceFn</span><span class="hl-1">)[];</span><br/><span class="hl-1">  </span><span class="hl-0">getPrompt</span><span class="hl-1">: (</span><br/><span class="hl-1">    </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">messages</span><span class="hl-1">: </span><span class="hl-13">IOptimizerMessage</span><span class="hl-1">[]</span><br/><span class="hl-1">  ) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-13">string</span><span class="hl-1">&gt;;                </span><span class="hl-5">// Generate strategy prompt</span><br/><span class="hl-1">  </span><span class="hl-4">template</span><span class="hl-1">?: </span><span class="hl-13">Partial</span><span class="hl-1">&lt;</span><span class="hl-13">IOptimizerTemplate</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks</span><span class="hl-1">?: </span><span class="hl-13">Partial</span><span class="hl-1">&lt;</span><span class="hl-13">IOptimizerCallbacks</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-13">string</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">IOptimizerRange</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-13">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">startDate</span><span class="hl-1">: </span><span class="hl-13">Date</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">endDate</span><span class="hl-1">: </span><span class="hl-13">Date</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">IOptimizerSource</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">fetch</span><span class="hl-1">: </span><span class="hl-13">IOptimizerFetchFn</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">user</span><span class="hl-1">: </span><span class="hl-13">IOptimizerMessageFormatterFn</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">assistant</span><span class="hl-1">: </span><span class="hl-13">IOptimizerMessageFormatterFn</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-7">type</span><span class="hl-1"> </span><span class="hl-13">IOptimizerSourceFn</span><span class="hl-1"> = (</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">startDate</span><span class="hl-1">: </span><span class="hl-13">Date</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">endDate</span><span class="hl-1">: </span><span class="hl-13">Date</span><br/><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-13">IOptimizerMessage</span><span class="hl-1">[]&gt;;</span>
</code><button type="button">Copy</button></pre>

<a id="optimizer-data-collection-pipeline" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Optimizer Data Collection Pipeline<a href="#optimizer-data-collection-pipeline" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16_Component_Registration_Functions_7.svg" alt="Mermaid Diagram"></p>
<a id="example-usage-6" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example Usage<a href="#example-usage-6" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// Basic optimizer with single source</span><br/><span class="hl-0">addOptimizer</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">optimizerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;rsi-generator&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">rangeTrain:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Bull market training&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-01&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-31&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Bear market training&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-02-01&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-02-28&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-4">rangeTest:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Validation period&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-03-01&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">    </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-03-31&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-4">source:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">data</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">fetchCandleData</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-2">&quot;1h&quot;</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">rsi</span><span class="hl-1"> = </span><span class="hl-0">calculateRSI</span><span class="hl-1">(</span><span class="hl-4">data</span><span class="hl-1">, </span><span class="hl-6">14</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><br/><span class="hl-1">      </span><span class="hl-3">return</span><span class="hl-1"> [</span><br/><span class="hl-1">        {</span><br/><span class="hl-1">          </span><span class="hl-4">role:</span><span class="hl-1"> </span><span class="hl-2">&quot;user&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-4">content:</span><span class="hl-1"> </span><span class="hl-2">`Analyze </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2"> RSI data from </span><span class="hl-7">${</span><span class="hl-4">startDate</span><span class="hl-7">}</span><span class="hl-2"> to </span><span class="hl-7">${</span><span class="hl-4">endDate</span><span class="hl-7">}</span><span class="hl-2">:</span><span class="hl-12">\n</span><span class="hl-7">${</span><span class="hl-0">formatRSIData</span><span class="hl-9">(</span><span class="hl-4">rsi</span><span class="hl-9">)</span><span class="hl-7">}</span><span class="hl-2">`</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">        {</span><br/><span class="hl-1">          </span><span class="hl-4">role:</span><span class="hl-1"> </span><span class="hl-2">&quot;assistant&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-4">content:</span><span class="hl-1"> </span><span class="hl-2">&quot;RSI data analyzed. Ready for strategy generation.&quot;</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      ];</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-0">getPrompt</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">messages</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">`Generate a trading strategy for </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2"> based on RSI indicator. </span><br/><span class="hl-2">            Use RSI &lt; 30 for buy signals and RSI &gt; 70 for sell signals.</span><br/><span class="hl-2">            Set take profit at 2% and stop loss at 1%.`</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onData</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyData</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Generated </span><span class="hl-7">${</span><span class="hl-4">strategyData</span><span class="hl-9">.</span><span class="hl-4">length</span><span class="hl-7">}</span><span class="hl-2"> strategies`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">onCode</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">code</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Generated </span><span class="hl-7">${</span><span class="hl-4">code</span><span class="hl-9">.</span><span class="hl-4">length</span><span class="hl-7">}</span><span class="hl-2"> chars of code`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">onDump</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">filepath</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Saved to </span><span class="hl-7">${</span><span class="hl-4">filepath</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Advanced optimizer with multiple sources</span><br/><span class="hl-0">addOptimizer</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">optimizerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;multi-timeframe-llm&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">rangeTrain:</span><span class="hl-1"> [</span><br/><span class="hl-1">    { </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-01&quot;</span><span class="hl-1">), </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-15&quot;</span><span class="hl-1">) },</span><br/><span class="hl-1">    { </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-16&quot;</span><span class="hl-1">), </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-31&quot;</span><span class="hl-1">) }</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-4">rangeTest:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-02-01&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">    </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-02-29&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-4">source:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;1h-candles&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">fetch</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> ({ </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">, </span><span class="hl-4">offset</span><span class="hl-1"> }) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">fetchCandles</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-2">&quot;1h&quot;</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">);</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">      </span><span class="hl-0">user</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">, </span><span class="hl-4">name</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">`1-hour candles for </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2">:</span><span class="hl-12">\n</span><span class="hl-7">${</span><span class="hl-0">formatCandles</span><span class="hl-9">(</span><span class="hl-4">data</span><span class="hl-9">)</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">;</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">      </span><span class="hl-0">assistant</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">, </span><span class="hl-4">name</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">&quot;1-hour data processed.&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;15m-candles&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">fetch</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> ({ </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">, </span><span class="hl-4">offset</span><span class="hl-1"> }) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">fetchCandles</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-2">&quot;15m&quot;</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">);</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">      </span><span class="hl-0">user</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">, </span><span class="hl-4">name</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">`15-minute candles for </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2">:</span><span class="hl-12">\n</span><span class="hl-7">${</span><span class="hl-0">formatCandles</span><span class="hl-9">(</span><span class="hl-4">data</span><span class="hl-9">)</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">;</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">      </span><span class="hl-0">assistant</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">, </span><span class="hl-4">name</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">&quot;15-minute data processed.&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-0">getPrompt</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">messages</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">llmResponse</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">callLLM</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-4">model:</span><span class="hl-1"> </span><span class="hl-2">&quot;gpt-4&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">messages:</span><span class="hl-1"> [</span><br/><span class="hl-1">        { </span><span class="hl-4">role:</span><span class="hl-1"> </span><span class="hl-2">&quot;system&quot;</span><span class="hl-1">, </span><span class="hl-4">content:</span><span class="hl-1"> </span><span class="hl-2">&quot;You are a trading strategy expert.&quot;</span><span class="hl-1"> },</span><br/><span class="hl-1">        ...</span><span class="hl-4">messages</span><span class="hl-1">,</span><br/><span class="hl-1">        { </span><span class="hl-4">role:</span><span class="hl-1"> </span><span class="hl-2">&quot;user&quot;</span><span class="hl-1">, </span><span class="hl-4">content:</span><span class="hl-1"> </span><span class="hl-2">`Generate a trading strategy for </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1"> }</span><br/><span class="hl-1">      ]</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">llmResponse</span><span class="hl-1">.</span><span class="hl-4">content</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="service-dependencies" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Service Dependencies<a href="#service-dependencies" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The registration functions depend on two service categories that are injected via the dependency injection container.</p>
<a id="service-dependency-diagram" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Service Dependency Diagram<a href="#service-dependency-diagram" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16_Component_Registration_Functions_8.svg" alt="Mermaid Diagram"></p>
<a id="dependency-injection-registration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Dependency Injection Registration<a href="#dependency-injection-registration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>All services used by registration functions are registered in the DI container at startup:</p>
<table>
<thead>
<tr>
<th>Service Category</th>
<th>Registration Location</th>
<th>Service Count</th>
</tr>
</thead>
<tbody>
<tr>
<td>Validation Services</td>
<td><a href="">src/lib/core/provide.ts:119-127</a></td>
<td>7 services</td>
</tr>
<tr>
<td>Schema Services</td>
<td><a href="">src/lib/core/provide.ts:71-79</a></td>
<td>7 services</td>
</tr>
<tr>
<td>Logger Service</td>
<td><a href="">src/lib/core/provide.ts:53</a></td>
<td>1 service</td>
</tr>
</tbody>
</table>
<hr>
<a id="validation-process" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Validation Process<a href="#validation-process" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Each registration function invokes a corresponding validation service that checks schema integrity before storage. Validation failures throw descriptive errors that prevent registration.</p>
<a id="validation-service-methods" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Validation Service Methods<a href="#validation-service-methods" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>All validation services implement an <code>add*</code> method that performs schema validation:</p>
<pre><code class="typescript"><span class="hl-7">class</span><span class="hl-1"> </span><span class="hl-13">StrategyValidationService</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">addStrategy</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-13">StrategyName</span><span class="hl-1">, </span><span class="hl-4">schema</span><span class="hl-1">: </span><span class="hl-13">IStrategySchema</span><span class="hl-1">): </span><span class="hl-13">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// Throws error if validation fails</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-7">class</span><span class="hl-1"> </span><span class="hl-13">ExchangeValidationService</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">addExchange</span><span class="hl-1">(</span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-13">ExchangeName</span><span class="hl-1">, </span><span class="hl-4">schema</span><span class="hl-1">: </span><span class="hl-13">IExchangeSchema</span><span class="hl-1">): </span><span class="hl-13">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// Throws error if validation fails</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Similar pattern for Frame, Walker, Sizing, Risk, Optimizer</span>
</code><button type="button">Copy</button></pre>

<a id="common-validation-checks" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Common Validation Checks<a href="#common-validation-checks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Check Type</th>
<th>Validation</th>
<th>Example Error</th>
</tr>
</thead>
<tbody>
<tr>
<td>Required Fields</td>
<td>Name, interval, functions present</td>
<td><code>&quot;strategyName is required&quot;</code></td>
</tr>
<tr>
<td>Type Validation</td>
<td>Functions are functions, dates are dates</td>
<td><code>&quot;getSignal must be a function&quot;</code></td>
</tr>
<tr>
<td>Value Constraints</td>
<td>Intervals valid, dates chronological</td>
<td><code>&quot;interval must be one of: 1m, 3m, 5m, ...&quot;</code></td>
</tr>
<tr>
<td>Cross-Reference</td>
<td>Referenced names exist</td>
<td><code>&quot;riskName 'advanced' not found&quot;</code></td>
</tr>
<tr>
<td>Logic Validation</td>
<td>TP/SL relationships, time ranges</td>
<td><code>&quot;startDate must be before endDate&quot;</code></td>
</tr>
<tr>
<td>Duplicate Prevention</td>
<td>No duplicate names</td>
<td><code>&quot;strategyName 'my-strategy' already registered&quot;</code></td>
</tr>
</tbody>
</table>
<hr>
<a id="schema-storage-and-retrieval" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Schema Storage and Retrieval<a href="#schema-storage-and-retrieval" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>After successful validation, schemas are stored in schema services that maintain in-memory registries. These registries are queried during execution to retrieve component configurations.</p>
<a id="schema-service-interface" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schema Service Interface<a href="#schema-service-interface" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>All schema services implement a consistent interface:</p>
<pre><code class="typescript"><span class="hl-7">class</span><span class="hl-1"> </span><span class="hl-13">SchemaService</span><span class="hl-1">&lt;</span><span class="hl-13">T</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">  </span><span class="hl-7">private</span><span class="hl-1"> </span><span class="hl-4">_registry</span><span class="hl-1">: </span><span class="hl-13">Map</span><span class="hl-1">&lt;</span><span class="hl-13">string</span><span class="hl-1">, </span><span class="hl-13">T</span><span class="hl-1">&gt; = </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Map</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-0">register</span><span class="hl-1">(</span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">, </span><span class="hl-4">schema</span><span class="hl-1">: </span><span class="hl-13">T</span><span class="hl-1">): </span><span class="hl-13">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_registry</span><span class="hl-1">.</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-4">name</span><span class="hl-1">, </span><span class="hl-4">schema</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">): </span><span class="hl-13">T</span><span class="hl-1"> | </span><span class="hl-13">undefined</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_registry</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-4">name</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-0">has</span><span class="hl-1">(</span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">): </span><span class="hl-13">boolean</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_registry</span><span class="hl-1">.</span><span class="hl-0">has</span><span class="hl-1">(</span><span class="hl-4">name</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-0">getAll</span><span class="hl-1">(): </span><span class="hl-13">T</span><span class="hl-1">[] {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">Array</span><span class="hl-1">.</span><span class="hl-0">from</span><span class="hl-1">(</span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_registry</span><span class="hl-1">.</span><span class="hl-0">values</span><span class="hl-1">());</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="registry-access-pattern" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Registry Access Pattern<a href="#registry-access-pattern" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16_Component_Registration_Functions_9.svg" alt="Mermaid Diagram"></p>
<a id="registration-summary-table" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Registration Summary Table<a href="#registration-summary-table" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Component</th>
<th>Add Function</th>
<th>Schema Service</th>
<th>Connection Service</th>
<th>Client Class</th>
</tr>
</thead>
<tbody>
<tr>
<td>Strategy</td>
<td><code>addStrategy()</code></td>
<td><code>StrategySchemaService</code></td>
<td><code>StrategyConnectionService</code></td>
<td><code>ClientStrategy</code></td>
</tr>
<tr>
<td>Exchange</td>
<td><code>addExchange()</code></td>
<td><code>ExchangeSchemaService</code></td>
<td><code>ExchangeConnectionService</code></td>
<td><code>ClientExchange</code></td>
</tr>
<tr>
<td>Frame</td>
<td><code>addFrame()</code></td>
<td><code>FrameSchemaService</code></td>
<td><code>FrameConnectionService</code></td>
<td><code>ClientFrame</code></td>
</tr>
<tr>
<td>Walker</td>
<td><code>addWalker()</code></td>
<td><code>WalkerSchemaService</code></td>
<td>N/A (logic service)</td>
<td>N/A</td>
</tr>
<tr>
<td>Sizing</td>
<td><code>addSizing()</code></td>
<td><code>SizingSchemaService</code></td>
<td><code>SizingConnectionService</code></td>
<td><code>ClientSizing</code></td>
</tr>
<tr>
<td>Risk</td>
<td><code>addRisk()</code></td>
<td><code>RiskSchemaService</code></td>
<td><code>RiskConnectionService</code></td>
<td><code>ClientRisk</code></td>
</tr>
<tr>
<td>Optimizer</td>
<td><code>addOptimizer()</code></td>
<td><code>OptimizerSchemaService</code></td>
<td><code>OptimizerConnectionService</code></td>
<td><code>ClientOptimizer</code></td>
</tr>
</tbody>
</table>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#component-registration-functions"><span>Component <wbr/>Registration <wbr/>Functions</span></a><ul><li><a href="#purpose-and-scope"><span>Purpose and <wbr/>Scope</span></a></li><li><a href="#registration-architecture"><span>Registration <wbr/>Architecture</span></a></li><li><ul><li><a href="#registration-flow-diagram"><span>Registration <wbr/>Flow <wbr/>Diagram</span></a></li><li><a href="#component-lifecycle"><span>Component <wbr/>Lifecycle</span></a></li></ul></li><li><a href="#registration-functions"><span>Registration <wbr/>Functions</span></a></li><li><ul><li><a href="#function-summary-table"><span>Function <wbr/>Summary <wbr/>Table</span></a></li></ul></li><li><a href="#addstrategy"><span>add<wbr/>Strategy</span></a></li><li><ul><li><a href="#function-signature"><span>Function <wbr/>Signature</span></a></li><li><a href="#schema-interface"><span>Schema <wbr/>Interface</span></a></li><li><a href="#signal-intervals"><span>Signal <wbr/>Intervals</span></a></li><li><a href="#lifecycle-callbacks"><span>Lifecycle <wbr/>Callbacks</span></a></li><li><a href="#registration-process"><span>Registration <wbr/>Process</span></a></li><li><a href="#example-usage"><span>Example <wbr/>Usage</span></a></li></ul></li><li><a href="#addexchange"><span>add<wbr/>Exchange</span></a></li><li><ul><li><a href="#function-signature-1"><span>Function <wbr/>Signature</span></a></li><li><a href="#schema-interface-1"><span>Schema <wbr/>Interface</span></a></li><li><a href="#candle-data-structure"><span>Candle <wbr/>Data <wbr/>Structure</span></a></li><li><a href="#candle-intervals"><span>Candle <wbr/>Intervals</span></a></li><li><a href="#registration-process-1"><span>Registration <wbr/>Process</span></a></li><li><a href="#example-usage-1"><span>Example <wbr/>Usage</span></a></li></ul></li><li><a href="#addframe"><span>add<wbr/>Frame</span></a></li><li><ul><li><a href="#function-signature-2"><span>Function <wbr/>Signature</span></a></li><li><a href="#schema-interface-2"><span>Schema <wbr/>Interface</span></a></li><li><a href="#frame-intervals"><span>Frame <wbr/>Intervals</span></a></li><li><a href="#timeframe-generation-process"><span>Timeframe <wbr/>Generation <wbr/>Process</span></a></li><li><a href="#example-usage-2"><span>Example <wbr/>Usage</span></a></li></ul></li><li><a href="#addwalker"><span>add<wbr/>Walker</span></a></li><li><ul><li><a href="#function-signature-3"><span>Function <wbr/>Signature</span></a></li><li><a href="#schema-interface-3"><span>Schema <wbr/>Interface</span></a></li><li><a href="#walker-metrics"><span>Walker <wbr/>Metrics</span></a></li><li><a href="#walker-execution-flow"><span>Walker <wbr/>Execution <wbr/>Flow</span></a></li><li><a href="#example-usage-3"><span>Example <wbr/>Usage</span></a></li></ul></li><li><a href="#addsizing"><span>add<wbr/>Sizing</span></a></li><li><ul><li><a href="#function-signature-4"><span>Function <wbr/>Signature</span></a></li><li><a href="#schema-interface-discriminated-union"><span>Schema <wbr/>Interface (<wbr/>Discriminated <wbr/>Union)</span></a></li><li><a href="#sizing-method-comparison"><span>Sizing <wbr/>Method <wbr/>Comparison</span></a></li><li><a href="#example-usage-4"><span>Example <wbr/>Usage</span></a></li></ul></li><li><a href="#addrisk"><span>add<wbr/>Risk</span></a></li><li><ul><li><a href="#function-signature-5"><span>Function <wbr/>Signature</span></a></li><li><a href="#schema-interface-4"><span>Schema <wbr/>Interface</span></a></li><li><a href="#risk-validation-flow"><span>Risk <wbr/>Validation <wbr/>Flow</span></a></li><li><a href="#example-usage-5"><span>Example <wbr/>Usage</span></a></li></ul></li><li><a href="#addoptimizer"><span>add<wbr/>Optimizer</span></a></li><li><ul><li><a href="#function-signature-6"><span>Function <wbr/>Signature</span></a></li><li><a href="#schema-interface-5"><span>Schema <wbr/>Interface</span></a></li><li><a href="#optimizer-data-collection-pipeline"><span>Optimizer <wbr/>Data <wbr/>Collection <wbr/>Pipeline</span></a></li><li><a href="#example-usage-6"><span>Example <wbr/>Usage</span></a></li></ul></li><li><a href="#service-dependencies"><span>Service <wbr/>Dependencies</span></a></li><li><ul><li><a href="#service-dependency-diagram"><span>Service <wbr/>Dependency <wbr/>Diagram</span></a></li><li><a href="#dependency-injection-registration"><span>Dependency <wbr/>Injection <wbr/>Registration</span></a></li></ul></li><li><a href="#validation-process"><span>Validation <wbr/>Process</span></a></li><li><ul><li><a href="#validation-service-methods"><span>Validation <wbr/>Service <wbr/>Methods</span></a></li><li><a href="#common-validation-checks"><span>Common <wbr/>Validation <wbr/>Checks</span></a></li></ul></li><li><a href="#schema-storage-and-retrieval"><span>Schema <wbr/>Storage and <wbr/>Retrieval</span></a></li><li><ul><li><a href="#schema-service-interface"><span>Schema <wbr/>Service <wbr/>Interface</span></a></li><li><a href="#registry-access-pattern"><span>Registry <wbr/>Access <wbr/>Pattern</span></a></li><li><a href="#registration-summary-table"><span>Registration <wbr/>Summary <wbr/>Table</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
