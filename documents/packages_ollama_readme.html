<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>packages/ollama/readme | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="packages_ollama_readme.html">packages/ollama/readme</a></li></ul></div><div class="tsd-panel tsd-typography"><img src="https://github.com/tripolskypetr/backtest-kit/raw/refs/heads/master/assets/monade.svg" height="45px" align="right">
<a id="ü§ñ-backtest-kitollama" class="tsd-anchor"></a><h1 class="tsd-anchor-link">ü§ñ @backtest-kit/ollama<a href="#ü§ñ-backtest-kitollama" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><blockquote>
<p>Multi-provider LLM context wrapper for trading strategies. Supports 10+ providers with unified HOF API.</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/tripolskypetr/backtest-kit/HEAD/assets/screenshots/screenshot8.png" alt="screenshot"></p>
<p><a href="https://deepwiki.com/tripolskypetr/backtest-kit"><img src="https://deepwiki.com/badge.svg" alt="Ask DeepWiki"></a>
<a href="https://npmjs.org/package/@backtest-kit/ollama"><img src="https://img.shields.io/npm/v/@backtest-kit/ollama.svg?style=flat-square" alt="npm"></a>
<a href=""><img src="https://img.shields.io/badge/TypeScript-5.0+-blue" alt="TypeScript"></a></p>
<p>Transform technical analysis into trading decisions with multi-provider LLM support, structured output, and built-in risk management.</p>
<p>üìö <strong><a href="https://backtest-kit.github.io/documents/example_02_first_backtest.html">Backtest Kit Docs</a></strong> | üåü <strong><a href="https://github.com/tripolskypetr/backtest-kit">GitHub</a></strong></p>
<a id="‚ú®-features" class="tsd-anchor"></a><h2 class="tsd-anchor-link">‚ú® Features<a href="#‚ú®-features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>üîå 10+ LLM Providers: OpenAI, Claude, DeepSeek, Grok, Mistral, Perplexity, Cohere, Alibaba, Hugging Face, Ollama, GLM-4</li>
<li>‚ö° Higher-Order Functions: Wrap async functions with inference context via <code>di-scoped</code></li>
<li>üìù Userspace Prompts: Load prompts from <code>.cjs</code> modules in <code>config/prompt/</code></li>
<li>üéØ Userspace Schema: Define your own Zod or JSON schema with <code>addOutline</code></li>
<li>üîÑ Token Rotation: Pass array of API keys for automatic rotation</li>
<li>üóÑÔ∏è Memoized Cache: Prompt modules cached with <code>memoize</code> from <code>functools-kit</code></li>
</ul>
<a id="üì¶-installation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">üì¶ Installation<a href="#üì¶-installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="bash"><span class="hl-1">npm</span><span class="hl-2"> </span><span class="hl-4">install</span><span class="hl-2"> </span><span class="hl-4">@backtest-kit/ollama</span><span class="hl-2"> </span><span class="hl-4">backtest-kit</span><span class="hl-2"> </span><span class="hl-4">agent-swarm-kit</span>
</code><button type="button">Copy</button></pre>

<a id="üöÄ-usage" class="tsd-anchor"></a><h2 class="tsd-anchor-link">üöÄ Usage<a href="#üöÄ-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="signal-schema-userspace" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Signal Schema (userspace)<a href="#signal-schema-userspace" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">// schema/Signal.schema.ts</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">z</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&#39;zod&#39;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">str</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&#39;functools-kit&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-5">export</span><span class="hl-2"> </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">SignalSchema</span><span class="hl-2"> = </span><span class="hl-6">z</span><span class="hl-2">.</span><span class="hl-1">object</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">position:</span><span class="hl-2"> </span><span class="hl-6">z</span><span class="hl-2">.</span><span class="hl-1">enum</span><span class="hl-2">([</span><span class="hl-4">&#39;long&#39;</span><span class="hl-2">, </span><span class="hl-4">&#39;short&#39;</span><span class="hl-2">, </span><span class="hl-4">&#39;wait&#39;</span><span class="hl-2">]).</span><span class="hl-1">describe</span><span class="hl-2">(</span><br/><span class="hl-2">    </span><span class="hl-6">str</span><span class="hl-2">.</span><span class="hl-1">newline</span><span class="hl-2">(</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;Position direction:&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;long: bullish signals, uptrend potential&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;short: bearish signals, downtrend potential&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;wait: conflicting signals or unfavorable conditions&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">    )</span><br/><span class="hl-2">  ),</span><br/><span class="hl-2">  </span><span class="hl-6">price_open:</span><span class="hl-2"> </span><span class="hl-6">z</span><span class="hl-2">.</span><span class="hl-1">number</span><span class="hl-2">().</span><span class="hl-1">describe</span><span class="hl-2">(</span><br/><span class="hl-2">    </span><span class="hl-6">str</span><span class="hl-2">.</span><span class="hl-1">newline</span><span class="hl-2">(</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;Entry price in USD&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;Current market price or limit order price&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">    )</span><br/><span class="hl-2">  ),</span><br/><span class="hl-2">  </span><span class="hl-6">price_stop_loss:</span><span class="hl-2"> </span><span class="hl-6">z</span><span class="hl-2">.</span><span class="hl-1">number</span><span class="hl-2">().</span><span class="hl-1">describe</span><span class="hl-2">(</span><br/><span class="hl-2">    </span><span class="hl-6">str</span><span class="hl-2">.</span><span class="hl-1">newline</span><span class="hl-2">(</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;Stop-loss price in USD&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;LONG: below price_open&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;SHORT: above price_open&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">    )</span><br/><span class="hl-2">  ),</span><br/><span class="hl-2">  </span><span class="hl-6">price_take_profit:</span><span class="hl-2"> </span><span class="hl-6">z</span><span class="hl-2">.</span><span class="hl-1">number</span><span class="hl-2">().</span><span class="hl-1">describe</span><span class="hl-2">(</span><br/><span class="hl-2">    </span><span class="hl-6">str</span><span class="hl-2">.</span><span class="hl-1">newline</span><span class="hl-2">(</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;Take-profit price in USD&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;LONG: above price_open&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;SHORT: below price_open&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">    )</span><br/><span class="hl-2">  ),</span><br/><span class="hl-2">  </span><span class="hl-6">minute_estimated_time:</span><span class="hl-2"> </span><span class="hl-6">z</span><span class="hl-2">.</span><span class="hl-1">number</span><span class="hl-2">().</span><span class="hl-1">describe</span><span class="hl-2">(</span><br/><span class="hl-2">    </span><span class="hl-4">&#39;Estimated time to reach TP in minutes&#39;</span><br/><span class="hl-2">  ),</span><br/><span class="hl-2">  </span><span class="hl-6">risk_note:</span><span class="hl-2"> </span><span class="hl-6">z</span><span class="hl-2">.</span><span class="hl-1">string</span><span class="hl-2">().</span><span class="hl-1">describe</span><span class="hl-2">(</span><br/><span class="hl-2">    </span><span class="hl-6">str</span><span class="hl-2">.</span><span class="hl-1">newline</span><span class="hl-2">(</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;Risk assessment:&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;- Whale manipulations&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;- Order book imbalance&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;- Technical divergences&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-4">&#39;Provide specific numbers and percentages&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">    )</span><br/><span class="hl-2">  ),</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-5">export</span><span class="hl-2"> </span><span class="hl-3">type</span><span class="hl-2"> </span><span class="hl-11">TSignalSchema</span><span class="hl-2"> = </span><span class="hl-11">z</span><span class="hl-2">.</span><span class="hl-11">infer</span><span class="hl-2">&lt;</span><span class="hl-3">typeof</span><span class="hl-2"> </span><span class="hl-6">SignalSchema</span><span class="hl-2">&gt;;</span>
</code><button type="button">Copy</button></pre>

<a id="signal-outline-with-zod-userspace" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Signal Outline with Zod (userspace)<a href="#signal-outline-with-zod-userspace" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">// outline/signal.outline.ts</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">addOutline</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&#39;agent-swarm-kit&#39;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">zodResponseFormat</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&#39;openai/helpers/zod&#39;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">SignalSchema</span><span class="hl-2">, </span><span class="hl-6">TSignalSchema</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&#39;../schema/Signal.schema&#39;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">CompletionName</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&#39;@backtest-kit/ollama&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-1">addOutline</span><span class="hl-2">&lt;</span><span class="hl-11">TSignalSchema</span><span class="hl-2">&gt;({</span><br/><span class="hl-2">  </span><span class="hl-6">outlineName:</span><span class="hl-2"> </span><span class="hl-4">&#39;SignalOutline&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">completion:</span><span class="hl-2"> </span><span class="hl-6">CompletionName</span><span class="hl-2">.</span><span class="hl-6">RunnerOutlineCompletion</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">format:</span><span class="hl-2"> </span><span class="hl-1">zodResponseFormat</span><span class="hl-2">(</span><span class="hl-6">SignalSchema</span><span class="hl-2">, </span><span class="hl-4">&#39;position_decision&#39;</span><span class="hl-2">),</span><br/><span class="hl-2">  </span><span class="hl-1">getOutlineHistory</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> ({ </span><span class="hl-6">history</span><span class="hl-2">, </span><span class="hl-6">param</span><span class="hl-2">: </span><span class="hl-6">messages</span><span class="hl-2"> = [] }) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">history</span><span class="hl-2">.</span><span class="hl-1">push</span><span class="hl-2">(</span><span class="hl-6">messages</span><span class="hl-2">);</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">  </span><span class="hl-6">validations:</span><span class="hl-2"> [</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-1">validate</span><span class="hl-6">:</span><span class="hl-2"> ({ </span><span class="hl-6">data</span><span class="hl-2"> }) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-5">if</span><span class="hl-2"> (</span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-6">position</span><span class="hl-2"> === </span><span class="hl-4">&#39;long&#39;</span><span class="hl-2"> &amp;&amp; </span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-6">price_stop_loss</span><span class="hl-2"> &gt;= </span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-6">price_open</span><span class="hl-2">) {</span><br/><span class="hl-2">          </span><span class="hl-5">throw</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Error</span><span class="hl-2">(</span><span class="hl-4">&#39;For LONG, stop_loss must be below price_open&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">        }</span><br/><span class="hl-2">        </span><span class="hl-5">if</span><span class="hl-2"> (</span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-6">position</span><span class="hl-2"> === </span><span class="hl-4">&#39;short&#39;</span><span class="hl-2"> &amp;&amp; </span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-6">price_stop_loss</span><span class="hl-2"> &lt;= </span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-6">price_open</span><span class="hl-2">) {</span><br/><span class="hl-2">          </span><span class="hl-5">throw</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Error</span><span class="hl-2">(</span><span class="hl-4">&#39;For SHORT, stop_loss must be above price_open&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">        }</span><br/><span class="hl-2">      },</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  ],</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="signal-outline-without-zod-userspace" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Signal Outline without Zod (userspace)<a href="#signal-outline-without-zod-userspace" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">// outline/signal.outline.ts</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">addOutline</span><span class="hl-2">, </span><span class="hl-6">IOutlineFormat</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&#39;agent-swarm-kit&#39;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">CompletionName</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&#39;@backtest-kit/ollama&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">format</span><span class="hl-2">: </span><span class="hl-11">IOutlineFormat</span><span class="hl-2"> = {</span><br/><span class="hl-2">  </span><span class="hl-6">type:</span><span class="hl-2"> </span><span class="hl-4">&#39;object&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">properties:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-6">take_profit_price:</span><span class="hl-2"> { </span><span class="hl-6">type:</span><span class="hl-2"> </span><span class="hl-4">&#39;number&#39;</span><span class="hl-2">, </span><span class="hl-6">description:</span><span class="hl-2"> </span><span class="hl-4">&#39;Take profit price in USD&#39;</span><span class="hl-2"> },</span><br/><span class="hl-2">    </span><span class="hl-6">stop_loss_price:</span><span class="hl-2"> { </span><span class="hl-6">type:</span><span class="hl-2"> </span><span class="hl-4">&#39;number&#39;</span><span class="hl-2">, </span><span class="hl-6">description:</span><span class="hl-2"> </span><span class="hl-4">&#39;Stop-loss price in USD&#39;</span><span class="hl-2"> },</span><br/><span class="hl-2">    </span><span class="hl-6">description:</span><span class="hl-2"> { </span><span class="hl-6">type:</span><span class="hl-2"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-2">, </span><span class="hl-6">description:</span><span class="hl-2"> </span><span class="hl-4">&#39;User-friendly explanation of risks, min 10 sentences&#39;</span><span class="hl-2"> },</span><br/><span class="hl-2">    </span><span class="hl-6">reasoning:</span><span class="hl-2"> { </span><span class="hl-6">type:</span><span class="hl-2"> </span><span class="hl-4">&#39;string&#39;</span><span class="hl-2">, </span><span class="hl-6">description:</span><span class="hl-2"> </span><span class="hl-4">&#39;Technical analysis, min 15 sentences&#39;</span><span class="hl-2"> },</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">  </span><span class="hl-6">required:</span><span class="hl-2"> [</span><span class="hl-4">&#39;take_profit_price&#39;</span><span class="hl-2">, </span><span class="hl-4">&#39;stop_loss_price&#39;</span><span class="hl-2">, </span><span class="hl-4">&#39;description&#39;</span><span class="hl-2">, </span><span class="hl-4">&#39;reasoning&#39;</span><span class="hl-2">],</span><br/><span class="hl-2">};</span><br/><br/><span class="hl-1">addOutline</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">outlineName:</span><span class="hl-2"> </span><span class="hl-4">&#39;SignalOutline&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">format</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">prompt:</span><span class="hl-2"> </span><span class="hl-4">&#39;Generate crypto trading signals based on price and volume indicators in JSON format.&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">completion:</span><span class="hl-2"> </span><span class="hl-6">CompletionName</span><span class="hl-2">.</span><span class="hl-6">RunnerOutlineCompletion</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-1">getOutlineHistory</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> ({ </span><span class="hl-6">history</span><span class="hl-2">, </span><span class="hl-6">param</span><span class="hl-2"> }) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">signalReport</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">ioc</span><span class="hl-2">.</span><span class="hl-6">signalReportService</span><span class="hl-2">.</span><span class="hl-1">getSignalReport</span><span class="hl-2">(</span><span class="hl-6">param</span><span class="hl-2">);</span><br/><span class="hl-2">    </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">commitReports</span><span class="hl-2">(</span><span class="hl-6">history</span><span class="hl-2">, </span><span class="hl-6">signalReport</span><span class="hl-2">);</span><br/><span class="hl-2">    </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">history</span><span class="hl-2">.</span><span class="hl-1">push</span><span class="hl-2">({ </span><span class="hl-6">role:</span><span class="hl-2"> </span><span class="hl-4">&#39;user&#39;</span><span class="hl-2">, </span><span class="hl-6">content:</span><span class="hl-2"> </span><span class="hl-4">&#39;Generate JSON based on reports.&#39;</span><span class="hl-2"> });</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">  </span><span class="hl-6">validations:</span><span class="hl-2"> [</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-1">validate</span><span class="hl-6">:</span><span class="hl-2"> ({ </span><span class="hl-6">data</span><span class="hl-2"> }) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-5">if</span><span class="hl-2"> (</span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-6">action</span><span class="hl-2"> !== </span><span class="hl-4">&#39;buy&#39;</span><span class="hl-2">) </span><span class="hl-5">return</span><span class="hl-2">;</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">stopLossChange</span><span class="hl-2"> = </span><span class="hl-1">percentDiff</span><span class="hl-2">(</span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-6">current_price</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-6">stop_loss_price</span><span class="hl-2">);</span><br/><span class="hl-2">        </span><span class="hl-5">if</span><span class="hl-2"> (</span><span class="hl-6">stopLossChange</span><span class="hl-2"> &gt; </span><span class="hl-8">CC_LADDER_STOP_LOSS</span><span class="hl-2">) {</span><br/><span class="hl-2">          </span><span class="hl-5">throw</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Error</span><span class="hl-2">(</span><span class="hl-4">`Stop loss must not exceed -</span><span class="hl-3">${</span><span class="hl-8">CC_LADDER_STOP_LOSS</span><span class="hl-3">}</span><span class="hl-4">%`</span><span class="hl-2">);</span><br/><span class="hl-2">        }</span><br/><span class="hl-2">      },</span><br/><span class="hl-2">      </span><span class="hl-6">docDescription:</span><span class="hl-2"> </span><span class="hl-4">&#39;Checks stop-loss price against max loss percentage.&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-1">validate</span><span class="hl-6">:</span><span class="hl-2"> ({ </span><span class="hl-6">data</span><span class="hl-2"> }) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-5">if</span><span class="hl-2"> (</span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-6">action</span><span class="hl-2"> !== </span><span class="hl-4">&#39;buy&#39;</span><span class="hl-2">) </span><span class="hl-5">return</span><span class="hl-2">;</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">sellChange</span><span class="hl-2"> = </span><span class="hl-1">percentDiff</span><span class="hl-2">(</span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-6">current_price</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-6">take_profit_price</span><span class="hl-2">);</span><br/><span class="hl-2">        </span><span class="hl-5">if</span><span class="hl-2"> (</span><span class="hl-6">sellChange</span><span class="hl-2"> &gt; </span><span class="hl-8">CC_LADDER_TAKE_PROFIT</span><span class="hl-2">) {</span><br/><span class="hl-2">          </span><span class="hl-5">throw</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Error</span><span class="hl-2">(</span><span class="hl-4">`Take profit must not exceed +</span><span class="hl-3">${</span><span class="hl-8">CC_LADDER_TAKE_PROFIT</span><span class="hl-3">}</span><span class="hl-4">%`</span><span class="hl-2">);</span><br/><span class="hl-2">        }</span><br/><span class="hl-2">      },</span><br/><span class="hl-2">      </span><span class="hl-6">docDescription:</span><span class="hl-2"> </span><span class="hl-4">&#39;Checks take-profit price against max profit percentage.&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  ],</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="prompt-module-userspace" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Prompt Module (userspace)<a href="#prompt-module-userspace" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">// config/prompt/signal.prompt.cjs</span><br/><span class="hl-11">module</span><span class="hl-2">.</span><span class="hl-11">exports</span><span class="hl-2"> = {</span><br/><span class="hl-2">  </span><span class="hl-1">system</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">strategyName</span><span class="hl-2">, </span><span class="hl-6">exchangeName</span><span class="hl-2">, </span><span class="hl-6">frameName</span><span class="hl-2">, </span><span class="hl-6">backtest</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> [</span><br/><span class="hl-2">    </span><span class="hl-4">`You are analyzing </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4"> on </span><span class="hl-3">${</span><span class="hl-6">exchangeName</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-4">`Strategy: </span><span class="hl-3">${</span><span class="hl-6">strategyName</span><span class="hl-3">}</span><span class="hl-4">, Timeframe: </span><span class="hl-3">${</span><span class="hl-6">frameName</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-6">backtest</span><span class="hl-2"> ? </span><span class="hl-4">&#39;Backtest mode&#39;</span><span class="hl-2"> : </span><span class="hl-4">&#39;Live mode&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  ],</span><br/><span class="hl-2">  </span><span class="hl-1">user</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-4">`Analyze </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4"> and return trading decision`</span><span class="hl-2">,</span><br/><span class="hl-2">};</span>
</code><button type="button">Copy</button></pre>

<a id="strategy" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Strategy<a href="#strategy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">// strategy.ts</span><br/><span class="hl-5">import</span><span class="hl-2"> </span><span class="hl-4">&#39;./outline/signal.outline&#39;</span><span class="hl-2">; </span><span class="hl-0">// register outline</span><br/><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">deepseek</span><span class="hl-2">, </span><span class="hl-6">Module</span><span class="hl-2">, </span><span class="hl-6">commitPrompt</span><span class="hl-2">, </span><span class="hl-6">MessageModel</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&#39;@backtest-kit/ollama&#39;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">addStrategy</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&#39;backtest-kit&#39;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">json</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&#39;agent-swarm-kit&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">signalModule</span><span class="hl-2"> = </span><span class="hl-6">Module</span><span class="hl-2">.</span><span class="hl-1">fromPath</span><span class="hl-2">(</span><span class="hl-4">&#39;./signal.prompt.cjs&#39;</span><span class="hl-2">);</span><br/><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-1">getSignal</span><span class="hl-2"> = </span><span class="hl-3">async</span><span class="hl-2"> () </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">messages</span><span class="hl-2">: </span><span class="hl-11">MessageModel</span><span class="hl-2">[] = [];</span><br/><span class="hl-2">  </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">commitPrompt</span><span class="hl-2">(</span><span class="hl-6">signalModule</span><span class="hl-2">, </span><span class="hl-6">messages</span><span class="hl-2">);</span><br/><br/><span class="hl-2">  </span><span class="hl-3">const</span><span class="hl-2"> { </span><span class="hl-8">data</span><span class="hl-2"> } = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">json</span><span class="hl-2">(</span><span class="hl-4">&#39;SignalOutline&#39;</span><span class="hl-2">, </span><span class="hl-6">messages</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-6">data</span><span class="hl-2">;</span><br/><span class="hl-2">};</span><br/><br/><span class="hl-1">addStrategy</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">strategyName:</span><span class="hl-2"> </span><span class="hl-4">&#39;llm-signal&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">interval:</span><span class="hl-2"> </span><span class="hl-4">&#39;5m&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">getSignal:</span><span class="hl-2"> </span><span class="hl-1">deepseek</span><span class="hl-2">(</span><span class="hl-6">getSignal</span><span class="hl-2">, </span><span class="hl-4">&#39;deepseek-chat&#39;</span><span class="hl-2">, </span><span class="hl-6">process</span><span class="hl-2">.</span><span class="hl-6">env</span><span class="hl-2">.</span><span class="hl-8">DEEPSEEK_API_KEY</span><span class="hl-2">),</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="dynamic-prompt" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Dynamic Prompt<a href="#dynamic-prompt" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">// config/prompt/risk.prompt.cjs</span><br/><span class="hl-11">module</span><span class="hl-2">.</span><span class="hl-11">exports</span><span class="hl-2"> = {</span><br/><span class="hl-2">  </span><span class="hl-6">system:</span><span class="hl-2"> [</span><span class="hl-4">&#39;You are a risk analyst&#39;</span><span class="hl-2">, </span><span class="hl-4">&#39;Be conservative&#39;</span><span class="hl-2">],</span><br/><span class="hl-2">  </span><span class="hl-1">user</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">strategyName</span><span class="hl-2">, </span><span class="hl-6">exchangeName</span><span class="hl-2">, </span><span class="hl-6">frameName</span><span class="hl-2">, </span><span class="hl-6">backtest</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><br/><span class="hl-2">    </span><span class="hl-4">`Evaluate risk for </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4"> position on </span><span class="hl-3">${</span><span class="hl-6">frameName</span><span class="hl-3">}</span><span class="hl-4"> timeframe`</span><span class="hl-2">,</span><br/><span class="hl-2">};</span>
</code><button type="button">Copy</button></pre>

<a id="inline-prompt" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Inline Prompt<a href="#inline-prompt" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">Prompt</span><span class="hl-2">, </span><span class="hl-6">commitPrompt</span><span class="hl-2">, </span><span class="hl-6">MessageModel</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&#39;@backtest-kit/ollama&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">prompt</span><span class="hl-2"> = </span><span class="hl-6">Prompt</span><span class="hl-2">.</span><span class="hl-1">fromPrompt</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">system:</span><span class="hl-2"> [</span><span class="hl-4">&#39;You are a trading bot&#39;</span><span class="hl-2">],</span><br/><span class="hl-2">  </span><span class="hl-1">user</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-4">`What is the trend for </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">?`</span><span class="hl-2">,</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">messages</span><span class="hl-2">: </span><span class="hl-11">MessageModel</span><span class="hl-2">[] = [];</span><br/><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">commitPrompt</span><span class="hl-2">(</span><span class="hl-6">prompt</span><span class="hl-2">, </span><span class="hl-6">messages</span><span class="hl-2">);</span>
</code><button type="button">Copy</button></pre>

<a id="token-rotation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Token Rotation<a href="#token-rotation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">ollama</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&#39;@backtest-kit/ollama&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">wrappedFn</span><span class="hl-2"> = </span><span class="hl-1">ollama</span><span class="hl-2">(</span><span class="hl-6">myFn</span><span class="hl-2">, </span><span class="hl-4">&#39;llama3.3:70b&#39;</span><span class="hl-2">, [</span><span class="hl-4">&#39;key1&#39;</span><span class="hl-2">, </span><span class="hl-4">&#39;key2&#39;</span><span class="hl-2">, </span><span class="hl-4">&#39;key3&#39;</span><span class="hl-2">]);</span>
</code><button type="button">Copy</button></pre>

<a id="üîå-providers" class="tsd-anchor"></a><h2 class="tsd-anchor-link">üîå Providers<a href="#üîå-providers" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><table>
<thead>
<tr>
<th>Provider</th>
<th>Function</th>
<th>Base URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>OpenAI</td>
<td><code>gpt5()</code></td>
<td><code>https://api.openai.com/v1/</code></td>
</tr>
<tr>
<td>Claude</td>
<td><code>claude()</code></td>
<td><code>https://api.anthropic.com/v1/</code></td>
</tr>
<tr>
<td>DeepSeek</td>
<td><code>deepseek()</code></td>
<td><code>https://api.deepseek.com/</code></td>
</tr>
<tr>
<td>Grok</td>
<td><code>grok()</code></td>
<td><code>https://api.x.ai/v1/</code></td>
</tr>
<tr>
<td>Mistral</td>
<td><code>mistral()</code></td>
<td><code>https://api.mistral.ai/v1/</code></td>
</tr>
<tr>
<td>Perplexity</td>
<td><code>perplexity()</code></td>
<td><code>https://api.perplexity.ai/</code></td>
</tr>
<tr>
<td>Cohere</td>
<td><code>cohere()</code></td>
<td><code>https://api.cohere.ai/compatibility/v1/</code></td>
</tr>
<tr>
<td>Alibaba</td>
<td><code>alibaba()</code></td>
<td><code>https://dashscope-intl.aliyuncs.com/compatible-mode/v1/</code></td>
</tr>
<tr>
<td>Hugging Face</td>
<td><code>hf()</code></td>
<td><code>https://router.huggingface.co/v1/</code></td>
</tr>
<tr>
<td>Ollama</td>
<td><code>ollama()</code></td>
<td><code>http://localhost:11434/</code></td>
</tr>
<tr>
<td>Zhipu AI</td>
<td><code>glm4()</code></td>
<td><code>https://open.bigmodel.cn/api/paas/v4/</code></td>
</tr>
</tbody>
</table>
<a id="üìñ-api" class="tsd-anchor"></a><h2 class="tsd-anchor-link">üìñ API<a href="#üìñ-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="provider-hof" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Provider HOF<a href="#provider-hof" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-6">ollama</span><span class="hl-2"> | </span><span class="hl-6">gpt5</span><span class="hl-2"> | </span><span class="hl-6">claude</span><span class="hl-2"> | </span><span class="hl-6">deepseek</span><span class="hl-2"> | </span><span class="hl-6">grok</span><span class="hl-2"> | </span><span class="hl-6">mistral</span><span class="hl-2"> | </span><span class="hl-6">perplexity</span><span class="hl-2"> | </span><span class="hl-6">cohere</span><span class="hl-2"> | </span><span class="hl-6">alibaba</span><span class="hl-2"> | </span><span class="hl-6">hf</span><span class="hl-2"> | </span><span class="hl-6">glm4</span><br/><span class="hl-2">(</span><span class="hl-6">fn</span><span class="hl-2">, </span><span class="hl-6">model</span><span class="hl-2">, </span><span class="hl-6">apiKey</span><span class="hl-2">?) </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-6">fn</span>
</code><button type="button">Copy</button></pre>

<a id="module" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Module<a href="#module" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-6">Module</span><span class="hl-2">.</span><span class="hl-1">fromPath</span><span class="hl-2">(</span><span class="hl-6">path</span><span class="hl-2">: </span><span class="hl-6">string</span><span class="hl-2">, </span><span class="hl-6">baseDir</span><span class="hl-2">?: </span><span class="hl-6">string</span><span class="hl-2">): </span><span class="hl-6">Module</span>
</code><button type="button">Copy</button></pre>

<p>Default baseDir: <code>{cwd}/config/prompt/</code></p>
<a id="prompt" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Prompt<a href="#prompt" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-6">Prompt</span><span class="hl-2">.</span><span class="hl-1">fromPrompt</span><span class="hl-2">(</span><span class="hl-6">source</span><span class="hl-2">: </span><span class="hl-6">PromptModel</span><span class="hl-2">): </span><span class="hl-6">Prompt</span>
</code><button type="button">Copy</button></pre>

<a id="commitprompt" class="tsd-anchor"></a><h3 class="tsd-anchor-link">commitPrompt<a href="#commitprompt" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">async</span><span class="hl-2"> </span><span class="hl-3">function</span><span class="hl-2"> </span><span class="hl-1">commitPrompt</span><span class="hl-2">(</span><span class="hl-6">source</span><span class="hl-2">: </span><span class="hl-11">Module</span><span class="hl-2"> | </span><span class="hl-11">Prompt</span><span class="hl-2">, </span><span class="hl-6">history</span><span class="hl-2">: </span><span class="hl-11">MessageModel</span><span class="hl-2">[]): </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">void</span><span class="hl-2">&gt;</span>
</code><button type="button">Copy</button></pre>

<a id="promptmodel" class="tsd-anchor"></a><h3 class="tsd-anchor-link">PromptModel<a href="#promptmodel" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">interface</span><span class="hl-2"> </span><span class="hl-11">PromptModel</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">system</span><span class="hl-2">?: </span><span class="hl-11">string</span><span class="hl-2">[] | </span><span class="hl-11">SystemPromptFn</span><span class="hl-2">;</span><br/><span class="hl-2">  </span><span class="hl-6">user</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2"> | </span><span class="hl-11">UserPromptFn</span><span class="hl-2">;</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-3">type</span><span class="hl-2"> </span><span class="hl-11">SystemPromptFn</span><span class="hl-2"> = (</span><br/><span class="hl-2">  </span><span class="hl-6">symbol</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">strategyName</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">exchangeName</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">frameName</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">backtest</span><span class="hl-2">: </span><span class="hl-11">boolean</span><br/><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">string</span><span class="hl-2">[]&gt; | </span><span class="hl-11">string</span><span class="hl-2">[];</span><br/><br/><span class="hl-3">type</span><span class="hl-2"> </span><span class="hl-11">UserPromptFn</span><span class="hl-2"> = (</span><br/><span class="hl-2">  </span><span class="hl-6">symbol</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">strategyName</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">exchangeName</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">frameName</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">backtest</span><span class="hl-2">: </span><span class="hl-11">boolean</span><br/><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">string</span><span class="hl-2">&gt; | </span><span class="hl-11">string</span><span class="hl-2">;</span>
</code><button type="button">Copy</button></pre>

<a id="üí°-why-use-backtest-kitollama" class="tsd-anchor"></a><h2 class="tsd-anchor-link">üí° Why Use @backtest-kit/ollama?<a href="#üí°-why-use-backtest-kitollama" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Instead of manually integrating LLM SDKs:</p>
<p><strong>‚ùå Without ollama (manual work)</strong></p>
<pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> </span><span class="hl-6">OpenAI</span><span class="hl-2"> </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&#39;openai&#39;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> </span><span class="hl-6">Anthropic</span><span class="hl-2"> </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&#39;@anthropic-ai/sdk&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">openai</span><span class="hl-2"> = </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">OpenAI</span><span class="hl-2">({ </span><span class="hl-6">apiKey:</span><span class="hl-2"> </span><span class="hl-6">process</span><span class="hl-2">.</span><span class="hl-6">env</span><span class="hl-2">.</span><span class="hl-8">OPENAI_KEY</span><span class="hl-2"> });</span><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">response</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">openai</span><span class="hl-2">.</span><span class="hl-6">chat</span><span class="hl-2">.</span><span class="hl-6">completions</span><span class="hl-2">.</span><span class="hl-1">create</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">model:</span><span class="hl-2"> </span><span class="hl-4">&#39;gpt-4o&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">messages</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">response_format:</span><span class="hl-2"> { </span><span class="hl-6">type:</span><span class="hl-2"> </span><span class="hl-4">&#39;json_object&#39;</span><span class="hl-2"> }</span><br/><span class="hl-2">});</span><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">signal</span><span class="hl-2"> = </span><span class="hl-8">JSON</span><span class="hl-2">.</span><span class="hl-1">parse</span><span class="hl-2">(</span><span class="hl-6">response</span><span class="hl-2">.</span><span class="hl-6">choices</span><span class="hl-2">[</span><span class="hl-7">0</span><span class="hl-2">].</span><span class="hl-6">message</span><span class="hl-2">.</span><span class="hl-6">content</span><span class="hl-2">);</span><br/><span class="hl-0">// ... manual schema validation</span><br/><span class="hl-0">// ... manual error handling</span><br/><span class="hl-0">// ... no fallback</span>
</code><button type="button">Copy</button></pre>

<p><strong>‚úÖ With ollama (one line)</strong></p>
<pre><code class="typescript"><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">signal</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">gpt5</span><span class="hl-2">(</span><span class="hl-6">messages</span><span class="hl-2">, </span><span class="hl-4">&#39;gpt-4o&#39;</span><span class="hl-2">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>üî• Benefits:</strong></p>
<ul>
<li>‚ö° Unified API across 10+ providers</li>
<li>üéØ Enforced JSON schema (no parsing errors)</li>
<li>üîÑ Built-in token rotation (Ollama)</li>
<li>üîë Context-based API keys</li>
<li>üõ°Ô∏è Type-safe TypeScript interfaces</li>
<li>üìä Trading-specific output format</li>
</ul>
<a id="ü§ù-contribute" class="tsd-anchor"></a><h2 class="tsd-anchor-link">ü§ù Contribute<a href="#ü§ù-contribute" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Fork/PR on <a href="https://github.com/tripolskypetr/backtest-kit">GitHub</a>.</p>
<a id="üìú-license" class="tsd-anchor"></a><h2 class="tsd-anchor-link">üìú License<a href="#üìú-license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>MIT ¬© <a href="https://github.com/tripolskypetr">tripolskypetr</a></p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#ü§ñ-backtest-kitollama"><span>ü§ñ @backtest-<wbr/>kit/ollama</span></a><ul><li><a href="#‚ú®-features"><span>‚ú® <wbr/>Features</span></a></li><li><a href="#üì¶-installation"><span>üì¶ <wbr/>Installation</span></a></li><li><a href="#üöÄ-usage"><span>üöÄ <wbr/>Usage</span></a></li><li><ul><li><a href="#signal-schema-userspace"><span>Signal <wbr/>Schema (userspace)</span></a></li><li><a href="#signal-outline-with-zod-userspace"><span>Signal <wbr/>Outline with <wbr/>Zod (userspace)</span></a></li><li><a href="#signal-outline-without-zod-userspace"><span>Signal <wbr/>Outline without <wbr/>Zod (userspace)</span></a></li><li><a href="#prompt-module-userspace"><span>Prompt <wbr/>Module (userspace)</span></a></li><li><a href="#strategy"><span>Strategy</span></a></li><li><a href="#dynamic-prompt"><span>Dynamic <wbr/>Prompt</span></a></li><li><a href="#inline-prompt"><span>Inline <wbr/>Prompt</span></a></li><li><a href="#token-rotation"><span>Token <wbr/>Rotation</span></a></li></ul></li><li><a href="#üîå-providers"><span>üîå <wbr/>Providers</span></a></li><li><a href="#üìñ-api"><span>üìñ API</span></a></li><li><ul><li><a href="#provider-hof"><span>Provider HOF</span></a></li><li><a href="#module"><span>Module</span></a></li><li><a href="#prompt"><span>Prompt</span></a></li><li><a href="#commitprompt"><span>commit<wbr/>Prompt</span></a></li><li><a href="#promptmodel"><span>Prompt<wbr/>Model</span></a></li></ul></li><li><a href="#üí°-why-use-backtest-kitollama"><span>üí° <wbr/>Why <wbr/>Use @backtest-<wbr/>kit/ollama?</span></a></li><li><a href="#ü§ù-contribute"><span>ü§ù <wbr/>Contribute</span></a></li><li><a href="#üìú-license"><span>üìú <wbr/>License</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
