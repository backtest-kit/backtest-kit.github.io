<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/91_strategy_code_generation | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_91_strategy_code_generation.html">design/91_strategy_code_generation</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="strategy-code-generation" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Strategy Code Generation<a href="#strategy-code-generation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>This page documents the code generation system used by the Optimizer to produce executable trading strategy scripts. The generation process transforms collected data and LLM conversation histories into standalone Node.js files that implement multi-timeframe trading strategies with Walker-based comparison.</p>
<p>For information about data collection and LLM integration, see <a href="design_87_ai-powered_strategy_optimization.html">AI-Powered Strategy Optimization</a>. For details on prompt engineering and conversation building, see <a href="design_90_llm_integration.html">LLM Integration</a>. For information about walk-forward validation, see <a href="design_92_training_vs_testing_ranges.html">Training vs Testing Ranges</a>.</p>
<a id="template-system-architecture" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Template System Architecture<a href="#template-system-architecture" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The code generation system uses a template-based approach where 11 distinct template methods produce individual code sections. These sections are assembled in a specific order by <code>ClientOptimizer.getCode()</code> to create a complete executable file.</p>
<a id="ioptimizertemplate-interface" class="tsd-anchor"></a><h3 class="tsd-anchor-link">IOptimizerTemplate Interface<a href="#ioptimizertemplate-interface" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The template system is defined by the <code>IOptimizerTemplate</code> interface, which specifies 11 methods that each generate a specific section of the output file. Default implementations are provided by <code>OptimizerTemplateService</code>, but any method can be overridden in the optimizer schema configuration.</p>
<p><strong>Template Methods by Category:</strong></p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Method</th>
<th>Purpose</th>
<th>Output Type</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Initialization</strong></td>
<td><code>getTopBanner()</code></td>
<td>Shebang, imports, constants</td>
<td>ES module header</td>
</tr>
<tr>
<td><strong>Helper Functions</strong></td>
<td><code>getJsonDumpTemplate()</code></td>
<td>Debug output writer</td>
<td>Async function</td>
</tr>
<tr>
<td></td>
<td><code>getTextTemplate()</code></td>
<td>LLM text generation</td>
<td>Async function</td>
</tr>
<tr>
<td></td>
<td><code>getJsonTemplate()</code></td>
<td>LLM structured output</td>
<td>Async function</td>
</tr>
<tr>
<td><strong>Component Config</strong></td>
<td><code>getExchangeTemplate()</code></td>
<td>Exchange integration</td>
<td><code>addExchange()</code> call</td>
</tr>
<tr>
<td></td>
<td><code>getFrameTemplate()</code></td>
<td>Timeframe definition</td>
<td><code>addFrame()</code> call</td>
</tr>
<tr>
<td></td>
<td><code>getStrategyTemplate()</code></td>
<td>Strategy with LLM</td>
<td><code>addStrategy()</code> call</td>
</tr>
<tr>
<td></td>
<td><code>getWalkerTemplate()</code></td>
<td>Strategy comparison</td>
<td><code>addWalker()</code> call</td>
</tr>
<tr>
<td><strong>Execution</strong></td>
<td><code>getLauncherTemplate()</code></td>
<td>Walker launcher + listeners</td>
<td><code>Walker.background()</code> + event handlers</td>
</tr>
<tr>
<td><strong>Conversation</strong></td>
<td><code>getUserMessage()</code></td>
<td>Data prompt formatting</td>
<td>String content</td>
</tr>
<tr>
<td></td>
<td><code>getAssistantMessage()</code></td>
<td>LLM response formatting</td>
<td>String content</td>
</tr>
</tbody>
</table>
<p><strong>Template System Diagram:</strong></p>
<p><img src="../media/91_Strategy_Code_Generation_0.svg" alt="Mermaid Diagram"></p>
<a id="template-method-reference" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Template Method Reference<a href="#template-method-reference" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Each template method generates a specific code section with consistent escaping and formatting. All methods accept <code>symbol</code> as the first parameter and return a string (or Promise resolving to string) containing valid TypeScript/JavaScript code.</p>
<a id="initialization-templates" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Initialization Templates<a href="#initialization-templates" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><a id="gettopbanner" class="tsd-anchor"></a><h4 class="tsd-anchor-link">getTopBanner<a href="#gettopbanner" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Generates the file header with shebang, imports, and constants.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-0">getTopBanner</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Output Structure:</strong></p>
<ul>
<li>Shebang line (<code>#!/usr/bin/env node</code>)</li>
<li>Ollama import for LLM integration</li>
<li>CCXT import for exchange connectivity</li>
<li>backtest-kit imports (strategy registration, execution, listeners)</li>
<li>Node.js built-in imports (<code>fs/promises</code>, <code>path</code>)</li>
<li>UUID import for debug file naming</li>
<li><code>WARN_KB</code> constant for message size warnings</li>
</ul>
<p><strong>Implementation:</strong> <a href="">src/lib/services/template/OptimizerTemplateService.ts:35-65</a></p>
<a id="helper-function-templates" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Helper Function Templates<a href="#helper-function-templates" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><a id="getjsondumptemplate" class="tsd-anchor"></a><h4 class="tsd-anchor-link">getJsonDumpTemplate<a href="#getjsondumptemplate" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Generates the <code>dumpJson()</code> helper function for debugging LLM conversations. Creates a directory structure under <code>./dump/strategy/{resultId}/</code> containing:</p>
<ul>
<li><code>00_system_prompt.md</code> - System messages and output data</li>
<li><code>{nn}_user_message.md</code> - User input messages by sequence</li>
<li><code>{nn}_llm_output.md</code> - Final LLM response</li>
</ul>
<p>The function checks for message size and warns if any exceed <code>WARN_KB</code> (100 KB).</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-0">getJsonDumpTemplate</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Implementation:</strong> <a href="">src/lib/services/template/OptimizerTemplateService.ts:446-540</a></p>
<a id="gettexttemplate" class="tsd-anchor"></a><h4 class="tsd-anchor-link">getTextTemplate<a href="#gettexttemplate" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Generates the <code>text()</code> helper function for free-form LLM strategy generation. Uses Ollama's <code>deepseek-v3.1:671b</code> model with a system prompt that requests concise trading strategy reports without greetings or explanations.</p>
<p>The function:</p>
<ul>
<li>Initializes Ollama client with API key from environment</li>
<li>Injects system prompt requesting strategy-only output</li>
<li>Appends user query for market analysis (support/resistance, LONG/SHORT entry points, risk/reward ratios)</li>
<li>Requests fundamental analysis rather than dry technical analysis</li>
<li>Returns escaped content suitable for template literal insertion</li>
</ul>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-0">getTextTemplate</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Implementation:</strong> <a href="">src/lib/services/template/OptimizerTemplateService.ts:549-606</a></p>
<a id="getjsontemplate" class="tsd-anchor"></a><h4 class="tsd-anchor-link">getJsonTemplate<a href="#getjsontemplate" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Generates the <code>json()</code> helper function for structured signal generation. Uses JSON schema enforcement to produce signals with:</p>
<ul>
<li><code>position</code>: &quot;wait&quot; | &quot;long&quot; | &quot;short&quot;</li>
<li><code>note</code>: Professional trading recommendation</li>
<li><code>priceOpen</code>: Entry price (market or limit)</li>
<li><code>priceTakeProfit</code>: Target price</li>
<li><code>priceStopLoss</code>: Stop price</li>
<li><code>minuteEstimatedTime</code>: Expected duration (max 360 minutes)</li>
</ul>
<p>The system prompt includes detailed rules for:</p>
<ul>
<li>Position type selection criteria</li>
<li>Entry price determination (immediate or deferred)</li>
<li>Exit level calculation (must follow LONG/SHORT logic)</li>
<li>Time estimation using technical indicators</li>
</ul>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-0">getJsonTemplate</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Implementation:</strong> <a href="">src/lib/services/template/OptimizerTemplateService.ts:623-706</a></p>
<a id="component-configuration-templates" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Component Configuration Templates<a href="#component-configuration-templates" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><a id="getexchangetemplate" class="tsd-anchor"></a><h4 class="tsd-anchor-link">getExchangeTemplate<a href="#getexchangetemplate" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Generates <code>addExchange()</code> call with CCXT Binance integration. Includes:</p>
<ul>
<li><code>getCandles()</code>: Fetches OHLCV data via <code>fetchOHLCV()</code></li>
<li><code>formatPrice()</code>: Two decimal places</li>
<li><code>formatQuantity()</code>: Eight decimal places</li>
</ul>
<p>The exchange name is dynamically generated with a random prefix to avoid collisions.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-0">getExchangeTemplate</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-4">ExchangeName</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Implementation:</strong> <a href="">src/lib/services/template/OptimizerTemplateService.ts:308-336</a></p>
<a id="getframetemplate" class="tsd-anchor"></a><h4 class="tsd-anchor-link">getFrameTemplate<a href="#getframetemplate" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Generates <code>addFrame()</code> call defining a backtest timeframe. Parameters are escaped to prevent code injection attacks.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-0">getFrameTemplate</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-4">CandleInterval</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">startDate</span><span class="hl-1">: </span><span class="hl-4">Date</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">endDate</span><span class="hl-1">: </span><span class="hl-4">Date</span><br/><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Implementation:</strong> <a href="">src/lib/services/template/OptimizerTemplateService.ts:348-379</a></p>
<a id="getstrategytemplate" class="tsd-anchor"></a><h4 class="tsd-anchor-link">getStrategyTemplate<a href="#getstrategytemplate" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Generates <code>addStrategy()</code> call with multi-timeframe LLM integration. The strategy's <code>getSignal()</code> function:</p>
<ol>
<li>Fetches candles from four timeframes (1m, 5m, 15m, 1h)</li>
<li>Formats candles as markdown with timestamps</li>
<li>Builds message history with progressive timeframe analysis:
<ul>
<li>Message 1-2: Medium-term trend (1h)</li>
<li>Message 3-4: Short-term trend (15m)</li>
<li>Message 5-6: Primary timeframe (5m)</li>
<li>Message 7-8: Micro-structure (1m)</li>
<li>Message 9: Final signal request with injected strategy prompt</li>
</ul>
</li>
<li>Calls <code>json(messages)</code> to get structured signal</li>
<li>Calls <code>dumpJson()</code> to save conversation for debugging</li>
</ol>
<p>The strategy prompt from <code>getPrompt()</code> is escaped and injected into the final message, creating a feedback loop where the LLM both designed the strategy and executes it.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-0">getStrategyTemplate</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">prompt</span><span class="hl-1">: </span><span class="hl-4">string</span><br/><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Implementation:</strong> <a href="">src/lib/services/template/OptimizerTemplateService.ts:167-298</a></p>
<a id="getwalkertemplate" class="tsd-anchor"></a><h4 class="tsd-anchor-link">getWalkerTemplate<a href="#getwalkertemplate" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Generates <code>addWalker()</code> call for strategy comparison. References:</p>
<ul>
<li>Walker name (with random prefix)</li>
<li>Exchange name</li>
<li>Test frame name</li>
<li>Array of strategy names to compare</li>
</ul>
<p>All strings are escaped to prevent injection.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-0">getWalkerTemplate</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">walkerName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">strategies</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">[]</span><br/><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Implementation:</strong> <a href="">src/lib/services/template/OptimizerTemplateService.ts:121-156</a></p>
<a id="execution-templates" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Execution Templates<a href="#execution-templates" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><a id="getlaunchertemplate" class="tsd-anchor"></a><h4 class="tsd-anchor-link">getLauncherTemplate<a href="#getlaunchertemplate" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Generates Walker execution code with comprehensive event listeners:</p>
<ul>
<li><code>Walker.background()</code>: Async execution</li>
<li><code>listenSignalBacktest()</code>: Log each signal</li>
<li><code>listenBacktestProgress()</code>: Progress percentage and frame counts</li>
<li><code>listenWalkerProgress()</code>: Strategy comparison progress</li>
<li><code>listenWalkerComplete()</code>: Final results and auto-dump</li>
<li><code>listenDoneBacktest()</code>: Individual strategy completion</li>
<li><code>listenError()</code>: Error handling</li>
</ul>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-0">getLauncherTemplate</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">walkerName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Implementation:</strong> <a href="">src/lib/services/template/OptimizerTemplateService.ts:389-437</a></p>
<a id="conversation-formatting-templates" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Conversation Formatting Templates<a href="#conversation-formatting-templates" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><a id="getusermessage" class="tsd-anchor"></a><h4 class="tsd-anchor-link">getUserMessage<a href="#getusermessage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Formats data from a source into a user message for LLM conversation. Default implementation creates a simple prompt with JSON serialized data.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-4">getUserMessage</span><span class="hl-1">&lt;</span><span class="hl-4">Data</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-4">IOptimizerData</span><span class="hl-1">&gt;(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">data</span><span class="hl-1">: </span><span class="hl-4">Data</span><span class="hl-1">[],</span><br/><span class="hl-1">  </span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-4">string</span><br/><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Implementation:</strong> <a href="">src/lib/services/template/OptimizerTemplateService.ts:76-87</a></p>
<a id="getassistantmessage" class="tsd-anchor"></a><h4 class="tsd-anchor-link">getAssistantMessage<a href="#getassistantmessage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Formats the expected assistant response for a data source. Default implementation returns a simple acknowledgment (&quot;ОК&quot;).</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-4">getAssistantMessage</span><span class="hl-1">&lt;</span><span class="hl-4">Data</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-4">IOptimizerData</span><span class="hl-1">&gt;(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">data</span><span class="hl-1">: </span><span class="hl-4">Data</span><span class="hl-1">[],</span><br/><span class="hl-1">  </span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-4">string</span><br/><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Implementation:</strong> <a href="">src/lib/services/template/OptimizerTemplateService.ts:98-109</a></p>
<a id="code-assembly-pipeline" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Code Assembly Pipeline<a href="#code-assembly-pipeline" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The assembly pipeline in <code>GET_STRATEGY_CODE_FN</code> calls template methods in a specific sequence to build a complete executable file. The function generates unique prefixes for component names to prevent collisions between generated files.</p>
<p><strong>Assembly Sequence Diagram:</strong></p>
<p><img src="../media/91_Strategy_Code_Generation_1.svg" alt="Mermaid Diagram"></p>
<p><strong>Pipeline Implementation Details:</strong></p>
<p>The assembly pipeline consists of 9 sequential phases:</p>
<ol>
<li><strong>Top Banner</strong> - Imports and constants <a href="">src/client/ClientOptimizer.ts:233-236</a></li>
<li><strong>JSON Dump Helper</strong> - Debug output function <a href="">src/client/ClientOptimizer.ts:239-242</a></li>
<li><strong>Helper Functions</strong> - text() and json() LLM wrappers <a href="">src/client/ClientOptimizer.ts:245-253</a></li>
<li><strong>Exchange Configuration</strong> - CCXT integration <a href="">src/client/ClientOptimizer.ts:256-264</a></li>
<li><strong>Training Frames</strong> - One per rangeTrain entry <a href="">src/client/ClientOptimizer.ts:267-282</a></li>
<li><strong>Test Frame</strong> - Single validation frame <a href="">src/client/ClientOptimizer.ts:285-297</a></li>
<li><strong>Strategy Definitions</strong> - One per generated strategy <a href="">src/client/ClientOptimizer.ts:300-314</a></li>
<li><strong>Walker Configuration</strong> - Strategy comparison setup <a href="">src/client/ClientOptimizer.ts:317-332</a></li>
<li><strong>Launcher Code</strong> - Execution and event listeners <a href="">src/client/ClientOptimizer.ts:335-341</a></li>
</ol>
<p>Each section is separated by empty lines for readability. The <code>CREATE_PREFIX_FN()</code> generates a random 7-character identifier that prefixes all component names to ensure uniqueness.</p>
<a id="template-customization" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Template Customization<a href="#template-customization" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Templates can be partially overridden in the optimizer schema by providing a <code>template</code> field with custom implementations. The <code>OptimizerConnectionService</code> merges custom templates with defaults from <code>OptimizerTemplateService</code>.</p>
<p><strong>Template Merging Diagram:</strong></p>
<p><img src="../media/91_Strategy_Code_Generation_2.svg" alt="Mermaid Diagram"></p>
<p><strong>Example: Custom Strategy Template</strong></p>
<pre><code class="typescript"><span class="hl-0">addOptimizer</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">optimizerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-optimizer&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">rangeTrain:</span><span class="hl-1"> [</span><span class="hl-5">/* ... */</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">rangeTest:</span><span class="hl-1"> {</span><span class="hl-5">/* ... */</span><span class="hl-1">},</span><br/><span class="hl-1">  </span><span class="hl-4">source:</span><span class="hl-1"> [</span><span class="hl-5">/* ... */</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-0">getPrompt</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">messages</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><span class="hl-5">/* ... */</span><span class="hl-1">},</span><br/><span class="hl-1">  </span><span class="hl-4">template:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// Override only getStrategyTemplate</span><br/><span class="hl-1">    </span><span class="hl-0">getStrategyTemplate</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">prompt</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">`</span><br/><span class="hl-2">        addStrategy({</span><br/><span class="hl-2">          strategyName: &quot;</span><span class="hl-7">${</span><span class="hl-4">strategyName</span><span class="hl-7">}</span><span class="hl-2">&quot;,</span><br/><span class="hl-2">          interval: &quot;</span><span class="hl-7">${</span><span class="hl-4">interval</span><span class="hl-7">}</span><span class="hl-2">&quot;,</span><br/><span class="hl-2">          getSignal: async (symbol) =&gt; {</span><br/><span class="hl-2">            // Custom implementation without LLM</span><br/><span class="hl-2">            const candles = await getCandles(symbol, &quot;1m&quot;, 50);</span><br/><span class="hl-2">            // ... custom logic</span><br/><span class="hl-2">            return signal;</span><br/><span class="hl-2">          },</span><br/><span class="hl-2">        });</span><br/><span class="hl-2">      `</span><span class="hl-1">;</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-5">// All other methods use defaults</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>The merging process uses destructuring with default fallbacks:</p>
<pre><code class="typescript"><span class="hl-7">const</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-8">getAssistantMessage</span><span class="hl-1"> = </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">optimizerTemplateService</span><span class="hl-1">.</span><span class="hl-4">getAssistantMessage</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">getExchangeTemplate</span><span class="hl-1"> = </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">optimizerTemplateService</span><span class="hl-1">.</span><span class="hl-4">getExchangeTemplate</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">// ... all 11 methods</span><br/><span class="hl-1">} = </span><span class="hl-4">rawTemplate</span><span class="hl-1">;</span>
</code><button type="button">Copy</button></pre>

<p>This pattern allows selective override of any template method while maintaining defaults for others.</p>
<a id="generated-code-structure" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Generated Code Structure<a href="#generated-code-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The generated file follows a consistent structure designed for immediate execution. All components are configured in the correct order to satisfy dependency requirements.</p>
<p><strong>Generated File Structure:</strong></p>
<pre><code><span class="hl-5">#!/usr/bin/env node</span><br/><br/><span class="hl-5">// Imports (Ollama, CCXT, backtest-kit, fs, path, uuid)</span><br/><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">WARN_KB</span><span class="hl-1"> = </span><span class="hl-6">100</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Helper Functions</span><br/><span class="hl-7">async</span><span class="hl-1"> </span><span class="hl-7">function</span><span class="hl-1"> </span><span class="hl-0">dumpJson</span><span class="hl-1">(</span><span class="hl-4">resultId</span><span class="hl-1">, </span><span class="hl-4">history</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">, </span><span class="hl-4">outputDir</span><span class="hl-1">) { </span><span class="hl-5">/* ... */</span><span class="hl-1"> }</span><br/><span class="hl-7">async</span><span class="hl-1"> </span><span class="hl-7">function</span><span class="hl-1"> </span><span class="hl-0">text</span><span class="hl-1">(</span><span class="hl-4">messages</span><span class="hl-1">) { </span><span class="hl-5">/* ... */</span><span class="hl-1"> }</span><br/><span class="hl-7">async</span><span class="hl-1"> </span><span class="hl-7">function</span><span class="hl-1"> </span><span class="hl-0">json</span><span class="hl-1">(</span><span class="hl-4">messages</span><span class="hl-1">) { </span><span class="hl-5">/* ... */</span><span class="hl-1"> }</span><br/><br/><span class="hl-5">// Exchange Configuration</span><br/><span class="hl-0">addExchange</span><span class="hl-1">({ </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;{prefix}_exchange&quot;</span><span class="hl-1">, </span><span class="hl-4">getCandles:</span><span class="hl-1"> ..., </span><span class="hl-4">formatPrice:</span><span class="hl-1"> ..., </span><span class="hl-4">formatQuantity:</span><span class="hl-1"> ... });</span><br/><br/><span class="hl-5">// Training Frames</span><br/><span class="hl-0">addFrame</span><span class="hl-1">({ </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;{prefix}_train_frame-1&quot;</span><span class="hl-1">, </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;1m&quot;</span><span class="hl-1">, </span><span class="hl-4">startDate:</span><span class="hl-1"> ..., </span><span class="hl-4">endDate:</span><span class="hl-1"> ... });</span><br/><span class="hl-0">addFrame</span><span class="hl-1">({ </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;{prefix}_train_frame-2&quot;</span><span class="hl-1">, </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;1m&quot;</span><span class="hl-1">, </span><span class="hl-4">startDate:</span><span class="hl-1"> ..., </span><span class="hl-4">endDate:</span><span class="hl-1"> ... });</span><br/><span class="hl-5">// ... more training frames</span><br/><br/><span class="hl-5">// Test Frame</span><br/><span class="hl-0">addFrame</span><span class="hl-1">({ </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;{prefix}_test_frame&quot;</span><span class="hl-1">, </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;1m&quot;</span><span class="hl-1">, </span><span class="hl-4">startDate:</span><span class="hl-1"> ..., </span><span class="hl-4">endDate:</span><span class="hl-1"> ... });</span><br/><br/><span class="hl-5">// Strategies</span><br/><span class="hl-0">addStrategy</span><span class="hl-1">({ </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;{prefix}_strategy-1&quot;</span><span class="hl-1">, </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">, </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> { </span><span class="hl-5">/* LLM integration */</span><span class="hl-1"> } });</span><br/><span class="hl-0">addStrategy</span><span class="hl-1">({ </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;{prefix}_strategy-2&quot;</span><span class="hl-1">, </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">, </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> { </span><span class="hl-5">/* LLM integration */</span><span class="hl-1"> } });</span><br/><span class="hl-5">// ... more strategies</span><br/><br/><span class="hl-5">// Walker Configuration</span><br/><span class="hl-0">addWalker</span><span class="hl-1">({ </span><span class="hl-4">walkerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;{prefix}_walker&quot;</span><span class="hl-1">, </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;{prefix}_exchange&quot;</span><span class="hl-1">, </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;{prefix}_test_frame&quot;</span><span class="hl-1">, </span><span class="hl-4">strategies:</span><span class="hl-1"> [...] });</span><br/><br/><span class="hl-5">// Launcher</span><br/><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, { </span><span class="hl-4">walkerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;{prefix}_walker&quot;</span><span class="hl-1"> });</span><br/><span class="hl-0">listenSignalBacktest</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> { </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">); });</span><br/><span class="hl-0">listenBacktestProgress</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> { </span><span class="hl-5">/* ... */</span><span class="hl-1"> });</span><br/><span class="hl-0">listenWalkerProgress</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> { </span><span class="hl-5">/* ... */</span><span class="hl-1"> });</span><br/><span class="hl-0">listenWalkerComplete</span><span class="hl-1">((</span><span class="hl-4">results</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> { </span><span class="hl-5">/* ... */</span><span class="hl-1"> });</span><br/><span class="hl-0">listenDoneBacktest</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> { </span><span class="hl-5">/* ... */</span><span class="hl-1"> });</span><br/><span class="hl-0">listenError</span><span class="hl-1">((</span><span class="hl-4">error</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> { </span><span class="hl-5">/* ... */</span><span class="hl-1"> });</span>
</code><button>Copy</button></pre>

<p><strong>Naming Conventions:</strong></p>
<ul>
<li><code>{prefix}</code>: Random 7-character string from <code>CREATE_PREFIX_FN()</code></li>
<li>Exchange: <code>{prefix}_exchange</code></li>
<li>Train frames: <code>{prefix}_train_frame-{n}</code> (n = 1-based index)</li>
<li>Test frame: <code>{prefix}_test_frame</code></li>
<li>Strategies: <code>{prefix}_strategy-{n}</code> (n = 1-based index)</li>
<li>Walker: <code>{prefix}_walker</code></li>
</ul>
<p>The prefix ensures that multiple generated files can coexist in the same codebase without naming conflicts.</p>
<a id="security-and-escaping" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Security and Escaping<a href="#security-and-escaping" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>All template methods implement string escaping to prevent code injection attacks. User-controlled strings (symbol, names, prompts) are escaped before insertion into generated code.</p>
<p><strong>Escape Patterns by Template:</strong></p>
<table>
<thead>
<tr>
<th>Template</th>
<th>Escaped Parameters</th>
<th>Escape Pattern</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>getWalkerTemplate</code></td>
<td>walkerName, exchangeName, frameName, strategies</td>
<td>Backslash: <code>\\</code>, Quote: <code>\&quot;</code></td>
</tr>
<tr>
<td><code>getStrategyTemplate</code></td>
<td>strategyName, interval, prompt</td>
<td>Backslash: <code>\\</code>, Quote: <code>\&quot;</code>, Backtick: <code>\`</code>, Dollar: <code>\$</code></td>
</tr>
<tr>
<td><code>getExchangeTemplate</code></td>
<td>exchangeName</td>
<td>Backslash: <code>\\</code>, Quote: <code>\&quot;</code></td>
</tr>
<tr>
<td><code>getFrameTemplate</code></td>
<td>frameName, interval</td>
<td>Backslash: <code>\\</code>, Quote: <code>\&quot;</code></td>
</tr>
<tr>
<td><code>getLauncherTemplate</code></td>
<td>symbol, walkerName</td>
<td>Backslash: <code>\\</code>, Quote: <code>\&quot;</code></td>
</tr>
<tr>
<td><code>getTextTemplate</code></td>
<td>symbol</td>
<td>Backslash: <code>\\</code>, Backtick: <code>\`</code>, Dollar: <code>\$</code></td>
</tr>
</tbody>
</table>
<p><strong>Example from getStrategyTemplate:</strong></p>
<pre><code class="typescript"><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">escapedPrompt</span><span class="hl-1"> = </span><span class="hl-0">String</span><span class="hl-1">(</span><span class="hl-4">prompt</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-0">replace</span><span class="hl-1">(</span><span class="hl-15">/</span><span class="hl-12">\\</span><span class="hl-15">/</span><span class="hl-7">g</span><span class="hl-1">, </span><span class="hl-2">&#39;</span><span class="hl-12">\\\\</span><span class="hl-2">&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-0">replace</span><span class="hl-1">(</span><span class="hl-15">/`/</span><span class="hl-7">g</span><span class="hl-1">, </span><span class="hl-2">&#39;</span><span class="hl-12">\\</span><span class="hl-2">`&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-0">replace</span><span class="hl-1">(</span><span class="hl-15">/</span><span class="hl-12">\$</span><span class="hl-15">/</span><span class="hl-7">g</span><span class="hl-1">, </span><span class="hl-2">&#39;</span><span class="hl-12">\\</span><span class="hl-2">$&#39;</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p>The prompt escaping is particularly important since it contains LLM-generated content that will be embedded in a template literal. Without proper escaping, malicious content could break out of the string context.</p>
<a id="integration-with-execution-pipeline" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Integration with Execution Pipeline<a href="#integration-with-execution-pipeline" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The generated code integrates seamlessly with backtest-kit's execution modes. The Walker configuration uses the test frame to validate all generated strategies, producing a comparative report.</p>
<p><strong>Execution Flow:</strong></p>
<p><img src="../media/91_Strategy_Code_Generation_3.svg" alt="Mermaid Diagram"></p>
<p>The generated strategies use environment-based authentication (<code>process.env.OLLAMA_API_KEY</code>) for Ollama API access, allowing the same code to run in different environments without modification.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#strategy-code-generation"><span>Strategy <wbr/>Code <wbr/>Generation</span></a><ul><li><a href="#template-system-architecture"><span>Template <wbr/>System <wbr/>Architecture</span></a></li><li><ul><li><a href="#ioptimizertemplate-interface"><span>IOptimizer<wbr/>Template <wbr/>Interface</span></a></li></ul></li><li><a href="#template-method-reference"><span>Template <wbr/>Method <wbr/>Reference</span></a></li><li><ul><li><a href="#initialization-templates"><span>Initialization <wbr/>Templates</span></a></li><li><ul><li><a href="#gettopbanner"><span>get<wbr/>Top<wbr/>Banner</span></a></li></ul></li><li><a href="#helper-function-templates"><span>Helper <wbr/>Function <wbr/>Templates</span></a></li><li><ul><li><a href="#getjsondumptemplate"><span>get<wbr/>Json<wbr/>Dump<wbr/>Template</span></a></li><li><a href="#gettexttemplate"><span>get<wbr/>Text<wbr/>Template</span></a></li><li><a href="#getjsontemplate"><span>get<wbr/>Json<wbr/>Template</span></a></li></ul></li><li><a href="#component-configuration-templates"><span>Component <wbr/>Configuration <wbr/>Templates</span></a></li><li><ul><li><a href="#getexchangetemplate"><span>get<wbr/>Exchange<wbr/>Template</span></a></li><li><a href="#getframetemplate"><span>get<wbr/>Frame<wbr/>Template</span></a></li><li><a href="#getstrategytemplate"><span>get<wbr/>Strategy<wbr/>Template</span></a></li><li><a href="#getwalkertemplate"><span>get<wbr/>Walker<wbr/>Template</span></a></li></ul></li><li><a href="#execution-templates"><span>Execution <wbr/>Templates</span></a></li><li><ul><li><a href="#getlaunchertemplate"><span>get<wbr/>Launcher<wbr/>Template</span></a></li></ul></li><li><a href="#conversation-formatting-templates"><span>Conversation <wbr/>Formatting <wbr/>Templates</span></a></li><li><ul><li><a href="#getusermessage"><span>get<wbr/>User<wbr/>Message</span></a></li><li><a href="#getassistantmessage"><span>get<wbr/>Assistant<wbr/>Message</span></a></li></ul></li></ul></li><li><a href="#code-assembly-pipeline"><span>Code <wbr/>Assembly <wbr/>Pipeline</span></a></li><li><a href="#template-customization"><span>Template <wbr/>Customization</span></a></li><li><a href="#generated-code-structure"><span>Generated <wbr/>Code <wbr/>Structure</span></a></li><li><a href="#security-and-escaping"><span>Security and <wbr/>Escaping</span></a></li><li><a href="#integration-with-execution-pipeline"><span>Integration with <wbr/>Execution <wbr/>Pipeline</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
