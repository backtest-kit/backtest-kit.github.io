<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/33_clientexchange | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_33_clientexchange.html">design/33_clientexchange</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="clientexchange" class="tsd-anchor"></a><h1 class="tsd-anchor-link">ClientExchange<a href="#clientexchange" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><a id="purpose-and-scope" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Purpose and Scope<a href="#purpose-and-scope" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>ClientExchange</code> is the core data access class that provides market data to trading strategies through a unified interface. It wraps external exchange data providers (CCXT libraries, custom APIs, or database sources) and handles candle fetching, price formatting, and VWAP calculation. The class implements time-aware data fetching by using <code>ExecutionContextService</code> to determine the temporal boundary for historical vs. future data requests.</p>
<p>This document covers the implementation details of <code>ClientExchange</code> including its constructor parameters, core methods, retry logic, and integration with the execution context system. For exchange schema registration, see <a href="design_25_exchange_schemas.html">Exchange Schemas</a>. For how <code>ClientExchange</code> instances are managed and memoized, see <a href="design_54_timeframe_generation.html">Connection Services</a>.</p>
<hr>
<a id="architecture-overview" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Architecture Overview<a href="#architecture-overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>ClientExchange</code> sits in the Data &amp; Integration Layer and serves as the boundary between the framework's execution logic and external data sources. The class is instantiated by <code>ExchangeConnectionService</code>, wrapped by <code>ExchangeGlobalService</code> for context injection, and invoked by <code>ClientStrategy</code> during signal generation and by backtest logic during fast-forward simulation.</p>
<a id="integration-in-system-architecture" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Integration in System Architecture<a href="#integration-in-system-architecture" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/33_ClientExchange_0.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="constructor-and-configuration" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Constructor and Configuration<a href="#constructor-and-configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>ClientExchange</code> is instantiated with an <code>IExchangeParams</code> object that defines the exchange name, data provider functions, formatting functions, execution context reference, and logger.</p>
<a id="iexchangeparams-structure" class="tsd-anchor"></a><h3 class="tsd-anchor-link">IExchangeParams Structure<a href="#iexchangeparams-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>exchangeName</code></td>
<td><code>string</code></td>
<td>Unique identifier for the exchange (e.g., &quot;binance&quot;, &quot;bybit&quot;)</td>
</tr>
<tr>
<td><code>getCandles</code></td>
<td><code>(symbol, interval, since, limit) =&gt; Promise&lt;ICandleData[]&gt;</code></td>
<td>Function to fetch candles from data source starting at <code>since</code></td>
</tr>
<tr>
<td><code>formatPrice</code></td>
<td><code>(symbol, price) =&gt; Promise&lt;number&gt;</code></td>
<td>Function to format price to exchange precision</td>
</tr>
<tr>
<td><code>formatQuantity</code></td>
<td><code>(symbol, quantity) =&gt; Promise&lt;number&gt;</code></td>
<td>Function to format quantity to exchange precision</td>
</tr>
<tr>
<td><code>execution</code></td>
<td><code>ExecutionContextService</code></td>
<td>Reference to execution context for time-aware fetching</td>
</tr>
<tr>
<td><code>logger</code></td>
<td><code>LoggerService</code></td>
<td>Logger instance for debug/warn/error messages</td>
</tr>
<tr>
<td><code>callbacks?.onCandleData</code></td>
<td><code>(symbol, interval, since, limit, data) =&gt; void</code></td>
<td>Optional callback invoked after fetching candles</td>
</tr>
</tbody>
</table>
<a id="constructor-invocation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Constructor Invocation<a href="#constructor-invocation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">exchange</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">ClientExchange</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getCandles</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// CCXT implementation or custom data source</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">ccxt</span><span class="hl-1">.</span><span class="hl-0">fetchOHLCV</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">.</span><span class="hl-0">getTime</span><span class="hl-1">(), </span><span class="hl-4">limit</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">formatPrice</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">price</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-0">formatQuantity</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">quantity</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-8">8</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">execution:</span><span class="hl-1"> </span><span class="hl-4">executionContextService</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">logger:</span><span class="hl-1"> </span><span class="hl-4">loggerService</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onCandleData</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Fetched </span><span class="hl-6">${</span><span class="hl-4">data</span><span class="hl-9">.</span><span class="hl-4">length</span><span class="hl-6">}</span><span class="hl-2"> candles for </span><span class="hl-6">${</span><span class="hl-4">symbol</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="core-methods" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Core Methods<a href="#core-methods" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="getcandles-historical-data-fetching" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getCandles: Historical Data Fetching<a href="#getcandles-historical-data-fetching" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>getCandles</code> method fetches historical candles <strong>backwards</strong> from the execution context time (<code>ExecutionContextService.context.when</code>). This method is used by strategies during signal generation to analyze past market data.</p>
<a id="method-signature" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Method Signature<a href="#method-signature" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-4">async</span><span class="hl-1"> </span><span class="hl-0">getCandles</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-4">CandleInterval</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">limit</span><span class="hl-1">: </span><span class="hl-4">number</span><br/><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">ICandleData</span><span class="hl-1">[]&gt;</span>
</code><button type="button">Copy</button></pre>

<a id="time-calculation-logic" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Time Calculation Logic<a href="#time-calculation-logic" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p><img src="../media/33_ClientExchange_1.svg" alt="Mermaid Diagram"></p>
<p><strong>Implementation Details:</strong></p>
<ol>
<li>
<p><strong>Time Adjustment Calculation</strong> <a href="">src/client/ClientExchange.ts:201-212</a></p>
<ul>
<li>Converts interval to minutes using <code>INTERVAL_MINUTES</code> mapping <a href="">src/client/ClientExchange.ts:10-21</a></li>
<li>Calculates <code>adjust = step * limit - step</code></li>
<li>Computes <code>since = when - (adjust * 60 * 1000)</code></li>
</ul>
</li>
<li>
<p><strong>Retry Logic</strong> <a href="">src/client/ClientExchange.ts:214</a></p>
<ul>
<li>Delegates to <code>GET_CANDLES_FN</code> which retries <code>CC_GET_CANDLES_RETRY_COUNT</code> times</li>
<li>Sleeps <code>CC_GET_CANDLES_RETRY_DELAY_MS</code> between attempts <a href="">src/client/ClientExchange.ts:114-151</a></li>
</ul>
</li>
<li>
<p><strong>Range Filtering</strong> <a href="">src/client/ClientExchange.ts:217-229</a></p>
<ul>
<li>Filters candles to match <code>[since, when]</code> timestamp range</li>
<li>Warns if fewer candles returned than requested</li>
</ul>
</li>
<li>
<p><strong>Callback Invocation</strong> <a href="">src/client/ClientExchange.ts:231-239</a></p>
<ul>
<li>Calls <code>params.callbacks.onCandleData</code> if provided</li>
</ul>
</li>
</ol>
<hr>
<a id="getnextcandles-future-data-fetching" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getNextCandles: Future Data Fetching<a href="#getnextcandles-future-data-fetching" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>getNextCandles</code> method fetches candles <strong>forwards</strong> from the execution context time. This method is only used in backtest mode to retrieve candles for signal duration simulation. It returns an empty array if the requested time range extends beyond <code>Date.now()</code>.</p>
<a id="method-signature-1" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Method Signature<a href="#method-signature-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-4">async</span><span class="hl-1"> </span><span class="hl-0">getNextCandles</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-4">CandleInterval</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">limit</span><span class="hl-1">: </span><span class="hl-4">number</span><br/><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">ICandleData</span><span class="hl-1">[]&gt;</span>
</code><button type="button">Copy</button></pre>

<a id="backtest-vs-live-behavior" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Backtest vs Live Behavior<a href="#backtest-vs-live-behavior" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p><img src="../media/33_ClientExchange_2.svg" alt="Mermaid Diagram"></p>
<p><strong>Implementation Details:</strong></p>
<ol>
<li>
<p><strong>Time Range Validation</strong> <a href="">src/client/ClientExchange.ts:265-275</a></p>
<ul>
<li>Calculates <code>endTime = since + (limit * interval_minutes * 60 * 1000)</code></li>
<li>Returns empty array if <code>endTime &gt; Date.now()</code></li>
<li>Prevents fetching non-existent future data in live mode</li>
</ul>
</li>
<li>
<p><strong>Data Fetching</strong> <a href="">src/client/ClientExchange.ts:277</a></p>
<ul>
<li>Uses same <code>GET_CANDLES_FN</code> retry logic as <code>getCandles</code></li>
<li>Starts from <code>when</code> timestamp instead of adjusted historical time</li>
</ul>
</li>
<li>
<p><strong>Usage in Backtest</strong> <a href="">src/lib/services/logic/private/BacktestLogicPrivateService.ts:127-155</a></p>
<ul>
<li>Called when scheduled signal is detected</li>
<li>Fetches <code>CC_SCHEDULE_AWAIT_MINUTES + minuteEstimatedTime + 1</code> candles</li>
<li>Used to simulate scheduled signal activation and closure</li>
</ul>
</li>
</ol>
<hr>
<a id="getaverageprice-vwap-calculation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getAveragePrice: VWAP Calculation<a href="#getaverageprice-vwap-calculation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>getAveragePrice</code> method computes the Volume Weighted Average Price (VWAP) from the last N 1-minute candles, where N is configurable via <code>GLOBAL_CONFIG.CC_AVG_PRICE_CANDLES_COUNT</code> (default: 5).</p>
<a id="method-signature-2" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Method Signature<a href="#method-signature-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-4">async</span><span class="hl-1"> </span><span class="hl-0">getAveragePrice</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">number</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<a id="vwap-calculation-algorithm" class="tsd-anchor"></a><h4 class="tsd-anchor-link">VWAP Calculation Algorithm<a href="#vwap-calculation-algorithm" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p><img src="../media/33_ClientExchange_3.svg" alt="Mermaid Diagram"></p>
<p><strong>Implementation Details:</strong></p>
<ol>
<li>
<p><strong>Typical Price Formula</strong> <a href="">src/client/ClientExchange.ts:340</a></p>
<ul>
<li><code>typicalPrice = (high + low + close) / 3</code></li>
<li>Uses the average of high, low, and close prices</li>
</ul>
</li>
<li>
<p><strong>VWAP Formula</strong> <a href="">src/client/ClientExchange.ts:339-352</a></p>
<ul>
<li><code>VWAP = sum(typicalPrice * volume) / sum(volume)</code></li>
<li>Weights each candle's typical price by its trading volume</li>
</ul>
</li>
<li>
<p><strong>Zero Volume Fallback</strong> <a href="">src/client/ClientExchange.ts:346-349</a></p>
<ul>
<li>Returns simple average of close prices if total volume is zero</li>
<li>Ensures method always returns a valid price</li>
</ul>
</li>
<li>
<p><strong>Usage Context</strong></p>
<ul>
<li>Called by <code>ClientStrategy.backtest()</code> during signal closure simulation</li>
<li>Used to determine realistic fill prices in backtesting</li>
</ul>
</li>
</ol>
<hr>
<a id="formatprice-and-formatquantity" class="tsd-anchor"></a><h3 class="tsd-anchor-link">formatPrice and formatQuantity<a href="#formatprice-and-formatquantity" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>These methods delegate to user-provided formatting functions to ensure prices and quantities conform to exchange-specific precision requirements.</p>
<a id="method-signatures" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Method Signatures<a href="#method-signatures" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-4">async</span><span class="hl-1"> </span><span class="hl-0">formatPrice</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">number</span><span class="hl-1">&gt;</span><br/><span class="hl-4">async</span><span class="hl-1"> </span><span class="hl-0">formatQuantity</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">number</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Implementation:</strong> Direct delegation to <code>params.formatPrice</code> and <code>params.formatQuantity</code> with logging <a href="">src/client/ClientExchange.ts:357-371</a></p>
<p><strong>Typical Use Cases:</strong></p>
<ul>
<li><code>formatPrice</code>: Rounds price to exchange's tick size (e.g., 0.01 for BTCUSDT)</li>
<li><code>formatQuantity</code>: Rounds quantity to exchange's lot size (e.g., 0.00001 BTC)</li>
</ul>
<hr>
<a id="validation-and-retry-logic" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Validation and Retry Logic<a href="#validation-and-retry-logic" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>ClientExchange</code> implements robust validation and retry mechanisms to handle data quality issues and transient failures from external data sources.</p>
<a id="incomplete-candle-detection" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Incomplete Candle Detection<a href="#incomplete-candle-detection" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>VALIDATE_NO_INCOMPLETE_CANDLES_FN</code> function detects anomalous candles that result from incomplete API responses, such as prices that are orders of magnitude too low or zero volumes.</p>
<a id="validation-algorithm" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Validation Algorithm<a href="#validation-algorithm" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p><img src="../media/33_ClientExchange_4.svg" alt="Mermaid Diagram"></p>
<p><strong>Validation Checks:</strong> <a href="">src/client/ClientExchange.ts:31-105</a></p>
<ol>
<li>
<p><strong>Reference Price Calculation</strong> <a href="">src/client/ClientExchange.ts:39-56</a></p>
<ul>
<li>Uses median for datasets &gt;= <code>CC_GET_CANDLES_MIN_CANDLES_FOR_MEDIAN</code></li>
<li>Uses average for smaller datasets (more stable)</li>
</ul>
</li>
<li>
<p><strong>Numeric Validity</strong> <a href="">src/client/ClientExchange.ts:65-76</a></p>
<ul>
<li>Ensures all OHLCV values are finite (not NaN or Infinity)</li>
</ul>
</li>
<li>
<p><strong>Positivity Check</strong> <a href="">src/client/ClientExchange.ts:79-89</a></p>
<ul>
<li>All OHLC prices must be positive</li>
<li>Volume must be non-negative</li>
</ul>
</li>
<li>
<p><strong>Anomaly Detection</strong> <a href="">src/client/ClientExchange.ts:92-104</a></p>
<ul>
<li>Flags prices below <code>referencePrice / CC_GET_CANDLES_PRICE_ANOMALY_THRESHOLD_FACTOR</code></li>
<li>Default factor: 10 (prices 10x lower than median are rejected)</li>
</ul>
</li>
</ol>
<hr>
<a id="retry-logic" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Retry Logic<a href="#retry-logic" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>GET_CANDLES_FN</code> helper implements automatic retry with exponential backoff for transient failures.</p>
<a id="retry-flow" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Retry Flow<a href="#retry-flow" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p><img src="../media/33_ClientExchange_5.svg" alt="Mermaid Diagram"></p>
<p><strong>Configuration Parameters:</strong></p>
<ul>
<li><code>CC_GET_CANDLES_RETRY_COUNT</code>: Number of retry attempts (default: 3) <a href="">src/config/params.ts:15</a></li>
<li><code>CC_GET_CANDLES_RETRY_DELAY_MS</code>: Delay between retries in milliseconds (default: 1000) <a href="">src/config/params.ts:16</a></li>
</ul>
<hr>
<a id="context-integration" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Context Integration<a href="#context-integration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>ClientExchange</code> depends on <code>ExecutionContextService</code> to determine the current temporal position, which controls the boundary between historical and future data requests.</p>
<a id="executioncontext-usage" class="tsd-anchor"></a><h3 class="tsd-anchor-link">ExecutionContext Usage<a href="#executioncontext-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/33_ClientExchange_6.svg" alt="Mermaid Diagram"></p>
<p><strong>Key Context Dependencies:</strong></p>
<ol>
<li>
<p><strong>Backtest Mode</strong> <a href="">src/client/ClientExchange.ts:265-275</a></p>
<ul>
<li><code>getNextCandles</code> checks if <code>endTime &gt; Date.now()</code></li>
<li>Returns empty array in live mode (prevents future data access)</li>
<li>Returns historical data in backtest mode</li>
</ul>
</li>
<li>
<p><strong>Time Boundaries</strong> <a href="">src/client/ClientExchange.ts:211-212</a>, <a href="">src/client/ClientExchange.ts:217-223</a></p>
<ul>
<li>All candle fetches use <code>execution.context.when</code> as reference</li>
<li>Ensures consistent temporal perspective across all data requests</li>
</ul>
</li>
<li>
<p><strong>Symbol Context</strong> <a href="">src/interfaces/Exchange.interface.ts:18-35</a></p>
<ul>
<li>Exchange methods receive symbol from strategy invocation</li>
<li>No implicit symbol storage in <code>ClientExchange</code></li>
</ul>
</li>
</ol>
<hr>
<a id="usage-patterns" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage Patterns<a href="#usage-patterns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="strategy-signal-generation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Strategy Signal Generation<a href="#strategy-signal-generation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// Inside ClientStrategy.tick()</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">exchange</span><span class="hl-1"> = </span><span class="hl-4">exchangeGlobalService</span><span class="hl-1">.</span><span class="hl-0">getExchange</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">exchangeName</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">candles</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">getCandles</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;1h&quot;</span><span class="hl-1">, </span><span class="hl-8">24</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Analyze candles and generate signal</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">signal</span><span class="hl-1"> = </span><span class="hl-4">strategy</span><span class="hl-1">.</span><span class="hl-0">getSignal</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">candles</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="backtest-fast-forward-simulation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Backtest Fast-Forward Simulation<a href="#backtest-fast-forward-simulation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// Inside BacktestLogicPrivateService.run()</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;opened&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">candles</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">exchangeGlobalService</span><span class="hl-1">.</span><span class="hl-0">getNextCandles</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-4">symbol</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;1m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">minuteEstimatedTime</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">when</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">true</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">backtestResult</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">strategyGlobalService</span><span class="hl-1">.</span><span class="hl-0">backtest</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">candles</span><span class="hl-1">, </span><span class="hl-4">when</span><span class="hl-1">, </span><span class="hl-6">true</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="vwap-price-calculation-for-signal-closure" class="tsd-anchor"></a><h3 class="tsd-anchor-link">VWAP Price Calculation for Signal Closure<a href="#vwap-price-calculation-for-signal-closure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// Inside ClientStrategy.backtest()</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">vwap</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">params</span><span class="hl-1">.</span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">getAveragePrice</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">pnl</span><span class="hl-1"> = </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-0">calculatePnL</span><span class="hl-1">(</span><span class="hl-4">signal</span><span class="hl-1">, </span><span class="hl-4">vwap</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="custom-exchange-integration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Custom Exchange Integration<a href="#custom-exchange-integration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addExchange</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addExchange</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;custom-database&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getCandles</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">query</span><span class="hl-1"> = </span><span class="hl-2">`</span><br/><span class="hl-2">      SELECT timestamp, open, high, low, close, volume</span><br/><span class="hl-2">      FROM candles</span><br/><span class="hl-2">      WHERE symbol = ? AND interval = ? AND timestamp &gt;= ?</span><br/><span class="hl-2">      ORDER BY timestamp ASC</span><br/><span class="hl-2">      LIMIT ?</span><br/><span class="hl-2">    `</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">rows</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">db</span><span class="hl-1">.</span><span class="hl-0">query</span><span class="hl-1">(</span><span class="hl-4">query</span><span class="hl-1">, [</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">.</span><span class="hl-0">getTime</span><span class="hl-1">(), </span><span class="hl-4">limit</span><span class="hl-1">]);</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">rows</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">row</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">      </span><span class="hl-4">timestamp:</span><span class="hl-1"> </span><span class="hl-4">row</span><span class="hl-1">.</span><span class="hl-4">timestamp</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">open:</span><span class="hl-1"> </span><span class="hl-4">row</span><span class="hl-1">.</span><span class="hl-4">open</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">high:</span><span class="hl-1"> </span><span class="hl-4">row</span><span class="hl-1">.</span><span class="hl-4">high</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">low:</span><span class="hl-1"> </span><span class="hl-4">row</span><span class="hl-1">.</span><span class="hl-4">low</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">close:</span><span class="hl-1"> </span><span class="hl-4">row</span><span class="hl-1">.</span><span class="hl-4">close</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">volume:</span><span class="hl-1"> </span><span class="hl-4">row</span><span class="hl-1">.</span><span class="hl-4">volume</span><br/><span class="hl-1">    }));</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">formatPrice</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">precision</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">db</span><span class="hl-1">.</span><span class="hl-0">getPricePrecision</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-0">Number</span><span class="hl-1">(</span><span class="hl-4">price</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-4">precision</span><span class="hl-1">));</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">formatQuantity</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">precision</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">db</span><span class="hl-1">.</span><span class="hl-0">getQuantityPrecision</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-0">Number</span><span class="hl-1">(</span><span class="hl-4">quantity</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-4">precision</span><span class="hl-1">));</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#clientexchange"><span>Client<wbr/>Exchange</span></a><ul><li><a href="#purpose-and-scope"><span>Purpose and <wbr/>Scope</span></a></li><li><a href="#architecture-overview"><span>Architecture <wbr/>Overview</span></a></li><li><ul><li><a href="#integration-in-system-architecture"><span>Integration in <wbr/>System <wbr/>Architecture</span></a></li></ul></li><li><a href="#constructor-and-configuration"><span>Constructor and <wbr/>Configuration</span></a></li><li><ul><li><a href="#iexchangeparams-structure"><span>IExchange<wbr/>Params <wbr/>Structure</span></a></li><li><a href="#constructor-invocation"><span>Constructor <wbr/>Invocation</span></a></li></ul></li><li><a href="#core-methods"><span>Core <wbr/>Methods</span></a></li><li><ul><li><a href="#getcandles-historical-data-fetching"><span>get<wbr/>Candles: <wbr/>Historical <wbr/>Data <wbr/>Fetching</span></a></li><li><ul><li><a href="#method-signature"><span>Method <wbr/>Signature</span></a></li><li><a href="#time-calculation-logic"><span>Time <wbr/>Calculation <wbr/>Logic</span></a></li></ul></li><li><a href="#getnextcandles-future-data-fetching"><span>get<wbr/>Next<wbr/>Candles: <wbr/>Future <wbr/>Data <wbr/>Fetching</span></a></li><li><ul><li><a href="#method-signature-1"><span>Method <wbr/>Signature</span></a></li><li><a href="#backtest-vs-live-behavior"><span>Backtest vs <wbr/>Live <wbr/>Behavior</span></a></li></ul></li><li><a href="#getaverageprice-vwap-calculation"><span>get<wbr/>Average<wbr/>Price: VWAP <wbr/>Calculation</span></a></li><li><ul><li><a href="#method-signature-2"><span>Method <wbr/>Signature</span></a></li><li><a href="#vwap-calculation-algorithm"><span>VWAP <wbr/>Calculation <wbr/>Algorithm</span></a></li></ul></li><li><a href="#formatprice-and-formatquantity"><span>format<wbr/>Price and format<wbr/>Quantity</span></a></li><li><ul><li><a href="#method-signatures"><span>Method <wbr/>Signatures</span></a></li></ul></li></ul></li><li><a href="#validation-and-retry-logic"><span>Validation and <wbr/>Retry <wbr/>Logic</span></a></li><li><ul><li><a href="#incomplete-candle-detection"><span>Incomplete <wbr/>Candle <wbr/>Detection</span></a></li><li><ul><li><a href="#validation-algorithm"><span>Validation <wbr/>Algorithm</span></a></li></ul></li><li><a href="#retry-logic"><span>Retry <wbr/>Logic</span></a></li><li><ul><li><a href="#retry-flow"><span>Retry <wbr/>Flow</span></a></li></ul></li></ul></li><li><a href="#context-integration"><span>Context <wbr/>Integration</span></a></li><li><ul><li><a href="#executioncontext-usage"><span>Execution<wbr/>Context <wbr/>Usage</span></a></li></ul></li><li><a href="#usage-patterns"><span>Usage <wbr/>Patterns</span></a></li><li><ul><li><a href="#strategy-signal-generation"><span>Strategy <wbr/>Signal <wbr/>Generation</span></a></li><li><a href="#backtest-fast-forward-simulation"><span>Backtest <wbr/>Fast-<wbr/>Forward <wbr/>Simulation</span></a></li><li><a href="#vwap-price-calculation-for-signal-closure"><span>VWAP <wbr/>Price <wbr/>Calculation for <wbr/>Signal <wbr/>Closure</span></a></li><li><a href="#custom-exchange-integration"><span>Custom <wbr/>Exchange <wbr/>Integration</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
