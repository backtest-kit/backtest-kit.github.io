<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/68_markdown_report_generation | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_68_markdown_report_generation.html">design/68_markdown_report_generation</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="markdown-report-generation" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Markdown Report Generation<a href="#markdown-report-generation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><a id="purpose-and-scope" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Purpose and Scope<a href="#purpose-and-scope" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This document explains the markdown report generation system in backtest-kit. The framework provides two specialized services—<code>BacktestMarkdownService</code> and <code>LiveMarkdownService</code>—that passively observe signal execution events and generate formatted markdown reports with detailed signal information, statistics, and performance metrics.</p>
<p>These services act as event listeners that accumulate data without affecting execution flow. For information about the signal lifecycle events being observed, see <a href="design_44_signal_lifecycle.html">Signal Lifecycle</a>. For performance metrics calculation, see <a href="design_69_performance_metrics.html">Performance Metrics</a>.</p>
<hr>
<a id="service-architecture" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Service Architecture<a href="#service-architecture" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The markdown generation system uses two mode-specific services that share a common design pattern but differ in data accumulation strategy:</p>
<table>
<thead>
<tr>
<th>Service</th>
<th>Mode</th>
<th>Events Tracked</th>
<th>Output Location</th>
<th>Statistics</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>BacktestMarkdownService</code></td>
<td>Backtest</td>
<td>Closed signals only</td>
<td><code>./logs/backtest/{strategyName}.md</code></td>
<td>Total signals</td>
</tr>
<tr>
<td><code>LiveMarkdownService</code></td>
<td>Live</td>
<td>All events (idle, opened, active, closed)</td>
<td><code>./logs/live/{strategyName}.md</code></td>
<td>Win rate, average PNL, signal counts</td>
</tr>
</tbody>
</table>
<p>Both services follow the observer pattern, subscribing to signal emitters and accumulating data in isolated <code>ReportStorage</code> instances per strategy.</p>
<hr>
<a id="event-flow-architecture" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Event Flow Architecture<a href="#event-flow-architecture" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/68_Markdown_Report_Generation_0.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Signal Event Flow to Markdown Reports</strong></p>
<p>The services subscribe to emitters during initialization and passively accumulate data. The <code>BacktestMarkdownService</code> only processes closed signals, while <code>LiveMarkdownService</code> tracks all event types to provide a complete operational timeline.</p>
<hr>
<a id="reportstorage-pattern" class="tsd-anchor"></a><h2 class="tsd-anchor-link">ReportStorage Pattern<a href="#reportstorage-pattern" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Both services use an internal <code>ReportStorage</code> class to isolate data accumulation logic. Each strategy receives its own memoized storage instance, preventing data contamination between concurrent strategies.</p>
<p><img src="../media/68_Markdown_Report_Generation_1.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Service and Storage Class Structure</strong></p>
<p>The memoization pattern is implemented using <code>functools-kit</code>'s <code>memoize</code> function, which caches storage instances by strategy name. This ensures each strategy maintains isolated state even when multiple strategies run concurrently.</p>
<hr>
<a id="column-configuration-system" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Column Configuration System<a href="#column-configuration-system" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Both services define column configurations that specify how to extract and format data from signal events. Each column contains a key, label, and formatting function.</p>
<a id="backtest-columns" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Backtest Columns<a href="#backtest-columns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>BacktestMarkdownService</code> uses 13 columns optimized for closed signal analysis:</p>
<table>
<thead>
<tr>
<th>Column Key</th>
<th>Label</th>
<th>Format</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>signalId</code></td>
<td>Signal ID</td>
<td>Signal UUID</td>
</tr>
<tr>
<td><code>symbol</code></td>
<td>Symbol</td>
<td>Trading pair</td>
</tr>
<tr>
<td><code>position</code></td>
<td>Position</td>
<td>LONG/SHORT</td>
</tr>
<tr>
<td><code>note</code></td>
<td>Note</td>
<td>User note or &quot;N/A&quot;</td>
</tr>
<tr>
<td><code>openPrice</code></td>
<td>Open Price</td>
<td>Fixed 8 decimals USD</td>
</tr>
<tr>
<td><code>closePrice</code></td>
<td>Close Price</td>
<td>Fixed 8 decimals USD</td>
</tr>
<tr>
<td><code>takeProfit</code></td>
<td>Take Profit</td>
<td>Fixed 8 decimals USD</td>
</tr>
<tr>
<td><code>stopLoss</code></td>
<td>Stop Loss</td>
<td>Fixed 8 decimals USD</td>
</tr>
<tr>
<td><code>pnl</code></td>
<td>PNL (net)</td>
<td>Percentage with +/- prefix</td>
</tr>
<tr>
<td><code>closeReason</code></td>
<td>Close Reason</td>
<td>TP/SL/EXPIRED</td>
</tr>
<tr>
<td><code>duration</code></td>
<td>Duration (min)</td>
<td>Minutes rounded</td>
</tr>
<tr>
<td><code>openTimestamp</code></td>
<td>Open Time</td>
<td>ISO 8601 format</td>
</tr>
<tr>
<td><code>closeTimestamp</code></td>
<td>Close Time</td>
<td>ISO 8601 format</td>
</tr>
</tbody>
</table>
<a id="live-trading-columns" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Live Trading Columns<a href="#live-trading-columns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>LiveMarkdownService</code> uses 13 columns that accommodate all event types:</p>
<table>
<thead>
<tr>
<th>Column Key</th>
<th>Label</th>
<th>Special Handling</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>timestamp</code></td>
<td>Timestamp</td>
<td>ISO 8601 format</td>
</tr>
<tr>
<td><code>action</code></td>
<td>Action</td>
<td>IDLE/OPENED/ACTIVE/CLOSED</td>
</tr>
<tr>
<td><code>symbol</code></td>
<td>Symbol</td>
<td>&quot;N/A&quot; for idle events</td>
</tr>
<tr>
<td><code>signalId</code></td>
<td>Signal ID</td>
<td>&quot;N/A&quot; for idle events</td>
</tr>
<tr>
<td><code>position</code></td>
<td>Position</td>
<td>&quot;N/A&quot; for idle events</td>
</tr>
<tr>
<td><code>note</code></td>
<td>Note</td>
<td>Optional user note</td>
</tr>
<tr>
<td><code>currentPrice</code></td>
<td>Current Price</td>
<td>Always present</td>
</tr>
<tr>
<td><code>openPrice</code></td>
<td>Open Price</td>
<td>&quot;N/A&quot; for idle events</td>
</tr>
<tr>
<td><code>takeProfit</code></td>
<td>Take Profit</td>
<td>&quot;N/A&quot; for idle events</td>
</tr>
<tr>
<td><code>stopLoss</code></td>
<td>Stop Loss</td>
<td>&quot;N/A&quot; for idle events</td>
</tr>
<tr>
<td><code>pnl</code></td>
<td>PNL (net)</td>
<td>Only for closed events</td>
</tr>
<tr>
<td><code>closeReason</code></td>
<td>Close Reason</td>
<td>Only for closed events</td>
</tr>
<tr>
<td><code>duration</code></td>
<td>Duration (min)</td>
<td>Only for closed events</td>
</tr>
</tbody>
</table>
<hr>
<a id="report-generation-pipeline" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Report Generation Pipeline<a href="#report-generation-pipeline" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/68_Markdown_Report_Generation_2.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Report Generation Sequence</strong></p>
<p>The report generation process is lazy—no computation occurs until <code>getReport()</code> is called. This allows the services to accumulate data with minimal overhead during execution.</p>
<hr>
<a id="table-formatting-implementation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Table Formatting Implementation<a href="#table-formatting-implementation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Both services use <code>functools-kit</code>'s <code>str.table()</code> utility to generate markdown tables. The process follows these steps:</p>
<ol>
<li><strong>Extract Headers:</strong> Map column labels to header row</li>
<li><strong>Format Rows:</strong> Apply each column's format function to signal data</li>
<li><strong>Build Table Data:</strong> Combine header and rows into 2D array</li>
<li><strong>Generate Markdown:</strong> Pass to <code>str.table()</code> for formatting</li>
</ol>
<p>The resulting markdown follows standard table syntax:</p>
<pre><code class="markdown">| Signal ID | Symbol | Position | ... |
|-----------|--------|----------|-----|
| abc-123   | BTCUSD | LONG     | ... |
| def-456   | ETHUSD | SHORT    | ... |
</code><button type="button">Copy</button></pre>

<hr>
<a id="event-accumulation-strategies" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Event Accumulation Strategies<a href="#event-accumulation-strategies" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="backtestmarkdownservice-strategy" class="tsd-anchor"></a><h3 class="tsd-anchor-link">BacktestMarkdownService Strategy<a href="#backtestmarkdownservice-strategy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The backtest service implements a simple append-only accumulation:</p>
<p><img src="../media/68_Markdown_Report_Generation_3.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Backtest Event Accumulation State Machine</strong></p>
<p>The filter logic at <a href="">src/lib/services/markdown/BacktestMarkdownService.ts:245-247</a> ensures only closed signals with complete PNL information are recorded.</p>
<a id="livemarkdownservice-strategy" class="tsd-anchor"></a><h3 class="tsd-anchor-link">LiveMarkdownService Strategy<a href="#livemarkdownservice-strategy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The live service maintains a comprehensive event timeline with update logic for active and closed events:</p>
<p><img src="../media/68_Markdown_Report_Generation_4.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Live Event Accumulation Logic</strong></p>
<p>The update logic at <a href="">src/lib/services/markdown/LiveMarkdownService.ts:187-210</a> and <a href="">src/lib/services/markdown/LiveMarkdownService.ts:219-250</a> replaces previous events with the same signal ID, ensuring the report always shows the latest state of each signal.</p>
<hr>
<a id="statistics-generation-live-only" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Statistics Generation (Live Only)<a href="#statistics-generation-live-only" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>LiveMarkdownService</code> calculates real-time performance statistics from closed events:</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Calculation</th>
<th>Source</th>
</tr>
</thead>
<tbody>
<tr>
<td>Total Events</td>
<td><code>_eventList.length</code></td>
<td>All recorded events</td>
</tr>
<tr>
<td>Closed Signals</td>
<td><code>filter(e =&gt; e.action === &quot;closed&quot;).length</code></td>
<td>Completed trades</td>
</tr>
<tr>
<td>Win Count</td>
<td><code>filter(e =&gt; e.pnl &amp;&amp; e.pnl &gt; 0).length</code></td>
<td>Profitable trades</td>
</tr>
<tr>
<td>Loss Count</td>
<td><code>filter(e =&gt; e.pnl &amp;&amp; e.pnl &lt; 0).length</code></td>
<td>Losing trades</td>
</tr>
<tr>
<td>Win Rate</td>
<td><code>(winCount / totalClosed) * 100</code></td>
<td>Percentage success</td>
</tr>
<tr>
<td>Average PNL</td>
<td><code>sum(e.pnl) / totalClosed</code></td>
<td>Mean profit/loss</td>
</tr>
</tbody>
</table>
<p>These statistics appear in the report header:</p>
<pre><code class="markdown"># Live Trading Report: my-strategy

Total events: 247
Closed signals: 18
Win rate: 66.67% (12W / 6L)
Average PNL: +1.23%
</code><button type="button">Copy</button></pre>

<hr>
<a id="public-api-methods" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Public API Methods<a href="#public-api-methods" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="getreportstrategyname" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getReport(strategyName)<a href="#getreportstrategyname" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Generates and returns a markdown report string for the specified strategy. This method is synchronous in practice despite returning a Promise—the computation happens in-memory from accumulated data.</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">markdown</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">backtestMarkdownService</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">markdown</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="dumpstrategyname-path" class="tsd-anchor"></a><h3 class="tsd-anchor-link">dump(strategyName, path?)<a href="#dumpstrategyname-path" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Saves the markdown report to disk. The method creates the directory if it doesn't exist using <code>mkdir</code> with <code>recursive: true</code>. Default paths:</p>
<ul>
<li>Backtest: <code>./logs/backtest/{strategyName}.md</code></li>
<li>Live: <code>./logs/live/{strategyName}.md</code></li>
</ul>
<pre><code class="typescript"><span class="hl-5">// Save to default location</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">backtestMarkdownService</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Save to custom location</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">liveMarkdownService</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;./custom/reports&quot;</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="clearstrategyname" class="tsd-anchor"></a><h3 class="tsd-anchor-link">clear(strategyName?)<a href="#clearstrategyname" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Clears accumulated data from memory. If <code>strategyName</code> is provided, only that strategy's storage is cleared. If omitted, all storage instances are cleared via the memoization cache.</p>
<pre><code class="typescript"><span class="hl-5">// Clear specific strategy</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">backtestMarkdownService</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Clear all strategies</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">backtestMarkdownService</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">();</span>
</code><button type="button">Copy</button></pre>

<a id="init" class="tsd-anchor"></a><h3 class="tsd-anchor-link">init()<a href="#init" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Initializes the service by subscribing to the appropriate event emitter. Uses <code>functools-kit</code>'s <code>singleshot</code> pattern to ensure subscription happens only once, even if called multiple times. Automatically invoked on first use.</p>
<hr>
<a id="integration-with-service-layer" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Integration with Service Layer<a href="#integration-with-service-layer" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The markdown services are registered in the dependency injection container and integrated into the backtest aggregator object:</p>
<p><img src="../media/68_Markdown_Report_Generation_5.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: DI Integration for Markdown Services</strong></p>
<p>The services are accessible through the main <code>backtest</code> object, providing a unified API for report generation across both backtest and live modes.</p>
<hr>
<a id="error-handling" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Error Handling<a href="#error-handling" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Both services implement defensive error handling for file system operations:</p>
<ol>
<li><strong>Directory Creation:</strong> Uses <code>mkdir</code> with <code>recursive: true</code> to ensure parent directories exist</li>
<li><strong>Write Failures:</strong> Catches and logs errors without throwing, allowing execution to continue</li>
<li><strong>Invalid Data:</strong> Gracefully handles empty signal lists with informative messages</li>
</ol>
<p>Error output example from <a href="">src/lib/services/markdown/BacktestMarkdownService.ts:176</a>:</p>
<pre><code class="typescript"><span class="hl-3">catch</span><span class="hl-1"> (</span><span class="hl-4">error</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">`Failed to save markdown report:`</span><span class="hl-1">, </span><span class="hl-4">error</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="usage-examples" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage Examples<a href="#usage-examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="backtest-report-generation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Backtest Report Generation<a href="#backtest-report-generation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Backtest</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Run backtest</span><br/><span class="hl-3">for</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">result</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSD&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;trend-follower&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;daily&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">})) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Signal </span><span class="hl-6">${</span><span class="hl-4">result</span><span class="hl-9">.</span><span class="hl-4">action</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Generate report</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">markdown</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-2">&quot;trend-follower&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">markdown</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Save to disk</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;trend-follower&quot;</span><span class="hl-1">);</span><br/><span class="hl-5">// Output: ./logs/backtest/trend-follower.md</span>
</code><button type="button">Copy</button></pre>

<a id="live-trading-report-generation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Live Trading Report Generation<a href="#live-trading-report-generation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Live</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Run live trading in background</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">generator</span><span class="hl-1"> = </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;ETHUSD&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;scalper&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Later: check current report status</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">markdown</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-2">&quot;scalper&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">markdown</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Save to custom location</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;scalper&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;./reports/live&quot;</span><span class="hl-1">);</span><br/><span class="hl-5">// Output: ./reports/live/scalper.md</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="performance-considerations" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Performance Considerations<a href="#performance-considerations" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="memory-efficiency" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Memory Efficiency<a href="#memory-efficiency" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>Backtest:</strong> Stores only closed signals, typically 10-1000 signals per strategy</li>
<li><strong>Live:</strong> Stores all events, but uses update logic to prevent unbounded growth for active signals</li>
<li><strong>Isolation:</strong> Memoized storage prevents cross-strategy interference</li>
<li><strong>Lazy Generation:</strong> Reports computed only when requested</li>
</ul>
<a id="computation-overhead" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Computation Overhead<a href="#computation-overhead" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>Event Processing:</strong> O(1) for backtest, O(n) for live due to signal ID search</li>
<li><strong>Report Generation:</strong> O(n) table formatting where n = number of signals/events</li>
<li><strong>File I/O:</strong> Asynchronous to avoid blocking execution thread</li>
</ul>
<p>The services are designed to have minimal impact on execution performance, making them suitable for production use.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#markdown-report-generation"><span>Markdown <wbr/>Report <wbr/>Generation</span></a><ul><li><a href="#purpose-and-scope"><span>Purpose and <wbr/>Scope</span></a></li><li><a href="#service-architecture"><span>Service <wbr/>Architecture</span></a></li><li><a href="#event-flow-architecture"><span>Event <wbr/>Flow <wbr/>Architecture</span></a></li><li><a href="#reportstorage-pattern"><span>Report<wbr/>Storage <wbr/>Pattern</span></a></li><li><a href="#column-configuration-system"><span>Column <wbr/>Configuration <wbr/>System</span></a></li><li><ul><li><a href="#backtest-columns"><span>Backtest <wbr/>Columns</span></a></li><li><a href="#live-trading-columns"><span>Live <wbr/>Trading <wbr/>Columns</span></a></li></ul></li><li><a href="#report-generation-pipeline"><span>Report <wbr/>Generation <wbr/>Pipeline</span></a></li><li><a href="#table-formatting-implementation"><span>Table <wbr/>Formatting <wbr/>Implementation</span></a></li><li><a href="#event-accumulation-strategies"><span>Event <wbr/>Accumulation <wbr/>Strategies</span></a></li><li><ul><li><a href="#backtestmarkdownservice-strategy"><span>Backtest<wbr/>Markdown<wbr/>Service <wbr/>Strategy</span></a></li><li><a href="#livemarkdownservice-strategy"><span>Live<wbr/>Markdown<wbr/>Service <wbr/>Strategy</span></a></li></ul></li><li><a href="#statistics-generation-live-only"><span>Statistics <wbr/>Generation (<wbr/>Live <wbr/>Only)</span></a></li><li><a href="#public-api-methods"><span>Public API <wbr/>Methods</span></a></li><li><ul><li><a href="#getreportstrategyname"><span>get<wbr/>Report(strategy<wbr/>Name)</span></a></li><li><a href="#dumpstrategyname-path"><span>dump(strategy<wbr/>Name, path?)</span></a></li><li><a href="#clearstrategyname"><span>clear(strategy<wbr/>Name?)</span></a></li><li><a href="#init"><span>init()</span></a></li></ul></li><li><a href="#integration-with-service-layer"><span>Integration with <wbr/>Service <wbr/>Layer</span></a></li><li><a href="#error-handling"><span>Error <wbr/>Handling</span></a></li><li><a href="#usage-examples"><span>Usage <wbr/>Examples</span></a></li><li><ul><li><a href="#backtest-report-generation"><span>Backtest <wbr/>Report <wbr/>Generation</span></a></li><li><a href="#live-trading-report-generation"><span>Live <wbr/>Trading <wbr/>Report <wbr/>Generation</span></a></li></ul></li><li><a href="#performance-considerations"><span>Performance <wbr/>Considerations</span></a></li><li><ul><li><a href="#memory-efficiency"><span>Memory <wbr/>Efficiency</span></a></li><li><a href="#computation-overhead"><span>Computation <wbr/>Overhead</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
