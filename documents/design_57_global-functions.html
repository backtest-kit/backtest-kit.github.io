<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/57_global-functions | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_57_global-functions.html">design/57_global-functions</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="global-functions" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Global Functions<a href="#global-functions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>Global functions are the primary user-facing API for configuring and interacting with Backtest Kit. These functions provide a declarative interface for registering components, configuring system behavior, subscribing to events, and accessing framework utilities. All global functions are exported from the main package entry point and operate on the singleton service layer.</p>
<p>For information about class-based execution APIs (Backtest, Live, Walker, Optimizer), see <a href="design_56_api-reference.html">Execution Classes API</a>. For data structure definitions used in function parameters and return values, see <a href="design_56_api-reference.html">Core Interfaces</a> and <a href="design_56_api-reference.html">Signal &amp; Result Types</a>.</p>
<hr>
<a id="function-categories" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Function Categories<a href="#function-categories" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Global functions are organized into six functional categories:</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Functions</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Configuration</strong></td>
<td><code>setLogger</code>, <code>setConfig</code>, <code>getConfig</code>, <code>getDefaultConfig</code>, <code>setColumns</code>, <code>getColumns</code>, <code>getDefaultColumns</code></td>
<td>System-wide settings and logging</td>
</tr>
<tr>
<td><strong>Registration</strong></td>
<td><code>addExchange</code>, <code>addStrategy</code>, <code>addFrame</code>, <code>addRisk</code>, <code>addWalker</code>, <code>addSizing</code>, <code>addOptimizer</code></td>
<td>Register trading components</td>
</tr>
<tr>
<td><strong>Query</strong></td>
<td><code>listExchanges</code>, <code>listStrategies</code>, <code>listFrames</code>, <code>listRisks</code>, <code>listWalkers</code>, <code>listSizings</code>, <code>listOptimizers</code></td>
<td>Retrieve registered components</td>
</tr>
<tr>
<td><strong>Event Subscription</strong></td>
<td><code>listenSignal*</code>, <code>listenDone*</code>, <code>listenPartial*</code>, <code>listenRisk</code>, <code>listenPerformance</code>, <code>listenError</code>, <code>listenExit</code></td>
<td>Subscribe to framework events</td>
</tr>
<tr>
<td><strong>Context Access</strong></td>
<td><code>getDate</code>, <code>getMode</code></td>
<td>Access execution context</td>
</tr>
<tr>
<td><strong>Exchange Utilities</strong></td>
<td><code>getCandles</code>, <code>getAveragePrice</code>, <code>formatPrice</code>, <code>formatQuantity</code></td>
<td>Data fetching and formatting</td>
</tr>
<tr>
<td><strong>Debugging</strong></td>
<td><code>dumpSignal</code></td>
<td>Logging and analysis</td>
</tr>
</tbody>
</table>
<hr>
<a id="architecture-global-functions-to-service-layer" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Architecture: Global Functions to Service Layer<a href="#architecture-global-functions-to-service-layer" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/57_global-functions_0.svg" alt="Mermaid Diagram"></p>
<p><strong>Architectural Flow:</strong></p>
<ol>
<li><strong>User Code</strong> calls global functions from the public API</li>
<li><strong>Global Functions</strong> delegate to the <code>backtest</code> singleton object (dependency injection container)</li>
<li><strong>Validation Services</strong> perform shallow validation and duplicate checks</li>
<li><strong>Schema Services</strong> store validated configurations in <code>ToolRegistry</code> instances</li>
<li><strong>Context Services</strong> propagate ambient execution state via <code>AsyncLocalStorage</code></li>
<li><strong>Connection Services</strong> create and cache client instances (memoized factories)</li>
<li><strong>Event System</strong> broadcasts events to registered listeners via Subject pattern</li>
</ol>
<hr>
<a id="configuration-functions" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Configuration Functions<a href="#configuration-functions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="setlogger" class="tsd-anchor"></a><h3 class="tsd-anchor-link">setLogger<a href="#setlogger" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">setLogger</span><span class="hl-1">(</span><span class="hl-4">logger</span><span class="hl-1">: </span><span class="hl-4">ILogger</span><span class="hl-1">): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Registers a custom logger implementation for framework-wide logging. The logger receives contextual information about operations including method names and parameters.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>logger: ILogger</code> - Logger implementation with <code>log</code>, <code>debug</code>, <code>info</code>, <code>warn</code> methods</li>
</ul>
<p><strong>Logger Interface:</strong></p>
<pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-11">ILogger</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">log</span><span class="hl-1">: (...</span><span class="hl-4">args</span><span class="hl-1">: </span><span class="hl-11">any</span><span class="hl-1">[]) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-11">void</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">debug</span><span class="hl-1">: (...</span><span class="hl-4">args</span><span class="hl-1">: </span><span class="hl-11">any</span><span class="hl-1">[]) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-11">void</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">info</span><span class="hl-1">: (...</span><span class="hl-4">args</span><span class="hl-1">: </span><span class="hl-11">any</span><span class="hl-1">[]) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-11">void</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">warn</span><span class="hl-1">: (...</span><span class="hl-4">args</span><span class="hl-1">: </span><span class="hl-11">any</span><span class="hl-1">[]) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-11">void</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">setLogger</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">setLogger</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">log:</span><span class="hl-1"> </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">debug:</span><span class="hl-1"> </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-4">debug</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">info:</span><span class="hl-1"> </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-4">info</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">warn:</span><span class="hl-1"> </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-4">warn</span><span class="hl-1">,</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Internal Flow:</strong>
The logger is stored in <code>LoggerService</code> (<code>src/services/base/LoggerService</code>), which is injected as a dependency throughout the service layer. All services access logging via <code>backtest.loggerService</code>.</p>
<hr>
<a id="setconfig" class="tsd-anchor"></a><h3 class="tsd-anchor-link">setConfig<a href="#setconfig" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">setConfig</span><span class="hl-1">(</span><span class="hl-4">config</span><span class="hl-1">: </span><span class="hl-4">Partial</span><span class="hl-1">&lt;</span><span class="hl-4">GlobalConfig</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Updates global configuration parameters that control validation thresholds, fees, slippage, retry logic, and anomaly detection. Configuration is merged with existing values, allowing partial updates.</p>
<p><strong>Key Configuration Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CC_PERCENT_FEE</code></td>
<td><code>0.1</code></td>
<td>Fee percentage per trade (0.1 = 0.1%)</td>
</tr>
<tr>
<td><code>CC_PERCENT_SLIPPAGE</code></td>
<td><code>0.1</code></td>
<td>Slippage percentage per trade (0.1 = 0.1%)</td>
</tr>
<tr>
<td><code>CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</code></td>
<td><code>0.22</code></td>
<td>Min TP distance to cover fees+slippage (0.1% + 0.1% + buffer)</td>
</tr>
<tr>
<td><code>CC_MAX_STOPLOSS_DISTANCE_PERCENT</code></td>
<td><code>100</code></td>
<td>Max SL distance as percentage</td>
</tr>
<tr>
<td><code>CC_MAX_SIGNAL_LIFETIME_MINUTES</code></td>
<td><code>10080</code></td>
<td>Max signal lifetime (default: 7 days)</td>
</tr>
<tr>
<td><code>CC_SCHEDULE_AWAIT_MINUTES</code></td>
<td><code>120</code></td>
<td>Timeout for scheduled signal activation</td>
</tr>
<tr>
<td><code>CC_AVG_PRICE_CANDLES_COUNT</code></td>
<td><code>5</code></td>
<td>Number of 1m candles for VWAP calculation</td>
</tr>
<tr>
<td><code>CC_CANDLES_RETRY_COUNT</code></td>
<td><code>3</code></td>
<td>Retry attempts for candle fetching</td>
</tr>
<tr>
<td><code>CC_CANDLES_RETRY_DELAY_MS</code></td>
<td><code>1000</code></td>
<td>Delay between retry attempts</td>
</tr>
<tr>
<td><code>CC_MEDIAN_CANDLES_LOOKBACK</code></td>
<td><code>20</code></td>
<td>Candles for median price calculation</td>
</tr>
<tr>
<td><code>CC_PRICE_ANOMALY_THRESHOLD</code></td>
<td><code>0.5</code></td>
<td>Threshold for price anomaly detection (50% deviation)</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">setConfig</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">setConfig</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">CC_PERCENT_FEE:</span><span class="hl-1"> </span><span class="hl-6">0.1</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">CC_PERCENT_SLIPPAGE:</span><span class="hl-1"> </span><span class="hl-6">0.1</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-6">0.3</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">CC_SCHEDULE_AWAIT_MINUTES:</span><span class="hl-1"> </span><span class="hl-6">120</span><span class="hl-1">,</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Internal Validation:</strong>
Configuration is validated by <code>ConfigValidationService</code> (<code>src/services/validation/ConfigValidationService</code>) which ensures:</p>
<ul>
<li>All percentages are finite positive numbers</li>
<li>Retry counts are positive integers</li>
<li>Lookback periods are positive integers</li>
<li>Thresholds are within valid ranges</li>
</ul>
<hr>
<a id="getconfig" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getConfig<a href="#getconfig" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">getConfig</span><span class="hl-1">(): </span><span class="hl-4">GlobalConfig</span>
</code><button type="button">Copy</button></pre>

<p>Returns the current global configuration object with all parameters. Useful for debugging or displaying configuration in UIs.</p>
<p><strong>Returns:</strong> Complete <code>GlobalConfig</code> object with all parameters</p>
<hr>
<a id="getdefaultconfig" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getDefaultConfig<a href="#getdefaultconfig" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">getDefaultConfig</span><span class="hl-1">(): </span><span class="hl-4">GlobalConfig</span>
</code><button type="button">Copy</button></pre>

<p>Returns the default global configuration object. Useful for resetting configuration or comparing against defaults.</p>
<p><strong>Returns:</strong> Default <code>GlobalConfig</code> object with framework defaults</p>
<hr>
<a id="setcolumns" class="tsd-anchor"></a><h3 class="tsd-anchor-link">setColumns<a href="#setcolumns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">setColumns</span><span class="hl-1">(</span><span class="hl-4">columns</span><span class="hl-1">: </span><span class="hl-4">Partial</span><span class="hl-1">&lt;</span><span class="hl-4">ColumnConfig</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Configures which columns are visible in markdown reports. Allows customization of report output format by showing/hiding specific columns.</p>
<p><strong>Column Categories:</strong></p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Columns</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Signal Identification</strong></td>
<td><code>id</code>, <code>symbol</code>, <code>strategyName</code>, <code>exchangeName</code></td>
<td>Core identifiers</td>
</tr>
<tr>
<td><strong>Pricing</strong></td>
<td><code>priceOpen</code>, <code>priceClose</code>, <code>priceTakeProfit</code>, <code>priceStopLoss</code>, <code>averageEntryPrice</code></td>
<td>Entry/exit prices</td>
</tr>
<tr>
<td><strong>Position</strong></td>
<td><code>position</code>, <code>quantity</code></td>
<td>Trade direction and size</td>
</tr>
<tr>
<td><strong>Timing</strong></td>
<td><code>timestamp</code>, <code>timestampOpen</code>, <code>timestampClose</code>, <code>minuteEstimatedTime</code></td>
<td>Temporal data</td>
</tr>
<tr>
<td><strong>Performance</strong></td>
<td><code>pnl</code>, <code>pnlPercentage</code>, <code>feePercentage</code>, <code>slippagePercentage</code></td>
<td>Financial results</td>
</tr>
<tr>
<td><strong>Status</strong></td>
<td><code>closeReason</code></td>
<td>Trade closure reason</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">setColumns</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">setColumns</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-7">false</span><span class="hl-1">,                    </span><span class="hl-5">// Hide signal IDs</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-7">false</span><span class="hl-1">,          </span><span class="hl-5">// Hide exchange names</span><br/><span class="hl-1">  </span><span class="hl-4">quantity:</span><span class="hl-1"> </span><span class="hl-7">true</span><span class="hl-1">,               </span><span class="hl-5">// Show quantities</span><br/><span class="hl-1">  </span><span class="hl-4">pnl:</span><span class="hl-1"> </span><span class="hl-7">true</span><span class="hl-1">,                    </span><span class="hl-5">// Show PNL</span><br/><span class="hl-1">  </span><span class="hl-4">pnlPercentage:</span><span class="hl-1"> </span><span class="hl-7">true</span><span class="hl-1">,         </span><span class="hl-5">// Show PNL %</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Internal Validation:</strong>
Column configuration is validated by <code>ColumnValidationService</code> (<code>src/services/validation/ColumnValidationService</code>) which ensures all keys are valid column names.</p>
<hr>
<a id="getcolumns" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getColumns<a href="#getcolumns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">getColumns</span><span class="hl-1">(): </span><span class="hl-4">ColumnConfig</span>
</code><button type="button">Copy</button></pre>

<p>Returns the current column visibility configuration.</p>
<p><strong>Returns:</strong> Complete <code>ColumnConfig</code> object</p>
<hr>
<a id="getdefaultcolumns" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getDefaultColumns<a href="#getdefaultcolumns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">getDefaultColumns</span><span class="hl-1">(): </span><span class="hl-4">ColumnConfig</span>
</code><button type="button">Copy</button></pre>

<p>Returns the default column visibility configuration.</p>
<p><strong>Returns:</strong> Default <code>ColumnConfig</code> object</p>
<hr>
<a id="registration-functions" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Registration Functions<a href="#registration-functions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Registration functions validate and store component schemas in the service layer. Each function performs two operations:</p>
<ol>
<li><strong>Validation</strong> via dedicated ValidationService (shallow validation, duplicate checking)</li>
<li><strong>Storage</strong> via dedicated SchemaService (ToolRegistry pattern for immutable storage)</li>
</ol>
<p><img src="../media/57_global-functions_1.svg" alt="Mermaid Diagram"></p>
<p><strong>Registration Flow:</strong></p>
<ol>
<li>User calls <code>add*()</code> function with schema object</li>
<li><code>LoggerService</code> logs registration attempt with method name and schema</li>
<li><code>ValidationService</code> validates schema and checks for duplicate names</li>
<li><code>SchemaService</code> stores validated schema in <code>ToolRegistry</code> instance</li>
<li>Later, <code>ConnectionService</code> retrieves schema and creates client instances on-demand (memoized)</li>
</ol>
<hr>
<a id="addstrategy" class="tsd-anchor"></a><h3 class="tsd-anchor-link">addStrategy<a href="#addstrategy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">addStrategy</span><span class="hl-1">(</span><span class="hl-4">strategySchema</span><span class="hl-1">: </span><span class="hl-4">IStrategySchema</span><span class="hl-1">): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Registers a trading strategy with signal generation logic, lifecycle callbacks, and risk profile association.</p>
<p><strong>Schema Structure (IStrategySchema):</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>strategyName</code></td>
<td><code>string</code></td>
<td>✓</td>
<td>Unique strategy identifier</td>
</tr>
<tr>
<td><code>interval</code></td>
<td><code>SignalInterval</code></td>
<td>✓</td>
<td>Throttling interval: <code>&quot;1m&quot;</code> | <code>&quot;3m&quot;</code> | <code>&quot;5m&quot;</code> | <code>&quot;15m&quot;</code> | <code>&quot;30m&quot;</code> | <code>&quot;1h&quot;</code></td>
</tr>
<tr>
<td><code>getSignal</code></td>
<td><code>(symbol: string, when: Date) =&gt; Promise&lt;ISignalDto | null&gt;</code></td>
<td>✓</td>
<td>Signal generation function</td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td><code>Partial&lt;IStrategyCallbacks&gt;</code></td>
<td></td>
<td>Lifecycle hooks: <code>onOpen</code>, <code>onClose</code>, <code>onSchedule</code>, <code>onCancel</code>, <code>onPartialProfit</code>, <code>onPartialLoss</code></td>
</tr>
<tr>
<td><code>riskName</code></td>
<td><code>string</code></td>
<td></td>
<td>Single risk profile name</td>
</tr>
<tr>
<td><code>riskList</code></td>
<td><code>string[]</code></td>
<td></td>
<td>Multiple risk profile names (if multiple required)</td>
</tr>
<tr>
<td><code>note</code></td>
<td><code>string</code></td>
<td></td>
<td>Developer documentation</td>
</tr>
</tbody>
</table>
<p><strong>Signal DTO (ISignalDto):</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>position</code></td>
<td><code>&quot;long&quot;</code> | <code>&quot;short&quot;</code></td>
<td>✓</td>
<td>Trade direction</td>
</tr>
<tr>
<td><code>priceOpen</code></td>
<td><code>number</code></td>
<td></td>
<td>Entry price (if omitted, opens immediately at current price)</td>
</tr>
<tr>
<td><code>priceTakeProfit</code></td>
<td><code>number</code></td>
<td>✓</td>
<td>Take profit price</td>
</tr>
<tr>
<td><code>priceStopLoss</code></td>
<td><code>number</code></td>
<td>✓</td>
<td>Stop loss price</td>
</tr>
<tr>
<td><code>minuteEstimatedTime</code></td>
<td><code>number</code></td>
<td>✓</td>
<td>Expected signal lifetime in minutes</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>number</code></td>
<td>✓</td>
<td>Signal generation timestamp (Unix milliseconds)</td>
</tr>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td></td>
<td>Optional unique signal identifier</td>
</tr>
<tr>
<td><code>quantity</code></td>
<td><code>number</code></td>
<td></td>
<td>Optional position size override</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addStrategy</span><span class="hl-1">, </span><span class="hl-4">getCandles</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;sma-crossover&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">riskName:</span><span class="hl-1"> </span><span class="hl-2">&quot;conservative&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">when</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">candles</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getCandles</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-2">&quot;1h&quot;</span><span class="hl-1">, </span><span class="hl-6">50</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">sma20</span><span class="hl-1"> = </span><span class="hl-0">calculateSMA</span><span class="hl-1">(</span><span class="hl-4">candles</span><span class="hl-1">, </span><span class="hl-6">20</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">sma50</span><span class="hl-1"> = </span><span class="hl-0">calculateSMA</span><span class="hl-1">(</span><span class="hl-4">candles</span><span class="hl-1">, </span><span class="hl-6">50</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">sma20</span><span class="hl-1"> &gt; </span><span class="hl-4">sma50</span><span class="hl-1"> &amp;&amp; </span><span class="hl-4">previousSma20</span><span class="hl-1"> &lt;= </span><span class="hl-4">previousSma50</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">position:</span><span class="hl-1"> </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">priceTakeProfit:</span><span class="hl-1"> </span><span class="hl-4">currentPrice</span><span class="hl-1"> * </span><span class="hl-6">1.02</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">priceStopLoss:</span><span class="hl-1"> </span><span class="hl-4">currentPrice</span><span class="hl-1"> * </span><span class="hl-6">0.99</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">minuteEstimatedTime:</span><span class="hl-1"> </span><span class="hl-6">60</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">timestamp:</span><span class="hl-1"> </span><span class="hl-4">when</span><span class="hl-1">.</span><span class="hl-0">getTime</span><span class="hl-1">(),</span><br/><span class="hl-1">      };</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-7">null</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onOpen</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">, </span><span class="hl-4">currentPrice</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[OPEN] </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2"> at </span><span class="hl-7">${</span><span class="hl-4">currentPrice</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">onClose</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">, </span><span class="hl-4">priceClose</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[CLOSE] </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2"> at </span><span class="hl-7">${</span><span class="hl-4">priceClose</span><span class="hl-7">}</span><span class="hl-2"> - PNL: </span><span class="hl-7">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">pnl</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Validation:</strong>
<code>StrategyValidationService</code> (<code>src/services/validation/StrategyValidationService</code>) validates:</p>
<ul>
<li><code>strategyName</code> is unique and non-empty string</li>
<li><code>interval</code> is valid <code>SignalInterval</code> enum value</li>
<li><code>getSignal</code> is a function</li>
<li>If <code>callbacks</code> provided, each callback is a function</li>
<li>If <code>riskName</code> or <code>riskList</code> provided, references valid risk profiles (deferred check)</li>
</ul>
<p><strong>Storage:</strong>
<code>StrategySchemaService</code> (<code>src/services/schema/StrategySchemaService</code>) stores schema in <code>ToolRegistry</code> instance, enabling later retrieval by <code>StrategyConnectionService</code>.</p>
<hr>
<a id="addexchange" class="tsd-anchor"></a><h3 class="tsd-anchor-link">addExchange<a href="#addexchange" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">addExchange</span><span class="hl-1">(</span><span class="hl-4">exchangeSchema</span><span class="hl-1">: </span><span class="hl-4">IExchangeSchema</span><span class="hl-1">): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Registers an exchange data source with candle fetching, price formatting, and optional callbacks.</p>
<p><strong>Schema Structure (IExchangeSchema):</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>exchangeName</code></td>
<td><code>string</code></td>
<td>✓</td>
<td>Unique exchange identifier</td>
</tr>
<tr>
<td><code>getCandles</code></td>
<td><code>(symbol, interval, since, limit) =&gt; Promise&lt;ICandleData[]&gt;</code></td>
<td>✓</td>
<td>Candle data fetching function</td>
</tr>
<tr>
<td><code>formatPrice</code></td>
<td><code>(symbol, price) =&gt; Promise&lt;string&gt;</code></td>
<td>✓</td>
<td>Price formatting for exchange</td>
</tr>
<tr>
<td><code>formatQuantity</code></td>
<td><code>(symbol, quantity) =&gt; Promise&lt;string&gt;</code></td>
<td>✓</td>
<td>Quantity formatting for exchange</td>
</tr>
<tr>
<td><code>getAveragePrice</code></td>
<td><code>(symbol) =&gt; Promise&lt;number&gt;</code></td>
<td></td>
<td>Optional VWAP override (default: last 5 1m candles)</td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td><code>Partial&lt;IExchangeCallbacks&gt;</code></td>
<td></td>
<td>Optional <code>onCandles</code> callback</td>
</tr>
<tr>
<td><code>note</code></td>
<td><code>string</code></td>
<td></td>
<td>Developer documentation</td>
</tr>
</tbody>
</table>
<p><strong>Candle Data Structure (ICandleData):</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>timestamp</code></td>
<td><code>number</code></td>
<td>Unix milliseconds</td>
</tr>
<tr>
<td><code>open</code></td>
<td><code>number</code></td>
<td>Opening price</td>
</tr>
<tr>
<td><code>high</code></td>
<td><code>number</code></td>
<td>Highest price</td>
</tr>
<tr>
<td><code>low</code></td>
<td><code>number</code></td>
<td>Lowest price</td>
</tr>
<tr>
<td><code>close</code></td>
<td><code>number</code></td>
<td>Closing price</td>
</tr>
<tr>
<td><code>volume</code></td>
<td><code>number</code></td>
<td>Trading volume</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addExchange</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">ccxt</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;ccxt&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addExchange</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getCandles</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">exchange</span><span class="hl-1"> = </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-4">ccxt</span><span class="hl-1">.</span><span class="hl-0">binance</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">ohlcv</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">fetchOHLCV</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-4">symbol</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">interval</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">since</span><span class="hl-1">.</span><span class="hl-0">getTime</span><span class="hl-1">(),</span><br/><span class="hl-1">      </span><span class="hl-4">limit</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">ohlcv</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(([</span><span class="hl-4">timestamp</span><span class="hl-1">, </span><span class="hl-4">open</span><span class="hl-1">, </span><span class="hl-4">high</span><span class="hl-1">, </span><span class="hl-4">low</span><span class="hl-1">, </span><span class="hl-4">close</span><span class="hl-1">, </span><span class="hl-4">volume</span><span class="hl-1">]) </span><span class="hl-7">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">      </span><span class="hl-4">timestamp</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">open</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">high</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">low</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">close</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">volume</span><span class="hl-1">,</span><br/><span class="hl-1">    }));</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">formatPrice</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-4">price</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-6">2</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-0">formatQuantity</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-4">quantity</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-6">8</span><span class="hl-1">),</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Validation:</strong>
<code>ExchangeValidationService</code> (<code>src/services/validation/ExchangeValidationService</code>) validates:</p>
<ul>
<li><code>exchangeName</code> is unique and non-empty string</li>
<li><code>getCandles</code> is a function</li>
<li><code>formatPrice</code> is a function</li>
<li><code>formatQuantity</code> is a function</li>
</ul>
<p><strong>Storage:</strong>
<code>ExchangeSchemaService</code> (<code>src/services/schema/ExchangeSchemaService</code>) stores schema in <code>ToolRegistry</code> instance.</p>
<hr>
<a id="addframe" class="tsd-anchor"></a><h3 class="tsd-anchor-link">addFrame<a href="#addframe" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">addFrame</span><span class="hl-1">(</span><span class="hl-4">frameSchema</span><span class="hl-1">: </span><span class="hl-4">IFrameSchema</span><span class="hl-1">): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Registers a timeframe generator for backtesting with start/end dates and interval configuration.</p>
<p><strong>Schema Structure (IFrameSchema):</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>frameName</code></td>
<td><code>string</code></td>
<td>✓</td>
<td>Unique frame identifier</td>
</tr>
<tr>
<td><code>interval</code></td>
<td><code>FrameInterval</code></td>
<td>✓</td>
<td>Timeframe interval</td>
</tr>
<tr>
<td><code>startDate</code></td>
<td><code>Date</code></td>
<td>✓</td>
<td>Backtest start date</td>
</tr>
<tr>
<td><code>endDate</code></td>
<td><code>Date</code></td>
<td>✓</td>
<td>Backtest end date</td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td><code>Partial&lt;IFrameCallbacks&gt;</code></td>
<td></td>
<td>Optional <code>onTimeframe</code> callback</td>
</tr>
<tr>
<td><code>note</code></td>
<td><code>string</code></td>
<td></td>
<td>Developer documentation</td>
</tr>
</tbody>
</table>
<p><strong>Frame Intervals:</strong>
<code>&quot;1m&quot;</code> | <code>&quot;3m&quot;</code> | <code>&quot;5m&quot;</code> | <code>&quot;15m&quot;</code> | <code>&quot;30m&quot;</code> | <code>&quot;1h&quot;</code> | <code>&quot;2h&quot;</code> | <code>&quot;4h&quot;</code> | <code>&quot;6h&quot;</code> | <code>&quot;8h&quot;</code> | <code>&quot;12h&quot;</code> | <code>&quot;1d&quot;</code> | <code>&quot;3d&quot;</code></p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addFrame</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addFrame</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-test&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;1m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-01T00:00:00Z&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-02T00:00:00Z&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onTimeframe</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">timeframe</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Generated </span><span class="hl-7">${</span><span class="hl-4">timeframe</span><span class="hl-9">.</span><span class="hl-4">length</span><span class="hl-7">}</span><span class="hl-2"> timeframes`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Validation:</strong>
<code>FrameValidationService</code> (<code>src/services/validation/FrameValidationService</code>) validates:</p>
<ul>
<li><code>frameName</code> is unique and non-empty string</li>
<li><code>interval</code> is valid <code>FrameInterval</code> enum value</li>
<li><code>startDate</code> and <code>endDate</code> are valid Date objects</li>
<li><code>endDate</code> is after <code>startDate</code></li>
</ul>
<p><strong>Storage:</strong>
<code>FrameSchemaService</code> (<code>src/services/schema/FrameSchemaService</code>) stores schema in <code>ToolRegistry</code> instance.</p>
<hr>
<a id="addwalker" class="tsd-anchor"></a><h3 class="tsd-anchor-link">addWalker<a href="#addwalker" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">addWalker</span><span class="hl-1">(</span><span class="hl-4">walkerSchema</span><span class="hl-1">: </span><span class="hl-4">IWalkerSchema</span><span class="hl-1">): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Registers a walker for multi-strategy comparison with metric-based ranking.</p>
<p><strong>Schema Structure (IWalkerSchema):</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>walkerName</code></td>
<td><code>string</code></td>
<td>✓</td>
<td>Unique walker identifier</td>
</tr>
<tr>
<td><code>exchangeName</code></td>
<td><code>string</code></td>
<td>✓</td>
<td>Exchange for all strategies</td>
</tr>
<tr>
<td><code>frameName</code></td>
<td><code>string</code></td>
<td>✓</td>
<td>Timeframe for all strategies</td>
</tr>
<tr>
<td><code>strategies</code></td>
<td><code>string[]</code></td>
<td>✓</td>
<td>Strategy names to compare</td>
</tr>
<tr>
<td><code>metric</code></td>
<td><code>WalkerMetric</code></td>
<td></td>
<td>Ranking metric (default: <code>&quot;sharpeRatio&quot;</code>)</td>
</tr>
<tr>
<td><code>context</code></td>
<td><code>any</code></td>
<td></td>
<td>User-defined context passed to callbacks</td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td><code>Partial&lt;IWalkerCallbacks&gt;</code></td>
<td></td>
<td>Optional lifecycle hooks</td>
</tr>
<tr>
<td><code>note</code></td>
<td><code>string</code></td>
<td></td>
<td>Developer documentation</td>
</tr>
</tbody>
</table>
<p><strong>Walker Metrics:</strong>
<code>&quot;sharpeRatio&quot;</code> | <code>&quot;winRate&quot;</code> | <code>&quot;pnl&quot;</code> | <code>&quot;totalTrades&quot;</code> | <code>&quot;avgPnl&quot;</code> | <code>&quot;maxDrawdown&quot;</code></p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addWalker</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addWalker</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">walkerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;llm-prompt-optimizer&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d-test&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">strategies:</span><span class="hl-1"> [</span><span class="hl-2">&quot;strategy-v1&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;strategy-v2&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;strategy-v3&quot;</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">metric:</span><span class="hl-1"> </span><span class="hl-2">&quot;sharpeRatio&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onStrategyComplete</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">stats</span><span class="hl-1">, </span><span class="hl-4">metric</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`</span><span class="hl-7">${</span><span class="hl-4">strategyName</span><span class="hl-7">}</span><span class="hl-2">: Sharpe=</span><span class="hl-7">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">sharpeRatio</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">onComplete</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">results</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Best: </span><span class="hl-7">${</span><span class="hl-4">results</span><span class="hl-9">.</span><span class="hl-4">bestStrategy</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Validation:</strong>
<code>WalkerValidationService</code> (<code>src/services/validation/WalkerValidationService</code>) validates:</p>
<ul>
<li><code>walkerName</code> is unique and non-empty string</li>
<li><code>exchangeName</code> references valid exchange (deferred check)</li>
<li><code>frameName</code> references valid frame (deferred check)</li>
<li><code>strategies</code> is non-empty array of strings</li>
<li><code>metric</code> is valid <code>WalkerMetric</code> enum value</li>
</ul>
<p><strong>Storage:</strong>
<code>WalkerSchemaService</code> (<code>src/services/schema/WalkerSchemaService</code>) stores schema in <code>ToolRegistry</code> instance.</p>
<hr>
<a id="addsizing" class="tsd-anchor"></a><h3 class="tsd-anchor-link">addSizing<a href="#addsizing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">addSizing</span><span class="hl-1">(</span><span class="hl-4">sizingSchema</span><span class="hl-1">: </span><span class="hl-4">ISizingSchema</span><span class="hl-1">): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Registers a position sizing configuration using one of three methods: fixed-percentage, Kelly criterion, or ATR-based.</p>
<p><strong>Schema Structure (ISizingSchema - Discriminated Union):</strong></p>
<p><strong>Fixed Percentage:</strong></p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-10">sizingName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-10">method</span><span class="hl-1">: </span><span class="hl-2">&quot;fixed-percentage&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-10">riskPercentage</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">;              </span><span class="hl-5">// % of account to risk per trade</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionPercentage</span><span class="hl-1">?: </span><span class="hl-4">number</span><span class="hl-1">;      </span><span class="hl-5">// Max position size as % of account</span><br/><span class="hl-1">  </span><span class="hl-4">minPositionSize</span><span class="hl-1">?: </span><span class="hl-4">number</span><span class="hl-1">;            </span><span class="hl-5">// Min position size</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionSize</span><span class="hl-1">?: </span><span class="hl-4">number</span><span class="hl-1">;            </span><span class="hl-5">// Max position size</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks</span><span class="hl-1">?: </span><span class="hl-4">Partial</span><span class="hl-1">&lt;</span><span class="hl-4">ISizingCallbacks</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-4">string</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Kelly Criterion:</strong></p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-10">sizingName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-10">method</span><span class="hl-1">: </span><span class="hl-2">&quot;kelly-criterion&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">kellyMultiplier</span><span class="hl-1">?: </span><span class="hl-4">number</span><span class="hl-1">;            </span><span class="hl-5">// Multiplier for Kelly % (default: 0.25)</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionPercentage</span><span class="hl-1">?: </span><span class="hl-4">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">minPositionSize</span><span class="hl-1">?: </span><span class="hl-4">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionSize</span><span class="hl-1">?: </span><span class="hl-4">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks</span><span class="hl-1">?: </span><span class="hl-4">Partial</span><span class="hl-1">&lt;</span><span class="hl-4">ISizingCallbacks</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-4">string</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>ATR-Based:</strong></p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-10">sizingName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-10">method</span><span class="hl-1">: </span><span class="hl-2">&quot;atr-based&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-10">riskPercentage</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">;              </span><span class="hl-5">// % of account to risk</span><br/><span class="hl-1">  </span><span class="hl-4">atrMultiplier</span><span class="hl-1">?: </span><span class="hl-4">number</span><span class="hl-1">;              </span><span class="hl-5">// ATR multiplier for stop distance (default: 2)</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionPercentage</span><span class="hl-1">?: </span><span class="hl-4">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">minPositionSize</span><span class="hl-1">?: </span><span class="hl-4">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionSize</span><span class="hl-1">?: </span><span class="hl-4">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks</span><span class="hl-1">?: </span><span class="hl-4">Partial</span><span class="hl-1">&lt;</span><span class="hl-4">ISizingCallbacks</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-4">string</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addSizing</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Fixed percentage</span><br/><span class="hl-0">addSizing</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;conservative&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-2">&quot;fixed-percentage&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">riskPercentage:</span><span class="hl-1"> </span><span class="hl-6">1</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionPercentage:</span><span class="hl-1"> </span><span class="hl-6">10</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Kelly criterion</span><br/><span class="hl-0">addSizing</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;kelly&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-2">&quot;kelly-criterion&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">kellyMultiplier:</span><span class="hl-1"> </span><span class="hl-6">0.25</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositionPercentage:</span><span class="hl-1"> </span><span class="hl-6">20</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// ATR-based</span><br/><span class="hl-0">addSizing</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">sizingName:</span><span class="hl-1"> </span><span class="hl-2">&quot;atr-dynamic&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-2">&quot;atr-based&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">riskPercentage:</span><span class="hl-1"> </span><span class="hl-6">2</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">atrMultiplier:</span><span class="hl-1"> </span><span class="hl-6">2</span><span class="hl-1">,</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Validation:</strong>
<code>SizingValidationService</code> (<code>src/services/validation/SizingValidationService</code>) validates:</p>
<ul>
<li><code>sizingName</code> is unique and non-empty string</li>
<li><code>method</code> is valid sizing method</li>
<li>Method-specific fields are present and valid</li>
<li>Percentages are positive numbers</li>
</ul>
<p><strong>Storage:</strong>
<code>SizingSchemaService</code> (<code>src/services/schema/SizingSchemaService</code>) stores schema in <code>ToolRegistry</code> instance.</p>
<hr>
<a id="addrisk" class="tsd-anchor"></a><h3 class="tsd-anchor-link">addRisk<a href="#addrisk" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">addRisk</span><span class="hl-1">(</span><span class="hl-4">riskSchema</span><span class="hl-1">: </span><span class="hl-4">IRiskSchema</span><span class="hl-1">): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Registers a risk management profile with position limits and custom validations.</p>
<p><strong>Schema Structure (IRiskSchema):</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>riskName</code></td>
<td><code>string</code></td>
<td>✓</td>
<td>Unique risk profile identifier</td>
</tr>
<tr>
<td><code>maxConcurrentPositions</code></td>
<td><code>number</code></td>
<td></td>
<td>Max open positions across all strategies</td>
</tr>
<tr>
<td><code>validations</code></td>
<td><code>IRiskValidation[]</code></td>
<td></td>
<td>Custom validation functions</td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td><code>Partial&lt;IRiskCallbacks&gt;</code></td>
<td></td>
<td>Optional <code>onRejected</code>, <code>onAllowed</code> callbacks</td>
</tr>
<tr>
<td><code>note</code></td>
<td><code>string</code></td>
<td></td>
<td>Developer documentation</td>
</tr>
</tbody>
</table>
<p><strong>Risk Validation Function:</strong></p>
<pre><code class="typescript"><span class="hl-7">type</span><span class="hl-1"> </span><span class="hl-11">IRiskValidationFn</span><span class="hl-1"> = (</span><span class="hl-4">args</span><span class="hl-1">: {</span><br/><span class="hl-1">  </span><span class="hl-4">params</span><span class="hl-1">: </span><span class="hl-11">IRiskCheckArgs</span><span class="hl-1">;</span><br/><span class="hl-1">}) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-11">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-11">void</span><span class="hl-1">&gt;;</span><br/><br/><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-11">IRiskCheckArgs</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-11">ISignalDto</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">currentPrice</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">timestamp</span><span class="hl-1">: </span><span class="hl-11">Date</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Validation functions throw errors to reject signals. Async validations are supported for external data fetching.</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addRisk</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addRisk</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">riskName:</span><span class="hl-1"> </span><span class="hl-2">&quot;advanced&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">maxConcurrentPositions:</span><span class="hl-1"> </span><span class="hl-6">10</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">validations:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-0">validate</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> ({ </span><span class="hl-4">params</span><span class="hl-1"> }) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">portfolio</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getPortfolioState</span><span class="hl-1">();</span><br/><span class="hl-1">        </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">portfolio</span><span class="hl-1">.</span><span class="hl-4">drawdown</span><span class="hl-1"> &gt; </span><span class="hl-6">20</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-3">throw</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><span class="hl-2">&quot;Portfolio drawdown exceeds 20%&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">      </span><span class="hl-4">docDescription:</span><span class="hl-1"> </span><span class="hl-2">&quot;Prevents trading during high drawdown&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    ({ </span><span class="hl-4">params</span><span class="hl-1"> }) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">riskRewardRatio</span><span class="hl-1"> = </span><br/><span class="hl-1">        </span><span class="hl-4">Math</span><span class="hl-1">.</span><span class="hl-0">abs</span><span class="hl-1">(</span><span class="hl-4">params</span><span class="hl-1">.</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceTakeProfit</span><span class="hl-1"> - </span><span class="hl-4">params</span><span class="hl-1">.</span><span class="hl-4">currentPrice</span><span class="hl-1">) /</span><br/><span class="hl-1">        </span><span class="hl-4">Math</span><span class="hl-1">.</span><span class="hl-0">abs</span><span class="hl-1">(</span><span class="hl-4">params</span><span class="hl-1">.</span><span class="hl-4">currentPrice</span><span class="hl-1"> - </span><span class="hl-4">params</span><span class="hl-1">.</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceStopLoss</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><br/><span class="hl-1">      </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">riskRewardRatio</span><span class="hl-1"> &lt; </span><span class="hl-6">2</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">throw</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><span class="hl-2">&quot;Risk/reward ratio below 2:1&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onRejected</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">reason</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[RISK] Signal rejected: </span><span class="hl-7">${</span><span class="hl-4">reason</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">onAllowed</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[RISK] Signal allowed for </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Validation:</strong>
<code>RiskValidationService</code> (<code>src/services/validation/RiskValidationService</code>) validates:</p>
<ul>
<li><code>riskName</code> is unique and non-empty string</li>
<li><code>maxConcurrentPositions</code> (if provided) is positive integer</li>
<li>Each validation in <code>validations</code> array has <code>validate</code> function</li>
</ul>
<p><strong>Storage:</strong>
<code>RiskSchemaService</code> (<code>src/services/schema/RiskSchemaService</code>) stores schema in <code>ToolRegistry</code> instance.</p>
<hr>
<a id="addoptimizer" class="tsd-anchor"></a><h3 class="tsd-anchor-link">addOptimizer<a href="#addoptimizer" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">addOptimizer</span><span class="hl-1">(</span><span class="hl-4">optimizerSchema</span><span class="hl-1">: </span><span class="hl-4">IOptimizerSchema</span><span class="hl-1">): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Registers an optimizer for LLM-powered strategy generation with data collection, prompt engineering, and code generation.</p>
<p><strong>Schema Structure (IOptimizerSchema):</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>optimizerName</code></td>
<td><code>string</code></td>
<td>✓</td>
<td>Unique optimizer identifier</td>
</tr>
<tr>
<td><code>rangeTrain</code></td>
<td><code>IOptimizerRange[]</code></td>
<td>✓</td>
<td>Training period date ranges</td>
</tr>
<tr>
<td><code>rangeTest</code></td>
<td><code>IOptimizerRange</code></td>
<td>✓</td>
<td>Testing period date range</td>
</tr>
<tr>
<td><code>source</code></td>
<td><code>IOptimizerSource[]</code></td>
<td>✓</td>
<td>Data sources for LLM context</td>
</tr>
<tr>
<td><code>getPrompt</code></td>
<td><code>(symbol, messages) =&gt; Promise&lt;string&gt;</code></td>
<td>✓</td>
<td>Prompt generation function</td>
</tr>
<tr>
<td><code>template</code></td>
<td><code>IOptimizerTemplate</code></td>
<td></td>
<td>Custom code generation template</td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td><code>Partial&lt;IOptimizerCallbacks&gt;</code></td>
<td></td>
<td>Optional lifecycle hooks</td>
</tr>
<tr>
<td><code>note</code></td>
<td><code>string</code></td>
<td></td>
<td>Developer documentation</td>
</tr>
</tbody>
</table>
<p><strong>Date Range Structure:</strong></p>
<pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-11">IOptimizerRange</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">startDate</span><span class="hl-1">: </span><span class="hl-11">Date</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">endDate</span><span class="hl-1">: </span><span class="hl-11">Date</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Data Source Structure:</strong></p>
<pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-11">IOptimizerSource</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-11">CandleInterval</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">strategies</span><span class="hl-1">: </span><span class="hl-11">IOptimizerStrategy</span><span class="hl-1">[];</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-11">IOptimizerStrategy</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">frameName</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addOptimizer</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Ollama</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;ollama&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">ollama</span><span class="hl-1"> = </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Ollama</span><span class="hl-1">({ </span><span class="hl-4">host:</span><span class="hl-1"> </span><span class="hl-2">&#39;http://localhost:11434&#39;</span><span class="hl-1"> });</span><br/><br/><span class="hl-0">addOptimizer</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">optimizerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;llm-strategy-generator&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">rangeTrain:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-01&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-31&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Training period 1&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-4">rangeTest:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-02-01&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">    </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-02-28&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">    </span><span class="hl-4">note:</span><span class="hl-1"> </span><span class="hl-2">&quot;Testing period&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-4">source:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;1h&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">strategies:</span><span class="hl-1"> [</span><br/><span class="hl-1">        { </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;baseline&quot;</span><span class="hl-1">, </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;train-frame-1&quot;</span><span class="hl-1"> },</span><br/><span class="hl-1">      ],</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-0">getPrompt</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">messages</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">response</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">ollama</span><span class="hl-1">.</span><span class="hl-0">chat</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-4">model:</span><span class="hl-1"> </span><span class="hl-2">&quot;deepseek-v3.1:671b&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">messages</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">response</span><span class="hl-1">.</span><span class="hl-4">message</span><span class="hl-1">.</span><span class="hl-4">content</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Validation:</strong>
<code>OptimizerValidationService</code> (<code>src/services/validation/OptimizerValidationService</code>) validates:</p>
<ul>
<li><code>optimizerName</code> is unique and non-empty string</li>
<li><code>rangeTrain</code> is non-empty array</li>
<li><code>rangeTest</code> is valid date range</li>
<li><code>source</code> array structure is valid</li>
<li><code>getPrompt</code> is a function</li>
</ul>
<p><strong>Storage:</strong>
<code>OptimizerSchemaService</code> (<code>src/services/schema/OptimizerSchemaService</code>) stores schema in <code>ToolRegistry</code> instance.</p>
<hr>
<a id="query-functions" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Query Functions<a href="#query-functions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Query functions retrieve lists of registered schemas from validation services. All functions return arrays of schema objects.</p>
<p><img src="../media/57_global-functions_2.svg" alt="Mermaid Diagram"></p>
<p>All list functions share the same pattern:</p>
<ol>
<li>Log the request via <code>LoggerService</code></li>
<li>Delegate to appropriate <code>ValidationService.list()</code></li>
<li>ValidationService retrieves schemas from SchemaService</li>
<li>Returns array of schema objects</li>
</ol>
<hr>
<a id="listexchanges" class="tsd-anchor"></a><h3 class="tsd-anchor-link">listExchanges<a href="#listexchanges" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">listExchanges</span><span class="hl-1">(): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">IExchangeSchema</span><span class="hl-1">[]&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Returns array of all registered exchange schemas.</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">exchanges</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">listExchanges</span><span class="hl-1">();</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">exchanges</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">e</span><span class="hl-1"> </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-4">e</span><span class="hl-1">.</span><span class="hl-4">exchangeName</span><span class="hl-1">));</span><br/><span class="hl-5">// [&quot;binance&quot;, &quot;coinbase&quot;, ...]</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="liststrategies" class="tsd-anchor"></a><h3 class="tsd-anchor-link">listStrategies<a href="#liststrategies" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">listStrategies</span><span class="hl-1">(): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">IStrategySchema</span><span class="hl-1">[]&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Returns array of all registered strategy schemas.</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">strategies</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">listStrategies</span><span class="hl-1">();</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">strategies</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">s</span><span class="hl-1"> </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-4">s</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">));</span><br/><span class="hl-5">// [&quot;sma-crossover&quot;, &quot;rsi-divergence&quot;, ...]</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="listframes" class="tsd-anchor"></a><h3 class="tsd-anchor-link">listFrames<a href="#listframes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">listFrames</span><span class="hl-1">(): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">IFrameSchema</span><span class="hl-1">[]&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Returns array of all registered frame schemas.</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">frames</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">listFrames</span><span class="hl-1">();</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">frames</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">f</span><span class="hl-1"> </span><span class="hl-7">=&gt;</span><span class="hl-1"> ({ </span><br/><span class="hl-1">  </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-4">f</span><span class="hl-1">.</span><span class="hl-4">frameName</span><span class="hl-1">, </span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-4">f</span><span class="hl-1">.</span><span class="hl-4">interval</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">start:</span><span class="hl-1"> </span><span class="hl-4">f</span><span class="hl-1">.</span><span class="hl-4">startDate</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">end:</span><span class="hl-1"> </span><span class="hl-4">f</span><span class="hl-1">.</span><span class="hl-4">endDate</span><span class="hl-1"> </span><br/><span class="hl-1">})));</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="listwalkers" class="tsd-anchor"></a><h3 class="tsd-anchor-link">listWalkers<a href="#listwalkers" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">listWalkers</span><span class="hl-1">(): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">IWalkerSchema</span><span class="hl-1">[]&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Returns array of all registered walker schemas.</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">walkers</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">listWalkers</span><span class="hl-1">();</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">walkers</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">w</span><span class="hl-1"> </span><span class="hl-7">=&gt;</span><span class="hl-1"> ({ </span><br/><span class="hl-1">  </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-4">w</span><span class="hl-1">.</span><span class="hl-4">walkerName</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">strategies:</span><span class="hl-1"> </span><span class="hl-4">w</span><span class="hl-1">.</span><span class="hl-4">strategies</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">metric:</span><span class="hl-1"> </span><span class="hl-4">w</span><span class="hl-1">.</span><span class="hl-4">metric</span><span class="hl-1"> </span><br/><span class="hl-1">})));</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="listsizings" class="tsd-anchor"></a><h3 class="tsd-anchor-link">listSizings<a href="#listsizings" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">listSizings</span><span class="hl-1">(): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">ISizingSchema</span><span class="hl-1">[]&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Returns array of all registered sizing schemas.</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">sizings</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">listSizings</span><span class="hl-1">();</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">sizings</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">s</span><span class="hl-1"> </span><span class="hl-7">=&gt;</span><span class="hl-1"> ({ </span><br/><span class="hl-1">  </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-4">s</span><span class="hl-1">.</span><span class="hl-4">sizingName</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">method:</span><span class="hl-1"> </span><span class="hl-4">s</span><span class="hl-1">.</span><span class="hl-4">method</span><span class="hl-1"> </span><br/><span class="hl-1">})));</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="listrisks" class="tsd-anchor"></a><h3 class="tsd-anchor-link">listRisks<a href="#listrisks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">listRisks</span><span class="hl-1">(): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">IRiskSchema</span><span class="hl-1">[]&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Returns array of all registered risk schemas.</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">risks</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">listRisks</span><span class="hl-1">();</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">risks</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">r</span><span class="hl-1"> </span><span class="hl-7">=&gt;</span><span class="hl-1"> ({ </span><br/><span class="hl-1">  </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-4">r</span><span class="hl-1">.</span><span class="hl-4">riskName</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">maxPositions:</span><span class="hl-1"> </span><span class="hl-4">r</span><span class="hl-1">.</span><span class="hl-4">maxConcurrentPositions</span><span class="hl-1"> </span><br/><span class="hl-1">})));</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="listoptimizers" class="tsd-anchor"></a><h3 class="tsd-anchor-link">listOptimizers<a href="#listoptimizers" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">listOptimizers</span><span class="hl-1">(): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">IOptimizerSchema</span><span class="hl-1">[]&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Returns array of all registered optimizer schemas.</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">optimizers</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">listOptimizers</span><span class="hl-1">();</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">optimizers</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">o</span><span class="hl-1"> </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-4">o</span><span class="hl-1">.</span><span class="hl-4">optimizerName</span><span class="hl-1">));</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="event-subscription-functions" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Event Subscription Functions<a href="#event-subscription-functions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Event subscription functions register callbacks for framework events. The framework uses a Subject pattern for event emission with support for both persistent and one-time listeners.</p>
<p><img src="../media/57_global-functions_3.svg" alt="Mermaid Diagram"></p>
<p><strong>Event Subscription Pattern:</strong></p>
<ol>
<li><strong>Event Producers</strong> emit events during execution (strategies, backtests, live trading, walkers)</li>
<li><strong>Event Emitters</strong> broadcast events to registered listeners using Subject pattern</li>
<li><strong>Listen Functions</strong> register callbacks with emitters</li>
<li><strong>Queued Wrapper</strong> ensures sequential async callback execution (prevents race conditions)</li>
</ol>
<p>All listener callbacks are wrapped with <code>functools-kit</code> <code>queued()</code> to ensure sequential execution even when multiple events fire rapidly.</p>
<hr>
<a id="signal-event-listeners" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Signal Event Listeners<a href="#signal-event-listeners" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>listenSignal / listenSignalOnce:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenSignal</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-11">ISignalRow</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span><br/><span class="hl-0">listenSignalOnce</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-11">ISignalRow</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to all signal events (backtest and live). <code>listenSignalOnce</code> unsubscribes after first event.</p>
<p><strong>listenSignalBacktest / listenSignalBacktestOnce:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenSignalBacktest</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-11">ISignalRow</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span><br/><span class="hl-0">listenSignalBacktestOnce</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-11">ISignalRow</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to backtest signal events only.</p>
<p><strong>listenSignalLive / listenSignalLiveOnce:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenSignalLive</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-11">ISignalRow</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span><br/><span class="hl-0">listenSignalLiveOnce</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-11">ISignalRow</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to live trading signal events only.</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">listenSignal</span><span class="hl-1">, </span><span class="hl-4">listenSignalBacktest</span><span class="hl-1">, </span><span class="hl-4">Backtest</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">listenSignal</span><span class="hl-1">((</span><span class="hl-4">signal</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[</span><span class="hl-7">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2">] </span><span class="hl-7">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">position</span><span class="hl-7">}</span><span class="hl-2"> at </span><span class="hl-7">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceOpen</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">listenSignalBacktest</span><span class="hl-1">((</span><span class="hl-4">signal</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">closeReason</span><span class="hl-1"> === </span><span class="hl-2">&#39;take_profit&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`TP hit: </span><span class="hl-7">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">pnl</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&#39;BTCUSDT&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&#39;my-strategy&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&#39;binance&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&#39;1d-test&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="completion-event-listeners" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Completion Event Listeners<a href="#completion-event-listeners" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>listenDoneBacktest / listenDoneBacktestOnce:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenDoneBacktest</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">DoneContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span><br/><span class="hl-0">listenDoneBacktestOnce</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">DoneContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to backtest completion events.</p>
<p><strong>listenDoneLive / listenDoneLiveOnce:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenDoneLive</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">DoneContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span><br/><span class="hl-0">listenDoneLiveOnce</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">DoneContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to live trading completion events (graceful shutdown).</p>
<p><strong>listenDoneWalker / listenDoneWalkerOnce:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenDoneWalker</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">DoneContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span><br/><span class="hl-0">listenDoneWalkerOnce</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">DoneContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to walker completion events.</p>
<p><strong>DoneContract Structure:</strong></p>
<pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-11">DoneContract</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName</span><span class="hl-1">?: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">frameName</span><span class="hl-1">?: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">backtest</span><span class="hl-1">: </span><span class="hl-11">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">listenDoneBacktest</span><span class="hl-1">, </span><span class="hl-4">Backtest</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">listenDoneBacktest</span><span class="hl-1">(</span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Backtest complete: </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2"> - </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">strategyName</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="progress-event-listeners" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Progress Event Listeners<a href="#progress-event-listeners" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>listenBacktestProgress:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenBacktestProgress</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">ProgressBacktestContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to backtest frame completion progress.</p>
<p><strong>ProgressBacktestContract:</strong></p>
<pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-11">ProgressBacktestContract</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">frameName</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">currentFrame</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">totalFrames</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">percentage</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>listenWalkerProgress:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenWalkerProgress</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">ProgressWalkerContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to walker strategy comparison progress.</p>
<p><strong>ProgressWalkerContract:</strong></p>
<pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-11">ProgressWalkerContract</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">walkerName</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">currentStrategy</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">currentStrategyIndex</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">totalStrategies</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">percentage</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>listenOptimizerProgress:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenOptimizerProgress</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">ProgressOptimizerContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to optimizer data collection progress.</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">listenBacktestProgress</span><span class="hl-1">, </span><span class="hl-4">Backtest</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">listenBacktestProgress</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Progress: </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">percentage</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-6">2</span><span class="hl-9">)</span><span class="hl-7">}</span><span class="hl-2">% (</span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">currentFrame</span><span class="hl-7">}</span><span class="hl-2">/</span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">totalFrames</span><span class="hl-7">}</span><span class="hl-2">)`</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="risk-event-listeners" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Risk Event Listeners<a href="#risk-event-listeners" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>listenRisk / listenRiskOnce:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenRisk</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">RiskContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span><br/><span class="hl-0">listenRiskOnce</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">RiskContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to risk validation rejection events.</p>
<p><strong>RiskContract:</strong></p>
<pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-11">RiskContract</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">reason</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">timestamp</span><span class="hl-1">: </span><span class="hl-11">Date</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">listenRisk</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">listenRisk</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[RISK] </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2">: </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">reason</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="partial-event-listeners" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Partial Event Listeners<a href="#partial-event-listeners" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>listenPartialProfit / listenPartialProfitOnce:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenPartialProfit</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">PartialProfitContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span><br/><span class="hl-0">listenPartialProfitOnce</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">PartialProfitContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to profit milestone events (10%, 20%, 30%, etc.).</p>
<p><strong>listenPartialLoss / listenPartialLossOnce:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenPartialLoss</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">PartialLossContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span><br/><span class="hl-0">listenPartialLossOnce</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">PartialLossContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to loss milestone events (-10%, -20%, -30%, etc.).</p>
<p><strong>PartialProfitContract / PartialLossContract:</strong></p>
<pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-11">PartialProfitContract</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">level</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;           </span><span class="hl-5">// Milestone level (10, 20, 30, ...)</span><br/><span class="hl-1">  </span><span class="hl-4">currentPnlPercentage</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-11">ISignalRow</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">timestamp</span><span class="hl-1">: </span><span class="hl-11">Date</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">listenPartialProfit</span><span class="hl-1">, </span><span class="hl-4">listenPartialLoss</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">listenPartialProfit</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[PROFIT] </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2">: +</span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">currentPnlPercentage</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-6">2</span><span class="hl-9">)</span><span class="hl-7">}</span><span class="hl-2">%`</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">listenPartialLoss</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`[LOSS] </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2">: </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">currentPnlPercentage</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-6">2</span><span class="hl-9">)</span><span class="hl-7">}</span><span class="hl-2">%`</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="performance-event-listeners" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Performance Event Listeners<a href="#performance-event-listeners" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>listenPerformance:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenPerformance</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">PerformanceContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to execution timing metrics for profiling.</p>
<p><strong>PerformanceContract:</strong></p>
<pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-11">PerformanceContract</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">metricType</span><span class="hl-1">: </span><span class="hl-11">PerformanceMetricType</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">duration</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">timestamp</span><span class="hl-1">: </span><span class="hl-11">Date</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-7">type</span><span class="hl-1"> </span><span class="hl-11">PerformanceMetricType</span><span class="hl-1"> = </span><span class="hl-2">&#39;tick&#39;</span><span class="hl-1"> | </span><span class="hl-2">&#39;backtest&#39;</span><span class="hl-1"> | </span><span class="hl-2">&#39;getSignal&#39;</span><span class="hl-1"> | </span><span class="hl-2">&#39;getCandles&#39;</span><span class="hl-1">;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">listenPerformance</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">listenPerformance</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">duration</span><span class="hl-1"> &gt; </span><span class="hl-6">1000</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">warn</span><span class="hl-1">(</span><span class="hl-2">`[PERF] Slow </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">metricType</span><span class="hl-7">}</span><span class="hl-2">: </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">duration</span><span class="hl-7">}</span><span class="hl-2">ms`</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="error-event-listeners" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Error Event Listeners<a href="#error-event-listeners" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>listenError:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenError</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">error</span><span class="hl-1">: </span><span class="hl-11">Error</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to recoverable errors (execution continues).</p>
<p><strong>listenExit:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenExit</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">error</span><span class="hl-1">: </span><span class="hl-11">Error</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to fatal errors (execution terminates).</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">listenError</span><span class="hl-1">, </span><span class="hl-4">listenExit</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">listenError</span><span class="hl-1">((</span><span class="hl-4">error</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">&#39;[ERROR] Recoverable:&#39;</span><span class="hl-1">, </span><span class="hl-4">error</span><span class="hl-1">.</span><span class="hl-4">message</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">listenExit</span><span class="hl-1">((</span><span class="hl-4">error</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">&#39;[FATAL] Terminating:&#39;</span><span class="hl-1">, </span><span class="hl-4">error</span><span class="hl-1">.</span><span class="hl-4">message</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">process</span><span class="hl-1">.</span><span class="hl-0">exit</span><span class="hl-1">(</span><span class="hl-6">1</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="walker-event-listeners" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Walker Event Listeners<a href="#walker-event-listeners" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>listenWalker / listenWalkerOnce:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenWalker</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">WalkerContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span><br/><span class="hl-0">listenWalkerOnce</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">WalkerContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to walker strategy comparison events.</p>
<p><strong>listenWalkerComplete:</strong></p>
<pre><code class="typescript"><span class="hl-0">listenWalkerComplete</span><span class="hl-1">(</span><span class="hl-4">callback</span><span class="hl-1">: (</span><span class="hl-4">event</span><span class="hl-1">: </span><span class="hl-11">WalkerCompleteContract</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">void</span><span class="hl-1"> | </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;): </span><span class="hl-7">void</span>
</code><button type="button">Copy</button></pre>

<p>Listens to walker final results with ranked strategies.</p>
<p><strong>WalkerCompleteContract:</strong></p>
<pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-11">WalkerCompleteContract</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">walkerName</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">bestStrategy</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">bestMetricValue</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">results</span><span class="hl-1">: </span><span class="hl-11">IWalkerResults</span><span class="hl-1">[];</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">listenWalkerComplete</span><span class="hl-1">, </span><span class="hl-4">Walker</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">listenWalkerComplete</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Best strategy: </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">bestStrategy</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Metric value: </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">bestMetricValue</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">results</span><span class="hl-1">.</span><span class="hl-0">forEach</span><span class="hl-1">((</span><span class="hl-4">result</span><span class="hl-1">, </span><span class="hl-4">index</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`</span><span class="hl-7">${</span><span class="hl-4">index</span><span class="hl-9"> </span><span class="hl-1">+</span><span class="hl-9"> </span><span class="hl-6">1</span><span class="hl-7">}</span><span class="hl-2">. </span><span class="hl-7">${</span><span class="hl-4">result</span><span class="hl-9">.</span><span class="hl-4">strategyName</span><span class="hl-7">}</span><span class="hl-2">: </span><span class="hl-7">${</span><span class="hl-4">result</span><span class="hl-9">.</span><span class="hl-4">metricValue</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&#39;BTCUSDT&#39;</span><span class="hl-1">, { </span><span class="hl-4">walkerName:</span><span class="hl-1"> </span><span class="hl-2">&#39;llm-optimizer&#39;</span><span class="hl-1"> });</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="context-access-functions" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Context Access Functions<a href="#context-access-functions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Context access functions retrieve ambient execution state propagated via <code>AsyncLocalStorage</code>. These functions work within strategy code and callbacks.</p>
<p><img src="../media/57_global-functions_4.svg" alt="Mermaid Diagram"></p>
<p><strong>Context Propagation:</strong></p>
<ol>
<li><strong>Execution Entry</strong> (Backtest/Live) initializes execution context</li>
<li><strong>Context Services</strong> store ambient state in <code>AsyncLocalStorage</code></li>
<li><strong>Strategy Code</strong> accesses context via global functions</li>
<li><strong>No Parameters Required</strong> - context is automatically available</li>
</ol>
<hr>
<a id="getdate" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getDate<a href="#getdate" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">getDate</span><span class="hl-1">(): </span><span class="hl-4">Date</span>
</code><button type="button">Copy</button></pre>

<p>Returns the current execution timestamp from <code>ExecutionContextService</code>. In backtest mode, this is the current frame timestamp. In live mode, this is <code>new Date()</code>.</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addStrategy</span><span class="hl-1">, </span><span class="hl-4">getDate</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;time-aware&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">when</span><span class="hl-1"> = </span><span class="hl-0">getDate</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">hour</span><span class="hl-1"> = </span><span class="hl-4">when</span><span class="hl-1">.</span><span class="hl-0">getHours</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">hour</span><span class="hl-1"> &lt; </span><span class="hl-6">8</span><span class="hl-1"> || </span><span class="hl-4">hour</span><span class="hl-1"> &gt; </span><span class="hl-6">20</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-7">null</span><span class="hl-1">;  </span><span class="hl-5">// Don&#39;t trade outside market hours</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-5">// Generate signal...</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Internal Access:</strong>
<code>getDate()</code> retrieves <code>when</code> from <code>ExecutionContextService.context.when</code> (<code>src/services/context/ExecutionContextService</code>).</p>
<hr>
<a id="getmode" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getMode<a href="#getmode" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">getMode</span><span class="hl-1">(): </span><span class="hl-4">boolean</span>
</code><button type="button">Copy</button></pre>

<p>Returns the execution mode flag from <code>ExecutionContextService</code>. Returns <code>true</code> for backtest mode, <code>false</code> for live mode.</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addStrategy</span><span class="hl-1">, </span><span class="hl-4">getMode</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;mode-aware&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onOpen</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">, </span><span class="hl-4">currentPrice</span><span class="hl-1">, </span><span class="hl-4">backtest</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">isBacktest</span><span class="hl-1"> = </span><span class="hl-0">getMode</span><span class="hl-1">();</span><br/><span class="hl-1">      </span><br/><span class="hl-1">      </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">isBacktest</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;[BACKTEST] Signal opened&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      } </span><span class="hl-3">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">// Send notification to live trading system</span><br/><span class="hl-1">        </span><span class="hl-0">sendNotification</span><span class="hl-1">(</span><span class="hl-2">`[LIVE] </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2"> opened at </span><span class="hl-7">${</span><span class="hl-4">currentPrice</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// Generate signal...</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Internal Access:</strong>
<code>getMode()</code> retrieves <code>backtest</code> from <code>ExecutionContextService.context.backtest</code> (<code>src/services/context/ExecutionContextService</code>).</p>
<hr>
<a id="exchange-utility-functions" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Exchange Utility Functions<a href="#exchange-utility-functions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Exchange utility functions provide access to candle data and formatting methods. These functions retrieve the exchange from context and delegate to <code>ClientExchange</code> methods.</p>
<p><img src="../media/57_global-functions_5.svg" alt="Mermaid Diagram"></p>
<p><strong>Utility Function Flow:</strong></p>
<ol>
<li><strong>Utility Function</strong> called from strategy code</li>
<li><strong>MethodContext</strong> provides current <code>exchangeName</code></li>
<li><strong>ExchangeConnectionService</strong> retrieves cached <code>ClientExchange</code> instance</li>
<li><strong>ClientExchange</strong> delegates to user-defined schema functions</li>
<li><strong>Schema Functions</strong> fetch data from CCXT or custom sources</li>
</ol>
<hr>
<a id="getcandles" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getCandles<a href="#getcandles" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">getCandles</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-4">CandleInterval</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">limit</span><span class="hl-1">: </span><span class="hl-4">number</span><br/><span class="hl-1">): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">ICandleData</span><span class="hl-1">[]&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Fetches historical candle data for the specified symbol and interval. In backtest mode, returns candles up to the current frame timestamp (prevents look-ahead bias). In live mode, returns the most recent candles.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>symbol: string</code> - Trading pair symbol (e.g., &quot;BTCUSDT&quot;)</li>
<li><code>interval: CandleInterval</code> - Candle interval (e.g., &quot;1h&quot;, &quot;15m&quot;)</li>
<li><code>limit: number</code> - Maximum number of candles to fetch</li>
</ul>
<p><strong>CandleInterval:</strong>
<code>&quot;1m&quot;</code> | <code>&quot;3m&quot;</code> | <code>&quot;5m&quot;</code> | <code>&quot;15m&quot;</code> | <code>&quot;30m&quot;</code> | <code>&quot;1h&quot;</code> | <code>&quot;2h&quot;</code> | <code>&quot;4h&quot;</code> | <code>&quot;6h&quot;</code> | <code>&quot;8h&quot;</code> | <code>&quot;12h&quot;</code> | <code>&quot;1d&quot;</code> | <code>&quot;3d&quot;</code></p>
<p><strong>Returns:</strong>
Array of <code>ICandleData</code> objects sorted by timestamp ascending.</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addStrategy</span><span class="hl-1">, </span><span class="hl-4">getCandles</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;sma-crossover&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">candles1h</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getCandles</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-2">&quot;1h&quot;</span><span class="hl-1">, </span><span class="hl-6">50</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">candles15m</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getCandles</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-2">&quot;15m&quot;</span><span class="hl-1">, </span><span class="hl-6">100</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">sma20</span><span class="hl-1"> = </span><span class="hl-0">calculateSMA</span><span class="hl-1">(</span><span class="hl-4">candles1h</span><span class="hl-1">, </span><span class="hl-6">20</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">sma50</span><span class="hl-1"> = </span><span class="hl-0">calculateSMA</span><span class="hl-1">(</span><span class="hl-4">candles1h</span><span class="hl-1">, </span><span class="hl-6">50</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">sma20</span><span class="hl-1"> &gt; </span><span class="hl-4">sma50</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">position:</span><span class="hl-1"> </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">priceTakeProfit:</span><span class="hl-1"> </span><span class="hl-4">candles1h</span><span class="hl-1">[</span><span class="hl-4">candles1h</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1"> - </span><span class="hl-6">1</span><span class="hl-1">].</span><span class="hl-4">close</span><span class="hl-1"> * </span><span class="hl-6">1.02</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">priceStopLoss:</span><span class="hl-1"> </span><span class="hl-4">candles1h</span><span class="hl-1">[</span><span class="hl-4">candles1h</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1"> - </span><span class="hl-6">1</span><span class="hl-1">].</span><span class="hl-4">close</span><span class="hl-1"> * </span><span class="hl-6">0.99</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">minuteEstimatedTime:</span><span class="hl-1"> </span><span class="hl-6">60</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">timestamp:</span><span class="hl-1"> </span><span class="hl-4">Date</span><span class="hl-1">.</span><span class="hl-0">now</span><span class="hl-1">(),</span><br/><span class="hl-1">      };</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-7">null</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Temporal Context Guarantee:</strong>
In backtest mode, <code>getCandles()</code> automatically enforces temporal context by only returning candles with <code>timestamp &lt;= currentFrameTimestamp</code>. This architecturally prevents look-ahead bias - strategies cannot access future data.</p>
<p><strong>Internal Flow:</strong></p>
<ol>
<li>Retrieves <code>exchangeName</code> from <code>MethodContextService</code></li>
<li>Gets cached <code>ClientExchange</code> via <code>ExchangeConnectionService</code></li>
<li>Calls <code>ClientExchange.getCandles()</code> which delegates to user-defined <code>IExchangeSchema.getCandles()</code></li>
<li>Applies temporal filtering in backtest mode</li>
<li>Validates candle data (anomaly detection, completeness checks)</li>
<li>Returns filtered candles</li>
</ol>
<hr>
<a id="getaverageprice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getAveragePrice<a href="#getaverageprice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">getAveragePrice</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">number</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Returns the current VWAP (Volume Weighted Average Price) for the symbol. By default, calculates VWAP from the last 5 1-minute candles. Can be overridden via <code>IExchangeSchema.getAveragePrice()</code>.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>symbol: string</code> - Trading pair symbol</li>
</ul>
<p><strong>Returns:</strong>
VWAP price as a number.</p>
<p><strong>VWAP Calculation:</strong></p>
<pre><code><span class="hl-8">VWAP</span><span class="hl-1"> = </span><span class="hl-0">Σ</span><span class="hl-1">(</span><span class="hl-4">price</span><span class="hl-1"> * </span><span class="hl-4">volume</span><span class="hl-1">) / </span><span class="hl-0">Σ</span><span class="hl-1">(</span><span class="hl-4">volume</span><span class="hl-1">)</span><br/><span class="hl-4">where</span><span class="hl-1"> </span><span class="hl-4">price</span><span class="hl-1"> = (</span><span class="hl-4">high</span><span class="hl-1"> + </span><span class="hl-4">low</span><span class="hl-1"> + </span><span class="hl-4">close</span><span class="hl-1">) / </span><span class="hl-6">3</span>
</code><button>Copy</button></pre>

<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addStrategy</span><span class="hl-1">, </span><span class="hl-4">getAveragePrice</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;vwap-entry&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">vwap</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getAveragePrice</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">lastPrice</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getLastPrice</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">lastPrice</span><span class="hl-1"> &lt; </span><span class="hl-4">vwap</span><span class="hl-1"> * </span><span class="hl-6">0.99</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">position:</span><span class="hl-1"> </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">priceTakeProfit:</span><span class="hl-1"> </span><span class="hl-4">vwap</span><span class="hl-1"> * </span><span class="hl-6">1.01</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">priceStopLoss:</span><span class="hl-1"> </span><span class="hl-4">lastPrice</span><span class="hl-1"> * </span><span class="hl-6">0.98</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">minuteEstimatedTime:</span><span class="hl-1"> </span><span class="hl-6">30</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">timestamp:</span><span class="hl-1"> </span><span class="hl-4">Date</span><span class="hl-1">.</span><span class="hl-0">now</span><span class="hl-1">(),</span><br/><span class="hl-1">      };</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-7">null</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Internal Flow:</strong></p>
<ol>
<li>Retrieves <code>exchangeName</code> from <code>MethodContextService</code></li>
<li>Gets cached <code>ClientExchange</code> via <code>ExchangeConnectionService</code></li>
<li>If <code>IExchangeSchema.getAveragePrice()</code> defined, calls it</li>
<li>Otherwise, fetches last 5 1m candles and calculates VWAP</li>
<li>Returns VWAP price</li>
</ol>
<hr>
<a id="formatprice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">formatPrice<a href="#formatprice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">formatPrice</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Formats price according to exchange-specific precision rules.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>symbol: string</code> - Trading pair symbol</li>
<li><code>price: number</code> - Price to format</li>
</ul>
<p><strong>Returns:</strong>
Formatted price string.</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addStrategy</span><span class="hl-1">, </span><span class="hl-4">formatPrice</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;order-placer&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onOpen</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">, </span><span class="hl-4">currentPrice</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">formattedPrice</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">formatPrice</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">currentPrice</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Order placed at </span><span class="hl-7">${</span><span class="hl-4">formattedPrice</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// Generate signal...</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Internal Flow:</strong></p>
<ol>
<li>Retrieves <code>exchangeName</code> from <code>MethodContextService</code></li>
<li>Gets cached <code>ClientExchange</code> via <code>ExchangeConnectionService</code></li>
<li>Calls <code>ClientExchange.formatPrice()</code> which delegates to <code>IExchangeSchema.formatPrice()</code></li>
<li>Returns formatted string</li>
</ol>
<hr>
<a id="formatquantity" class="tsd-anchor"></a><h3 class="tsd-anchor-link">formatQuantity<a href="#formatquantity" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">formatQuantity</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Formats quantity according to exchange-specific precision rules.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>symbol: string</code> - Trading pair symbol</li>
<li><code>quantity: number</code> - Quantity to format</li>
</ul>
<p><strong>Returns:</strong>
Formatted quantity string.</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addStrategy</span><span class="hl-1">, </span><span class="hl-4">formatQuantity</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;order-placer&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onOpen</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">formattedQty</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">formatQuantity</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">quantity</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Quantity: </span><span class="hl-7">${</span><span class="hl-4">formattedQty</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// Generate signal...</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Internal Flow:</strong></p>
<ol>
<li>Retrieves <code>exchangeName</code> from <code>MethodContextService</code></li>
<li>Gets cached <code>ClientExchange</code> via <code>ExchangeConnectionService</code></li>
<li>Calls <code>ClientExchange.formatQuantity()</code> which delegates to <code>IExchangeSchema.formatQuantity()</code></li>
<li>Returns formatted string</li>
</ol>
<hr>
<a id="debugging-functions" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Debugging Functions<a href="#debugging-functions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="dumpsignal" class="tsd-anchor"></a><h3 class="tsd-anchor-link">dumpSignal<a href="#dumpsignal" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">dumpSignal</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">id</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">messages</span><span class="hl-1">: </span><span class="hl-4">any</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">signal</span><span class="hl-1">: </span><span class="hl-4">any</span><br/><span class="hl-1">): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Logs LLM conversation history and generated signal to file system for analysis and debugging. Creates structured JSON files in <code>./dump/signals/</code> directory.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>id: string</code> - Unique identifier for the dump file</li>
<li><code>messages: any</code> - LLM conversation messages (OpenAI format)</li>
<li><code>signal: any</code> - Generated signal object</li>
</ul>
<p><strong>Output File Structure:</strong></p>
<pre><code><span class="hl-1">./</span><span class="hl-4">dump</span><span class="hl-1">/</span><span class="hl-4">signals</span><span class="hl-1">/{</span><span class="hl-4">id</span><span class="hl-1">}.</span><span class="hl-4">json</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;id&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;uuid-v4&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;timestamp&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;2024-01-01T12:00:00.000Z&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;messages&quot;</span><span class="hl-1">: [...],</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;signal&quot;</span><span class="hl-1">: {...}</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>

<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addStrategy</span><span class="hl-1">, </span><span class="hl-4">dumpSignal</span><span class="hl-1">, </span><span class="hl-4">getCandles</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">v4</span><span class="hl-1"> </span><span class="hl-3">as</span><span class="hl-1"> </span><span class="hl-4">uuid</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;uuid&#39;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Ollama</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;ollama&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">ollama</span><span class="hl-1"> = </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Ollama</span><span class="hl-1">({ </span><span class="hl-4">host:</span><span class="hl-1"> </span><span class="hl-2">&#39;http://localhost:11434&#39;</span><span class="hl-1"> });</span><br/><br/><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;llm-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">candles</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getCandles</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-2">&quot;1h&quot;</span><span class="hl-1">, </span><span class="hl-6">24</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">messages</span><span class="hl-1"> = [</span><br/><span class="hl-1">      { </span><span class="hl-4">role:</span><span class="hl-1"> </span><span class="hl-2">&#39;system&#39;</span><span class="hl-1">, </span><span class="hl-4">content:</span><span class="hl-1"> </span><span class="hl-2">&#39;You are a trading strategy generator.&#39;</span><span class="hl-1"> },</span><br/><span class="hl-1">      { </span><span class="hl-4">role:</span><span class="hl-1"> </span><span class="hl-2">&#39;user&#39;</span><span class="hl-1">, </span><span class="hl-4">content:</span><span class="hl-1"> </span><span class="hl-8">JSON</span><span class="hl-1">.</span><span class="hl-0">stringify</span><span class="hl-1">(</span><span class="hl-4">candles</span><span class="hl-1">) },</span><br/><span class="hl-1">    ];</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">response</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">ollama</span><span class="hl-1">.</span><span class="hl-0">chat</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-4">model:</span><span class="hl-1"> </span><span class="hl-2">&#39;deepseek-v3.1:671b&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">messages</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">signal</span><span class="hl-1"> = </span><span class="hl-8">JSON</span><span class="hl-1">.</span><span class="hl-0">parse</span><span class="hl-1">(</span><span class="hl-4">response</span><span class="hl-1">.</span><span class="hl-4">message</span><span class="hl-1">.</span><span class="hl-4">content</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">resultId</span><span class="hl-1"> = </span><span class="hl-0">uuid</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">dumpSignal</span><span class="hl-1">(</span><span class="hl-4">resultId</span><span class="hl-1">, </span><span class="hl-4">messages</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> { ...</span><span class="hl-4">signal</span><span class="hl-1">, </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-4">resultId</span><span class="hl-1"> };</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Use Cases:</strong></p>
<ul>
<li>Debugging LLM-generated strategies</li>
<li>Analyzing conversation context and outputs</li>
<li>Auditing signal generation decisions</li>
<li>Training data collection</li>
</ul>
<hr>
<a id="summary-tables" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Summary Tables<a href="#summary-tables" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="function-categories-summary" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Function Categories Summary<a href="#function-categories-summary" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Category</th>
<th>Count</th>
<th>Primary Use Cases</th>
</tr>
</thead>
<tbody>
<tr>
<td>Configuration</td>
<td>7</td>
<td>System setup, logging, validation thresholds</td>
</tr>
<tr>
<td>Registration</td>
<td>7</td>
<td>Component definition and storage</td>
</tr>
<tr>
<td>Query</td>
<td>7</td>
<td>Listing registered components</td>
</tr>
<tr>
<td>Event Subscription</td>
<td>20+</td>
<td>Real-time monitoring, callbacks</td>
</tr>
<tr>
<td>Context Access</td>
<td>2</td>
<td>Ambient state retrieval</td>
</tr>
<tr>
<td>Exchange Utilities</td>
<td>4</td>
<td>Data fetching, formatting</td>
</tr>
<tr>
<td>Debugging</td>
<td>1</td>
<td>LLM conversation logging</td>
</tr>
</tbody>
</table>
<hr>
<a id="service-layer-mapping" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Service Layer Mapping<a href="#service-layer-mapping" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Global Function</th>
<th>Service Layer Access Path</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>addStrategy()</code></td>
<td><code>backtest.strategyValidationService</code> → <code>backtest.strategySchemaService</code></td>
<td>Validate and store strategy schema</td>
</tr>
<tr>
<td><code>addExchange()</code></td>
<td><code>backtest.exchangeValidationService</code> → <code>backtest.exchangeSchemaService</code></td>
<td>Validate and store exchange schema</td>
</tr>
<tr>
<td><code>addFrame()</code></td>
<td><code>backtest.frameValidationService</code> → <code>backtest.frameSchemaService</code></td>
<td>Validate and store frame schema</td>
</tr>
<tr>
<td><code>addRisk()</code></td>
<td><code>backtest.riskValidationService</code> → <code>backtest.riskSchemaService</code></td>
<td>Validate and store risk schema</td>
</tr>
<tr>
<td><code>addWalker()</code></td>
<td><code>backtest.walkerValidationService</code> → <code>backtest.walkerSchemaService</code></td>
<td>Validate and store walker schema</td>
</tr>
<tr>
<td><code>addSizing()</code></td>
<td><code>backtest.sizingValidationService</code> → <code>backtest.sizingSchemaService</code></td>
<td>Validate and store sizing schema</td>
</tr>
<tr>
<td><code>addOptimizer()</code></td>
<td><code>backtest.optimizerValidationService</code> → <code>backtest.optimizerSchemaService</code></td>
<td>Validate and store optimizer schema</td>
</tr>
<tr>
<td><code>listExchanges()</code></td>
<td><code>backtest.exchangeValidationService.list()</code></td>
<td>Query exchange schemas</td>
</tr>
<tr>
<td><code>listStrategies()</code></td>
<td><code>backtest.strategyValidationService.list()</code></td>
<td>Query strategy schemas</td>
</tr>
<tr>
<td><code>getCandles()</code></td>
<td><code>backtest.methodContextService</code> → <code>backtest.exchangeConnectionService</code> → <code>ClientExchange</code></td>
<td>Fetch candle data</td>
</tr>
<tr>
<td><code>getDate()</code></td>
<td><code>backtest.executionContextService.context.when</code></td>
<td>Retrieve execution timestamp</td>
</tr>
<tr>
<td><code>getMode()</code></td>
<td><code>backtest.executionContextService.context.backtest</code></td>
<td>Retrieve execution mode flag</td>
</tr>
</tbody>
</table>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#global-functions"><span>Global <wbr/>Functions</span></a><ul><li><a href="#function-categories"><span>Function <wbr/>Categories</span></a></li><li><a href="#architecture-global-functions-to-service-layer"><span>Architecture: <wbr/>Global <wbr/>Functions to <wbr/>Service <wbr/>Layer</span></a></li><li><a href="#configuration-functions"><span>Configuration <wbr/>Functions</span></a></li><li><ul><li><a href="#setlogger"><span>set<wbr/>Logger</span></a></li><li><a href="#setconfig"><span>set<wbr/>Config</span></a></li><li><a href="#getconfig"><span>get<wbr/>Config</span></a></li><li><a href="#getdefaultconfig"><span>get<wbr/>Default<wbr/>Config</span></a></li><li><a href="#setcolumns"><span>set<wbr/>Columns</span></a></li><li><a href="#getcolumns"><span>get<wbr/>Columns</span></a></li><li><a href="#getdefaultcolumns"><span>get<wbr/>Default<wbr/>Columns</span></a></li></ul></li><li><a href="#registration-functions"><span>Registration <wbr/>Functions</span></a></li><li><ul><li><a href="#addstrategy"><span>add<wbr/>Strategy</span></a></li><li><a href="#addexchange"><span>add<wbr/>Exchange</span></a></li><li><a href="#addframe"><span>add<wbr/>Frame</span></a></li><li><a href="#addwalker"><span>add<wbr/>Walker</span></a></li><li><a href="#addsizing"><span>add<wbr/>Sizing</span></a></li><li><a href="#addrisk"><span>add<wbr/>Risk</span></a></li><li><a href="#addoptimizer"><span>add<wbr/>Optimizer</span></a></li></ul></li><li><a href="#query-functions"><span>Query <wbr/>Functions</span></a></li><li><ul><li><a href="#listexchanges"><span>list<wbr/>Exchanges</span></a></li><li><a href="#liststrategies"><span>list<wbr/>Strategies</span></a></li><li><a href="#listframes"><span>list<wbr/>Frames</span></a></li><li><a href="#listwalkers"><span>list<wbr/>Walkers</span></a></li><li><a href="#listsizings"><span>list<wbr/>Sizings</span></a></li><li><a href="#listrisks"><span>list<wbr/>Risks</span></a></li><li><a href="#listoptimizers"><span>list<wbr/>Optimizers</span></a></li></ul></li><li><a href="#event-subscription-functions"><span>Event <wbr/>Subscription <wbr/>Functions</span></a></li><li><ul><li><a href="#signal-event-listeners"><span>Signal <wbr/>Event <wbr/>Listeners</span></a></li><li><a href="#completion-event-listeners"><span>Completion <wbr/>Event <wbr/>Listeners</span></a></li><li><a href="#progress-event-listeners"><span>Progress <wbr/>Event <wbr/>Listeners</span></a></li><li><a href="#risk-event-listeners"><span>Risk <wbr/>Event <wbr/>Listeners</span></a></li><li><a href="#partial-event-listeners"><span>Partial <wbr/>Event <wbr/>Listeners</span></a></li><li><a href="#performance-event-listeners"><span>Performance <wbr/>Event <wbr/>Listeners</span></a></li><li><a href="#error-event-listeners"><span>Error <wbr/>Event <wbr/>Listeners</span></a></li><li><a href="#walker-event-listeners"><span>Walker <wbr/>Event <wbr/>Listeners</span></a></li></ul></li><li><a href="#context-access-functions"><span>Context <wbr/>Access <wbr/>Functions</span></a></li><li><ul><li><a href="#getdate"><span>get<wbr/>Date</span></a></li><li><a href="#getmode"><span>get<wbr/>Mode</span></a></li></ul></li><li><a href="#exchange-utility-functions"><span>Exchange <wbr/>Utility <wbr/>Functions</span></a></li><li><ul><li><a href="#getcandles"><span>get<wbr/>Candles</span></a></li><li><a href="#getaverageprice"><span>get<wbr/>Average<wbr/>Price</span></a></li><li><a href="#formatprice"><span>format<wbr/>Price</span></a></li><li><a href="#formatquantity"><span>format<wbr/>Quantity</span></a></li></ul></li><li><a href="#debugging-functions"><span>Debugging <wbr/>Functions</span></a></li><li><ul><li><a href="#dumpsignal"><span>dump<wbr/>Signal</span></a></li></ul></li><li><a href="#summary-tables"><span>Summary <wbr/>Tables</span></a></li><li><ul><li><a href="#function-categories-summary"><span>Function <wbr/>Categories <wbr/>Summary</span></a></li><li><a href="#service-layer-mapping"><span>Service <wbr/>Layer <wbr/>Mapping</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
