<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/16_execution-modes-detailed | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_16_execution-modes-detailed.html">design/16_execution-modes-detailed</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="execution-modes-detailed" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Execution Modes (Detailed)<a href="#execution-modes-detailed" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><a id="purpose-and-scope" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Purpose and Scope<a href="#purpose-and-scope" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This page provides comprehensive documentation of the four execution modes implemented in backtest-kit: <strong>Backtest</strong>, <strong>Live</strong>, <strong>Walker</strong>, and <strong>Optimizer</strong>. Each mode orchestrates trading strategy execution with distinct architectural patterns, data flows, and performance characteristics. This document details the internal implementation of each mode, including the service layer architecture, async generator patterns, and state management.</p>
<p>For a high-level comparison of when to use each mode, see <a href="design_04_execution-modes-overview.html">Execution Modes Overview</a>. For strategy definition and signal lifecycle concepts, see <a href="design_03_signal-lifecycle-and-state-machine.html">Signal Lifecycle and State Machine</a>.</p>
<a id="execution-mode-architecture" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Execution Mode Architecture<a href="#execution-mode-architecture" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>All four execution modes follow a consistent architectural pattern with three primary layers:</p>
<table>
<thead>
<tr>
<th>Layer</th>
<th>Components</th>
<th>Responsibilities</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Public API</strong></td>
<td><code>Backtest</code>, <code>Live</code>, <code>Walker</code>, <code>Optimizer</code> classes</td>
<td>User-facing singleton instances with validation</td>
</tr>
<tr>
<td><strong>Instance Management</strong></td>
<td><code>BacktestInstance</code>, <code>LiveInstance</code>, <code>WalkerInstance</code></td>
<td>Memoized per-symbol execution contexts</td>
</tr>
<tr>
<td><strong>Command Services</strong></td>
<td><code>BacktestCommandService</code>, <code>LiveCommandService</code>, <code>WalkerCommandService</code></td>
<td>Dependency injection and context propagation</td>
</tr>
<tr>
<td><strong>Logic Services</strong></td>
<td><code>BacktestLogicPublicService/Private</code>, <code>LiveLogicPublicService/Private</code>, <code>WalkerLogicPublicService/Private</code></td>
<td>Core execution logic with async generators</td>
</tr>
<tr>
<td><strong>Core Services</strong></td>
<td><code>StrategyCoreService</code>, <code>ExchangeCoreService</code>, <code>FrameCoreService</code></td>
<td>Domain business logic</td>
</tr>
</tbody>
</table>
<hr>
<a id="backtest-mode" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Backtest Mode<a href="#backtest-mode" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="architecture-overview" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Architecture Overview<a href="#architecture-overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16-execution-modes-detailed_0.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Backtest Mode Service Dependencies</strong></p>
<a id="public-api-entry-points" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Public API Entry Points<a href="#public-api-entry-points" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>Backtest</code> singleton provides the primary interface for backtest operations:</p>
<pre><code class="typescript"><span class="hl-5">// From Backtest.ts</span><br/><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">context</span><span class="hl-1">: {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-4">string</span><br/><span class="hl-1">}) -&gt; </span><span class="hl-4">AsyncGenerator</span><span class="hl-1">&lt;</span><span class="hl-4">IStrategyBacktestResult</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">context</span><span class="hl-1">) -&gt; </span><span class="hl-4">CancellationFunction</span><br/><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">stop</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">) -&gt; </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;</span><br/><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">) -&gt; </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">BacktestStatistics</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Each symbol-strategy pair is managed by a memoized <code>BacktestInstance</code> (keyed by <code>&quot;${symbol}:${strategyName}&quot;</code>), ensuring isolated state and preventing duplicate executions.</p>
<a id="execution-flow" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Execution Flow<a href="#execution-flow" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16-execution-modes-detailed_1.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Backtest Execution Flow with Signal Type Handling</strong></p>
<a id="timeframe-iteration-and-skip-optimization" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Timeframe Iteration and Skip Optimization<a href="#timeframe-iteration-and-skip-optimization" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The backtest mode uses pre-generated timeframes from <code>FrameCoreService.getTimeframe()</code>, which returns an array of <code>Date</code> objects based on the frame configuration. The main optimization technique is <strong>skip-to-close</strong>:</p>
<ol>
<li><strong>Initial tick:</strong> Call <code>StrategyCoreService.tick(when, backtest=true)</code> at each timeframe</li>
<li><strong>Signal opened/scheduled:</strong> When a signal opens, fetch all required candles at once:
<ul>
<li>For scheduled signals: <code>CC_SCHEDULE_AWAIT_MINUTES + minuteEstimatedTime + buffer</code> candles</li>
<li>For opened signals: <code>minuteEstimatedTime + buffer</code> candles</li>
<li>Buffer = <code>CC_AVG_PRICE_CANDLES_COUNT - 1</code> for VWAP calculation</li>
</ul>
</li>
<li><strong>Fast processing:</strong> Call <code>backtest(candles)</code> which processes all candles in memory without individual ticks</li>
<li><strong>Skip timeframes:</strong> Advance loop counter <code>i</code> to skip all timeframes before <code>closeTimestamp</code></li>
<li><strong>Yield result:</strong> Emit closed signal result immediately</li>
</ol>
<p>This pattern eliminates redundant tick calls during active signal monitoring, reducing execution time by orders of magnitude for strategies with long signal lifetimes.</p>
<a id="backtestlogicprivateservice-implementation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">BacktestLogicPrivateService Implementation<a href="#backtestlogicprivateservice-implementation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The core logic is implemented as an async generator in <code>BacktestLogicPrivateService.run()</code>:</p>
<pre><code class="typescript"><span class="hl-5">// From BacktestLogicPrivateService.ts:62-477</span><br/><span class="hl-4">public</span><span class="hl-1"> </span><span class="hl-4">async</span><span class="hl-1"> *</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">timeframes</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">frameCoreService</span><span class="hl-1">.</span><span class="hl-0">getTimeframe</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">frameName</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-7">let</span><span class="hl-1"> </span><span class="hl-4">i</span><span class="hl-1"> = </span><span class="hl-6">0</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-3">while</span><span class="hl-1"> (</span><span class="hl-4">i</span><span class="hl-1"> &lt; </span><span class="hl-4">timeframes</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">when</span><span class="hl-1"> = </span><span class="hl-4">timeframes</span><span class="hl-1">[</span><span class="hl-4">i</span><span class="hl-1">];</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-5">// Emit progress event</span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">progressBacktestEmitter</span><span class="hl-1">.</span><span class="hl-0">next</span><span class="hl-1">({...});</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-5">// Check stop flag before processing</span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">strategyCoreService</span><span class="hl-1">.</span><span class="hl-0">getStopped</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">)) {</span><br/><span class="hl-1">      </span><span class="hl-3">break</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">result</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">strategyCoreService</span><span class="hl-1">.</span><span class="hl-0">tick</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">when</span><span class="hl-1">, </span><span class="hl-7">true</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-5">// Handle scheduled signals</span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;scheduled&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">candles</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">exchangeCoreService</span><span class="hl-1">.</span><span class="hl-0">getNextCandles</span><span class="hl-1">(...);</span><br/><span class="hl-1">      </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">backtestResult</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">strategyCoreService</span><span class="hl-1">.</span><span class="hl-0">backtest</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">candles</span><span class="hl-1">, </span><span class="hl-4">when</span><span class="hl-1">, </span><span class="hl-7">true</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><br/><span class="hl-1">      </span><span class="hl-5">// Skip to close timestamp</span><br/><span class="hl-1">      </span><span class="hl-3">while</span><span class="hl-1"> (</span><span class="hl-4">i</span><span class="hl-1"> &lt; </span><span class="hl-4">timeframes</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1"> &amp;&amp; </span><span class="hl-4">timeframes</span><span class="hl-1">[</span><span class="hl-4">i</span><span class="hl-1">].</span><span class="hl-0">getTime</span><span class="hl-1">() &lt; </span><span class="hl-4">backtestResult</span><span class="hl-1">.</span><span class="hl-4">closeTimestamp</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-4">i</span><span class="hl-1">++;</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><br/><span class="hl-1">      </span><span class="hl-3">yield</span><span class="hl-1"> </span><span class="hl-4">backtestResult</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-5">// Handle opened signals (similar pattern)</span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;opened&quot;</span><span class="hl-1">) { ... }</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-4">i</span><span class="hl-1">++;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Key implementation details:</p>
<ul>
<li><strong>Error handling:</strong> Tick and backtest failures emit to <code>errorEmitter</code> and skip the timeframe</li>
<li><strong>Performance tracking:</strong> Emits to <code>performanceEmitter</code> for signal and timeframe durations</li>
<li><strong>Stop checks:</strong> Multiple stop points (before tick, after idle, after closed) for graceful shutdown</li>
<li><strong>Progress reporting:</strong> Emits <code>progressBacktestEmitter</code> with <code>processedFrames / totalFrames</code></li>
</ul>
<a id="scheduled-signal-handling" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Scheduled Signal Handling<a href="#scheduled-signal-handling" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Scheduled signals (delayed entry orders) require special handling in backtest mode:</p>
<pre><code class="typescript"><span class="hl-5">// From BacktestLogicPrivateService.ts:154-301</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;scheduled&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">signal</span><span class="hl-1"> = </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">signal</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Calculate candles needed:</span><br/><span class="hl-1">  </span><span class="hl-5">// - Buffer for VWAP (CC_AVG_PRICE_CANDLES_COUNT - 1)</span><br/><span class="hl-1">  </span><span class="hl-5">// - Await period (CC_SCHEDULE_AWAIT_MINUTES)</span><br/><span class="hl-1">  </span><span class="hl-5">// - Signal lifetime (minuteEstimatedTime)</span><br/><span class="hl-1">  </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">bufferMinutes</span><span class="hl-1"> = </span><span class="hl-8">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-8">CC_AVG_PRICE_CANDLES_COUNT</span><span class="hl-1"> - </span><span class="hl-6">1</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">bufferStartTime</span><span class="hl-1"> = </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-4">when</span><span class="hl-1">.</span><span class="hl-0">getTime</span><span class="hl-1">() - </span><span class="hl-4">bufferMinutes</span><span class="hl-1"> * </span><span class="hl-6">60</span><span class="hl-1"> * </span><span class="hl-6">1000</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">candlesNeeded</span><span class="hl-1"> = </span><span class="hl-4">bufferMinutes</span><span class="hl-1"> + </span><span class="hl-8">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-8">CC_SCHEDULE_AWAIT_MINUTES</span><span class="hl-1"> + </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">minuteEstimatedTime</span><span class="hl-1"> + </span><span class="hl-6">1</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">candles</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">exchangeCoreService</span><span class="hl-1">.</span><span class="hl-0">getNextCandles</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-2">&quot;1m&quot;</span><span class="hl-1">, </span><span class="hl-4">candlesNeeded</span><span class="hl-1">, </span><span class="hl-4">bufferStartTime</span><span class="hl-1">, </span><span class="hl-7">true</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// backtest() handles activation/cancellation monitoring internally</span><br/><span class="hl-1">  </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">backtestResult</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">strategyCoreService</span><span class="hl-1">.</span><span class="hl-0">backtest</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">candles</span><span class="hl-1">, </span><span class="hl-4">when</span><span class="hl-1">, </span><span class="hl-7">true</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>The <code>backtest()</code> method internally monitors for:</p>
<ol>
<li><strong>Activation conditions:</strong> Price reaches <code>priceOpen</code> within <code>CC_SCHEDULE_AWAIT_MINUTES</code></li>
<li><strong>Cancellation conditions:</strong> Time expires without activation</li>
<li><strong>Post-activation:</strong> Normal TP/SL/time monitoring if activated</li>
</ol>
<a id="state-management-and-memory-efficiency" class="tsd-anchor"></a><h3 class="tsd-anchor-link">State Management and Memory Efficiency<a href="#state-management-and-memory-efficiency" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Backtest mode is stateless by design:</p>
<ul>
<li><strong>No persistence:</strong> Signals are not written to disk</li>
<li><strong>Streaming results:</strong> Async generator yields results without accumulation</li>
<li><strong>Clear on start:</strong> Each <code>run()</code> clears previous markdown service data and strategy state</li>
<li><strong>Early termination:</strong> Consumer can <code>break</code> from the async generator at any point</li>
<li><strong>Memoized instances:</strong> Each symbol-strategy pair reuses the same <code>BacktestInstance</code></li>
</ul>
<p>The clear operations ensure isolation between runs:</p>
<pre><code class="typescript"><span class="hl-5">// From Backtest.ts:161-174</span><br/><span class="hl-4">backtest</span><span class="hl-1">.</span><span class="hl-4">backtestMarkdownService</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">({ </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1"> });</span><br/><span class="hl-4">backtest</span><span class="hl-1">.</span><span class="hl-4">scheduleMarkdownService</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">({ </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1"> });</span><br/><span class="hl-4">backtest</span><span class="hl-1">.</span><span class="hl-4">strategyCoreService</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">({ </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1"> });</span><br/><br/><span class="hl-7">const</span><span class="hl-1"> { </span><span class="hl-8">riskName</span><span class="hl-1">, </span><span class="hl-8">riskList</span><span class="hl-1"> } = </span><span class="hl-4">backtest</span><span class="hl-1">.</span><span class="hl-4">strategySchemaService</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">);</span><br/><span class="hl-4">riskName</span><span class="hl-1"> &amp;&amp; </span><span class="hl-4">backtest</span><span class="hl-1">.</span><span class="hl-4">riskGlobalService</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">(</span><span class="hl-4">riskName</span><span class="hl-1">);</span><br/><span class="hl-4">riskList</span><span class="hl-1">?.</span><span class="hl-0">forEach</span><span class="hl-1">((</span><span class="hl-4">riskName</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-4">backtest</span><span class="hl-1">.</span><span class="hl-4">riskGlobalService</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">(</span><span class="hl-4">riskName</span><span class="hl-1">));</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="live-trading-mode" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Live Trading Mode<a href="#live-trading-mode" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="architecture-overview-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Architecture Overview<a href="#architecture-overview-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16-execution-modes-detailed_2.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Live Mode Service Dependencies with Persistence</strong></p>
<a id="public-api-entry-points-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Public API Entry Points<a href="#public-api-entry-points-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>Live</code> singleton provides crash-safe real-time trading:</p>
<pre><code class="typescript"><span class="hl-5">// From Live.ts</span><br/><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">context</span><span class="hl-1">: {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-4">string</span><br/><span class="hl-1">}) -&gt; </span><span class="hl-4">AsyncGenerator</span><span class="hl-1">&lt;</span><span class="hl-4">IStrategyTickResultOpened</span><span class="hl-1"> | </span><span class="hl-4">IStrategyTickResultClosed</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">context</span><span class="hl-1">) -&gt; </span><span class="hl-4">CancellationFunction</span><br/><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">stop</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">) -&gt; </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;</span><br/><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">) -&gt; </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">LiveStatistics</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Key differences from Backtest:</p>
<ul>
<li><strong>No frameName:</strong> Live mode uses real-time progression (<code>new Date()</code>)</li>
<li><strong>Filtered output:</strong> Generator only yields <code>opened</code> and <code>closed</code> results (not <code>idle</code>/<code>active</code>)</li>
<li><strong>Infinite loop:</strong> Generator never completes unless explicitly stopped</li>
<li><strong>Crash recovery:</strong> State restored from disk on restart</li>
</ul>
<a id="execution-flow-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Execution Flow<a href="#execution-flow-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16-execution-modes-detailed_3.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Live Mode Infinite Loop with Crash-Safe Persistence</strong></p>
<a id="infinite-loop-architecture" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Infinite Loop Architecture<a href="#infinite-loop-architecture" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The core difference between live and backtest is the infinite loop structure:</p>
<pre><code class="typescript"><span class="hl-5">// From LiveLogicPrivateService.ts:63-175</span><br/><span class="hl-4">public</span><span class="hl-1"> </span><span class="hl-4">async</span><span class="hl-1"> *</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-7">let</span><span class="hl-1"> </span><span class="hl-4">previousEventTimestamp</span><span class="hl-1">: </span><span class="hl-13">number</span><span class="hl-1"> | </span><span class="hl-13">null</span><span class="hl-1"> = </span><span class="hl-7">null</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-3">while</span><span class="hl-1"> (</span><span class="hl-7">true</span><span class="hl-1">) {  </span><span class="hl-5">// Infinite loop</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">tickStartTime</span><span class="hl-1"> = </span><span class="hl-4">performance</span><span class="hl-1">.</span><span class="hl-0">now</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">when</span><span class="hl-1"> = </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">();  </span><span class="hl-5">// Real-time date</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">result</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">strategyCoreService</span><span class="hl-1">.</span><span class="hl-0">tick</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">when</span><span class="hl-1">, </span><span class="hl-7">false</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-5">// Track performance</span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">performanceEmitter</span><span class="hl-1">.</span><span class="hl-0">next</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-4">timestamp:</span><span class="hl-1"> </span><span class="hl-4">Date</span><span class="hl-1">.</span><span class="hl-0">now</span><span class="hl-1">(),</span><br/><span class="hl-1">      </span><span class="hl-4">previousTimestamp:</span><span class="hl-1"> </span><span class="hl-4">previousEventTimestamp</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">metricType:</span><span class="hl-1"> </span><span class="hl-2">&quot;live_tick&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">duration:</span><span class="hl-1"> </span><span class="hl-4">performance</span><span class="hl-1">.</span><span class="hl-0">now</span><span class="hl-1">() - </span><span class="hl-4">tickStartTime</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">exchangeName</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">backtest:</span><span class="hl-1"> </span><span class="hl-7">false</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-5">// Check stop conditions</span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;idle&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">strategyCoreService</span><span class="hl-1">.</span><span class="hl-0">getStopped</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">)) {</span><br/><span class="hl-1">        </span><span class="hl-3">break</span><span class="hl-1">;  </span><span class="hl-5">// Exit when idle</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">sleep</span><span class="hl-1">(</span><span class="hl-8">TICK_TTL</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-3">continue</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;active&quot;</span><span class="hl-1"> || </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;scheduled&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">sleep</span><span class="hl-1">(</span><span class="hl-8">TICK_TTL</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-3">continue</span><span class="hl-1">;  </span><span class="hl-5">// Skip yielding, just continue loop</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-5">// Yield opened/closed only</span><br/><span class="hl-1">    </span><span class="hl-3">yield</span><span class="hl-1"> </span><span class="hl-4">result</span><span class="hl-1"> </span><span class="hl-3">as</span><span class="hl-1"> </span><span class="hl-13">IStrategyTickResultOpened</span><span class="hl-1"> | </span><span class="hl-13">IStrategyTickResultClosed</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-5">// Check stop after closed</span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">strategyCoreService</span><span class="hl-1">.</span><span class="hl-0">getStopped</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">)) {</span><br/><span class="hl-1">        </span><span class="hl-3">break</span><span class="hl-1">;</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">sleep</span><span class="hl-1">(</span><span class="hl-8">TICK_TTL</span><span class="hl-1">);  </span><span class="hl-5">// 61 seconds between ticks</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Key characteristics:</p>
<ul>
<li><strong><code>TICK_TTL = 61000ms</code>:</strong> Slightly over 1 minute to ensure fresh candle data</li>
<li><strong>Real-time dates:</strong> <code>new Date()</code> called each iteration</li>
<li><strong>No frame skipping:</strong> Every tick is processed (no optimization like backtest)</li>
<li><strong>Filtered yield:</strong> Only <code>opened</code> and <code>closed</code> emitted to consumer</li>
</ul>
<a id="crash-safe-persistence" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Crash-Safe Persistence<a href="#crash-safe-persistence" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Live mode achieves crash safety through atomic file writes and state recovery:</p>
<a id="write-path-persistence" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Write Path (Persistence)<a href="#write-path-persistence" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-5">// StrategyCoreService calls PersistSignalAdapter</span><br/><span class="hl-5">// From StrategyCoreService (not shown in files, but documented)</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">persistSignalAdapter</span><span class="hl-1">.</span><span class="hl-0">writeSignalData</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">signal</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p>The <code>PersistSignalAdapter</code> writes JSON atomically:</p>
<ol>
<li>Serialize signal object to JSON</li>
<li>Write to temporary file</li>
<li>Atomic rename to final path: <code>./persist/${symbol}_${strategyName}.json</code></li>
</ol>
<a id="read-path-recovery" class="tsd-anchor"></a><h4 class="tsd-anchor-link">Read Path (Recovery)<a href="#read-path-recovery" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-5">// From ClientStrategy (referenced but not in provided files)</span><br/><span class="hl-4">async</span><span class="hl-1"> </span><span class="hl-0">waitForInit</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_initialized</span><span class="hl-1">) </span><span class="hl-3">return</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">persistedSignal</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">persistSignalAdapter</span><span class="hl-1">.</span><span class="hl-0">readSignalData</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1">, </span><br/><span class="hl-1">    </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">persistedSignal</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_pendingSignal</span><span class="hl-1"> = </span><span class="hl-4">persistedSignal</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_initialized</span><span class="hl-1"> = </span><span class="hl-7">true</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>The <code>waitForInit()</code> is called on first tick:</p>
<ul>
<li>Loads persisted signal from disk</li>
<li>Restores <code>_pendingSignal</code> state</li>
<li>Continues monitoring from last known position</li>
<li>If file doesn't exist, starts fresh</li>
</ul>
<a id="graceful-shutdown" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Graceful Shutdown<a href="#graceful-shutdown" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Live mode implements graceful shutdown to avoid interrupting active positions:</p>
<pre><code class="typescript"><span class="hl-5">// From Live.ts:221-240</span><br/><span class="hl-3">return</span><span class="hl-1"> () </span><span class="hl-7">=&gt;</span><span class="hl-1"> {  </span><span class="hl-5">// Cancellation function returned by background()</span><br/><span class="hl-1">  </span><span class="hl-5">// Set stop flag</span><br/><span class="hl-1">  </span><span class="hl-4">backtest</span><span class="hl-1">.</span><span class="hl-4">strategyCoreService</span><span class="hl-1">.</span><span class="hl-0">stop</span><span class="hl-1">({</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">}, </span><span class="hl-7">false</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Wait for position to close</span><br/><span class="hl-1">  </span><span class="hl-4">backtest</span><span class="hl-1">.</span><span class="hl-4">strategyCoreService</span><br/><span class="hl-1">    .</span><span class="hl-0">getPendingSignal</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">)</span><br/><span class="hl-1">    .</span><span class="hl-0">then</span><span class="hl-1">(</span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">pendingSignal</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">pendingSignal</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">return</span><span class="hl-1">;  </span><span class="hl-5">// Position still open, don&#39;t emit done</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><span class="hl-3">if</span><span class="hl-1"> (!</span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_isDone</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">doneLiveSubject</span><span class="hl-1">.</span><span class="hl-0">next</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-4">exchangeName</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-4">backtest:</span><span class="hl-1"> </span><span class="hl-7">false</span><span class="hl-1">, </span><span class="hl-4">symbol</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_isDone</span><span class="hl-1"> = </span><span class="hl-7">true</span><span class="hl-1">;</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_isStopped</span><span class="hl-1"> = </span><span class="hl-7">true</span><span class="hl-1">;</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<p>Stop flow:</p>
<ol>
<li><strong>User calls</strong> <code>Live.stop()</code> or cancellation function</li>
<li><strong>Stop flag set:</strong> <code>strategyCoreService.stop(symbol, strategyName, false)</code> where <code>false</code> means &quot;don't force immediate stop&quot;</li>
<li><strong>Loop checks:</strong>
<ul>
<li>If idle: breaks immediately</li>
<li>If active: continues monitoring until closed</li>
</ul>
</li>
<li><strong>Position closes:</strong> Loop breaks after <code>action === &quot;closed&quot;</code> and <code>getStopped()</code> returns true</li>
<li><strong>Done event:</strong> Emits <code>doneLiveSubject</code> only when no pending signal</li>
</ol>
<p>This prevents orphaned positions by waiting for natural close (TP/SL/time).</p>
<a id="state-management-and-persistence-lifecycle" class="tsd-anchor"></a><h3 class="tsd-anchor-link">State Management and Persistence Lifecycle<a href="#state-management-and-persistence-lifecycle" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16-execution-modes-detailed_4.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Live Mode Crash Recovery Lifecycle</strong></p>
<p>The persistence layer ensures:</p>
<ul>
<li><strong>Atomic writes:</strong> No corrupted state files</li>
<li><strong>Singleshot initialization:</strong> <code>waitForInit()</code> called once per instance</li>
<li><strong>Stateless process:</strong> All state in JSON files, not in-memory</li>
<li><strong>Crash recovery:</strong> Process can restart anytime and resume monitoring</li>
</ul>
<hr>
<a id="walker-mode" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Walker Mode<a href="#walker-mode" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="architecture-overview-2" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Architecture Overview<a href="#architecture-overview-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/16-execution-modes-detailed_5.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Walker Mode Architecture with Sequential Backtest Delegation</strong></p>
<a id="public-api-entry-points-2" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Public API Entry Points<a href="#public-api-entry-points-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>Walker</code> singleton orchestrates strategy comparison:</p>
<pre><code class="typescript"><span class="hl-5">// From Walker.ts</span><br/><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">context</span><span class="hl-1">: {</span><br/><span class="hl-1">  </span><span class="hl-4">walkerName:</span><span class="hl-1"> </span><span class="hl-4">string</span><br/><span class="hl-1">}) -&gt; </span><span class="hl-4">AsyncGenerator</span><span class="hl-1">&lt;</span><span class="hl-4">WalkerContract</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">context</span><span class="hl-1">) -&gt; </span><span class="hl-4">CancellationFunction</span><br/><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">stop</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">walkerName</span><span class="hl-1">) -&gt; </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;</span><br/><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">walkerName</span><span class="hl-1">) -&gt; </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">WalkerData</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p>Configuration is pulled from <code>WalkerSchemaService</code>:</p>
<pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">IWalkerSchema</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">walkerName</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">strategies</span><span class="hl-1">: </span><span class="hl-13">StrategyName</span><span class="hl-1">[];  </span><span class="hl-5">// List of strategies to compare</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">frameName</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">metric</span><span class="hl-1">?: </span><span class="hl-13">WalkerMetric</span><span class="hl-1">;  </span><span class="hl-5">// Default: &quot;sharpeRatio&quot;</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks</span><span class="hl-1">?: {</span><br/><span class="hl-1">    </span><span class="hl-0">onStrategyStart</span><span class="hl-1">?: (</span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">void</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">onStrategyComplete</span><span class="hl-1">?: (</span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">stats</span><span class="hl-1">, </span><span class="hl-4">metricValue</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-13">void</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">    </span><span class="hl-0">onStrategyError</span><span class="hl-1">?: (</span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">error</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">void</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">onComplete</span><span class="hl-1">?: (</span><span class="hl-4">finalResults</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">void</span><span class="hl-1">;</span><br/><span class="hl-1">  };</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="sequential-backtest-execution" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Sequential Backtest Execution<a href="#sequential-backtest-execution" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Walker mode runs one backtest per strategy sequentially:</p>
<p><img src="../media/16-execution-modes-detailed_6.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Walker Sequential Execution Flow</strong></p>
<a id="walkerlogicprivateservice-implementation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">WalkerLogicPrivateService Implementation<a href="#walkerlogicprivateservice-implementation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The core logic runs backtests sequentially and compares results:</p>
<pre><code class="typescript"><span class="hl-5">// From WalkerLogicPrivateService.ts:68-259</span><br/><span class="hl-4">public</span><span class="hl-1"> </span><span class="hl-4">async</span><span class="hl-1"> *</span><span class="hl-0">run</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">strategies</span><span class="hl-1">: </span><span class="hl-4">StrategyName</span><span class="hl-1">[],</span><br/><span class="hl-1">  </span><span class="hl-4">metric</span><span class="hl-1">: </span><span class="hl-4">WalkerMetric</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">context</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">walkerName:</span><span class="hl-1"> </span><span class="hl-4">string</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">): </span><span class="hl-4">AsyncGenerator</span><span class="hl-1">&lt;</span><span class="hl-4">WalkerContract</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  let </span><span class="hl-4">strategiesTested</span><span class="hl-1"> = </span><span class="hl-6">0</span><span class="hl-1">;</span><br/><span class="hl-1">  let </span><span class="hl-4">bestMetric:</span><span class="hl-1"> </span><span class="hl-4">number</span><span class="hl-1"> | </span><span class="hl-7">null</span><span class="hl-1"> = </span><span class="hl-7">null</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-4">bestStrategy</span><span class="hl-1">: </span><span class="hl-4">StrategyName</span><span class="hl-1"> | </span><span class="hl-7">null</span><span class="hl-1"> = </span><span class="hl-7">null</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Track stopped strategies</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-4">stoppedStrategies</span><span class="hl-1"> = </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Set</span><span class="hl-1">&lt;</span><span class="hl-13">StrategyName</span><span class="hl-1">&gt;();</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Subscribe to stop signals (filtered by symbol AND walkerName)</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-4">unsubscribe</span><span class="hl-1"> = </span><span class="hl-4">walkerStopSubject</span><br/><span class="hl-1">    .</span><span class="hl-0">filter</span><span class="hl-1">((</span><span class="hl-4">data</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1"> === </span><span class="hl-4">symbol</span><span class="hl-1"> &amp;&amp; </span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">walkerName</span><span class="hl-1"> === </span><span class="hl-4">context</span><span class="hl-1">.</span><span class="hl-4">walkerName</span><span class="hl-1">)</span><br/><span class="hl-1">    .</span><span class="hl-0">connect</span><span class="hl-1">((</span><span class="hl-4">data</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">stoppedStrategies</span><span class="hl-1">.</span><span class="hl-0">add</span><span class="hl-1">(</span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-4">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// Sequential backtest for each strategy</span><br/><span class="hl-1">    </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-4">strategyName</span><span class="hl-1"> </span><span class="hl-4">of</span><span class="hl-1"> </span><span class="hl-4">strategies</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">// Check if stopped</span><br/><span class="hl-1">      </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">stoppedStrategies</span><span class="hl-1">.</span><span class="hl-0">has</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">)) {</span><br/><span class="hl-1">        </span><span class="hl-3">break</span><span class="hl-1">;</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><br/><span class="hl-1">      </span><span class="hl-5">// Run backtest</span><br/><span class="hl-1">      </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">iterator</span><span class="hl-1"> = </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">backtestLogicPublicService</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, {</span><br/><span class="hl-1">        </span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">exchangeName</span><span class="hl-1">, </span><span class="hl-4">frameName</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><br/><span class="hl-1">      </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">resolveDocuments</span><span class="hl-1">(</span><span class="hl-4">iterator</span><span class="hl-1">);  </span><span class="hl-5">// Consume all results</span><br/><span class="hl-1">      </span><br/><span class="hl-1">      </span><span class="hl-5">// Get statistics</span><br/><span class="hl-1">      </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">stats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">backtestMarkdownService</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><br/><span class="hl-1">      </span><span class="hl-5">// Extract metric value</span><br/><span class="hl-1">      </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">value</span><span class="hl-1"> = </span><span class="hl-4">stats</span><span class="hl-1">[</span><span class="hl-4">metric</span><span class="hl-1">];</span><br/><span class="hl-1">      </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-0">metricValue</span><span class="hl-1"> = (</span><br/><span class="hl-1">        </span><span class="hl-4">value</span><span class="hl-1"> !== </span><span class="hl-7">null</span><span class="hl-1"> &amp;&amp; </span><br/><span class="hl-1">        </span><span class="hl-4">value</span><span class="hl-1"> !== </span><span class="hl-7">undefined</span><span class="hl-1"> &amp;&amp; </span><br/><span class="hl-1">        </span><span class="hl-7">typeof</span><span class="hl-1"> </span><span class="hl-4">value</span><span class="hl-1"> === </span><span class="hl-2">&quot;number&quot;</span><span class="hl-1"> &amp;&amp;</span><br/><span class="hl-1">        !</span><span class="hl-0">isNaN</span><span class="hl-1">(</span><span class="hl-4">value</span><span class="hl-1">) &amp;&amp;</span><br/><span class="hl-1">        </span><span class="hl-0">isFinite</span><span class="hl-1">(</span><span class="hl-4">value</span><span class="hl-1">)</span><br/><span class="hl-1">      ) ? </span><span class="hl-4">value</span><span class="hl-1"> : </span><span class="hl-7">null</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><br/><span class="hl-1">      </span><span class="hl-5">// Update best if better</span><br/><span class="hl-1">      </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">bestMetric</span><span class="hl-1"> === </span><span class="hl-7">null</span><span class="hl-1"> || (</span><span class="hl-4">metricValue</span><span class="hl-1"> !== </span><span class="hl-7">null</span><span class="hl-1"> &amp;&amp; </span><span class="hl-4">metricValue</span><span class="hl-1"> &gt; </span><span class="hl-4">bestMetric</span><span class="hl-1">)) {</span><br/><span class="hl-1">        </span><span class="hl-4">bestMetric</span><span class="hl-1"> = </span><span class="hl-4">metricValue</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">bestStrategy</span><span class="hl-1"> = </span><span class="hl-4">strategyName</span><span class="hl-1">;</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><br/><span class="hl-1">      </span><span class="hl-4">strategiesTested</span><span class="hl-1">++;</span><br/><span class="hl-1">      </span><br/><span class="hl-1">      </span><span class="hl-5">// Create progress contract</span><br/><span class="hl-1">      </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">walkerContract</span><span class="hl-1">: </span><span class="hl-13">WalkerContract</span><span class="hl-1"> = {</span><br/><span class="hl-1">        </span><span class="hl-4">walkerName</span><span class="hl-1">, </span><span class="hl-4">exchangeName</span><span class="hl-1">, </span><span class="hl-4">frameName</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">stats</span><span class="hl-1">, </span><span class="hl-4">metricValue</span><span class="hl-1">, </span><span class="hl-4">metric</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">bestMetric</span><span class="hl-1">, </span><span class="hl-4">bestStrategy</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">strategiesTested</span><span class="hl-1">, </span><span class="hl-4">totalStrategies:</span><span class="hl-1"> </span><span class="hl-4">strategies</span><span class="hl-1">.</span><span class="hl-4">length</span><br/><span class="hl-1">      };</span><br/><span class="hl-1">      </span><br/><span class="hl-1">      </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">walkerEmitter</span><span class="hl-1">.</span><span class="hl-0">next</span><span class="hl-1">(</span><span class="hl-4">walkerContract</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-3">yield</span><span class="hl-1"> </span><span class="hl-4">walkerContract</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  } </span><span class="hl-4">finally</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">unsubscribe</span><span class="hl-1">();  </span><span class="hl-5">// Clean up subscription</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Emit final results</span><br/><span class="hl-1">  </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">walkerCompleteSubject</span><span class="hl-1">.</span><span class="hl-0">next</span><span class="hl-1">({ </span><span class="hl-4">bestStrategy</span><span class="hl-1">, </span><span class="hl-4">bestMetric</span><span class="hl-1">, ... });</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="metric-evaluation-system" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Metric Evaluation System<a href="#metric-evaluation-system" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Walker supports multiple comparison metrics:</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Type</th>
<th>Formula</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sharpeRatio</code></td>
<td>Risk-adjusted return</td>
<td><code>avgPnl / stdDev</code></td>
<td>Higher is better - reward per unit risk</td>
</tr>
<tr>
<td><code>annualizedSharpeRatio</code></td>
<td>Annualized risk-adj.</td>
<td><code>sharpeRatio  365</code></td>
<td>Higher is better - yearly normalized</td>
</tr>
<tr>
<td><code>winRate</code></td>
<td>Win probability</td>
<td><code>winCount / totalSignals  100</code></td>
<td>Higher is better - % winning trades</td>
</tr>
<tr>
<td><code>avgPnl</code></td>
<td>Average return</td>
<td><code>sum(pnl) / count</code></td>
<td>Higher is better - expected profit per trade</td>
</tr>
<tr>
<td><code>totalPnl</code></td>
<td>Cumulative return</td>
<td><code>sum(pnl)</code></td>
<td>Higher is better - total profit</td>
</tr>
<tr>
<td><code>certaintyRatio</code></td>
<td>Win/loss ratio</td>
<td>`avgWin /</td>
<td>avgLoss</td>
</tr>
<tr>
<td><code>expectedYearlyReturns</code></td>
<td>Annualized profit</td>
<td>Based on avg duration</td>
<td>Higher is better - yearly expected gain</td>
</tr>
</tbody>
</table>
<p>Metric comparison logic:</p>
<pre><code class="typescript"><span class="hl-5">// From WalkerLogicPrivateService.ts:182-190</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">isBetter</span><span class="hl-1"> = </span><br/><span class="hl-1">  </span><span class="hl-4">bestMetric</span><span class="hl-1"> === </span><span class="hl-7">null</span><span class="hl-1"> ||</span><br/><span class="hl-1">  (</span><span class="hl-4">metricValue</span><span class="hl-1"> !== </span><span class="hl-7">null</span><span class="hl-1"> &amp;&amp; </span><span class="hl-4">metricValue</span><span class="hl-1"> &gt; </span><span class="hl-4">bestMetric</span><span class="hl-1">);</span><br/><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">isBetter</span><span class="hl-1"> &amp;&amp; </span><span class="hl-4">metricValue</span><span class="hl-1"> !== </span><span class="hl-7">null</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">bestMetric</span><span class="hl-1"> = </span><span class="hl-4">metricValue</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">bestStrategy</span><span class="hl-1"> = </span><span class="hl-4">strategyName</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>All metrics follow &quot;higher is better&quot; convention (including <code>stdDev</code> as inverse in Sharpe).</p>
<a id="stop-signal-system-and-multiple-walkers" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Stop Signal System and Multiple Walkers<a href="#stop-signal-system-and-multiple-walkers" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Walker mode supports concurrent walker instances on the same symbol through filtered stop signals:</p>
<pre><code class="typescript"><span class="hl-5">// From WalkerLogicPrivateService.ts:98-111</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">unsubscribe</span><span class="hl-1"> = </span><span class="hl-4">walkerStopSubject</span><br/><span class="hl-1">  .</span><span class="hl-0">filter</span><span class="hl-1">((</span><span class="hl-4">data</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><br/><span class="hl-1">    </span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1"> === </span><span class="hl-4">symbol</span><span class="hl-1"> &amp;&amp; </span><br/><span class="hl-1">    </span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">walkerName</span><span class="hl-1"> === </span><span class="hl-4">context</span><span class="hl-1">.</span><span class="hl-4">walkerName</span><span class="hl-1">  </span><span class="hl-5">// Filter by walker name</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">  .</span><span class="hl-0">connect</span><span class="hl-1">((</span><span class="hl-4">data</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">stoppedStrategies</span><span class="hl-1">.</span><span class="hl-0">add</span><span class="hl-1">(</span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">loggerService</span><span class="hl-1">.</span><span class="hl-0">info</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-2">&quot;walkerLogicPrivateService received stop signal for strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      { </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">walkerName</span><span class="hl-1">, </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1"> }</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">  });</span>
</code><button type="button">Copy</button></pre>

<p>Stop flow:</p>
<ol>
<li><strong>User calls</strong> <code>Walker.stop(symbol, walkerName)</code></li>
<li><strong>Iterate strategies:</strong> For each strategy in walker schema</li>
<li><strong>Emit stop signal:</strong> <code>walkerStopSubject.next({ symbol, strategyName, walkerName })</code></li>
<li><strong>Set internal flag:</strong> <code>strategyCoreService.stop({ symbol, strategyName }, true)</code></li>
<li><strong>Filter in loop:</strong> <code>WalkerLogicPrivateService</code> checks <code>stoppedStrategies.has()</code></li>
<li><strong>Break loop:</strong> Current strategy finishes, next is skipped</li>
</ol>
<p>The <code>walkerName</code> filter enables multiple walker instances on the same symbol without interference.</p>
<a id="lifecycle-callbacks" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Lifecycle Callbacks<a href="#lifecycle-callbacks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Walker schema supports callback hooks for progress monitoring:</p>
<pre><code class="typescript"><span class="hl-10">callbacks</span><span class="hl-1">: {</span><br/><span class="hl-1">  </span><span class="hl-5">// Called before each strategy backtest</span><br/><span class="hl-1">  </span><span class="hl-0">onStrategyStart</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-7">void</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Called after each strategy completes successfully</span><br/><span class="hl-1">  </span><span class="hl-0">onStrategyComplete</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><br/><span class="hl-1">    </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><br/><span class="hl-1">    </span><span class="hl-4">stats</span><span class="hl-1">: </span><span class="hl-4">BacktestStatistics</span><span class="hl-1">, </span><br/><span class="hl-1">    </span><span class="hl-4">metricValue</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1"> | </span><span class="hl-7">null</span><br/><span class="hl-1">  ): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Called if strategy backtest fails</span><br/><span class="hl-1">  </span><span class="hl-0">onStrategyError</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><br/><span class="hl-1">    </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><br/><span class="hl-1">    </span><span class="hl-4">error</span><span class="hl-1">: </span><span class="hl-4">Error</span><br/><span class="hl-1">  ): </span><span class="hl-7">void</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Called once at end with final best results</span><br/><span class="hl-1">  </span><span class="hl-0">onComplete</span><span class="hl-1">(</span><span class="hl-4">finalResults</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-4">walkerName</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">exchangeName</span><span class="hl-1">, </span><span class="hl-4">frameName</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">metric</span><span class="hl-1">, </span><span class="hl-4">totalStrategies</span><span class="hl-1">, </span><span class="hl-4">bestStrategy</span><span class="hl-1">, </span><span class="hl-4">bestMetric</span><span class="hl-1">, </span><span class="hl-4">bestStats</span><br/><span class="hl-1">  }): </span><span class="hl-7">void</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Callback execution points:</p>
<pre><code class="typescript"><span class="hl-5">// From WalkerLogicPrivateService.ts:129-160</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">walkerSchema</span><span class="hl-1">.</span><span class="hl-4">callbacks</span><span class="hl-1">?.</span><span class="hl-4">onStrategyStart</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">walkerSchema</span><span class="hl-1">.</span><span class="hl-4">callbacks</span><span class="hl-1">.</span><span class="hl-0">onStrategyStart</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// ... run backtest ...</span><br/><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">walkerSchema</span><span class="hl-1">.</span><span class="hl-4">callbacks</span><span class="hl-1">?.</span><span class="hl-4">onStrategyComplete</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">walkerSchema</span><span class="hl-1">.</span><span class="hl-4">callbacks</span><span class="hl-1">.</span><span class="hl-0">onStrategyComplete</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">stats</span><span class="hl-1">, </span><span class="hl-4">metricValue</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="optimizer-mode" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Optimizer Mode<a href="#optimizer-mode" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="architecture-overview-3" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Architecture Overview<a href="#architecture-overview-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Optimizer mode is distinct from the other execution modes - it does not execute strategies but generates them using LLM technology. The architecture is documented in the high-level diagrams but implementation files are not included in the provided sources.</p>
<p><img src="../media/16-execution-modes-detailed_7.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Optimizer Mode Architecture (High-Level)</strong></p>
<p>Based on the provided diagrams, the Optimizer mode follows this pattern:</p>
<ol>
<li><strong>Data Source Iteration:</strong> Fetches historical data at multiple timeframes (1h, 30m, 15m, 1m)</li>
<li><strong>Data Formatting:</strong> Converts candles to markdown tables for LLM consumption</li>
<li><strong>Prompt Construction:</strong> Calls user-provided <code>getPrompt()</code> callback with formatted data</li>
<li><strong>LLM Generation:</strong> Sends prompt to Ollama API with deepseek model</li>
<li><strong>Template Merging:</strong> Combines generated strategy logic with framework boilerplate</li>
<li><strong>Code Export:</strong> Outputs executable <code>.mjs</code> file with complete strategy</li>
</ol>
<p>(Diagram 2 section on Optimizer)</p>
<a id="key-differences-from-other-modes" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Key Differences from Other Modes<a href="#key-differences-from-other-modes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Aspect</th>
<th>Backtest/Live/Walker</th>
<th>Optimizer</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Purpose</strong></td>
<td>Execute strategies</td>
<td>Generate strategies</td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td>Signal results</td>
<td>Source code</td>
</tr>
<tr>
<td><strong>Execution</strong></td>
<td>Async generator loop</td>
<td>Single-shot code generation</td>
</tr>
<tr>
<td><strong>Data usage</strong></td>
<td>Real-time tick/candles</td>
<td>Historical multi-timeframe batch</td>
</tr>
<tr>
<td><strong>State</strong></td>
<td>Signal lifecycle</td>
<td>Stateless</td>
</tr>
<tr>
<td><strong>Duration</strong></td>
<td>Long-running</td>
<td>Completes after generation</td>
</tr>
</tbody>
</table>
<p>The Optimizer mode is not an execution mode in the traditional sense - it's a <strong>code generation tool</strong> that produces strategies which can then be executed via Backtest/Live/Walker modes.</p>
<p>(Diagram 1 and 2 sections)</p>
<hr>
<a id="execution-mode-comparison" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Execution Mode Comparison<a href="#execution-mode-comparison" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="feature-matrix" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Feature Matrix<a href="#feature-matrix" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Feature</th>
<th>Backtest</th>
<th>Live</th>
<th>Walker</th>
<th>Optimizer</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Loop Type</strong></td>
<td>Finite (timeframes)</td>
<td>Infinite (while true)</td>
<td>Sequential (strategies)</td>
<td>Single-shot</td>
</tr>
<tr>
<td><strong>Date Source</strong></td>
<td>Frame-generated</td>
<td><code>new Date()</code></td>
<td>Frame-delegated</td>
<td>Historical batch</td>
</tr>
<tr>
<td><strong>Persistence</strong></td>
<td>None</td>
<td>JSON atomic writes</td>
<td>None</td>
<td>File output</td>
</tr>
<tr>
<td><strong>Output Type</strong></td>
<td><code>IStrategyBacktestResult</code></td>
<td><code>IStrategyTickResultOpened|Closed</code></td>
<td><code>WalkerContract</code></td>
<td>Code string</td>
</tr>
<tr>
<td><strong>Crash Recovery</strong></td>
<td>Not needed</td>
<td><code>waitForInit()</code></td>
<td>Not needed</td>
<td>N/A</td>
</tr>
<tr>
<td><strong>Stop Behavior</strong></td>
<td>Graceful at idle/closed</td>
<td>Graceful at idle/closed</td>
<td>Filtered by walkerName</td>
<td>N/A</td>
</tr>
<tr>
<td><strong>Performance Optimization</strong></td>
<td>Skip-to-close</td>
<td>None (real-time)</td>
<td>Parallel not supported</td>
<td>Data fetching</td>
</tr>
<tr>
<td><strong>State Management</strong></td>
<td>Cleared on start</td>
<td>Persisted to disk</td>
<td>Cleared per strategy</td>
<td>Stateless</td>
</tr>
<tr>
<td><strong>Primary Use Case</strong></td>
<td>Historical validation</td>
<td>Production trading</td>
<td>Strategy comparison</td>
<td>Strategy generation</td>
</tr>
</tbody>
</table>
<p>(Data Flow sections)</p>
<a id="performance-characteristics" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Performance Characteristics<a href="#performance-characteristics" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Mode</th>
<th>Execution Speed</th>
<th>Memory Usage</th>
<th>Disk I/O</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Backtest</strong></td>
<td>Very fast (skip-to-close)</td>
<td>Low (streaming)</td>
<td>None</td>
</tr>
<tr>
<td><strong>Live</strong></td>
<td>Real-time (61s ticks)</td>
<td>Low (streaming)</td>
<td>Atomic writes per tick</td>
</tr>
<tr>
<td><strong>Walker</strong></td>
<td>Slow (sequential backtests)</td>
<td>Moderate (accumulated stats)</td>
<td>None</td>
</tr>
<tr>
<td><strong>Optimizer</strong></td>
<td>Depends on LLM latency</td>
<td>Moderate (multi-timeframe data)</td>
<td>File output</td>
</tr>
</tbody>
</table>
<a id="service-layer-dependencies" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Service Layer Dependencies<a href="#service-layer-dependencies" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>All modes share core services but use them differently:</p>
<p><img src="../media/16-execution-modes-detailed_8.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Execution Mode Service Dependencies</strong></p>
<hr>
<a id="summary" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Summary<a href="#summary" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The four execution modes provide complementary capabilities:</p>
<ul>
<li><strong>Backtest:</strong> Optimized historical validation with skip-to-close for fast signal processing</li>
<li><strong>Live:</strong> Crash-safe real-time trading with atomic persistence and graceful shutdown</li>
<li><strong>Walker:</strong> Sequential strategy comparison with metric-based ranking and progress callbacks</li>
<li><strong>Optimizer:</strong> LLM-powered strategy code generation using multi-timeframe historical data</li>
</ul>
<p>All modes leverage the same core service architecture (Strategy, Exchange, Frame) but implement distinct orchestration patterns via Logic services. The async generator pattern enables memory-efficient streaming, early termination, and consistent error handling across all execution modes.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#execution-modes-detailed"><span>Execution <wbr/>Modes (<wbr/>Detailed)</span></a><ul><li><a href="#purpose-and-scope"><span>Purpose and <wbr/>Scope</span></a></li><li><a href="#execution-mode-architecture"><span>Execution <wbr/>Mode <wbr/>Architecture</span></a></li><li><a href="#backtest-mode"><span>Backtest <wbr/>Mode</span></a></li><li><ul><li><a href="#architecture-overview"><span>Architecture <wbr/>Overview</span></a></li><li><a href="#public-api-entry-points"><span>Public API <wbr/>Entry <wbr/>Points</span></a></li><li><a href="#execution-flow"><span>Execution <wbr/>Flow</span></a></li><li><a href="#timeframe-iteration-and-skip-optimization"><span>Timeframe <wbr/>Iteration and <wbr/>Skip <wbr/>Optimization</span></a></li><li><a href="#backtestlogicprivateservice-implementation"><span>Backtest<wbr/>Logic<wbr/>Private<wbr/>Service <wbr/>Implementation</span></a></li><li><a href="#scheduled-signal-handling"><span>Scheduled <wbr/>Signal <wbr/>Handling</span></a></li><li><a href="#state-management-and-memory-efficiency"><span>State <wbr/>Management and <wbr/>Memory <wbr/>Efficiency</span></a></li></ul></li><li><a href="#live-trading-mode"><span>Live <wbr/>Trading <wbr/>Mode</span></a></li><li><ul><li><a href="#architecture-overview-1"><span>Architecture <wbr/>Overview</span></a></li><li><a href="#public-api-entry-points-1"><span>Public API <wbr/>Entry <wbr/>Points</span></a></li><li><a href="#execution-flow-1"><span>Execution <wbr/>Flow</span></a></li><li><a href="#infinite-loop-architecture"><span>Infinite <wbr/>Loop <wbr/>Architecture</span></a></li><li><a href="#crash-safe-persistence"><span>Crash-<wbr/>Safe <wbr/>Persistence</span></a></li><li><ul><li><a href="#write-path-persistence"><span>Write <wbr/>Path (<wbr/>Persistence)</span></a></li><li><a href="#read-path-recovery"><span>Read <wbr/>Path (<wbr/>Recovery)</span></a></li></ul></li><li><a href="#graceful-shutdown"><span>Graceful <wbr/>Shutdown</span></a></li><li><a href="#state-management-and-persistence-lifecycle"><span>State <wbr/>Management and <wbr/>Persistence <wbr/>Lifecycle</span></a></li></ul></li><li><a href="#walker-mode"><span>Walker <wbr/>Mode</span></a></li><li><ul><li><a href="#architecture-overview-2"><span>Architecture <wbr/>Overview</span></a></li><li><a href="#public-api-entry-points-2"><span>Public API <wbr/>Entry <wbr/>Points</span></a></li><li><a href="#sequential-backtest-execution"><span>Sequential <wbr/>Backtest <wbr/>Execution</span></a></li><li><a href="#walkerlogicprivateservice-implementation"><span>Walker<wbr/>Logic<wbr/>Private<wbr/>Service <wbr/>Implementation</span></a></li><li><a href="#metric-evaluation-system"><span>Metric <wbr/>Evaluation <wbr/>System</span></a></li><li><a href="#stop-signal-system-and-multiple-walkers"><span>Stop <wbr/>Signal <wbr/>System and <wbr/>Multiple <wbr/>Walkers</span></a></li><li><a href="#lifecycle-callbacks"><span>Lifecycle <wbr/>Callbacks</span></a></li></ul></li><li><a href="#optimizer-mode"><span>Optimizer <wbr/>Mode</span></a></li><li><ul><li><a href="#architecture-overview-3"><span>Architecture <wbr/>Overview</span></a></li><li><a href="#key-differences-from-other-modes"><span>Key <wbr/>Differences from <wbr/>Other <wbr/>Modes</span></a></li></ul></li><li><a href="#execution-mode-comparison"><span>Execution <wbr/>Mode <wbr/>Comparison</span></a></li><li><ul><li><a href="#feature-matrix"><span>Feature <wbr/>Matrix</span></a></li><li><a href="#performance-characteristics"><span>Performance <wbr/>Characteristics</span></a></li><li><a href="#service-layer-dependencies"><span>Service <wbr/>Layer <wbr/>Dependencies</span></a></li></ul></li><li><a href="#summary"><span>Summary</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
