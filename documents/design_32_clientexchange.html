<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/32_clientexchange | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_32_clientexchange.html">design/32_clientexchange</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="clientexchange" class="tsd-anchor"></a><h1 class="tsd-anchor-link">ClientExchange<a href="#clientexchange" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p><code>ClientExchange</code> is a client class that implements market data fetching, VWAP calculation, and price/quantity formatting logic for exchange operations. It provides context-aware access to historical and real-time candle data, abstracting the underlying data source (API, database, etc.) defined in <code>IExchangeSchema</code>.</p>
<p>For strategy-level market data access, see <a href="design_21_exchange_functions.html">Exchange Functions</a>. For schema registration, see <a href="design_25_exchange_schemas.html">Exchange Schemas</a>. For the connection service that instantiates ClientExchange, see <a href="design_38_connection_services.html">Connection Services</a>.</p>
<hr>
<a id="overview" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Overview<a href="#overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>ClientExchange</code> serves as the business logic layer for exchange operations, bridging the gap between user-defined data sources (<code>IExchangeSchema.getCandles</code>) and framework requirements (VWAP calculation, timestamp-aware fetching, precision formatting). It implements the <code>IExchange</code> interface and operates without direct dependency injection, receiving all dependencies through its constructor parameters.</p>
<p><strong>Key Responsibilities:</strong></p>
<table>
<thead>
<tr>
<th>Responsibility</th>
<th>Methods</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Historical data fetching</td>
<td><code>getCandles()</code></td>
<td>Fetch candles backwards from execution context time</td>
</tr>
<tr>
<td>Future data fetching</td>
<td><code>getNextCandles()</code></td>
<td>Fetch candles forward from execution context time (backtest only)</td>
</tr>
<tr>
<td>VWAP calculation</td>
<td><code>getAveragePrice()</code></td>
<td>Calculate volume-weighted average price from recent candles</td>
</tr>
<tr>
<td>Price formatting</td>
<td><code>formatPrice()</code></td>
<td>Apply exchange-specific price precision rules</td>
</tr>
<tr>
<td>Quantity formatting</td>
<td><code>formatQuantity()</code></td>
<td>Apply exchange-specific quantity precision rules</td>
</tr>
<tr>
<td>Lifecycle events</td>
<td>Callbacks</td>
<td>Trigger <code>onCandleData</code> when data is fetched</td>
</tr>
</tbody>
</table>
<hr>
<a id="constructor-and-parameters" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Constructor and Parameters<a href="#constructor-and-parameters" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>ClientExchange</code> is instantiated by <code>ExchangeConnectionService</code> with parameters combining the user-defined schema and runtime dependencies.</p>
<a id="iexchangeparams-structure" class="tsd-anchor"></a><h3 class="tsd-anchor-link">IExchangeParams Structure<a href="#iexchangeparams-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-10">IExchangeParams</span><span class="hl-1"> </span><span class="hl-6">extends</span><span class="hl-1"> </span><span class="hl-10">IExchangeSchema</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">logger</span><span class="hl-1">: </span><span class="hl-10">ILogger</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">execution</span><span class="hl-1">: </span><span class="hl-10">TExecutionContextService</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Parameter Details:</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Source</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>exchangeName</code></td>
<td><code>ExchangeName</code></td>
<td>Schema</td>
<td>Unique exchange identifier</td>
</tr>
<tr>
<td><code>getCandles</code></td>
<td>Function</td>
<td>Schema</td>
<td>User-defined candle fetching logic</td>
</tr>
<tr>
<td><code>formatPrice</code></td>
<td>Function</td>
<td>Schema</td>
<td>User-defined price formatting logic</td>
</tr>
<tr>
<td><code>formatQuantity</code></td>
<td>Function</td>
<td>Schema</td>
<td>User-defined quantity formatting logic</td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td>Optional</td>
<td>Schema</td>
<td>Lifecycle event handlers</td>
</tr>
<tr>
<td><code>logger</code></td>
<td><code>ILogger</code></td>
<td>Injected</td>
<td>Debug logging service</td>
</tr>
<tr>
<td><code>execution</code></td>
<td><code>TExecutionContextService</code></td>
<td>Injected</td>
<td>Execution context (symbol, when, backtest flag)</td>
</tr>
</tbody>
</table>
<p>The <code>execution</code> parameter provides implicit context propagation using <code>di-scoped</code>, allowing <code>ClientExchange</code> to access the current timestamp (<code>when</code>) and backtest flag without explicit parameters.</p>
<hr>
<a id="architecture-diagram" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Architecture Diagram<a href="#architecture-diagram" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/32_ClientExchange_0.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: ClientExchange Position in Architecture</strong></p>
<hr>
<a id="market-data-fetching" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Market Data Fetching<a href="#market-data-fetching" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="getcandles---historical-data" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getCandles() - Historical Data<a href="#getcandles---historical-data" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Fetches historical candle data <strong>backwards</strong> from the execution context timestamp. The <code>since</code> parameter is automatically calculated based on <code>execution.when</code> and the requested limit.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-0">getCandles</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-4">CandleInterval</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">ICandleData</span><span class="hl-1">[]&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Behavior:</strong></p>
<ol>
<li>Retrieves <code>execution.when</code> from injected context</li>
<li>Calculates <code>since</code> timestamp: <code>when - (interval × limit)</code></li>
<li>Calls user-defined <code>IExchangeSchema.getCandles(symbol, interval, since, limit)</code></li>
<li>Triggers <code>callbacks.onCandleData</code> if defined</li>
<li>Returns array of <code>ICandleData</code> objects sorted chronologically</li>
</ol>
<p><strong>Timestamp Calculation Example:</strong></p>
<table>
<thead>
<tr>
<th>Execution Time</th>
<th>Interval</th>
<th>Limit</th>
<th>Since Timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-01-15 12:00:00</td>
<td>1m</td>
<td>100</td>
<td>2024-01-15 10:20:00</td>
</tr>
<tr>
<td>2024-01-15 12:00:00</td>
<td>1h</td>
<td>24</td>
<td>2024-01-14 12:00:00</td>
</tr>
<tr>
<td>2024-01-15 12:00:00</td>
<td>1d</td>
<td>30</td>
<td>2023-12-16 12:00:00</td>
</tr>
</tbody>
</table>
<a id="getnextcandles---future-data-backtest-only" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getNextCandles() - Future Data (Backtest Only)<a href="#getnextcandles---future-data-backtest-only" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Fetches candle data <strong>forwards</strong> from the execution context timestamp. Used exclusively in backtest mode for fast-forward simulation.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-0">getNextCandles</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-4">CandleInterval</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">ICandleData</span><span class="hl-1">[]&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Behavior:</strong></p>
<ol>
<li>Retrieves <code>execution.when</code> from injected context</li>
<li>Uses <code>when</code> as <code>since</code> timestamp (start from current time)</li>
<li>Calls user-defined <code>IExchangeSchema.getCandles(symbol, interval, since, limit)</code></li>
<li>Returns future candles for TP/SL detection</li>
<li>Only used by <code>ClientStrategy.backtest()</code> method</li>
</ol>
<p><strong>Usage Context:</strong></p>
<ul>
<li><strong>Backtest mode</strong>: Fetches future candles to simulate position monitoring</li>
<li><strong>Live mode</strong>: Never called (live trading uses real-time progression)</li>
</ul>
<hr>
<a id="market-data-flow-diagram" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Market Data Flow Diagram<a href="#market-data-flow-diagram" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/32_ClientExchange_1.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Market Data Fetching Flow</strong></p>
<hr>
<a id="vwap-calculation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">VWAP Calculation<a href="#vwap-calculation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>getAveragePrice()</code> calculates the Volume-Weighted Average Price (VWAP) using the last N 1-minute candles, where N is defined by <code>CC_AVG_PRICE_CANDLES_COUNT</code> (default: 5).</p>
<a id="vwap-formula" class="tsd-anchor"></a><h3 class="tsd-anchor-link">VWAP Formula<a href="#vwap-formula" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>VWAP = Σ(Typical Price × Volume) / Σ(Volume)</strong></p>
<p>Where <strong>Typical Price = (High + Low + Close) / 3</strong></p>
<a id="implementation-flow" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Implementation Flow<a href="#implementation-flow" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/32_ClientExchange_2.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: VWAP Calculation Algorithm</strong></p>
<a id="usage-context" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Usage Context<a href="#usage-context" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Context</th>
<th>Purpose</th>
<th>Frequency</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Signal Generation</strong></td>
<td>Current price for signal validation</td>
<td>Every <code>tick()</code> call</td>
</tr>
<tr>
<td><strong>TP/SL Monitoring</strong></td>
<td>Current price for take profit / stop loss checks</td>
<td>Every <code>tick()</code> call</td>
</tr>
<tr>
<td><strong>Live Trading</strong></td>
<td>Real-time price updates</td>
<td>Continuous during active positions</td>
</tr>
<tr>
<td><strong>Backtesting</strong></td>
<td>Historical price at each timestamp</td>
<td>Per timeframe iteration</td>
</tr>
</tbody>
</table>
<a id="configuration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Configuration<a href="#configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The number of candles used for VWAP is configurable via global configuration:</p>
<pre><code class="typescript"><span class="hl-0">setConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">CC_AVG_PRICE_CANDLES_COUNT:</span><span class="hl-1"> </span><span class="hl-8">5</span><span class="hl-1">  </span><span class="hl-5">// Default: 5 candles (5 minutes)</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="price-and-quantity-formatting" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Price and Quantity Formatting<a href="#price-and-quantity-formatting" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>ClientExchange</code> delegates to user-defined formatting functions to ensure values comply with exchange-specific precision rules.</p>
<a id="formatprice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">formatPrice()<a href="#formatprice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-0">formatPrice</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Behavior:</strong></p>
<ol>
<li>Receives raw price value (e.g., <code>45123.456789</code>)</li>
<li>Calls <code>IExchangeSchema.formatPrice(symbol, price)</code></li>
<li>Returns formatted string matching exchange precision (e.g., <code>&quot;45123.45&quot;</code>)</li>
</ol>
<p><strong>Common Precision Rules:</strong></p>
<table>
<thead>
<tr>
<th>Exchange Type</th>
<th>Example Input</th>
<th>Example Output</th>
<th>Precision</th>
</tr>
</thead>
<tbody>
<tr>
<td>Crypto (USDT pairs)</td>
<td>45123.456789</td>
<td>&quot;45123.45&quot;</td>
<td>2 decimals</td>
</tr>
<tr>
<td>Crypto (BTC pairs)</td>
<td>0.0012345678</td>
<td>&quot;0.00123456&quot;</td>
<td>8 decimals</td>
</tr>
<tr>
<td>Forex</td>
<td>1.23456789</td>
<td>&quot;1.23456&quot;</td>
<td>5 decimals</td>
</tr>
<tr>
<td>Stocks</td>
<td>123.456789</td>
<td>&quot;123.46&quot;</td>
<td>2 decimals</td>
</tr>
</tbody>
</table>
<a id="formatquantity" class="tsd-anchor"></a><h3 class="tsd-anchor-link">formatQuantity()<a href="#formatquantity" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-0">formatQuantity</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Behavior:</strong></p>
<ol>
<li>Receives raw quantity value (e.g., <code>0.123456789</code>)</li>
<li>Calls <code>IExchangeSchema.formatQuantity(symbol, quantity)</code></li>
<li>Returns formatted string matching exchange lot size (e.g., <code>&quot;0.123&quot;</code>)</li>
</ol>
<p><strong>Common Lot Size Rules:</strong></p>
<table>
<thead>
<tr>
<th>Exchange Type</th>
<th>Example Input</th>
<th>Example Output</th>
<th>Lot Size</th>
</tr>
</thead>
<tbody>
<tr>
<td>Crypto (BTC)</td>
<td>0.123456789</td>
<td>&quot;0.123456&quot;</td>
<td>0.000001 BTC</td>
</tr>
<tr>
<td>Crypto (ETH)</td>
<td>1.23456789</td>
<td>&quot;1.2345&quot;</td>
<td>0.0001 ETH</td>
</tr>
<tr>
<td>Stocks</td>
<td>123.456</td>
<td>&quot;123&quot;</td>
<td>1 share</td>
</tr>
<tr>
<td>Forex</td>
<td>1000.567</td>
<td>&quot;1000&quot;</td>
<td>1 unit</td>
</tr>
</tbody>
</table>
<hr>
<a id="context-aware-behavior" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Context-Aware Behavior<a href="#context-aware-behavior" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>ClientExchange</code> uses <code>ExecutionContextService</code> to provide timestamp-aware and mode-aware operations without requiring explicit context parameters.</p>
<a id="context-propagation-pattern" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Context Propagation Pattern<a href="#context-propagation-pattern" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/32_ClientExchange_3.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Context Propagation to ClientExchange</strong></p>
<a id="context-fields" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Context Fields<a href="#context-fields" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Source</th>
<th>Usage in ClientExchange</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>symbol</code></td>
<td><code>string</code></td>
<td>ExecutionContext</td>
<td>Passed to all exchange methods</td>
</tr>
<tr>
<td><code>when</code></td>
<td><code>Date</code></td>
<td>ExecutionContext</td>
<td>Used to calculate <code>since</code> timestamp for <code>getCandles()</code></td>
</tr>
<tr>
<td><code>backtest</code></td>
<td><code>boolean</code></td>
<td>ExecutionContext</td>
<td>Determines if <code>getNextCandles()</code> is available</td>
</tr>
</tbody>
</table>
<a id="backtest-vs-live-mode" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Backtest vs Live Mode<a href="#backtest-vs-live-mode" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Backtest Mode (<code>backtest: true</code>):</strong></p>
<ul>
<li><code>execution.when</code> iterates through historical timestamps (e.g., 2024-01-01 00:00, 00:01, 00:02...)</li>
<li><code>getCandles()</code> fetches historical data before each timestamp</li>
<li><code>getNextCandles()</code> fetches future candles for fast-forward simulation</li>
<li>VWAP calculation uses historical candles at specific timestamp</li>
</ul>
<p><strong>Live Mode (<code>backtest: false</code>):</strong></p>
<ul>
<li><code>execution.when</code> always equals <code>Date.now()</code> (current time)</li>
<li><code>getCandles()</code> fetches recent historical data (last N candles)</li>
<li><code>getNextCandles()</code> never called (live progression uses real-time monitoring)</li>
<li>VWAP calculation uses most recent candles from exchange</li>
</ul>
<hr>
<a id="callbacks-and-events" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Callbacks and Events<a href="#callbacks-and-events" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>IExchangeCallbacks</code> defines optional lifecycle event handlers triggered during exchange operations.</p>
<a id="available-callbacks" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Available Callbacks<a href="#available-callbacks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>onCandleData</strong></p>
<p>Triggered after successful candle data fetch via <code>getCandles()</code> or <code>getNextCandles()</code>.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-12">onCandleData</span><span class="hl-1">: (</span><br/><span class="hl-1">    </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><br/><span class="hl-1">    </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-4">CandleInterval</span><span class="hl-1">, </span><br/><span class="hl-1">    </span><span class="hl-4">since</span><span class="hl-1">: </span><span class="hl-4">Date</span><span class="hl-1">, </span><br/><span class="hl-1">    </span><span class="hl-4">limit</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">, </span><br/><span class="hl-1">    </span><span class="hl-4">data</span><span class="hl-1">: </span><span class="hl-4">ICandleData</span><span class="hl-1">[]</span><br/><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-6">void</span>
</code><button type="button">Copy</button></pre>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>symbol</code></td>
<td><code>string</code></td>
<td>Trading pair that was fetched</td>
</tr>
<tr>
<td><code>interval</code></td>
<td><code>CandleInterval</code></td>
<td>Candle interval used (1m, 1h, etc.)</td>
</tr>
<tr>
<td><code>since</code></td>
<td><code>Date</code></td>
<td>Start timestamp for fetched range</td>
</tr>
<tr>
<td><code>limit</code></td>
<td><code>number</code></td>
<td>Number of candles requested</td>
</tr>
<tr>
<td><code>data</code></td>
<td><code>ICandleData[]</code></td>
<td>Array of fetched candles</td>
</tr>
</tbody>
</table>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Logging candle fetches for debugging</li>
<li>Caching candle data to reduce API calls</li>
<li>Monitoring data source health (check if candles are missing)</li>
<li>Analytics on data fetch patterns</li>
</ul>
<a id="example-usage" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example Usage<a href="#example-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">addExchange</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">getCandles</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">// Fetch from Binance API</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">onCandleData</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Fetched </span><span class="hl-6">${</span><span class="hl-4">data</span><span class="hl-9">.</span><span class="hl-4">length</span><span class="hl-6">}</span><span class="hl-2"> candles for </span><span class="hl-6">${</span><span class="hl-4">symbol</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Range: </span><span class="hl-6">${</span><span class="hl-4">since</span><span class="hl-6">}</span><span class="hl-2"> to </span><span class="hl-6">${</span><span class="hl-4">data</span><span class="hl-9">[</span><span class="hl-4">data</span><span class="hl-9">.</span><span class="hl-4">length</span><span class="hl-9"> </span><span class="hl-1">-</span><span class="hl-9"> </span><span class="hl-8">1</span><span class="hl-9">].</span><span class="hl-4">timestamp</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="integration-with-other-components" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Integration with Other Components<a href="#integration-with-other-components" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="connection-service-integration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Connection Service Integration<a href="#connection-service-integration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><code>ExchangeConnectionService</code> manages <code>ClientExchange</code> lifecycle and provides memoized instances.</p>
<p><strong>Memoization Pattern:</strong></p>
<ul>
<li>One <code>ClientExchange</code> instance per <code>exchangeName</code></li>
<li>Instance created on first use</li>
<li>Subsequent calls return cached instance</li>
<li>Parameters injected: <code>logger</code>, <code>execution</code> (scoped)</li>
</ul>
<p><strong>Instantiation Flow:</strong></p>
<ol>
<li><code>ExchangeConnectionService.get()</code> called with <code>exchangeName</code> from <code>MethodContext</code></li>
<li>Check memoization cache for existing instance</li>
<li>If not found:
<ul>
<li>Retrieve schema from <code>ExchangeSchemaService</code></li>
<li>Resolve <code>logger</code> from DI container</li>
<li>Resolve <code>execution</code> from scoped DI container</li>
<li>Instantiate <code>new ClientExchange(params)</code></li>
<li>Cache instance by <code>exchangeName</code></li>
</ul>
</li>
<li>Return instance</li>
</ol>
<a id="strategy-integration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Strategy Integration<a href="#strategy-integration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><code>ClientStrategy</code> consumes <code>ClientExchange</code> methods for market data access during signal lifecycle.</p>
<p><strong>Integration Points:</strong></p>
<table>
<thead>
<tr>
<th>ClientStrategy Method</th>
<th>Calls ClientExchange Method</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tick()</code></td>
<td><code>getAveragePrice()</code></td>
<td>Get current VWAP for signal generation and TP/SL checks</td>
</tr>
<tr>
<td><code>tick()</code></td>
<td><code>getCandles()</code> (via strategy schema)</td>
<td>Fetch historical data for indicator calculations</td>
</tr>
<tr>
<td><code>backtest()</code></td>
<td><code>getNextCandles()</code></td>
<td>Fetch future candles for fast-forward simulation</td>
</tr>
<tr>
<td><code>formatSignal()</code></td>
<td><code>formatPrice()</code></td>
<td>Format signal prices for display</td>
</tr>
<tr>
<td><code>formatSignal()</code></td>
<td><code>formatQuantity()</code></td>
<td>Format position sizes for display</td>
</tr>
</tbody>
</table>
<a id="logic-service-integration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Logic Service Integration<a href="#logic-service-integration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Both <code>BacktestLogicPrivateService</code> and <code>LiveLogicPrivateService</code> establish execution context before delegating to <code>ClientExchange</code>.</p>
<p><strong>Backtest Flow:</strong></p>
<ol>
<li><code>BacktestLogicPrivateService.run()</code> iterates through timeframe</li>
<li>For each timestamp, calls <code>ExecutionContextService.runInContext()</code> with <code>when: timestamp</code></li>
<li>Inside context, <code>ClientStrategy.tick()</code> calls <code>ClientExchange.getAveragePrice()</code></li>
<li><code>ClientExchange</code> uses <code>execution.when</code> to calculate historical VWAP</li>
</ol>
<p><strong>Live Flow:</strong></p>
<ol>
<li><code>LiveLogicPrivateService.run()</code> loops indefinitely</li>
<li>Each iteration calls <code>ExecutionContextService.runInContext()</code> with <code>when: Date.now()</code></li>
<li>Inside context, <code>ClientStrategy.tick()</code> calls <code>ClientExchange.getAveragePrice()</code></li>
<li><code>ClientExchange</code> uses <code>execution.when</code> (current time) to calculate real-time VWAP</li>
</ol>
<hr>
<a id="icandledata-structure" class="tsd-anchor"></a><h2 class="tsd-anchor-link">ICandleData Structure<a href="#icandledata-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Candle data returned by <code>getCandles()</code> and <code>getNextCandles()</code> follows the OHLCV format.</p>
<p><strong>Interface:</strong></p>
<pre><code class="typescript"><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-10">ICandleData</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">timestamp</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;   </span><span class="hl-5">// Unix milliseconds</span><br/><span class="hl-1">    </span><span class="hl-4">open</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;        </span><span class="hl-5">// Opening price</span><br/><span class="hl-1">    </span><span class="hl-4">high</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;        </span><span class="hl-5">// Highest price</span><br/><span class="hl-1">    </span><span class="hl-4">low</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;         </span><span class="hl-5">// Lowest price</span><br/><span class="hl-1">    </span><span class="hl-4">close</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;       </span><span class="hl-5">// Closing price</span><br/><span class="hl-1">    </span><span class="hl-4">volume</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;      </span><span class="hl-5">// Trading volume</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Field Details:</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Unit</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>timestamp</code></td>
<td><code>number</code></td>
<td>Milliseconds (Unix epoch)</td>
<td>Candle opening time</td>
</tr>
<tr>
<td><code>open</code></td>
<td><code>number</code></td>
<td>Quote currency</td>
<td>Price at candle start</td>
</tr>
<tr>
<td><code>high</code></td>
<td><code>number</code></td>
<td>Quote currency</td>
<td>Maximum price during period</td>
</tr>
<tr>
<td><code>low</code></td>
<td><code>number</code></td>
<td>Quote currency</td>
<td>Minimum price during period</td>
</tr>
<tr>
<td><code>close</code></td>
<td><code>number</code></td>
<td>Quote currency</td>
<td>Price at candle end</td>
</tr>
<tr>
<td><code>volume</code></td>
<td><code>number</code></td>
<td>Base currency</td>
<td>Total trading volume</td>
</tr>
</tbody>
</table>
<p><strong>Chronological Ordering:</strong></p>
<ul>
<li>Arrays returned by <code>getCandles()</code> are sorted by <code>timestamp</code> ascending (oldest first)</li>
<li>Arrays returned by <code>getNextCandles()</code> are sorted by <code>timestamp</code> ascending (earliest future first)</li>
</ul>
<hr>
<a id="candleinterval-types" class="tsd-anchor"></a><h2 class="tsd-anchor-link">CandleInterval Types<a href="#candleinterval-types" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>ClientExchange</code> supports multiple candle intervals for data fetching.</p>
<p><strong>Supported Intervals:</strong></p>
<table>
<thead>
<tr>
<th>Interval</th>
<th>Description</th>
<th>Milliseconds</th>
<th>Common Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&quot;1m&quot;</code></td>
<td>1 minute</td>
<td>60,000</td>
<td>VWAP calculation, high-frequency strategies</td>
</tr>
<tr>
<td><code>&quot;3m&quot;</code></td>
<td>3 minutes</td>
<td>180,000</td>
<td>Short-term signals</td>
</tr>
<tr>
<td><code>&quot;5m&quot;</code></td>
<td>5 minutes</td>
<td>300,000</td>
<td>Scalping strategies</td>
</tr>
<tr>
<td><code>&quot;15m&quot;</code></td>
<td>15 minutes</td>
<td>900,000</td>
<td>Intraday strategies</td>
</tr>
<tr>
<td><code>&quot;30m&quot;</code></td>
<td>30 minutes</td>
<td>1,800,000</td>
<td>Swing trading</td>
</tr>
<tr>
<td><code>&quot;1h&quot;</code></td>
<td>1 hour</td>
<td>3,600,000</td>
<td>Standard timeframe analysis</td>
</tr>
<tr>
<td><code>&quot;2h&quot;</code></td>
<td>2 hours</td>
<td>7,200,000</td>
<td>Medium-term strategies</td>
</tr>
<tr>
<td><code>&quot;4h&quot;</code></td>
<td>4 hours</td>
<td>14,400,000</td>
<td>Position trading</td>
</tr>
<tr>
<td><code>&quot;6h&quot;</code></td>
<td>6 hours</td>
<td>21,600,000</td>
<td>Long-term analysis</td>
</tr>
<tr>
<td><code>&quot;8h&quot;</code></td>
<td>8 hours</td>
<td>28,800,000</td>
<td>Daily monitoring</td>
</tr>
</tbody>
</table>
<p><strong>Conversion Utility:</strong></p>
<p>The framework includes interval-to-milliseconds conversion logic internally for timestamp calculations. User-defined <code>getCandles()</code> implementations must support these intervals or throw errors for unsupported ones.</p>
<hr>
<a id="summary-clientexchange-responsibilities" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Summary: ClientExchange Responsibilities<a href="#summary-clientexchange-responsibilities" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/32_ClientExchange_4.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: ClientExchange Inputs and Outputs</strong></p>
<p><strong>Key Design Patterns:</strong></p>
<ol>
<li><strong>Abstraction:</strong> Decouples framework from data sources (API vs database agnostic)</li>
<li><strong>Context-Aware:</strong> Uses <code>ExecutionContext</code> for timestamp-based operations</li>
<li><strong>Delegation:</strong> Forwards formatting and data fetching to user-defined functions</li>
<li><strong>Memoization:</strong> Single instance per exchange name via connection service</li>
<li><strong>Pure Business Logic:</strong> No DI dependencies, all via constructor injection</li>
</ol>
<p><strong>Related Components:</strong></p>
<ul>
<li><a href="design_31_clientstrategy.html">ClientStrategy</a>: Consumes exchange data for signal generation</li>
<li><a href="design_38_connection_services.html">ExchangeConnectionService</a>: Instantiates and manages ClientExchange instances</li>
<li><a href="design_21_exchange_functions.html">Exchange Functions</a>: Public API wrappers for exchange operations</li>
<li><a href="design_25_exchange_schemas.html">Exchange Schemas</a>: Schema registration and validation</li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#clientexchange"><span>Client<wbr/>Exchange</span></a><ul><li><a href="#overview"><span>Overview</span></a></li><li><a href="#constructor-and-parameters"><span>Constructor and <wbr/>Parameters</span></a></li><li><ul><li><a href="#iexchangeparams-structure"><span>IExchange<wbr/>Params <wbr/>Structure</span></a></li></ul></li><li><a href="#architecture-diagram"><span>Architecture <wbr/>Diagram</span></a></li><li><a href="#market-data-fetching"><span>Market <wbr/>Data <wbr/>Fetching</span></a></li><li><ul><li><a href="#getcandles---historical-data"><span>get<wbr/>Candles() -<wbr/> <wbr/>Historical <wbr/>Data</span></a></li><li><a href="#getnextcandles---future-data-backtest-only"><span>get<wbr/>Next<wbr/>Candles() -<wbr/> <wbr/>Future <wbr/>Data (<wbr/>Backtest <wbr/>Only)</span></a></li></ul></li><li><a href="#market-data-flow-diagram"><span>Market <wbr/>Data <wbr/>Flow <wbr/>Diagram</span></a></li><li><a href="#vwap-calculation"><span>VWAP <wbr/>Calculation</span></a></li><li><ul><li><a href="#vwap-formula"><span>VWAP <wbr/>Formula</span></a></li><li><a href="#implementation-flow"><span>Implementation <wbr/>Flow</span></a></li><li><a href="#usage-context"><span>Usage <wbr/>Context</span></a></li><li><a href="#configuration"><span>Configuration</span></a></li></ul></li><li><a href="#price-and-quantity-formatting"><span>Price and <wbr/>Quantity <wbr/>Formatting</span></a></li><li><ul><li><a href="#formatprice"><span>format<wbr/>Price()</span></a></li><li><a href="#formatquantity"><span>format<wbr/>Quantity()</span></a></li></ul></li><li><a href="#context-aware-behavior"><span>Context-<wbr/>Aware <wbr/>Behavior</span></a></li><li><ul><li><a href="#context-propagation-pattern"><span>Context <wbr/>Propagation <wbr/>Pattern</span></a></li><li><a href="#context-fields"><span>Context <wbr/>Fields</span></a></li><li><a href="#backtest-vs-live-mode"><span>Backtest vs <wbr/>Live <wbr/>Mode</span></a></li></ul></li><li><a href="#callbacks-and-events"><span>Callbacks and <wbr/>Events</span></a></li><li><ul><li><a href="#available-callbacks"><span>Available <wbr/>Callbacks</span></a></li><li><a href="#example-usage"><span>Example <wbr/>Usage</span></a></li></ul></li><li><a href="#integration-with-other-components"><span>Integration with <wbr/>Other <wbr/>Components</span></a></li><li><ul><li><a href="#connection-service-integration"><span>Connection <wbr/>Service <wbr/>Integration</span></a></li><li><a href="#strategy-integration"><span>Strategy <wbr/>Integration</span></a></li><li><a href="#logic-service-integration"><span>Logic <wbr/>Service <wbr/>Integration</span></a></li></ul></li><li><a href="#icandledata-structure"><span>ICandle<wbr/>Data <wbr/>Structure</span></a></li><li><a href="#candleinterval-types"><span>Candle<wbr/>Interval <wbr/>Types</span></a></li><li><a href="#summary-clientexchange-responsibilities"><span>Summary: <wbr/>Client<wbr/>Exchange <wbr/>Responsibilities</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
