<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>example/03_understanding_signals | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="example_03_understanding_signals.html">example/03_understanding_signals</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="understanding-trading-signals" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Understanding Trading Signals<a href="#understanding-trading-signals" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>This guide explains the complete lifecycle of trading signals in backtest-kit - from generation to closure. Understanding the signal state machine is critical for building reliable trading strategies.</p>
<a id="what-is-a-trading-signal" class="tsd-anchor"></a><h2 class="tsd-anchor-link">What is a Trading Signal?<a href="#what-is-a-trading-signal" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>A trading signal is a structured instruction to open a position in the market. Each signal contains:</p>
<ul>
<li><strong>Direction</strong>: LONG (buy) or SHORT (sell)</li>
<li><strong>Entry price</strong>: When to open the position</li>
<li><strong>Take-profit</strong>: Target price to lock in profit</li>
<li><strong>Stop-loss</strong>: Protection level against large losses</li>
<li><strong>Lifetime</strong>: Maximum duration of the position</li>
</ul>
<hr>
<a id="signal-state-machine" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Signal State Machine<a href="#signal-state-machine" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Each signal progresses through one of six possible states. The framework strictly controls transitions between states.</p>
<p><img src="../media/03-understanding-signals_0.svg" alt="Mermaid Diagram"></p>
<p><strong>Critical constraint</strong>: Only <strong>one</strong> signal can be active for a symbol-strategy pair at any given time. New signals wait until the previous signal reaches <code>closed</code> or <code>cancelled</code> state.</p>
<hr>
<a id="state-descriptions" class="tsd-anchor"></a><h2 class="tsd-anchor-link">State Descriptions<a href="#state-descriptions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="1-idle-waiting" class="tsd-anchor"></a><h3 class="tsd-anchor-link">1. Idle (Waiting)<a href="#1-idle-waiting" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>No active signal. Strategy is waiting for new signal generation.</p>
<p><strong>When</strong>:</p>
<ul>
<li>Strategy just started</li>
<li>Previous signal closed or cancelled</li>
<li><code>getSignal()</code> function returned <code>null</code></li>
</ul>
<p><strong>Event data</strong>:</p>
<pre><code class="typescript"><span class="hl-2">{</span><br/><span class="hl-2">  </span><span class="hl-10">action</span><span class="hl-2">: </span><span class="hl-4">&quot;idle&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">signal</span><span class="hl-2">: </span><span class="hl-3">null</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">currentPrice</span><span class="hl-2">: </span><span class="hl-7">50000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">strategyName</span><span class="hl-2">: </span><span class="hl-4">&quot;macd-crossover&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">exchangeName</span><span class="hl-2">: </span><span class="hl-4">&quot;binance&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">symbol</span><span class="hl-2">: </span><span class="hl-4">&quot;BTCUSDT&quot;</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="2-scheduled-pending" class="tsd-anchor"></a><h3 class="tsd-anchor-link">2. Scheduled (Pending)<a href="#2-scheduled-pending" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Signal is waiting for price to reach <code>priceOpen</code> (limit order behavior).</p>
<p><strong>When</strong>: <code>getSignal()</code> function returns a signal with specified <code>priceOpen</code> that hasn't been reached yet.</p>
<p><strong>Example LONG signal</strong>:</p>
<pre><code class="typescript"><span class="hl-2">{</span><br/><span class="hl-2">  </span><span class="hl-10">position</span><span class="hl-2">: </span><span class="hl-4">&quot;long&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">priceOpen</span><span class="hl-2">: </span><span class="hl-7">42000</span><span class="hl-2">,      </span><span class="hl-0">// Entry when price drops to 42000</span><br/><span class="hl-2">  </span><span class="hl-10">priceTakeProfit</span><span class="hl-2">: </span><span class="hl-7">45000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">priceStopLoss</span><span class="hl-2">: </span><span class="hl-7">40000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">minuteEstimatedTime</span><span class="hl-2">: </span><span class="hl-7">120</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">timestamp</span><span class="hl-2">: </span><span class="hl-6">Date</span><span class="hl-2">.</span><span class="hl-1">now</span><span class="hl-2">()</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>What happens</strong>:</p>
<ol>
<li>Signal is saved as &quot;scheduled&quot;</li>
<li>Each tick checks if price has reached <code>priceOpen</code></li>
<li>If price reaches <code>priceOpen</code> → transition to <code>opened</code> state</li>
<li>If timeout or SL before activation → transition to <code>cancelled</code> state</li>
</ol>
<p><strong>Important characteristics</strong>:</p>
<ul>
<li><strong>LONG</strong>: activates when <code>currentPrice &lt;= priceOpen</code> (price drops to entry)</li>
<li><strong>SHORT</strong>: activates when <code>currentPrice &gt;= priceOpen</code> (price rises to entry)</li>
</ul>
<hr>
<a id="3-opened-open" class="tsd-anchor"></a><h3 class="tsd-anchor-link">3. Opened (Open)<a href="#3-opened-open" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Position has just been opened. This is an intermediate state that transitions to <code>active</code> on the next tick.</p>
<p><strong>When</strong>:</p>
<ul>
<li>Immediate signal: <code>idle</code> → <code>opened</code> (when <code>priceOpen</code> not specified)</li>
<li>Scheduled signal: <code>scheduled</code> → <code>opened</code> (when activation price reached)</li>
</ul>
<p><strong>Event data</strong>:</p>
<pre><code class="typescript"><span class="hl-2">{</span><br/><span class="hl-2">  </span><span class="hl-10">action</span><span class="hl-2">: </span><span class="hl-4">&quot;opened&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">signal</span><span class="hl-2">: {</span><br/><span class="hl-2">    </span><span class="hl-10">id</span><span class="hl-2">: </span><span class="hl-4">&quot;sig_123&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-10">position</span><span class="hl-2">: </span><span class="hl-4">&quot;long&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-10">priceOpen</span><span class="hl-2">: </span><span class="hl-7">42000</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-10">priceTakeProfit</span><span class="hl-2">: </span><span class="hl-7">45000</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-10">priceStopLoss</span><span class="hl-2">: </span><span class="hl-7">40000</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-10">pendingAt</span><span class="hl-2">: </span><span class="hl-7">1702800000000</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-10">minuteEstimatedTime</span><span class="hl-2">: </span><span class="hl-7">120</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">  </span><span class="hl-10">currentPrice</span><span class="hl-2">: </span><span class="hl-7">42000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">strategyName</span><span class="hl-2">: </span><span class="hl-4">&quot;macd-crossover&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">exchangeName</span><span class="hl-2">: </span><span class="hl-4">&quot;binance&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">symbol</span><span class="hl-2">: </span><span class="hl-4">&quot;BTCUSDT&quot;</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Usage</strong>: This moment is ideal for sending notifications about position entry or logging trade start.</p>
<hr>
<a id="4-active-active" class="tsd-anchor"></a><h3 class="tsd-anchor-link">4. Active (Active)<a href="#4-active-active" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Signal is being monitored for exit conditions (TP, SL, or time expiration).</p>
<p><strong>Checked exit conditions</strong>:</p>
<a id="for-long-positions" class="tsd-anchor"></a><h4 class="tsd-anchor-link">For LONG positions:<a href="#for-long-positions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><ol>
<li><strong>Take-profit</strong>: <code>currentPrice &gt;= signal.priceTakeProfit</code></li>
<li><strong>Stop-loss</strong>: <code>currentPrice &lt;= signal.priceStopLoss</code></li>
<li><strong>Time expiration</strong>: <code>currentTime - signal.pendingAt &gt; signal.minuteEstimatedTime * 60 * 1000</code></li>
</ol>
<a id="for-short-positions" class="tsd-anchor"></a><h4 class="tsd-anchor-link">For SHORT positions:<a href="#for-short-positions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><ol>
<li><strong>Take-profit</strong>: <code>currentPrice &lt;= signal.priceTakeProfit</code></li>
<li><strong>Stop-loss</strong>: <code>currentPrice &gt;= signal.priceStopLoss</code></li>
<li><strong>Time expiration</strong>: (same as LONG)</li>
</ol>
<p><strong>Event data</strong>:</p>
<pre><code class="typescript"><span class="hl-2">{</span><br/><span class="hl-2">  </span><span class="hl-10">action</span><span class="hl-2">: </span><span class="hl-4">&quot;active&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">signal</span><span class="hl-2">: { </span><span class="hl-0">/* signal data */</span><span class="hl-2"> },</span><br/><span class="hl-2">  </span><span class="hl-10">currentPrice</span><span class="hl-2">: </span><span class="hl-7">43500</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">percentTp</span><span class="hl-2">: </span><span class="hl-7">50</span><span class="hl-2">,   </span><span class="hl-0">// Progress to TP: 50%</span><br/><span class="hl-2">  </span><span class="hl-10">percentSl</span><span class="hl-2">: </span><span class="hl-7">75</span><span class="hl-2">,   </span><span class="hl-0">// Distance from SL: 75%</span><br/><span class="hl-2">  </span><span class="hl-10">strategyName</span><span class="hl-2">: </span><span class="hl-4">&quot;macd-crossover&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">exchangeName</span><span class="hl-2">: </span><span class="hl-4">&quot;binance&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">symbol</span><span class="hl-2">: </span><span class="hl-4">&quot;BTCUSDT&quot;</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Usage</strong>: Monitoring <code>percentTp</code> and <code>percentSl</code> allows tracking position progress in real-time.</p>
<hr>
<a id="5-closed-closed" class="tsd-anchor"></a><h3 class="tsd-anchor-link">5. Closed (Closed)<a href="#5-closed-closed" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Signal completed with final PNL calculation. This is a terminal state.</p>
<p><strong>Close reasons</strong>:</p>
<ul>
<li><code>&quot;take_profit&quot;</code> - Price reached target profit level</li>
<li><code>&quot;stop_loss&quot;</code> - Protection level triggered</li>
<li><code>&quot;time_expired&quot;</code> - Maximum position lifetime expired</li>
</ul>
<p><strong>Event data</strong>:</p>
<pre><code class="typescript"><span class="hl-2">{</span><br/><span class="hl-2">  </span><span class="hl-10">action</span><span class="hl-2">: </span><span class="hl-4">&quot;closed&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">signal</span><span class="hl-2">: { </span><span class="hl-0">/* signal data */</span><span class="hl-2"> },</span><br/><span class="hl-2">  </span><span class="hl-10">currentPrice</span><span class="hl-2">: </span><span class="hl-7">45000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">closeReason</span><span class="hl-2">: </span><span class="hl-4">&quot;take_profit&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">closeTimestamp</span><span class="hl-2">: </span><span class="hl-7">1702807200000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">pnl</span><span class="hl-2">: {</span><br/><span class="hl-2">    </span><span class="hl-10">pnlPercentage</span><span class="hl-2">: </span><span class="hl-7">6.7</span><span class="hl-2">,      </span><span class="hl-0">// +6.7% after all costs</span><br/><span class="hl-2">    </span><span class="hl-10">priceOpen</span><span class="hl-2">: </span><span class="hl-7">42000</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-10">priceClose</span><span class="hl-2">: </span><span class="hl-7">45000</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-10">priceOpenAdjusted</span><span class="hl-2">: </span><span class="hl-7">42168</span><span class="hl-2">,  </span><span class="hl-0">// Including slippage and fees</span><br/><span class="hl-2">    </span><span class="hl-10">priceCloseAdjusted</span><span class="hl-2">: </span><span class="hl-7">44910</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">  </span><span class="hl-10">strategyName</span><span class="hl-2">: </span><span class="hl-4">&quot;macd-crossover&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">exchangeName</span><span class="hl-2">: </span><span class="hl-4">&quot;binance&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">symbol</span><span class="hl-2">: </span><span class="hl-4">&quot;BTCUSDT&quot;</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<a id="pnl-calculation" class="tsd-anchor"></a><h4 class="tsd-anchor-link">PNL Calculation<a href="#pnl-calculation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p><strong>For LONG positions</strong>:</p>
<pre><code><span class="hl-6">Adjusted</span><span class="hl-2"> </span><span class="hl-6">entry</span><span class="hl-2"> </span><span class="hl-10">price</span><span class="hl-2">:</span><br/><span class="hl-2">  </span><span class="hl-6">priceOpenAdjusted</span><span class="hl-2"> = </span><span class="hl-6">priceOpen</span><span class="hl-2"> × (</span><span class="hl-7">1</span><span class="hl-2"> + </span><span class="hl-6">slippage</span><span class="hl-2">) × (</span><span class="hl-7">1</span><span class="hl-2"> + </span><span class="hl-6">fee</span><span class="hl-2">)</span><br/><br/><span class="hl-6">Adjusted</span><span class="hl-2"> </span><span class="hl-6">exit</span><span class="hl-2"> </span><span class="hl-10">price</span><span class="hl-2">:</span><br/><span class="hl-2">  </span><span class="hl-6">priceCloseAdjusted</span><span class="hl-2"> = </span><span class="hl-6">priceClose</span><span class="hl-2"> × (</span><span class="hl-7">1</span><span class="hl-2"> - </span><span class="hl-6">slippage</span><span class="hl-2">) × (</span><span class="hl-7">1</span><span class="hl-2"> - </span><span class="hl-6">fee</span><span class="hl-2">)</span><br/><br/><span class="hl-8">PNL</span><span class="hl-2"> </span><span class="hl-10">percentage</span><span class="hl-2">:</span><br/><span class="hl-2">  </span><span class="hl-6">pnlPercentage</span><span class="hl-2"> = ((</span><span class="hl-6">priceCloseAdjusted</span><span class="hl-2"> - </span><span class="hl-6">priceOpenAdjusted</span><span class="hl-2">) / </span><span class="hl-6">priceOpenAdjusted</span><span class="hl-2">) × </span><span class="hl-7">100</span>
</code><button>Copy</button></pre>

<p><strong>For SHORT positions</strong>:</p>
<pre><code><span class="hl-6">Adjusted</span><span class="hl-2"> </span><span class="hl-6">entry</span><span class="hl-2"> </span><span class="hl-10">price</span><span class="hl-2">:</span><br/><span class="hl-2">  </span><span class="hl-6">priceOpenAdjusted</span><span class="hl-2"> = </span><span class="hl-6">priceOpen</span><span class="hl-2"> × (</span><span class="hl-7">1</span><span class="hl-2"> - </span><span class="hl-6">slippage</span><span class="hl-2">) × (</span><span class="hl-7">1</span><span class="hl-2"> - </span><span class="hl-6">fee</span><span class="hl-2">)</span><br/><br/><span class="hl-6">Adjusted</span><span class="hl-2"> </span><span class="hl-6">exit</span><span class="hl-2"> </span><span class="hl-10">price</span><span class="hl-2">:</span><br/><span class="hl-2">  </span><span class="hl-6">priceCloseAdjusted</span><span class="hl-2"> = </span><span class="hl-6">priceClose</span><span class="hl-2"> × (</span><span class="hl-7">1</span><span class="hl-2"> + </span><span class="hl-6">slippage</span><span class="hl-2">) × (</span><span class="hl-7">1</span><span class="hl-2"> + </span><span class="hl-6">fee</span><span class="hl-2">)</span><br/><br/><span class="hl-8">PNL</span><span class="hl-2"> </span><span class="hl-10">percentage</span><span class="hl-2">:</span><br/><span class="hl-2">  </span><span class="hl-6">pnlPercentage</span><span class="hl-2"> = ((</span><span class="hl-6">priceOpenAdjusted</span><span class="hl-2"> - </span><span class="hl-6">priceCloseAdjusted</span><span class="hl-2">) / </span><span class="hl-6">priceOpenAdjusted</span><span class="hl-2">) × </span><span class="hl-7">100</span>
</code><button>Copy</button></pre>

<p><strong>Default trading costs</strong>:</p>
<ul>
<li><code>CC_PERCENT_SLIPPAGE = 0.1%</code> (market impact)</li>
<li><code>CC_PERCENT_FEE = 0.1%</code> (exchange commission)</li>
<li><strong>Total costs: ~0.4%</strong> (2× slippage + 2× fee)</li>
</ul>
<p><strong>Important</strong>: For breakeven, a signal must achieve at least 0.4% gross profit.</p>
<hr>
<a id="6-cancelled-cancelled" class="tsd-anchor"></a><h3 class="tsd-anchor-link">6. Cancelled (Cancelled)<a href="#6-cancelled-cancelled" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Scheduled signal was cancelled without opening a position. This is a terminal state.</p>
<p><strong>Cancellation reasons</strong>:</p>
<ol>
<li><strong>Timeout</strong>: Scheduled signal did not activate within <code>CC_SCHEDULE_AWAIT_MINUTES</code> (default 60 minutes)</li>
<li><strong>Stop-loss before activation</strong>: Price reached SL before reaching <code>priceOpen</code></li>
</ol>
<p><strong>Event data</strong>:</p>
<pre><code class="typescript"><span class="hl-2">{</span><br/><span class="hl-2">  </span><span class="hl-10">action</span><span class="hl-2">: </span><span class="hl-4">&quot;cancelled&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">signal</span><span class="hl-2">: {</span><br/><span class="hl-2">    </span><span class="hl-10">id</span><span class="hl-2">: </span><span class="hl-4">&quot;sig_124&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-10">position</span><span class="hl-2">: </span><span class="hl-4">&quot;long&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-10">priceOpen</span><span class="hl-2">: </span><span class="hl-7">42000</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-10">scheduledAt</span><span class="hl-2">: </span><span class="hl-7">1702800000000</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-10">_isScheduled</span><span class="hl-2">: </span><span class="hl-3">true</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">  </span><span class="hl-10">currentPrice</span><span class="hl-2">: </span><span class="hl-7">39000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">closeTimestamp</span><span class="hl-2">: </span><span class="hl-7">1702803600000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">strategyName</span><span class="hl-2">: </span><span class="hl-4">&quot;macd-crossover&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">exchangeName</span><span class="hl-2">: </span><span class="hl-4">&quot;binance&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">symbol</span><span class="hl-2">: </span><span class="hl-4">&quot;BTCUSDT&quot;</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="scheduled-signals-long-vs-short" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Scheduled Signals: LONG vs SHORT<a href="#scheduled-signals-long-vs-short" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Activation and cancellation logic for scheduled signals differs between LONG and SHORT positions due to opposite price movement directions.</p>
<a id="long-position-activation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">LONG Position Activation<a href="#long-position-activation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/03-understanding-signals_1.svg" alt="Mermaid Diagram"></p>
<p><strong>Key rule</strong>: For LONG positions, stop-loss check has <strong>priority</strong> over activation check.</p>
<p><strong>Rationale</strong>: If price drops to both levels (SL and priceOpen) on the same candle, the position should be cancelled (not opened and immediately closed), preventing unnecessary fees.</p>
<hr>
<a id="short-position-activation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">SHORT Position Activation<a href="#short-position-activation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/03-understanding-signals_2.svg" alt="Mermaid Diagram"></p>
<p><strong>Key rule</strong>: For SHORT positions, stop-loss check has <strong>priority</strong> over activation check.</p>
<hr>
<a id="cancellation-scenario-examples" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Cancellation Scenario Examples<a href="#cancellation-scenario-examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="example-1-long-signal---timeout" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example 1: LONG signal - timeout<a href="#example-1-long-signal---timeout" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">// Scheduled LONG signal created</span><br/><span class="hl-2">{</span><br/><span class="hl-2">  </span><span class="hl-10">position</span><span class="hl-2">: </span><span class="hl-4">&quot;long&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">priceOpen</span><span class="hl-2">: </span><span class="hl-7">42000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">priceTakeProfit</span><span class="hl-2">: </span><span class="hl-7">45000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">priceStopLoss</span><span class="hl-2">: </span><span class="hl-7">40000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">scheduledAt</span><span class="hl-2">: </span><span class="hl-7">10</span><span class="hl-2">:</span><span class="hl-7">00</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-0">// Price does not reach 42000 within 60 minutes</span><br/><span class="hl-0">// Time: 11:00 - Timeout!</span><br/><span class="hl-0">// Result: CANCELLED (reason: timeout)</span>
</code><button type="button">Copy</button></pre>

<a id="example-2-long-signal---sl-before-activation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example 2: LONG signal - SL before activation<a href="#example-2-long-signal---sl-before-activation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">// Scheduled LONG signal created</span><br/><span class="hl-2">{</span><br/><span class="hl-2">  </span><span class="hl-10">position</span><span class="hl-2">: </span><span class="hl-4">&quot;long&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">priceOpen</span><span class="hl-2">: </span><span class="hl-7">42000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">priceStopLoss</span><span class="hl-2">: </span><span class="hl-7">41000</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-0">// Price path: 43000 → 40500 (skips priceOpen, reaches SL)</span><br/><span class="hl-0">// Result: CANCELLED (reason: SL before activation)</span><br/><span class="hl-0">// Rationale: Opening at 42000 with immediate SL at 41000 wastes fees</span>
</code><button type="button">Copy</button></pre>

<a id="example-3-short-signal---sl-before-activation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example 3: SHORT signal - SL before activation<a href="#example-3-short-signal---sl-before-activation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">// Scheduled SHORT signal created</span><br/><span class="hl-2">{</span><br/><span class="hl-2">  </span><span class="hl-10">position</span><span class="hl-2">: </span><span class="hl-4">&quot;short&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">priceOpen</span><span class="hl-2">: </span><span class="hl-7">42000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">priceStopLoss</span><span class="hl-2">: </span><span class="hl-7">44000</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-0">// Price path: 41000 → 45000 (skips priceOpen, reaches SL)</span><br/><span class="hl-0">// Result: CANCELLED (reason: SL before activation)</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="signal-validation-rules" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Signal Validation Rules<a href="#signal-validation-rules" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The framework enforces strict validation rules to prevent invalid trades.</p>
<a id="general-validation-rules" class="tsd-anchor"></a><h3 class="tsd-anchor-link">General Validation Rules<a href="#general-validation-rules" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Check</th>
<th>LONG</th>
<th>SHORT</th>
<th>Error if violated</th>
</tr>
</thead>
<tbody>
<tr>
<td>Position TP/SL</td>
<td><code>TP &gt; priceOpen &gt; SL</code></td>
<td><code>SL &gt; priceOpen &gt; TP</code></td>
<td>Price logic violated</td>
</tr>
<tr>
<td>TP distance</td>
<td><code>((TP - priceOpen) / priceOpen) × 100 ≥ 0.5%</code></td>
<td><code>((priceOpen - TP) / priceOpen) × 100 ≥ 0.5%</code></td>
<td>TP too close to cover fees</td>
</tr>
<tr>
<td>Min SL distance</td>
<td><code>((priceOpen - SL) / priceOpen) × 100 ≥ 0.5%</code></td>
<td><code>((SL - priceOpen) / priceOpen) × 100 ≥ 0.5%</code></td>
<td>SL too close (instant stop)</td>
</tr>
<tr>
<td>Max SL distance</td>
<td><code>((priceOpen - SL) / priceOpen) × 100 ≤ 20%</code></td>
<td><code>((SL - priceOpen) / priceOpen) × 100 ≤ 20%</code></td>
<td>SL too far (catastrophic loss)</td>
</tr>
<tr>
<td>Lifetime</td>
<td><code>minuteEstimatedTime ≤ 1440 minutes</code></td>
<td>Same</td>
<td>Signal lifetime too long</td>
</tr>
</tbody>
</table>
<a id="immediate-signal-validation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Immediate Signal Validation<a href="#immediate-signal-validation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>For signals that open immediately, additional checks prevent instant closure:</p>
<p><strong>LONG immediate</strong>:</p>
<pre><code><span class="hl-6">currentPrice</span><span class="hl-2"> </span><span class="hl-8">MUST</span><span class="hl-2"> </span><span class="hl-6">be</span><span class="hl-2"> </span><span class="hl-6">between</span><span class="hl-2"> </span><span class="hl-8">SL</span><span class="hl-2"> </span><span class="hl-6">and</span><span class="hl-2"> </span><span class="hl-10">TP</span><span class="hl-2">:</span><br/><span class="hl-2">  </span><span class="hl-6">priceStopLoss</span><span class="hl-2"> &lt; </span><span class="hl-6">currentPrice</span><span class="hl-2"> &lt; </span><span class="hl-6">priceTakeProfit</span>
</code><button>Copy</button></pre>

<p><strong>Error cases</strong>:</p>
<ul>
<li><code>currentPrice &lt;= priceStopLoss</code> → &quot;Signal will be immediately closed by stop-loss&quot;</li>
<li><code>currentPrice &gt;= priceTakeProfit</code> → &quot;Profit opportunity already missed&quot;</li>
</ul>
<p><strong>SHORT immediate</strong>:</p>
<pre><code><span class="hl-6">currentPrice</span><span class="hl-2"> </span><span class="hl-8">MUST</span><span class="hl-2"> </span><span class="hl-6">be</span><span class="hl-2"> </span><span class="hl-6">between</span><span class="hl-2"> </span><span class="hl-8">TP</span><span class="hl-2"> </span><span class="hl-6">and</span><span class="hl-2"> </span><span class="hl-10">SL</span><span class="hl-2">:</span><br/><span class="hl-2">  </span><span class="hl-6">priceTakeProfit</span><span class="hl-2"> &lt; </span><span class="hl-6">currentPrice</span><span class="hl-2"> &lt; </span><span class="hl-6">priceStopLoss</span>
</code><button>Copy</button></pre>

<hr>
<a id="monitoring-signals-with-events" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Monitoring Signals with Events<a href="#monitoring-signals-with-events" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="event-listeners" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Event Listeners<a href="#event-listeners" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">listenSignalBacktest</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-1">listenSignalBacktest</span><span class="hl-2">((</span><span class="hl-6">event</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`[</span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">action</span><span class="hl-3">}</span><span class="hl-4">] </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><br/><span class="hl-2">  </span><span class="hl-5">switch</span><span class="hl-2"> (</span><span class="hl-6">event</span><span class="hl-2">.</span><span class="hl-6">action</span><span class="hl-2">) {</span><br/><span class="hl-2">    </span><span class="hl-5">case</span><span class="hl-2"> </span><span class="hl-4">&quot;idle&quot;</span><span class="hl-2">:</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">&quot;  Waiting for new signal&quot;</span><span class="hl-2">);</span><br/><span class="hl-2">      </span><span class="hl-5">break</span><span class="hl-2">;</span><br/><br/><span class="hl-2">    </span><span class="hl-5">case</span><span class="hl-2"> </span><span class="hl-4">&quot;scheduled&quot;</span><span class="hl-2">:</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`  Scheduled: entry at </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">signal</span><span class="hl-9">.</span><span class="hl-6">priceOpen</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">      </span><span class="hl-5">break</span><span class="hl-2">;</span><br/><br/><span class="hl-2">    </span><span class="hl-5">case</span><span class="hl-2"> </span><span class="hl-4">&quot;opened&quot;</span><span class="hl-2">:</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`  Position opened: </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">signal</span><span class="hl-9">.</span><span class="hl-6">position</span><span class="hl-3">}</span><span class="hl-4"> @ </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">currentPrice</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">      </span><span class="hl-5">break</span><span class="hl-2">;</span><br/><br/><span class="hl-2">    </span><span class="hl-5">case</span><span class="hl-2"> </span><span class="hl-4">&quot;active&quot;</span><span class="hl-2">:</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`  Monitoring: TP </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">percentTp</span><span class="hl-3">}</span><span class="hl-4">%, SL </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">percentSl</span><span class="hl-3">}</span><span class="hl-4">%`</span><span class="hl-2">);</span><br/><span class="hl-2">      </span><span class="hl-5">break</span><span class="hl-2">;</span><br/><br/><span class="hl-2">    </span><span class="hl-5">case</span><span class="hl-2"> </span><span class="hl-4">&quot;closed&quot;</span><span class="hl-2">:</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`  Closed: </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">closeReason</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`  PNL: </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">pnl</span><span class="hl-9">.</span><span class="hl-6">pnlPercentage</span><span class="hl-9">.</span><span class="hl-1">toFixed</span><span class="hl-9">(</span><span class="hl-7">2</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-4">%`</span><span class="hl-2">);</span><br/><span class="hl-2">      </span><span class="hl-5">break</span><span class="hl-2">;</span><br/><br/><span class="hl-2">    </span><span class="hl-5">case</span><span class="hl-2"> </span><span class="hl-4">&quot;cancelled&quot;</span><span class="hl-2">:</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`  Scheduled signal cancelled`</span><span class="hl-2">);</span><br/><span class="hl-2">      </span><span class="hl-5">break</span><span class="hl-2">;</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="strategy-callbacks" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Strategy Callbacks<a href="#strategy-callbacks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Alternatively, use callbacks in the strategy schema:</p>
<pre><code class="typescript"><span class="hl-1">addStrategy</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">strategyName:</span><span class="hl-2"> </span><span class="hl-4">&quot;macd-crossover&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">interval:</span><span class="hl-2"> </span><span class="hl-4">&quot;15m&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-1">getSignal</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-0">// Signal generation logic</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">  </span><span class="hl-6">callbacks:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-1">onSchedule</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">signal</span><span class="hl-2">, </span><span class="hl-6">currentPrice</span><span class="hl-2">, </span><span class="hl-6">backtest</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Scheduled signal created for </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-1">onOpen</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">signal</span><span class="hl-2">, </span><span class="hl-6">currentPrice</span><span class="hl-2">, </span><span class="hl-6">backtest</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Position opened: </span><span class="hl-3">${</span><span class="hl-6">signal</span><span class="hl-9">.</span><span class="hl-6">position</span><span class="hl-3">}</span><span class="hl-4"> @ </span><span class="hl-3">${</span><span class="hl-6">currentPrice</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">      </span><span class="hl-0">// Send notification, update UI, etc.</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-1">onActive</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">signal</span><span class="hl-2">, </span><span class="hl-6">currentPrice</span><span class="hl-2">, </span><span class="hl-6">backtest</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-0">// Called every tick during monitoring</span><br/><span class="hl-2">      </span><span class="hl-0">// Use for progress tracking</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-1">onClose</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">signal</span><span class="hl-2">, </span><span class="hl-6">priceClose</span><span class="hl-2">, </span><span class="hl-6">backtest</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Position closed @ </span><span class="hl-3">${</span><span class="hl-6">priceClose</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">      </span><span class="hl-0">// Log trade results</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-1">onCancel</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">signal</span><span class="hl-2">, </span><span class="hl-6">currentPrice</span><span class="hl-2">, </span><span class="hl-6">backtest</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Scheduled signal cancelled @ </span><span class="hl-3">${</span><span class="hl-6">currentPrice</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="signal-persistence-live-trading" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Signal Persistence (Live Trading)<a href="#signal-persistence-live-trading" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>In live trading mode, active signals are saved to disk for crash protection.</p>
<a id="what-gets-saved" class="tsd-anchor"></a><h3 class="tsd-anchor-link">What Gets Saved<a href="#what-gets-saved" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>State</th>
<th>Saved?</th>
<th>Reason</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>idle</code></td>
<td>❌ No</td>
<td>No data to save</td>
</tr>
<tr>
<td><code>scheduled</code></td>
<td>✅ Yes</td>
<td>In PersistScheduleAdapter</td>
</tr>
<tr>
<td><code>opened</code></td>
<td>✅ Yes</td>
<td>In PersistSignalAdapter</td>
</tr>
<tr>
<td><code>active</code></td>
<td>✅ Yes</td>
<td>In PersistSignalAdapter</td>
</tr>
<tr>
<td><code>closed</code></td>
<td>❌ No</td>
<td>Position completed, cleared from disk</td>
</tr>
<tr>
<td><code>cancelled</code></td>
<td>❌ No</td>
<td>Scheduled signal cancelled, cleared from disk</td>
</tr>
</tbody>
</table>
<a id="crash-recovery" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Crash Recovery<a href="#crash-recovery" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>When the live trading process restarts, signals are restored from disk:</p>
<pre><code class="typescript"><span class="hl-0">// On Live.background() startup</span><br/><span class="hl-7">1.</span><span class="hl-2"> </span><span class="hl-6">Read</span><span class="hl-2"> </span><span class="hl-6">PersistSignalAdapter</span><span class="hl-2"> → </span><span class="hl-6">restore</span><span class="hl-2"> </span><span class="hl-6">active</span><span class="hl-2"> </span><span class="hl-6">position</span><br/><span class="hl-7">2.</span><span class="hl-2"> </span><span class="hl-6">Read</span><span class="hl-2"> </span><span class="hl-6">PersistScheduleAdapter</span><span class="hl-2"> → </span><span class="hl-6">restore</span><span class="hl-2"> </span><span class="hl-6">scheduled</span><span class="hl-2"> </span><span class="hl-6">signal</span><br/><span class="hl-7">3.</span><span class="hl-2"> </span><span class="hl-6">Call</span><span class="hl-2"> </span><span class="hl-6">appropriate</span><span class="hl-2"> </span><span class="hl-1">callbacks</span><span class="hl-2"> (</span><span class="hl-6">onActive</span><span class="hl-2"> / </span><span class="hl-6">onSchedule</span><span class="hl-2">)</span><br/><span class="hl-7">4.</span><span class="hl-2"> </span><span class="hl-6">Continue</span><span class="hl-2"> </span><span class="hl-6">monitoring</span><span class="hl-2"> </span><span class="hl-6">from</span><span class="hl-2"> </span><span class="hl-6">restored</span><span class="hl-2"> </span><span class="hl-6">state</span>
</code><button type="button">Copy</button></pre>

<p><strong>Key guarantees</strong>:</p>
<ul>
<li>No duplicate signals (single source of truth)</li>
<li>No lost positions (atomic writes prevent corruption)</li>
<li>Seamless recovery (callbacks notify about restored state)</li>
</ul>
<hr>
<a id="exit-condition-check-diagram" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Exit Condition Check Diagram<a href="#exit-condition-check-diagram" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/03-understanding-signals_3.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="practical-example-full-lifecycle" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Practical Example: Full Lifecycle<a href="#practical-example-full-lifecycle" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">addStrategy</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">listenSignalBacktest</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">Backtest</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">getCandles</span><br/><span class="hl-2">} </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-0">// Strategy with scheduled entry</span><br/><span class="hl-1">addStrategy</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">strategyName:</span><span class="hl-2"> </span><span class="hl-4">&quot;breakout-strategy&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">interval:</span><span class="hl-2"> </span><span class="hl-4">&quot;15m&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-1">getSignal</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-0">// Fetch recent candles to determine market state</span><br/><span class="hl-2">    </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">candles</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">getCandles</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-4">&quot;15m&quot;</span><span class="hl-2">, </span><span class="hl-7">20</span><span class="hl-2">);</span><br/><span class="hl-2">    </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">currentPrice</span><span class="hl-2"> = </span><span class="hl-6">candles</span><span class="hl-2">[</span><span class="hl-6">candles</span><span class="hl-2">.</span><span class="hl-6">length</span><span class="hl-2"> - </span><span class="hl-7">1</span><span class="hl-2">].</span><span class="hl-6">close</span><span class="hl-2">;</span><br/><br/><span class="hl-2">    </span><span class="hl-0">// Scheduled LONG: wait for breakout down to 48000</span><br/><span class="hl-2">    </span><span class="hl-5">return</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">position:</span><span class="hl-2"> </span><span class="hl-4">&quot;long&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-6">priceOpen:</span><span class="hl-2"> </span><span class="hl-7">48000</span><span class="hl-2">,        </span><span class="hl-0">// Activate on drop</span><br/><span class="hl-2">      </span><span class="hl-6">priceTakeProfit:</span><span class="hl-2"> </span><span class="hl-7">50000</span><span class="hl-2">,  </span><span class="hl-0">// +4.17% target profit</span><br/><span class="hl-2">      </span><span class="hl-6">priceStopLoss:</span><span class="hl-2"> </span><span class="hl-7">46500</span><span class="hl-2">,    </span><span class="hl-0">// -3.13% max loss</span><br/><span class="hl-2">      </span><span class="hl-6">minuteEstimatedTime:</span><span class="hl-2"> </span><span class="hl-7">240</span><span class="hl-2">,  </span><span class="hl-0">// 4 hours</span><br/><span class="hl-2">      </span><span class="hl-6">timestamp:</span><span class="hl-2"> </span><span class="hl-6">Date</span><span class="hl-2">.</span><span class="hl-1">now</span><span class="hl-2">(),</span><br/><span class="hl-2">    };</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">  </span><span class="hl-6">callbacks:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-1">onSchedule</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">signal</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`✓ Scheduled signal: entry at </span><span class="hl-3">${</span><span class="hl-6">signal</span><span class="hl-9">.</span><span class="hl-6">priceOpen</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-1">onOpen</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">signal</span><span class="hl-2">, </span><span class="hl-6">price</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`✓ Position opened at </span><span class="hl-3">${</span><span class="hl-6">price</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-1">onActive</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">signal</span><span class="hl-2">, </span><span class="hl-6">price</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`→ Monitoring: current price </span><span class="hl-3">${</span><span class="hl-6">price</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-1">onClose</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">signal</span><span class="hl-2">, </span><span class="hl-6">price</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`✓ Position closed at </span><span class="hl-3">${</span><span class="hl-6">price</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-1">onCancel</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">signal</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`✗ Scheduled signal cancelled`</span><span class="hl-2">);</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// Monitor all events</span><br/><span class="hl-1">listenSignalBacktest</span><span class="hl-2">((</span><span class="hl-6">event</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`[</span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">action</span><span class="hl-3">}</span><span class="hl-4">] </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4"> @ </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">currentPrice</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><br/><span class="hl-2">  </span><span class="hl-5">if</span><span class="hl-2"> (</span><span class="hl-6">event</span><span class="hl-2">.</span><span class="hl-6">action</span><span class="hl-2"> === </span><span class="hl-4">&quot;closed&quot;</span><span class="hl-2">) {</span><br/><span class="hl-2">    </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`  Reason: </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">closeReason</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">    </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`  PNL: </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">pnl</span><span class="hl-9">.</span><span class="hl-6">pnlPercentage</span><span class="hl-9">.</span><span class="hl-1">toFixed</span><span class="hl-9">(</span><span class="hl-7">2</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-4">%`</span><span class="hl-2">);</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// Run backtest</span><br/><span class="hl-6">Backtest</span><span class="hl-2">.</span><span class="hl-1">background</span><span class="hl-2">(</span><span class="hl-4">&quot;BTCUSDT&quot;</span><span class="hl-2">, {</span><br/><span class="hl-2">  </span><span class="hl-6">strategyName:</span><span class="hl-2"> </span><span class="hl-4">&quot;breakout-strategy&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">exchangeName:</span><span class="hl-2"> </span><span class="hl-4">&quot;binance&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">frameName:</span><span class="hl-2"> </span><span class="hl-4">&quot;december-2025&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Possible output</strong>:</p>
<pre><code><span class="hl-2">✓ </span><span class="hl-6">Scheduled</span><span class="hl-2"> </span><span class="hl-10">signal</span><span class="hl-2">: </span><span class="hl-6">entry</span><span class="hl-2"> </span><span class="hl-6">at</span><span class="hl-2"> </span><span class="hl-7">48000</span><br/><span class="hl-2">[</span><span class="hl-6">scheduled</span><span class="hl-2">] </span><span class="hl-8">BTCUSDT</span><span class="hl-2"> @ </span><span class="hl-7">50000</span><br/><span class="hl-2">[</span><span class="hl-6">opened</span><span class="hl-2">] </span><span class="hl-8">BTCUSDT</span><span class="hl-2"> @ </span><span class="hl-7">48000</span><br/><span class="hl-2">✓ </span><span class="hl-6">Position</span><span class="hl-2"> </span><span class="hl-6">opened</span><span class="hl-2"> </span><span class="hl-6">at</span><span class="hl-2"> </span><span class="hl-7">48000</span><br/><span class="hl-2">[</span><span class="hl-6">active</span><span class="hl-2">] </span><span class="hl-8">BTCUSDT</span><span class="hl-2"> @ </span><span class="hl-7">48500</span><br/><span class="hl-2">→ </span><span class="hl-10">Monitoring</span><span class="hl-2">: </span><span class="hl-6">current</span><span class="hl-2"> </span><span class="hl-6">price</span><span class="hl-2"> </span><span class="hl-7">48500</span><br/><span class="hl-2">[</span><span class="hl-6">active</span><span class="hl-2">] </span><span class="hl-8">BTCUSDT</span><span class="hl-2"> @ </span><span class="hl-7">49200</span><br/><span class="hl-2">→ </span><span class="hl-10">Monitoring</span><span class="hl-2">: </span><span class="hl-6">current</span><span class="hl-2"> </span><span class="hl-6">price</span><span class="hl-2"> </span><span class="hl-7">49200</span><br/><span class="hl-2">[</span><span class="hl-6">closed</span><span class="hl-2">] </span><span class="hl-8">BTCUSDT</span><span class="hl-2"> @ </span><span class="hl-7">50000</span><br/><span class="hl-2">✓ </span><span class="hl-6">Position</span><span class="hl-2"> </span><span class="hl-6">closed</span><span class="hl-2"> </span><span class="hl-6">at</span><span class="hl-2"> </span><span class="hl-7">50000</span><br/><span class="hl-2">  </span><span class="hl-10">Reason</span><span class="hl-2">: </span><span class="hl-6">take_profit</span><br/><span class="hl-2">  </span><span class="hl-10">PNL</span><span class="hl-2">: </span><span class="hl-7">3.76</span><span class="hl-2">%</span>
</code><button>Copy</button></pre>

<hr>
<a id="next-steps" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Next Steps<a href="#next-steps" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>After understanding the signal lifecycle:</p>
<ol>
<li><strong><a href="example_04_live_trading.html">Live Trading Setup</a></strong> - transition to real execution with automatic crash recovery</li>
<li><strong><a href="example_05_risk_management.html">Risk Management</a></strong> - implement portfolio validation rules and position limits</li>
<li><strong><a href="example_06_ai_optimization.html">AI Optimization</a></strong> - generate strategies using large language models</li>
</ol>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#understanding-trading-signals"><span>Understanding <wbr/>Trading <wbr/>Signals</span></a><ul><li><a href="#what-is-a-trading-signal"><span>What is a <wbr/>Trading <wbr/>Signal?</span></a></li><li><a href="#signal-state-machine"><span>Signal <wbr/>State <wbr/>Machine</span></a></li><li><a href="#state-descriptions"><span>State <wbr/>Descriptions</span></a></li><li><ul><li><a href="#1-idle-waiting"><span>1. <wbr/>Idle (<wbr/>Waiting)</span></a></li><li><a href="#2-scheduled-pending"><span>2. <wbr/>Scheduled (<wbr/>Pending)</span></a></li><li><a href="#3-opened-open"><span>3. <wbr/>Opened (<wbr/>Open)</span></a></li><li><a href="#4-active-active"><span>4. <wbr/>Active (<wbr/>Active)</span></a></li><li><ul><li><a href="#for-long-positions"><span>For LONG positions:</span></a></li><li><a href="#for-short-positions"><span>For SHORT positions:</span></a></li></ul></li><li><a href="#5-closed-closed"><span>5. <wbr/>Closed (<wbr/>Closed)</span></a></li><li><ul><li><a href="#pnl-calculation"><span>PNL <wbr/>Calculation</span></a></li></ul></li><li><a href="#6-cancelled-cancelled"><span>6. <wbr/>Cancelled (<wbr/>Cancelled)</span></a></li></ul></li><li><a href="#scheduled-signals-long-vs-short"><span>Scheduled <wbr/>Signals: LONG vs SHORT</span></a></li><li><ul><li><a href="#long-position-activation"><span>LONG <wbr/>Position <wbr/>Activation</span></a></li><li><a href="#short-position-activation"><span>SHORT <wbr/>Position <wbr/>Activation</span></a></li></ul></li><li><a href="#cancellation-scenario-examples"><span>Cancellation <wbr/>Scenario <wbr/>Examples</span></a></li><li><ul><li><a href="#example-1-long-signal---timeout"><span>Example 1: LONG signal -<wbr/> timeout</span></a></li><li><a href="#example-2-long-signal---sl-before-activation"><span>Example 2: LONG signal -<wbr/> SL before activation</span></a></li><li><a href="#example-3-short-signal---sl-before-activation"><span>Example 3: SHORT signal -<wbr/> SL before activation</span></a></li></ul></li><li><a href="#signal-validation-rules"><span>Signal <wbr/>Validation <wbr/>Rules</span></a></li><li><ul><li><a href="#general-validation-rules"><span>General <wbr/>Validation <wbr/>Rules</span></a></li><li><a href="#immediate-signal-validation"><span>Immediate <wbr/>Signal <wbr/>Validation</span></a></li></ul></li><li><a href="#monitoring-signals-with-events"><span>Monitoring <wbr/>Signals with <wbr/>Events</span></a></li><li><ul><li><a href="#event-listeners"><span>Event <wbr/>Listeners</span></a></li><li><a href="#strategy-callbacks"><span>Strategy <wbr/>Callbacks</span></a></li></ul></li><li><a href="#signal-persistence-live-trading"><span>Signal <wbr/>Persistence (<wbr/>Live <wbr/>Trading)</span></a></li><li><ul><li><a href="#what-gets-saved"><span>What <wbr/>Gets <wbr/>Saved</span></a></li><li><a href="#crash-recovery"><span>Crash <wbr/>Recovery</span></a></li></ul></li><li><a href="#exit-condition-check-diagram"><span>Exit <wbr/>Condition <wbr/>Check <wbr/>Diagram</span></a></li><li><a href="#practical-example-full-lifecycle"><span>Practical <wbr/>Example: <wbr/>Full <wbr/>Lifecycle</span></a></li><li><a href="#next-steps"><span>Next <wbr/>Steps</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
