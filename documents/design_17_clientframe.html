<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/17_clientframe | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_17_clientframe.html">design/17_clientframe</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="clientframe" class="tsd-anchor"></a><h1 class="tsd-anchor-link">ClientFrame<a href="#clientframe" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><a id="purpose-and-scope" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Purpose and Scope<a href="#purpose-and-scope" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>ClientFrame</code> is responsible for generating timeframe arrays used in backtesting operations. It produces an ordered sequence of timestamps from a start date to an end date at specified intervals (e.g., 1m, 1h, 1d). These timestamps serve as the iteration points for the backtesting engine, allowing strategies to be evaluated at each discrete time step.</p>
<p>This document covers the implementation details of <code>ClientFrame</code>, its integration with the service orchestration layer, and the timeframe generation algorithm. For information about how timeframes are consumed during backtest execution, see <a href="design_29_backtest_execution_flow.html">Backtest Execution Flow</a>. For frame configuration and registration, see <a href="design_09_configuration_functions.html">Configuration Functions</a>.</p>
<a id="overview" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Overview<a href="#overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>In backtesting, strategies need to be evaluated at regular intervals across a historical date range. Rather than manually managing these timestamps, <code>ClientFrame</code> generates them programmatically based on three parameters:</p>
<ul>
<li><strong>startDate</strong>: Beginning of the backtest period</li>
<li><strong>endDate</strong>: End of the backtest period</li>
<li><strong>interval</strong>: Time spacing between evaluations (1m, 5m, 1h, etc.)</li>
</ul>
<p>The generated timeframe array is then consumed by <code>BacktestLogicPrivateService</code>, which iterates through each timestamp and triggers strategy evaluation.</p>
<a id="architecture-integration" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Architecture Integration<a href="#architecture-integration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/17_ClientFrame_0.svg" alt="Mermaid Diagram"></p>
<p><strong>ClientFrame Position in Service Hierarchy</strong></p>
<p><code>ClientFrame</code> sits at the bottom of the frame service stack. The orchestration flow is:</p>
<ol>
<li><code>BacktestLogicPrivateService</code> requests timeframe via <code>FrameGlobalService</code></li>
<li><code>FrameGlobalService</code> sets execution context and delegates to <code>FrameConnectionService</code></li>
<li><code>FrameConnectionService</code> creates or retrieves cached <code>ClientFrame</code> instance</li>
<li><code>ClientFrame</code> generates timestamp array and returns it upstream</li>
</ol>
<p>This layered approach separates configuration (schema layer), context management (global layer), and pure business logic (client layer).</p>
<a id="iframe-interface" class="tsd-anchor"></a><h2 class="tsd-anchor-link">IFrame Interface<a href="#iframe-interface" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>ClientFrame</code> implements the <code>IFrame</code> interface, which defines a single method:</p>
<pre><code class="typescript"><span class="hl-0">getTimeframe</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">Date</span><span class="hl-1">[]&gt;</span>
</code><button type="button">Copy</button></pre>

<p>The <code>symbol</code> parameter exists for API consistency but is not used in timeframe generation. This design allows future extensions where different symbols might require different timeframes.</p>
<a id="constructor-parameters" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Constructor Parameters<a href="#constructor-parameters" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>ClientFrame</code> receives an <code>IFrameParams</code> object containing:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>interval</code></td>
<td><code>FrameInterval</code></td>
<td>Time spacing between timestamps (1m, 5m, 1h, etc.)</td>
</tr>
<tr>
<td><code>startDate</code></td>
<td><code>Date</code></td>
<td>Beginning of backtest period</td>
</tr>
<tr>
<td><code>endDate</code></td>
<td><code>Date</code></td>
<td>End of backtest period</td>
</tr>
<tr>
<td><code>logger</code></td>
<td><code>ILoggerService</code></td>
<td>Logger instance for debug output</td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td><code>Partial&lt;IFrameCallbacks&gt;</code></td>
<td>Optional callbacks (e.g., <code>onTimeframe</code>)</td>
</tr>
</tbody>
</table>
<a id="supported-intervals" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Supported Intervals<a href="#supported-intervals" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>INTERVAL_MINUTES</code> constant maps each <code>FrameInterval</code> to its minute equivalent:</p>
<table>
<thead>
<tr>
<th>Interval</th>
<th>Minutes</th>
<th>Typical Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td>1m</td>
<td>1</td>
<td>High-frequency strategies</td>
</tr>
<tr>
<td>3m</td>
<td>3</td>
<td>Short-term strategies</td>
</tr>
<tr>
<td>5m</td>
<td>5</td>
<td>Intraday strategies</td>
</tr>
<tr>
<td>15m</td>
<td>15</td>
<td>Swing strategies</td>
</tr>
<tr>
<td>30m</td>
<td>30</td>
<td>Multi-hour strategies</td>
</tr>
<tr>
<td>1h</td>
<td>60</td>
<td>Hourly evaluation</td>
</tr>
<tr>
<td>2h</td>
<td>120</td>
<td>2-hour evaluation</td>
</tr>
<tr>
<td>4h</td>
<td>240</td>
<td>4-hour evaluation</td>
</tr>
<tr>
<td>6h</td>
<td>360</td>
<td>6-hour evaluation</td>
</tr>
<tr>
<td>8h</td>
<td>480</td>
<td>8-hour evaluation</td>
</tr>
<tr>
<td>12h</td>
<td>720</td>
<td>Daily boundary tracking</td>
</tr>
<tr>
<td>1d</td>
<td>1440</td>
<td>Daily strategies</td>
</tr>
<tr>
<td>3d</td>
<td>4320</td>
<td>Multi-day strategies</td>
</tr>
</tbody>
</table>
<a id="timeframe-generation-algorithm" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Timeframe Generation Algorithm<a href="#timeframe-generation-algorithm" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/17_ClientFrame_1.svg" alt="Mermaid Diagram"></p>
<p><strong>Algorithm Steps</strong></p>
<p>The <code>GET_TIMEFRAME_FN</code> function <a href="">src/client/ClientFrame.ts:37-62</a> performs the following steps:</p>
<ol>
<li><strong>Logging</strong>: Debug log the request with symbol</li>
<li><strong>Parameter Extraction</strong>: Extract <code>interval</code>, <code>startDate</code>, <code>endDate</code> from <code>params</code></li>
<li><strong>Interval Lookup</strong>: Map <code>interval</code> to minutes using <code>INTERVAL_MINUTES</code></li>
<li><strong>Validation</strong>: Throw error if interval is unknown</li>
<li><strong>Initialization</strong>: Create empty array and set <code>currentDate</code> to <code>startDate</code></li>
<li><strong>Iteration Loop</strong>: While <code>currentDate &lt;= endDate</code>:
<ul>
<li>Clone <code>currentDate</code> and push to array</li>
<li>Increment <code>currentDate</code> by <code>intervalMinutes * 60 * 1000</code> milliseconds</li>
</ul>
</li>
<li><strong>Callback Invocation</strong>: If <code>onTimeframe</code> callback exists, invoke it</li>
<li><strong>Return</strong>: Return generated timeframe array</li>
</ol>
<a id="singleshot-caching-pattern" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Singleshot Caching Pattern<a href="#singleshot-caching-pattern" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>getTimeframe</code> method uses the <code>singleshot</code> pattern from <code>functools-kit</code>:</p>
<pre><code class="typescript"><span class="hl-4">public</span><span class="hl-1"> </span><span class="hl-4">getTimeframe</span><span class="hl-1"> = </span><span class="hl-0">singleshot</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">): </span><span class="hl-11">Promise</span><span class="hl-1">&lt;</span><span class="hl-11">Date</span><span class="hl-1">[]&gt; </span><span class="hl-6">=&gt;</span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">GET_TIMEFRAME_FN</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-6">this</span><span class="hl-1">)</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Caching Behavior</strong></p>
<p>The <code>singleshot</code> decorator ensures that:</p>
<ul>
<li>First call to <code>getTimeframe(symbol)</code> executes <code>GET_TIMEFRAME_FN</code> and caches the result</li>
<li>Subsequent calls return the cached value without re-execution</li>
<li>Cache key is the <code>symbol</code> parameter</li>
</ul>
<p>This optimization prevents redundant timeframe generation when multiple components request the same symbol's timeframe. Since timeframes are deterministic (same inputs always produce same output), caching is safe and improves performance.</p>
<a id="callback-system" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Callback System<a href="#callback-system" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>IFrameCallbacks</code> interface provides hooks for observing timeframe generation:</p>
<pre><code class="typescript"><span class="hl-4">callbacks</span><span class="hl-1">?: {</span><br/><span class="hl-1">  onTimeframe?</span><span class="hl-4">:</span><span class="hl-1"> (</span><br/><span class="hl-1">    </span><span class="hl-4">timeframes</span><span class="hl-1">: </span><span class="hl-11">Date</span><span class="hl-1">[],</span><br/><span class="hl-1">    </span><span class="hl-4">startDate</span><span class="hl-1">: </span><span class="hl-11">Date</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">endDate</span><span class="hl-1">: </span><span class="hl-11">Date</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-11">FrameInterval</span><br/><span class="hl-1">  ) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-6">void</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Usage Scenarios</strong></p>
<ul>
<li><strong>Validation</strong>: Verify expected number of timestamps</li>
<li><strong>Logging</strong>: Track timeframe size for performance monitoring</li>
<li><strong>Testing</strong>: Assert correct timestamp spacing in unit tests</li>
</ul>
<p>The callback is invoked after timeframe generation completes <a href="">src/client/ClientFrame.ts:57-59</a>.</p>
<a id="integration-with-backtest-flow" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Integration with Backtest Flow<a href="#integration-with-backtest-flow" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/17_ClientFrame_2.svg" alt="Mermaid Diagram"></p>
<p><strong>Backtest Orchestration</strong></p>
<p><code>BacktestLogicPrivateService</code> uses the timeframe as the outer loop for backtesting:</p>
<ol>
<li>Request timeframe via <code>FrameGlobalService.getTimeframe(symbol)</code></li>
<li>Receive array of timestamps</li>
<li>For each timestamp:
<ul>
<li>Set execution context to timestamp</li>
<li>Trigger strategy evaluation</li>
<li>Process signals</li>
</ul>
</li>
</ol>
<p>The timeframe array is generated once and reused for the entire backtest run, thanks to singleshot caching.</p>
<a id="memory-efficiency-considerations" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Memory Efficiency Considerations<a href="#memory-efficiency-considerations" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><strong>Array Size Calculation</strong></p>
<p>For a 1-year backtest with 1m intervals:</p>
<ul>
<li>Days: 365</li>
<li>Minutes per day: 1440</li>
<li>Total timestamps: ~525,600</li>
</ul>
<p>Each <code>Date</code> object is approximately 24 bytes in JavaScript. Total memory for timeframe array:</p>
<ul>
<li>525,600 Ã— 24 bytes = ~12 MB</li>
</ul>
<p><strong>Prototype Function Pattern</strong></p>
<p>The implementation uses a separate <code>GET_TIMEFRAME_FN</code> function instead of defining logic inline in the method <a href="">src/client/ClientFrame.ts:37-62</a>. This pattern:</p>
<ul>
<li>Defines the function once in memory</li>
<li>Shares the function across all <code>ClientFrame</code> instances</li>
<li>Reduces memory overhead when multiple frame instances exist</li>
</ul>
<p><strong>Alternative Approaches</strong></p>
<p>For extremely large backtests (e.g., 10+ years at 1m intervals), consider:</p>
<ul>
<li>Generator functions that yield timestamps on-demand</li>
<li>Chunked timeframe processing</li>
<li>Reducing interval granularity (e.g., 5m instead of 1m)</li>
</ul>
<p>However, for typical use cases (months to years of data at 1m-1h intervals), the current array-based approach provides optimal performance.</p>
<a id="comparison-with-clientexchange" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Comparison with ClientExchange<a href="#comparison-with-clientexchange" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Both <code>ClientFrame</code> and <code>ClientExchange</code> are client-layer components, but serve different purposes:</p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>ClientFrame</th>
<th>ClientExchange</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Purpose</strong></td>
<td>Generate timeframe for iteration</td>
<td>Fetch candle data for strategy evaluation</td>
</tr>
<tr>
<td><strong>Input</strong></td>
<td><code>startDate</code>, <code>endDate</code>, <code>interval</code></td>
<td><code>symbol</code>, <code>interval</code>, <code>limit</code></td>
</tr>
<tr>
<td><strong>Output</strong></td>
<td><code>Date[]</code></td>
<td><code>ICandleData[]</code></td>
</tr>
<tr>
<td><strong>Caching</strong></td>
<td>Singleshot (permanent)</td>
<td>No caching (each request fetches fresh data)</td>
</tr>
<tr>
<td><strong>Context Dependency</strong></td>
<td>Uses <code>startDate</code>/<code>endDate</code> from params</td>
<td>Uses <code>execution.context.when</code> for time reference</td>
</tr>
<tr>
<td><strong>Backtest Role</strong></td>
<td>Defines outer loop timestamps</td>
<td>Provides data for each timestamp</td>
</tr>
</tbody>
</table>
<p><code>ClientFrame</code> establishes <em>when</em> to evaluate, while <code>ClientExchange</code> provides <em>what data</em> to evaluate. Both are orchestrated by <code>BacktestLogicPrivateService</code>.</p>
<a id="error-handling" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Error Handling<a href="#error-handling" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The only error condition is an unknown interval:</p>
<pre><code class="typescript"><span class="hl-3">if</span><span class="hl-1"> (!</span><span class="hl-4">intervalMinutes</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-3">throw</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><span class="hl-2">`ClientFrame unknown interval: </span><span class="hl-6">${</span><span class="hl-4">interval</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>This error occurs if:</p>
<ul>
<li>An invalid <code>FrameInterval</code> is passed (should be caught by TypeScript)</li>
<li>The <code>INTERVAL_MINUTES</code> mapping is incomplete (developer error)</li>
</ul>
<p>Since <code>FrameInterval</code> is a type union, TypeScript prevents invalid intervals at compile time. The runtime check serves as a defensive safeguard.</p>
<a id="testing-considerations" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Testing Considerations<a href="#testing-considerations" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><strong>Unit Test Scenarios</strong></p>
<ol>
<li><strong>Basic Generation</strong>: Verify correct number of timestamps for known date ranges</li>
<li><strong>Interval Spacing</strong>: Assert timestamps are spaced by exact interval</li>
<li><strong>Boundary Conditions</strong>: Test when <code>startDate === endDate</code></li>
<li><strong>Multiple Intervals</strong>: Verify different intervals produce correct spacing</li>
<li><strong>Callback Invocation</strong>: Ensure <code>onTimeframe</code> is called with correct parameters</li>
<li><strong>Caching</strong>: Verify singleshot prevents re-execution</li>
<li><strong>Unknown Interval</strong>: Assert error thrown for invalid intervals</li>
</ol>
<p><strong>Example Test Structure</strong></p>
<pre><code class="typescript"><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&#39;ClientFrame&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">it</span><span class="hl-1">(</span><span class="hl-2">&#39;generates correct timestamps for 1m interval&#39;</span><span class="hl-1">, </span><span class="hl-6">async</span><span class="hl-1"> () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">frame</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">ClientFrame</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&#39;1m&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&#39;2024-01-01T00:00:00Z&#39;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&#39;2024-01-01T00:05:00Z&#39;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-4">logger:</span><span class="hl-1"> </span><span class="hl-4">mockLogger</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">timeframe</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">frame</span><span class="hl-1">.</span><span class="hl-0">getTimeframe</span><span class="hl-1">(</span><span class="hl-2">&#39;BTCUSDT&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-4">timeframe</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1">).</span><span class="hl-0">toBe</span><span class="hl-1">(</span><span class="hl-8">6</span><span class="hl-1">); </span><span class="hl-5">// 00:00, 00:01, 00:02, 00:03, 00:04, 00:05</span><br/><span class="hl-1">    </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-4">timeframe</span><span class="hl-1">[</span><span class="hl-8">1</span><span class="hl-1">].</span><span class="hl-0">getTime</span><span class="hl-1">() - </span><span class="hl-4">timeframe</span><span class="hl-1">[</span><span class="hl-8">0</span><span class="hl-1">].</span><span class="hl-0">getTime</span><span class="hl-1">()).</span><span class="hl-0">toBe</span><span class="hl-1">(</span><span class="hl-8">60_000</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="configuration-example" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Configuration Example<a href="#configuration-example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Frames are registered via <code>addFrame</code> in the configuration phase:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addFrame</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addFrame</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&#39;daily-2024&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&#39;1d&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&#39;2024-01-01&#39;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&#39;2024-12-31&#39;</span><span class="hl-1">),</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>This schema is stored in <code>FrameSchemaService</code> and later used by <code>FrameConnectionService</code> to instantiate <code>ClientFrame</code> with the specified parameters.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#clientframe"><span>Client<wbr/>Frame</span></a><ul><li><a href="#purpose-and-scope"><span>Purpose and <wbr/>Scope</span></a></li><li><a href="#overview"><span>Overview</span></a></li><li><a href="#architecture-integration"><span>Architecture <wbr/>Integration</span></a></li><li><a href="#iframe-interface"><span>IFrame <wbr/>Interface</span></a></li><li><a href="#constructor-parameters"><span>Constructor <wbr/>Parameters</span></a></li><li><a href="#supported-intervals"><span>Supported <wbr/>Intervals</span></a></li><li><a href="#timeframe-generation-algorithm"><span>Timeframe <wbr/>Generation <wbr/>Algorithm</span></a></li><li><a href="#singleshot-caching-pattern"><span>Singleshot <wbr/>Caching <wbr/>Pattern</span></a></li><li><a href="#callback-system"><span>Callback <wbr/>System</span></a></li><li><a href="#integration-with-backtest-flow"><span>Integration with <wbr/>Backtest <wbr/>Flow</span></a></li><li><a href="#memory-efficiency-considerations"><span>Memory <wbr/>Efficiency <wbr/>Considerations</span></a></li><li><a href="#comparison-with-clientexchange"><span>Comparison with <wbr/>Client<wbr/>Exchange</span></a></li><li><a href="#error-handling"><span>Error <wbr/>Handling</span></a></li><li><a href="#testing-considerations"><span>Testing <wbr/>Considerations</span></a></li><li><a href="#configuration-example"><span>Configuration <wbr/>Example</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
