<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/39_clientoptimizer | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_39_clientoptimizer.html">design/39_clientoptimizer</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="clientoptimizer" class="tsd-anchor"></a><h1 class="tsd-anchor-link">ClientOptimizer<a href="#clientoptimizer" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><a id="purpose-and-scope" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Purpose and Scope<a href="#purpose-and-scope" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>ClientOptimizer</code> is the core implementation class for AI-driven strategy generation within the backtest-kit framework. It orchestrates data collection from multiple sources, builds conversation history for Large Language Models (LLMs), and generates executable trading strategy code. This class implements the <code>IOptimizer</code> interface and operates without dependency injection, making it a pure business logic component.</p>
<p>For information about the optimizer schema configuration and registration, see <a href="design_31_optimizer_schemas.html">5.7 - Optimizer Schemas</a>. For the public API used to invoke optimizer operations, see <a href="design_90_ai-powered_strategy_optimization.html">16.5 - AI-Powered Strategy Optimization</a>. For the template system used to generate code, see <a href="design_94_strategy_code_generation.html">16.5.4 - Strategy Code Generation</a>.</p>
<hr>
<a id="core-concepts" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Core Concepts<a href="#core-concepts" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="data-sources-and-pagination" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Data Sources and Pagination<a href="#data-sources-and-pagination" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Data sources provide the training data that feeds into the LLM conversation. Each source must implement the <code>IOptimizerSourceFn</code> interface, which supports pagination through <code>limit</code> and <code>offset</code> parameters. Sources can be either simple functions or full configuration objects with custom message formatters.</p>
<p><img src="../media/39_ClientOptimizer_0.svg" alt="Mermaid Diagram"></p>
<p><strong>Data Flow:</strong></p>
<ol>
<li><code>fetch()</code> retrieves paginated data with <code>limit=25</code> (ITERATION_LIMIT)</li>
<li><code>iterateDocuments()</code> handles automatic pagination</li>
<li><code>distinctDocuments()</code> deduplicates by <code>data.id</code></li>
<li>Custom or default formatters convert data to messages</li>
</ol>
<a id="training-ranges" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Training Ranges<a href="#training-ranges" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Training ranges (<code>IOptimizerRange[]</code>) define time periods for data collection. Each range generates a separate strategy variant, allowing the LLM to learn from different market conditions. The optimizer iterates through all ranges sequentially, building a complete conversation history for each.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>startDate</code></td>
<td><code>Date</code></td>
<td>Start of training period (inclusive)</td>
</tr>
<tr>
<td><code>endDate</code></td>
<td><code>Date</code></td>
<td>End of training period (inclusive)</td>
</tr>
<tr>
<td><code>note</code></td>
<td><code>string?</code></td>
<td>Optional description (e.g., &quot;Bull market Q1&quot;)</td>
</tr>
</tbody>
</table>
<p>Each training range produces one strategy variant. All variants are compared using the Walker mode on the test range.</p>
<a id="message-history" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Message History<a href="#message-history" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Message history follows the standard LLM conversation format with three roles: <code>system</code>, <code>user</code>, and <code>assistant</code>. For each data source within each training range, the optimizer appends a user-assistant message pair. This builds context progressively across all sources.</p>
<p><img src="../media/39_ClientOptimizer_1.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="data-collection-pipeline" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Data Collection Pipeline<a href="#data-collection-pipeline" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>getData()</code> method orchestrates the entire data collection pipeline, building strategy metadata with full conversation context.</p>
<p><img src="../media/39_ClientOptimizer_2.svg" alt="Mermaid Diagram"></p>
<a id="source-processing" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Source Processing<a href="#source-processing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Sources are processed sequentially to maintain conversation order. The type of source determines which formatters are used:</p>
<p><strong>Function Source:</strong></p>
<ul>
<li>Uses <code>DEFAULT_USER_FN</code> → delegates to <code>template.getUserMessage()</code></li>
<li>Uses <code>DEFAULT_ASSISTANT_FN</code> → delegates to <code>template.getAssistantMessage()</code></li>
<li>Source name defaults to <code>&quot;unknown&quot;</code></li>
</ul>
<p><strong>Object Source:</strong></p>
<ul>
<li>Uses <code>source.user()</code> if provided, otherwise defaults</li>
<li>Uses <code>source.assistant()</code> if provided, otherwise defaults</li>
<li>Uses <code>source.name</code> for identification</li>
</ul>
<a id="pagination-and-deduplication" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Pagination and Deduplication<a href="#pagination-and-deduplication" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>RESOLVE_PAGINATION_FN</code> helper handles pagination automatically using <code>functools-kit</code> utilities:</p>
<table>
<thead>
<tr>
<th>Step</th>
<th>Function</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><code>iterateDocuments()</code></td>
<td>Creates async iterator with automatic pagination</td>
</tr>
<tr>
<td>2</td>
<td><code>distinctDocuments()</code></td>
<td>Deduplicates by <code>data.id</code> field</td>
</tr>
<tr>
<td>3</td>
<td><code>resolveDocuments()</code></td>
<td>Resolves iterator to array</td>
</tr>
</tbody>
</table>
<p><strong>Pagination Parameters:</strong></p>
<ul>
<li><code>limit</code>: 25 (ITERATION_LIMIT constant)</li>
<li><code>offset</code>: Automatically incremented (page * limit)</li>
</ul>
<a id="message-formatting" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Message Formatting<a href="#message-formatting" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Message formatting converts raw data into LLM-readable text. The default formatters call template methods, but can be overridden per-source:</p>
<pre><code class="typescript"><span class="hl-0">// Default behavior (delegates to template)</span><br/><span class="hl-8">DEFAULT_USER_FN</span><span class="hl-2"> → </span><span class="hl-6">template</span><span class="hl-2">.</span><span class="hl-1">getUserMessage</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">, </span><span class="hl-6">name</span><span class="hl-2">)</span><br/><span class="hl-8">DEFAULT_ASSISTANT_FN</span><span class="hl-2"> → </span><span class="hl-6">template</span><span class="hl-2">.</span><span class="hl-1">getAssistantMessage</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">, </span><span class="hl-6">name</span><span class="hl-2">)</span><br/><br/><span class="hl-0">// Custom behavior (per-source)</span><br/><span class="hl-6">source</span><span class="hl-2">.</span><span class="hl-1">user</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">, </span><span class="hl-6">name</span><span class="hl-2">) → </span><span class="hl-6">custom</span><span class="hl-2"> </span><span class="hl-6">formatted</span><span class="hl-2"> </span><span class="hl-6">string</span><br/><span class="hl-6">source</span><span class="hl-2">.</span><span class="hl-1">assistant</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">, </span><span class="hl-6">name</span><span class="hl-2">) → </span><span class="hl-6">custom</span><span class="hl-2"> </span><span class="hl-6">formatted</span><span class="hl-2"> </span><span class="hl-6">string</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="code-generation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Code Generation<a href="#code-generation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>getCode()</code> method generates complete executable strategy files by assembling multiple template sections.</p>
<p><img src="../media/39_ClientOptimizer_3.svg" alt="Mermaid Diagram"></p>
<a id="code-assembly-process" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Code Assembly Process<a href="#code-assembly-process" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The code generation follows a strict nine-section structure:</p>
<table>
<thead>
<tr>
<th>Order</th>
<th>Template Method</th>
<th>Purpose</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><code>getTopBanner()</code></td>
<td>Shebang, imports, constants</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td><code>getJsonDumpTemplate()</code></td>
<td>Debug output helper</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td><code>getTextTemplate()</code></td>
<td>LLM text generation</td>
<td>1</td>
</tr>
<tr>
<td>4</td>
<td><code>getJsonTemplate()</code></td>
<td>LLM structured output</td>
<td>1</td>
</tr>
<tr>
<td>5</td>
<td><code>getExchangeTemplate()</code></td>
<td>CCXT Binance integration</td>
<td>1</td>
</tr>
<tr>
<td>6</td>
<td><code>getFrameTemplate()</code></td>
<td>Training frames</td>
<td>N (rangeTrain.length)</td>
</tr>
<tr>
<td>7</td>
<td><code>getFrameTemplate()</code></td>
<td>Test frame</td>
<td>1</td>
</tr>
<tr>
<td>8</td>
<td><code>getStrategyTemplate()</code></td>
<td>Strategy implementations</td>
<td>N (strategy count)</td>
</tr>
<tr>
<td>9</td>
<td><code>getWalkerTemplate()</code></td>
<td>Walker comparison</td>
<td>1</td>
</tr>
<tr>
<td>10</td>
<td><code>getLauncherTemplate()</code></td>
<td>Walker.background() + listeners</td>
<td>1</td>
</tr>
</tbody>
</table>
<p><strong>Naming Conventions:</strong></p>
<ul>
<li>Prefix: Random string via <code>CREATE_PREFIX_FN()</code> → e.g., <code>&quot;xyz123&quot;</code></li>
<li>Exchange: <code>{prefix}_exchange</code> → e.g., <code>&quot;xyz123_exchange&quot;</code></li>
<li>Train frames: <code>{prefix}_train_frame-{i}</code> → e.g., <code>&quot;xyz123_train_frame-1&quot;</code></li>
<li>Test frame: <code>{prefix}_test_frame</code> → e.g., <code>&quot;xyz123_test_frame&quot;</code></li>
<li>Strategies: <code>{prefix}_strategy-{i}</code> → e.g., <code>&quot;xyz123_strategy-1&quot;</code></li>
<li>Walker: <code>{prefix}_walker</code> → e.g., <code>&quot;xyz123_walker&quot;</code></li>
</ul>
<a id="template-integration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Template Integration<a href="#template-integration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Templates are provided via <code>IOptimizerParams.template</code>, which merges custom overrides with defaults from <code>OptimizerTemplateService</code>. Each template method returns a string of executable code:</p>
<p><img src="../media/39_ClientOptimizer_4.svg" alt="Mermaid Diagram"></p>
<p><strong>Template Method Signatures:</strong></p>
<pre><code class="typescript"><span class="hl-3">interface</span><span class="hl-2"> </span><span class="hl-11">IOptimizerTemplate</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-1">getTopBanner</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">): </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">string</span><span class="hl-2">&gt;;</span><br/><span class="hl-2">  </span><span class="hl-1">getExchangeTemplate</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">, </span><span class="hl-6">exchangeName</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">): </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">string</span><span class="hl-2">&gt;;</span><br/><span class="hl-2">  </span><span class="hl-1">getFrameTemplate</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">, </span><span class="hl-6">frameName</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">, </span><span class="hl-6">interval</span><span class="hl-2">: </span><span class="hl-11">CandleInterval</span><span class="hl-2">, </span><br/><span class="hl-2">                   </span><span class="hl-6">startDate</span><span class="hl-2">: </span><span class="hl-11">Date</span><span class="hl-2">, </span><span class="hl-6">endDate</span><span class="hl-2">: </span><span class="hl-11">Date</span><span class="hl-2">): </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">string</span><span class="hl-2">&gt;;</span><br/><span class="hl-2">  </span><span class="hl-1">getStrategyTemplate</span><span class="hl-2">(</span><span class="hl-6">strategyName</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">, </span><span class="hl-6">interval</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">, </span><br/><span class="hl-2">                     </span><span class="hl-6">prompt</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">): </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">string</span><span class="hl-2">&gt;;</span><br/><span class="hl-2">  </span><span class="hl-1">getWalkerTemplate</span><span class="hl-2">(</span><span class="hl-6">walkerName</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">, </span><span class="hl-6">exchangeName</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">, </span><br/><span class="hl-2">                   </span><span class="hl-6">frameName</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">, </span><span class="hl-6">strategies</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">[]): </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">string</span><span class="hl-2">&gt;;</span><br/><span class="hl-2">  </span><span class="hl-1">getLauncherTemplate</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">, </span><span class="hl-6">walkerName</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">): </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">string</span><span class="hl-2">&gt;;</span><br/><span class="hl-2">  </span><span class="hl-1">getTextTemplate</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">): </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">string</span><span class="hl-2">&gt;;</span><br/><span class="hl-2">  </span><span class="hl-1">getJsonTemplate</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">): </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">string</span><span class="hl-2">&gt;;</span><br/><span class="hl-2">  </span><span class="hl-1">getJsonDumpTemplate</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">): </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">string</span><span class="hl-2">&gt;;</span><br/><span class="hl-2">  </span><span class="hl-1">getUserMessage</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">: </span><span class="hl-11">any</span><span class="hl-2">[], </span><span class="hl-6">name</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">): </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">string</span><span class="hl-2">&gt;;</span><br/><span class="hl-2">  </span><span class="hl-1">getAssistantMessage</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">: </span><span class="hl-11">any</span><span class="hl-2">[], </span><span class="hl-6">name</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">): </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">string</span><span class="hl-2">&gt;;</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<a id="generated-code-structure" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Generated Code Structure<a href="#generated-code-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The generated <code>.mjs</code> file follows this structure:</p>
<pre><code><span class="hl-0">#!/usr/bin/env node</span><br/><br/><span class="hl-0">// 1. Imports: Ollama, ccxt, backtest-kit, fs, uuid</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">Ollama</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;ollama&quot;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> </span><span class="hl-6">ccxt</span><span class="hl-2"> </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;ccxt&quot;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">addExchange</span><span class="hl-2">, </span><span class="hl-6">addStrategy</span><span class="hl-2">, </span><span class="hl-6">addFrame</span><span class="hl-2">, </span><span class="hl-6">addWalker</span><span class="hl-2">, </span><span class="hl-6">Walker</span><span class="hl-2">, ... } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">WARN_KB</span><span class="hl-2"> = </span><span class="hl-7">100</span><span class="hl-2">;</span><br/><br/><span class="hl-0">// 2. Helper: dumpJson() - Debug output to ./dump/strategy/{id}/</span><br/><span class="hl-3">async</span><span class="hl-2"> </span><span class="hl-3">function</span><span class="hl-2"> </span><span class="hl-1">dumpJson</span><span class="hl-2">(</span><span class="hl-6">resultId</span><span class="hl-2">, </span><span class="hl-6">history</span><span class="hl-2">, </span><span class="hl-6">result</span><span class="hl-2">, </span><span class="hl-6">outputDir</span><span class="hl-2">) { ... }</span><br/><br/><span class="hl-0">// 3. Helper: text() - LLM text generation via Ollama</span><br/><span class="hl-3">async</span><span class="hl-2"> </span><span class="hl-3">function</span><span class="hl-2"> </span><span class="hl-1">text</span><span class="hl-2">(</span><span class="hl-6">messages</span><span class="hl-2">) { ... }</span><br/><br/><span class="hl-0">// 4. Helper: json() - LLM JSON generation with schema</span><br/><span class="hl-3">async</span><span class="hl-2"> </span><span class="hl-3">function</span><span class="hl-2"> </span><span class="hl-1">json</span><span class="hl-2">(</span><span class="hl-6">messages</span><span class="hl-2">) { ... }</span><br/><br/><span class="hl-0">// 5. Exchange: CCXT Binance integration</span><br/><span class="hl-1">addExchange</span><span class="hl-2">({ </span><span class="hl-6">exchangeName:</span><span class="hl-2"> </span><span class="hl-4">&quot;xyz123_exchange&quot;</span><span class="hl-2">, </span><span class="hl-6">getCandles</span><span class="hl-2">, </span><span class="hl-6">formatPrice</span><span class="hl-2">, </span><span class="hl-6">formatQuantity</span><span class="hl-2"> });</span><br/><br/><span class="hl-0">// 6-7. Frames: Training and testing periods</span><br/><span class="hl-1">addFrame</span><span class="hl-2">({ </span><span class="hl-6">frameName:</span><span class="hl-2"> </span><span class="hl-4">&quot;xyz123_train_frame-1&quot;</span><span class="hl-2">, </span><span class="hl-6">interval:</span><span class="hl-2"> </span><span class="hl-4">&quot;1m&quot;</span><span class="hl-2">, </span><span class="hl-6">startDate</span><span class="hl-2">, </span><span class="hl-6">endDate</span><span class="hl-2"> });</span><br/><span class="hl-1">addFrame</span><span class="hl-2">({ </span><span class="hl-6">frameName:</span><span class="hl-2"> </span><span class="hl-4">&quot;xyz123_train_frame-2&quot;</span><span class="hl-2">, </span><span class="hl-6">interval:</span><span class="hl-2"> </span><span class="hl-4">&quot;1m&quot;</span><span class="hl-2">, </span><span class="hl-6">startDate</span><span class="hl-2">, </span><span class="hl-6">endDate</span><span class="hl-2"> });</span><br/><span class="hl-1">addFrame</span><span class="hl-2">({ </span><span class="hl-6">frameName:</span><span class="hl-2"> </span><span class="hl-4">&quot;xyz123_test_frame&quot;</span><span class="hl-2">, </span><span class="hl-6">interval:</span><span class="hl-2"> </span><span class="hl-4">&quot;1m&quot;</span><span class="hl-2">, </span><span class="hl-6">startDate</span><span class="hl-2">, </span><span class="hl-6">endDate</span><span class="hl-2"> });</span><br/><br/><span class="hl-0">// 8. Strategies: Multi-timeframe analysis with LLM</span><br/><span class="hl-1">addStrategy</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">strategyName:</span><span class="hl-2"> </span><span class="hl-4">&quot;xyz123_strategy-1&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">interval:</span><span class="hl-2"> </span><span class="hl-4">&quot;5m&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-1">getSignal</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-0">// Fetch 1h, 15m, 5m, 1m candles</span><br/><span class="hl-2">    </span><span class="hl-0">// Build messages with progressive context</span><br/><span class="hl-2">    </span><span class="hl-0">// Call json(messages) for signal</span><br/><span class="hl-2">    </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-6">result</span><span class="hl-2">;</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// 9. Walker: Strategy comparison</span><br/><span class="hl-1">addWalker</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">walkerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;xyz123_walker&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">exchangeName:</span><span class="hl-2"> </span><span class="hl-4">&quot;xyz123_exchange&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">frameName:</span><span class="hl-2"> </span><span class="hl-4">&quot;xyz123_test_frame&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">strategies:</span><span class="hl-2"> [</span><span class="hl-4">&quot;xyz123_strategy-1&quot;</span><span class="hl-2">, </span><span class="hl-4">&quot;xyz123_strategy-2&quot;</span><span class="hl-2">, ...]</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// 10. Launcher: Execute and listen</span><br/><span class="hl-6">Walker</span><span class="hl-2">.</span><span class="hl-1">background</span><span class="hl-2">(</span><span class="hl-4">&quot;BTCUSDT&quot;</span><span class="hl-2">, { </span><span class="hl-6">walkerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;xyz123_walker&quot;</span><span class="hl-2"> });</span><br/><span class="hl-1">listenSignalBacktest</span><span class="hl-2">(...);</span><br/><span class="hl-1">listenWalkerProgress</span><span class="hl-2">(...);</span><br/><span class="hl-1">listenWalkerComplete</span><span class="hl-2">(...);</span><br/><span class="hl-1">listenError</span><span class="hl-2">(...);</span>
</code><button>Copy</button></pre>

<hr>
<a id="progress-tracking" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Progress Tracking<a href="#progress-tracking" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>ClientOptimizer</code> emits progress events during data collection via the <code>onProgress</code> callback provided in the constructor. Progress tracks source processing, not code generation.</p>
<p><img src="../media/39_ClientOptimizer_5.svg" alt="Mermaid Diagram"></p>
<p><strong>Progress Contract Structure:</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>optimizerName</code></td>
<td><code>string</code></td>
<td>Unique optimizer identifier</td>
</tr>
<tr>
<td><code>symbol</code></td>
<td><code>string</code></td>
<td>Trading pair being processed</td>
</tr>
<tr>
<td><code>totalSources</code></td>
<td><code>number</code></td>
<td>Total number of sources to process</td>
</tr>
<tr>
<td><code>processedSources</code></td>
<td><code>number</code></td>
<td>Number of sources completed</td>
</tr>
<tr>
<td><code>progress</code></td>
<td><code>number</code></td>
<td>Decimal 0.0-1.0 (percentage / 100)</td>
</tr>
</tbody>
</table>
<p><strong>Calculation:</strong></p>
<pre><code><span class="hl-6">totalSources</span><span class="hl-2"> = </span><span class="hl-6">rangeTrain</span><span class="hl-2">.</span><span class="hl-6">length</span><span class="hl-2"> × </span><span class="hl-6">source</span><span class="hl-2">.</span><span class="hl-6">length</span><br/><span class="hl-6">progress</span><span class="hl-2"> = </span><span class="hl-6">totalSources</span><span class="hl-2"> &gt; </span><span class="hl-7">0</span><span class="hl-2"> ? </span><span class="hl-6">processedSources</span><span class="hl-2"> / </span><span class="hl-6">totalSources</span><span class="hl-2"> : </span><span class="hl-7">0</span>
</code><button>Copy</button></pre>

<p><strong>Emission Points:</strong></p>
<ol>
<li>At the start of each source processing (before fetch)</li>
<li>After all sources complete (progress = 1.0)</li>
</ol>
<hr>
<a id="lifecycle-callbacks" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Lifecycle Callbacks<a href="#lifecycle-callbacks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><code>IOptimizerCallbacks</code> provides hooks for monitoring and validating optimizer operations. All callbacks are optional and async-compatible.</p>
<p><img src="../media/39_ClientOptimizer_6.svg" alt="Mermaid Diagram"></p>
<p><strong>Callback Signatures:</strong></p>
<table>
<thead>
<tr>
<th>Callback</th>
<th>Parameters</th>
<th>When Called</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>onSourceData</code></td>
<td><code>symbol, sourceName, data, startDate, endDate</code></td>
<td>After each source fetch</td>
</tr>
<tr>
<td><code>onData</code></td>
<td><code>symbol, strategyData</code></td>
<td>After all ranges processed</td>
</tr>
<tr>
<td><code>onCode</code></td>
<td><code>symbol, code</code></td>
<td>After code generation</td>
</tr>
<tr>
<td><code>onDump</code></td>
<td><code>symbol, filepath</code></td>
<td>After file write</td>
</tr>
</tbody>
</table>
<p><strong>Example Usage:</strong></p>
<pre><code class="typescript"><span class="hl-1">addOptimizer</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;my-optimizer&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">callbacks:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-1">onSourceData</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">name</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">, </span><span class="hl-6">start</span><span class="hl-2">, </span><span class="hl-6">end</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Fetched </span><span class="hl-3">${</span><span class="hl-6">data</span><span class="hl-9">.</span><span class="hl-6">length</span><span class="hl-3">}</span><span class="hl-4"> rows from </span><span class="hl-3">${</span><span class="hl-6">name</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-1">onData</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">strategies</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Generated </span><span class="hl-3">${</span><span class="hl-6">strategies</span><span class="hl-9">.</span><span class="hl-6">length</span><span class="hl-3">}</span><span class="hl-4"> strategy variants`</span><span class="hl-2">);</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-1">onCode</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">code</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Generated </span><span class="hl-3">${</span><span class="hl-6">code</span><span class="hl-9">.</span><span class="hl-6">length</span><span class="hl-3">}</span><span class="hl-4"> bytes of code`</span><span class="hl-2">);</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-1">onDump</span><span class="hl-6">:</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">filepath</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Saved to </span><span class="hl-3">${</span><span class="hl-6">filepath</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">    }</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="internal-implementation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Internal Implementation<a href="#internal-implementation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="constructor-and-dependencies" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Constructor and Dependencies<a href="#constructor-and-dependencies" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/39_ClientOptimizer_7.svg" alt="Mermaid Diagram"></p>
<p><strong>Constructor:</strong></p>
<pre><code class="typescript"><span class="hl-1">constructor</span><span class="hl-2">(</span><br/><span class="hl-2">  </span><span class="hl-6">readonly</span><span class="hl-2"> </span><span class="hl-6">params</span><span class="hl-2">: </span><span class="hl-6">IOptimizerParams</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">readonly</span><span class="hl-2"> </span><span class="hl-6">onProgress</span><span class="hl-2">: (</span><span class="hl-6">progress</span><span class="hl-2">: </span><span class="hl-11">ProgressOptimizerContract</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-3">void</span><br/><span class="hl-2">)</span>
</code><button type="button">Copy</button></pre>

<p><strong>Dependency Injection:</strong></p>
<ul>
<li><code>params.logger</code>: For debug and info logging</li>
<li><code>params.template</code>: For code generation (merged defaults + custom)</li>
<li><code>params.callbacks</code>: For lifecycle hooks (optional)</li>
<li><code>onProgress</code>: Injected by <code>OptimizerConnectionService</code> → emits to <code>progressOptimizerEmitter</code></li>
</ul>
<a id="main-methods" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Main Methods<a href="#main-methods" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The three public methods delegate to internal helper functions for testability and code organization:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Delegates To</th>
<th>Return Type</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>getData(symbol)</code></td>
<td><code>GET_STRATEGY_DATA_FN(symbol, this)</code></td>
<td><code>Promise&lt;IOptimizerStrategy[]&gt;</code></td>
</tr>
<tr>
<td><code>getCode(symbol)</code></td>
<td><code>GET_STRATEGY_CODE_FN(symbol, this)</code></td>
<td><code>Promise&lt;string&gt;</code></td>
</tr>
<tr>
<td><code>dump(symbol, path?)</code></td>
<td><code>GET_STRATEGY_DUMP_FN(symbol, path, this)</code></td>
<td><code>Promise&lt;void&gt;</code></td>
</tr>
</tbody>
</table>
<p><strong>Internal Function Signatures:</strong></p>
<pre><code class="typescript"><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-1">GET_STRATEGY_DATA_FN</span><span class="hl-2"> = </span><span class="hl-3">async</span><span class="hl-2"> (</span><br/><span class="hl-2">  </span><span class="hl-6">symbol</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">self</span><span class="hl-2">: </span><span class="hl-11">ClientOptimizer</span><br/><span class="hl-2">): </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">IOptimizerStrategy</span><span class="hl-2">[]&gt; </span><span class="hl-3">=&gt;</span><span class="hl-2"> { ... }</span><br/><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-1">GET_STRATEGY_CODE_FN</span><span class="hl-2"> = </span><span class="hl-3">async</span><span class="hl-2"> (</span><br/><span class="hl-2">  </span><span class="hl-6">symbol</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">self</span><span class="hl-2">: </span><span class="hl-11">ClientOptimizer</span><br/><span class="hl-2">): </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">string</span><span class="hl-2">&gt; </span><span class="hl-3">=&gt;</span><span class="hl-2"> { ... }</span><br/><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-1">GET_STRATEGY_DUMP_FN</span><span class="hl-2"> = </span><span class="hl-3">async</span><span class="hl-2"> (</span><br/><span class="hl-2">  </span><span class="hl-6">symbol</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">path</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">self</span><span class="hl-2">: </span><span class="hl-11">ClientOptimizer</span><br/><span class="hl-2">): </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">void</span><span class="hl-2">&gt; </span><span class="hl-3">=&gt;</span><span class="hl-2"> { ... }</span>
</code><button type="button">Copy</button></pre>

<a id="helper-functions" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Helper Functions<a href="#helper-functions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Four module-level helper functions support the main operations:</p>
<p><strong>1. RESOLVE_PAGINATION_FN</strong></p>
<ul>
<li>Purpose: Fetch all pages from a source with deduplication</li>
<li>Uses: <code>iterateDocuments()</code>, <code>distinctDocuments()</code>, <code>resolveDocuments()</code> from <code>functools-kit</code></li>
<li>Returns: <code>Promise&lt;Data[]&gt;</code></li>
</ul>
<p><strong>2. DEFAULT_USER_FN</strong></p>
<ul>
<li>Purpose: Default user message formatter</li>
<li>Delegates to: <code>template.getUserMessage()</code></li>
<li>Returns: <code>Promise&lt;string&gt;</code></li>
</ul>
<p><strong>3. DEFAULT_ASSISTANT_FN</strong></p>
<ul>
<li>Purpose: Default assistant message formatter</li>
<li>Delegates to: <code>template.getAssistantMessage()</code></li>
<li>Returns: <code>Promise&lt;string&gt;</code></li>
</ul>
<p><strong>4. CREATE_PREFIX_FN</strong></p>
<ul>
<li>Purpose: Generate random prefix for code entity names</li>
<li>Algorithm: <code>(Math.random() + 1).toString(36).substring(7)</code></li>
<li>Returns: <code>string</code> (e.g., <code>&quot;xyz123&quot;</code>)</li>
</ul>
<p><strong>Constants:</strong></p>
<ul>
<li><code>ITERATION_LIMIT = 25</code>: Pagination page size</li>
<li><code>DEFAULT_SOURCE_NAME = &quot;unknown&quot;</code>: Fallback source name</li>
</ul>
<hr>
<a id="usage-patterns" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage Patterns<a href="#usage-patterns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="basic-strategy-generation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Basic Strategy Generation<a href="#basic-strategy-generation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">addOptimizer</span><span class="hl-2">, </span><span class="hl-6">Optimizer</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-0">// 1. Register optimizer</span><br/><span class="hl-1">addOptimizer</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;momentum-strategy&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">rangeTrain:</span><span class="hl-2"> [</span><br/><span class="hl-2">    { </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2024-01-01&quot;</span><span class="hl-2">), </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2024-03-31&quot;</span><span class="hl-2">) },</span><br/><span class="hl-2">    { </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2024-04-01&quot;</span><span class="hl-2">), </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2024-06-30&quot;</span><span class="hl-2">) }</span><br/><span class="hl-2">  ],</span><br/><span class="hl-2">  </span><span class="hl-6">rangeTest:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2024-07-01&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">    </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2024-09-30&quot;</span><span class="hl-2">)</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">  </span><span class="hl-6">source:</span><span class="hl-2"> [</span><br/><span class="hl-2">    </span><span class="hl-3">async</span><span class="hl-2"> ({ </span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">startDate</span><span class="hl-2">, </span><span class="hl-6">endDate</span><span class="hl-2">, </span><span class="hl-6">limit</span><span class="hl-2">, </span><span class="hl-6">offset</span><span class="hl-2"> }) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-0">// Fetch historical candles</span><br/><span class="hl-2">      </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">getCandles</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-4">&quot;1h&quot;</span><span class="hl-2">, </span><span class="hl-6">startDate</span><span class="hl-2">, </span><span class="hl-6">limit</span><span class="hl-2">);</span><br/><span class="hl-2">    }</span><br/><span class="hl-2">  ],</span><br/><span class="hl-2">  </span><span class="hl-1">getPrompt</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">messages</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">&quot;Generate momentum-based trading signals...&quot;</span><span class="hl-2">;</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// 2. Generate strategy code</span><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">code</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">Optimizer</span><span class="hl-2">.</span><span class="hl-1">getCode</span><span class="hl-2">(</span><span class="hl-4">&quot;BTCUSDT&quot;</span><span class="hl-2">, {</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;momentum-strategy&quot;</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// 3. Save to file</span><br/><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">Optimizer</span><span class="hl-2">.</span><span class="hl-1">dump</span><span class="hl-2">(</span><span class="hl-4">&quot;BTCUSDT&quot;</span><span class="hl-2">, {</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;momentum-strategy&quot;</span><br/><span class="hl-2">}, </span><span class="hl-4">&quot;./strategies&quot;</span><span class="hl-2">);</span><br/><br/><span class="hl-0">// Output: ./strategies/momentum-strategy_BTCUSDT.mjs</span>
</code><button type="button">Copy</button></pre>

<a id="multi-source-with-custom-formatters" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Multi-Source with Custom Formatters<a href="#multi-source-with-custom-formatters" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-1">addOptimizer</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;multi-source&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">rangeTrain:</span><span class="hl-2"> [{ </span><span class="hl-6">startDate</span><span class="hl-2">, </span><span class="hl-6">endDate</span><span class="hl-2"> }],</span><br/><span class="hl-2">  </span><span class="hl-6">rangeTest:</span><span class="hl-2"> { </span><span class="hl-6">startDate</span><span class="hl-2">, </span><span class="hl-6">endDate</span><span class="hl-2"> },</span><br/><span class="hl-2">  </span><span class="hl-6">source:</span><span class="hl-2"> [</span><br/><span class="hl-2">    </span><span class="hl-0">// Source 1: Candles with custom formatting</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-6">name:</span><span class="hl-2"> </span><span class="hl-4">&quot;price-data&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-1">fetch</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">args</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-1">fetchCandles</span><span class="hl-2">(</span><span class="hl-6">args</span><span class="hl-2">),</span><br/><span class="hl-2">      </span><span class="hl-1">user</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">, </span><span class="hl-6">name</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">`Analyze these </span><span class="hl-3">${</span><span class="hl-6">data</span><span class="hl-9">.</span><span class="hl-6">length</span><span class="hl-3">}</span><span class="hl-4"> candles:</span><span class="hl-13">\n</span><span class="hl-3">${</span><span class="hl-8">JSON</span><span class="hl-9">.</span><span class="hl-1">stringify</span><span class="hl-9">(</span><span class="hl-6">data</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">;</span><br/><span class="hl-2">      },</span><br/><span class="hl-2">      </span><span class="hl-1">assistant</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> () </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-4">&quot;Price data analyzed&quot;</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">// Source 2: Indicators with default formatting</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-6">name:</span><span class="hl-2"> </span><span class="hl-4">&quot;indicators&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-1">fetch</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">args</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-1">fetchIndicators</span><span class="hl-2">(</span><span class="hl-6">args</span><span class="hl-2">)</span><br/><span class="hl-2">      </span><span class="hl-0">// Uses template.getUserMessage() and template.getAssistantMessage()</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">// Source 3: Function-only (uses defaults)</span><br/><span class="hl-2">    </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">args</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-1">fetchSentiment</span><span class="hl-2">(</span><span class="hl-6">args</span><span class="hl-2">)</span><br/><span class="hl-2">  ],</span><br/><span class="hl-2">  </span><span class="hl-1">getPrompt</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">messages</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-0">// messages contains 6 entries (3 sources × 2 messages)</span><br/><span class="hl-2">    </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-1">generatePromptFromMessages</span><span class="hl-2">(</span><span class="hl-6">messages</span><span class="hl-2">);</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="progress-monitoring" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Progress Monitoring<a href="#progress-monitoring" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">listenOptimizerProgress</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-1">listenOptimizerProgress</span><span class="hl-2">((</span><span class="hl-6">event</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`[</span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">optimizerName</span><span class="hl-3">}</span><span class="hl-4">] </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Progress: </span><span class="hl-3">${</span><span class="hl-9">(</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">progress</span><span class="hl-9"> </span><span class="hl-2">*</span><span class="hl-9"> </span><span class="hl-7">100</span><span class="hl-9">).</span><span class="hl-1">toFixed</span><span class="hl-9">(</span><span class="hl-7">1</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-4">%`</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Processed: </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">processedSources</span><span class="hl-3">}</span><span class="hl-4">/</span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">totalSources</span><span class="hl-3">}</span><span class="hl-4"> sources`</span><span class="hl-2">);</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">Optimizer</span><span class="hl-2">.</span><span class="hl-1">getData</span><span class="hl-2">(</span><span class="hl-4">&quot;BTCUSDT&quot;</span><span class="hl-2">, { </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;my-optimizer&quot;</span><span class="hl-2"> });</span><br/><span class="hl-0">// Emits progress events at:</span><br/><span class="hl-0">// - Start of each source (processedSources increments)</span><br/><span class="hl-0">// - End of all sources (progress = 1.0)</span>
</code><button type="button">Copy</button></pre>

<a id="template-customization" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Template Customization<a href="#template-customization" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-1">addOptimizer</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;custom-template&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">template:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-0">// Override specific template methods</span><br/><span class="hl-2">    </span><span class="hl-1">getStrategyTemplate</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">strategyName</span><span class="hl-2">, </span><span class="hl-6">interval</span><span class="hl-2">, </span><span class="hl-6">prompt</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">`</span><br/><span class="hl-4">addStrategy({</span><br/><span class="hl-4">  strategyName: &quot;</span><span class="hl-3">${</span><span class="hl-6">strategyName</span><span class="hl-3">}</span><span class="hl-4">&quot;,</span><br/><span class="hl-4">  interval: &quot;</span><span class="hl-3">${</span><span class="hl-6">interval</span><span class="hl-3">}</span><span class="hl-4">&quot;,</span><br/><span class="hl-4">  getSignal: async (symbol) =&gt; {</span><br/><span class="hl-4">    // Custom implementation</span><br/><span class="hl-4">    </span><span class="hl-3">${</span><span class="hl-6">prompt</span><span class="hl-3">}</span><br/><span class="hl-4">    return customAnalysis();</span><br/><span class="hl-4">  }</span><br/><span class="hl-4">});</span><br/><span class="hl-4">      `</span><span class="hl-2">.</span><span class="hl-1">trim</span><span class="hl-2">();</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">// Other methods use defaults from OptimizerTemplateService</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">  </span><span class="hl-0">// ... other config</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="lifecycle-callbacks-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Lifecycle Callbacks<a href="#lifecycle-callbacks-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-1">addOptimizer</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;monitored&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">callbacks:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-1">onSourceData</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">sourceName</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">, </span><span class="hl-6">start</span><span class="hl-2">, </span><span class="hl-6">end</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-0">// Log data collection</span><br/><span class="hl-2">      </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">logToDatabase</span><span class="hl-2">({</span><br/><span class="hl-2">        </span><span class="hl-6">symbol</span><span class="hl-2">,</span><br/><span class="hl-2">        </span><span class="hl-6">source:</span><span class="hl-2"> </span><span class="hl-6">sourceName</span><span class="hl-2">,</span><br/><span class="hl-2">        </span><span class="hl-6">rows:</span><span class="hl-2"> </span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-6">length</span><span class="hl-2">,</span><br/><span class="hl-2">        </span><span class="hl-6">timeRange:</span><span class="hl-2"> { </span><span class="hl-6">start</span><span class="hl-2">, </span><span class="hl-6">end</span><span class="hl-2"> }</span><br/><span class="hl-2">      });</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-1">onData</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">strategyData</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-0">// Validate generated strategies</span><br/><span class="hl-2">      </span><span class="hl-5">if</span><span class="hl-2"> (</span><span class="hl-6">strategyData</span><span class="hl-2">.</span><span class="hl-6">length</span><span class="hl-2"> === </span><span class="hl-7">0</span><span class="hl-2">) {</span><br/><span class="hl-2">        </span><span class="hl-5">throw</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Error</span><span class="hl-2">(</span><span class="hl-4">&quot;No strategies generated&quot;</span><span class="hl-2">);</span><br/><span class="hl-2">      }</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-1">onCode</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">code</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-0">// Analyze generated code</span><br/><span class="hl-2">      </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">size</span><span class="hl-2"> = </span><span class="hl-6">Buffer</span><span class="hl-2">.</span><span class="hl-1">byteLength</span><span class="hl-2">(</span><span class="hl-6">code</span><span class="hl-2">, </span><span class="hl-4">&quot;utf-8&quot;</span><span class="hl-2">);</span><br/><span class="hl-2">      </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Generated </span><span class="hl-3">${</span><span class="hl-6">size</span><span class="hl-3">}</span><span class="hl-4"> bytes for </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-1">onDump</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">filepath</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">      </span><span class="hl-0">// Post-process file</span><br/><span class="hl-2">      </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">runLinter</span><span class="hl-2">(</span><span class="hl-6">filepath</span><span class="hl-2">);</span><br/><span class="hl-2">    }</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">  </span><span class="hl-0">// ... other config</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#clientoptimizer"><span>Client<wbr/>Optimizer</span></a><ul><li><a href="#purpose-and-scope"><span>Purpose and <wbr/>Scope</span></a></li><li><a href="#core-concepts"><span>Core <wbr/>Concepts</span></a></li><li><ul><li><a href="#data-sources-and-pagination"><span>Data <wbr/>Sources and <wbr/>Pagination</span></a></li><li><a href="#training-ranges"><span>Training <wbr/>Ranges</span></a></li><li><a href="#message-history"><span>Message <wbr/>History</span></a></li></ul></li><li><a href="#data-collection-pipeline"><span>Data <wbr/>Collection <wbr/>Pipeline</span></a></li><li><ul><li><a href="#source-processing"><span>Source <wbr/>Processing</span></a></li><li><a href="#pagination-and-deduplication"><span>Pagination and <wbr/>Deduplication</span></a></li><li><a href="#message-formatting"><span>Message <wbr/>Formatting</span></a></li></ul></li><li><a href="#code-generation"><span>Code <wbr/>Generation</span></a></li><li><ul><li><a href="#code-assembly-process"><span>Code <wbr/>Assembly <wbr/>Process</span></a></li><li><a href="#template-integration"><span>Template <wbr/>Integration</span></a></li><li><a href="#generated-code-structure"><span>Generated <wbr/>Code <wbr/>Structure</span></a></li></ul></li><li><a href="#progress-tracking"><span>Progress <wbr/>Tracking</span></a></li><li><a href="#lifecycle-callbacks"><span>Lifecycle <wbr/>Callbacks</span></a></li><li><a href="#internal-implementation"><span>Internal <wbr/>Implementation</span></a></li><li><ul><li><a href="#constructor-and-dependencies"><span>Constructor and <wbr/>Dependencies</span></a></li><li><a href="#main-methods"><span>Main <wbr/>Methods</span></a></li><li><a href="#helper-functions"><span>Helper <wbr/>Functions</span></a></li></ul></li><li><a href="#usage-patterns"><span>Usage <wbr/>Patterns</span></a></li><li><ul><li><a href="#basic-strategy-generation"><span>Basic <wbr/>Strategy <wbr/>Generation</span></a></li><li><a href="#multi-source-with-custom-formatters"><span>Multi-<wbr/>Source with <wbr/>Custom <wbr/>Formatters</span></a></li><li><a href="#progress-monitoring"><span>Progress <wbr/>Monitoring</span></a></li><li><a href="#template-customization"><span>Template <wbr/>Customization</span></a></li><li><a href="#lifecycle-callbacks-1"><span>Lifecycle <wbr/>Callbacks</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
