<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/30_markdown-report-system | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_30_markdown-report-system.html">design/30_markdown-report-system</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="markdown-report-system" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Markdown Report System<a href="#markdown-report-system" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><a id="purpose-and-scope" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Purpose and Scope<a href="#purpose-and-scope" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The Markdown Report System provides comprehensive analytics and reporting capabilities for trading strategy execution. This system consists of 9 specialized markdown services that subscribe to event emitters, accumulate trading data, calculate statistical metrics, and generate human-readable markdown reports. Each service focuses on a specific aspect of strategy performance (backtest results, live trading, scheduled signals, strategy comparison, performance profiling, portfolio heatmaps, partial P/L tracking, risk rejections, and system configuration).</p>
<p>For information about the event system that feeds these reports, see <a href="design_05_event-driven-architecture.html">Event-Driven Architecture</a>. For statistics interface types exported from these services, see <a href="design_31_performance-statistics.html">Performance Statistics</a>.</p>
<hr>
<a id="system-architecture-overview" class="tsd-anchor"></a><h2 class="tsd-anchor-link">System Architecture Overview<a href="#system-architecture-overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/30-markdown-report-system_0.svg" alt="Mermaid Diagram"></p>
<p>The system implements a consistent <strong>ReportStorage Pattern</strong> across all 9 markdown services. Each service subscribes to specific event emitters, accumulates data in memoized storage instances, and provides three primary methods: <code>getData()</code> for retrieving statistics objects, <code>getReport()</code> for generating markdown strings, and <code>dump()</code> for saving reports to the filesystem.</p>
<hr>
<a id="markdown-service-catalog" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Markdown Service Catalog<a href="#markdown-service-catalog" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="service-overview-table" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Service Overview Table<a href="#service-overview-table" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Service</th>
<th>Event Source</th>
<th>Storage Key</th>
<th>MAX_EVENTS</th>
<th>Default Path</th>
<th>Primary Metric</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>BacktestMarkdownService</code></td>
<td><code>signalBacktestEmitter</code></td>
<td><code>symbol:strategyName</code></td>
<td>250</td>
<td><code>./dump/backtest</code></td>
<td>Closed signals only</td>
</tr>
<tr>
<td><code>LiveMarkdownService</code></td>
<td><code>signalLiveEmitter</code></td>
<td><code>symbol:strategyName</code></td>
<td>250</td>
<td><code>./dump/live</code></td>
<td>All tick types</td>
</tr>
<tr>
<td><code>ScheduleMarkdownService</code></td>
<td><code>signalEmitter</code></td>
<td><code>symbol:strategyName</code></td>
<td>250</td>
<td><code>./dump/schedule</code></td>
<td>Scheduled/cancelled</td>
</tr>
<tr>
<td><code>WalkerMarkdownService</code></td>
<td><code>walkerEmitter</code></td>
<td><code>walkerName</code></td>
<td>Unbounded</td>
<td><code>./dump/walker</code></td>
<td>Strategy comparison</td>
</tr>
<tr>
<td><code>PerformanceMarkdownService</code></td>
<td><code>performanceEmitter</code></td>
<td><code>symbol:strategyName</code></td>
<td>10000</td>
<td><code>./dump/performance</code></td>
<td>Execution metrics</td>
</tr>
<tr>
<td><code>HeatMarkdownService</code></td>
<td><code>signalEmitter</code></td>
<td><code>strategyName</code></td>
<td>250 per symbol</td>
<td><code>./dump/heatmap</code></td>
<td>Portfolio-wide stats</td>
</tr>
<tr>
<td><code>PartialMarkdownService</code></td>
<td><code>partialProfitSubject</code> + <code>partialLossSubject</code></td>
<td><code>symbol:strategyName</code></td>
<td>250</td>
<td><code>./dump/partial</code></td>
<td>Milestone events</td>
</tr>
<tr>
<td><code>RiskMarkdownService</code></td>
<td><code>riskSubject</code></td>
<td><code>symbol:strategyName</code></td>
<td>Unbounded</td>
<td><code>./dump/risk</code></td>
<td>Risk rejections</td>
</tr>
<tr>
<td><code>OutlineMarkdownService</code></td>
<td>N/A (direct query)</td>
<td>N/A</td>
<td>N/A</td>
<td><code>./dump/outline</code></td>
<td>System configuration</td>
</tr>
</tbody>
</table>
<hr>
<a id="reportstorage-pattern-architecture" class="tsd-anchor"></a><h2 class="tsd-anchor-link">ReportStorage Pattern Architecture<a href="#reportstorage-pattern-architecture" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/30-markdown-report-system_1.svg" alt="Mermaid Diagram"></p>
<a id="pattern-components" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Pattern Components<a href="#pattern-components" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>1. Service Initialization</strong></p>
<p>All markdown services use <code>singleshot</code> from <code>functools-kit</code> to ensure event subscription happens exactly once:</p>
<pre><code class="typescript"><span class="hl-4">protected</span><span class="hl-1"> </span><span class="hl-4">init</span><span class="hl-1"> = </span><span class="hl-0">singleshot</span><span class="hl-1">(</span><span class="hl-7">async</span><span class="hl-1"> () </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">loggerService</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;backtestMarkdownService init&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">signalBacktestEmitter</span><span class="hl-1">.</span><span class="hl-0">subscribe</span><span class="hl-1">(</span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">tick</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>2. Memoized Storage</strong></p>
<p>Services use <code>memoize</code> to create and cache <code>ReportStorage</code> instances per key (typically <code>symbol:strategyName</code>):</p>
<pre><code class="typescript"><span class="hl-4">private</span><span class="hl-1"> </span><span class="hl-4">getStorage</span><span class="hl-1"> = </span><span class="hl-0">memoize</span><span class="hl-1">&lt;(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">ReportStorage</span><span class="hl-1">&gt;(</span><br/><span class="hl-1">  ([</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">]) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-2">`</span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2">:</span><span class="hl-7">${</span><span class="hl-4">strategyName</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">,</span><br/><span class="hl-1">  () </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">ReportStorage</span><span class="hl-1">()</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>3. Event Accumulation</strong></p>
<p>The <code>ReportStorage</code> class maintains an internal event array with bounds checking:</p>
<pre><code class="typescript"><span class="hl-4">public</span><span class="hl-1"> </span><span class="hl-0">addSignal</span><span class="hl-1">(</span><span class="hl-4">data</span><span class="hl-1">: </span><span class="hl-4">IStrategyTickResultClosed</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_signalList</span><span class="hl-1">.</span><span class="hl-0">unshift</span><span class="hl-1">(</span><span class="hl-4">data</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Trim queue if exceeded MAX_EVENTS</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_signalList</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1"> &gt; </span><span class="hl-8">MAX_EVENTS</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_signalList</span><span class="hl-1">.</span><span class="hl-0">pop</span><span class="hl-1">();</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>4. Column-Based Table Generation</strong></p>
<p>Reports use column configurations to dynamically build markdown tables:</p>
<pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">Column</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">key</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">label</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">format</span><span class="hl-1">: (</span><span class="hl-4">data</span><span class="hl-1">: </span><span class="hl-13">IStrategyTickResultClosed</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">isVisible</span><span class="hl-1">: () </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Tables respect <code>CC_REPORT_SHOW_SIGNAL_NOTE</code> configuration for conditional column visibility.</p>
<hr>
<a id="event-flow-and-data-accumulation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Event Flow and Data Accumulation<a href="#event-flow-and-data-accumulation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/30-markdown-report-system_2.svg" alt="Mermaid Diagram"></p>
<a id="memory-management-strategy" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Memory Management Strategy<a href="#memory-management-strategy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Each markdown service implements bounded queues to prevent memory leaks:</p>
<ol>
<li><strong>MAX_EVENTS Constant</strong>: Defines maximum events per storage instance</li>
<li><strong>FIFO Queue</strong>: New events added to front with <code>unshift()</code>, old events removed from back with <code>pop()</code></li>
<li><strong>Per-Key Isolation</strong>: Each <code>symbol:strategyName</code> combination gets its own storage instance</li>
</ol>
<p><strong>Exception</strong>: <code>WalkerMarkdownService</code> and <code>RiskMarkdownService</code> do not enforce MAX_EVENTS bounds because they aggregate across strategy runs and need complete data.</p>
<hr>
<a id="statistics-calculation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Statistics Calculation<a href="#statistics-calculation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="backtest-and-live-statistics" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Backtest and Live Statistics<a href="#backtest-and-live-statistics" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Both <code>BacktestMarkdownService</code> and <code>LiveMarkdownService</code> calculate identical metrics:</p>
<p><img src="../media/30-markdown-report-system_3.svg" alt="Mermaid Diagram"></p>
<p><strong>Key Formulas:</strong></p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Formula</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Win Rate</td>
<td><code>(winCount / totalSignals) * 100</code></td>
<td>Percentage of profitable trades</td>
</tr>
<tr>
<td>Sharpe Ratio</td>
<td><code>avgPnl / stdDev</code></td>
<td>Risk-adjusted return</td>
</tr>
<tr>
<td>Annualized Sharpe</td>
<td><code>sharpeRatio * âˆš365</code></td>
<td>Yearly scaled Sharpe ratio</td>
</tr>
<tr>
<td>Certainty Ratio</td>
<td><code>avgWin / |avgLoss|</code></td>
<td>Average win to average loss ratio</td>
</tr>
<tr>
<td>Expected Yearly Returns</td>
<td><code>avgPnl * (365 / avgDurationDays)</code></td>
<td>Projected annual return</td>
</tr>
</tbody>
</table>
<p><strong>Safe Math</strong>: All statistics apply <code>isUnsafe()</code> checks to return <code>null</code> for <code>NaN</code>, <code>Infinity</code>, or invalid numeric values.</p>
<hr>
<a id="report-specific-implementations" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Report-Specific Implementations<a href="#report-specific-implementations" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="backtestmarkdownservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">BacktestMarkdownService<a href="#backtestmarkdownservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Purpose</strong>: Track closed signals from backtest execution, calculate performance statistics.</p>
<p><strong>Event Source</strong>: <code>signalBacktestEmitter</code> (filtered to <code>action === &quot;closed&quot;</code>)</p>
<p><strong>Storage Key</strong>: <code>symbol:strategyName</code></p>
<p><strong>Output Example</strong>:</p>
<pre><code class="markdown"># Backtest Report: my-strategy

| Signal ID | Symbol | Position | Open Price | Close Price | PNL (net) | Close Reason | Duration (min) |
|-----------|--------|----------|------------|-------------|-----------|--------------|----------------|
| abc-123   | BTCUSDT| LONG     | 50000 USD  | 52000 USD   | +3.60%    | take_profit  | 120            |

**Total signals:** 45
**Win rate:** 62.22% (28W / 17L) (higher is better)
**Average PNL:** +1.25% (higher is better)
**Sharpe Ratio:** 1.523 (higher is better)
</code><button type="button">Copy</button></pre>

<hr>
<a id="livemarkdownservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">LiveMarkdownService<a href="#livemarkdownservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Purpose</strong>: Track all tick events (idle, opened, active, closed) from live trading execution.</p>
<p><strong>Event Source</strong>: <code>signalLiveEmitter</code> (all action types)</p>
<p><strong>Storage Key</strong>: <code>symbol:strategyName</code></p>
<p><strong>Unique Features</strong>:</p>
<ul>
<li>Tracks idle events (replaces last idle if no opened/active events follow)</li>
<li>Tracks active events (replaces last active for same signalId)</li>
<li>Provides comprehensive live monitoring view</li>
</ul>
<p><strong>Output Example</strong>:</p>
<pre><code class="markdown"># Live Trading Report: my-strategy

| Timestamp | Action | Symbol | Signal ID | Position | Current Price | % to TP | % to SL |
|-----------|--------|--------|-----------|----------|---------------|---------|---------|
| 2024-... | ACTIVE | BTCUSDT| abc-123   | LONG     | 51500 USD     | +45.5%  | -12.3%  |
| 2024-... | OPENED | BTCUSDT| abc-123   | LONG     | 50000 USD     | N/A     | N/A     |
| 2024-... | IDLE   | BTCUSDT| N/A       | N/A      | 49800 USD     | N/A     | N/A     |

**Total events:** 123
**Closed signals:** 12
**Win rate:** 58.33%
</code><button type="button">Copy</button></pre>

<hr>
<a id="schedulemarkdownservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">ScheduleMarkdownService<a href="#schedulemarkdownservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Purpose</strong>: Track scheduled signals and their activation/cancellation status.</p>
<p><strong>Event Source</strong>: <code>signalEmitter</code> (filtered to <code>scheduled</code>, <code>opened</code>, <code>cancelled</code>)</p>
<p><strong>Storage Key</strong>: <code>symbol:strategyName</code></p>
<p><strong>Unique Logic</strong>: Only tracks opened signals that were previously scheduled (checks <code>scheduledAt !== pendingAt</code>)</p>
<p><strong>Statistics Computed</strong>:</p>
<ul>
<li><code>activationRate</code>: Percentage of scheduled signals that opened</li>
<li><code>cancellationRate</code>: Percentage of scheduled signals that cancelled</li>
<li><code>avgActivationTime</code>: Average wait time for successful activations</li>
<li><code>avgWaitTime</code>: Average wait time for cancelled signals</li>
</ul>
<hr>
<a id="walkermarkdownservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">WalkerMarkdownService<a href="#walkermarkdownservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Purpose</strong>: Aggregate backtest results across multiple strategies for comparison.</p>
<p><strong>Event Source</strong>: <code>walkerEmitter</code> (progress events from <code>WalkerLogicPrivateService</code>)</p>
<p><strong>Storage Key</strong>: <code>walkerName</code> (not per-symbol, aggregates all strategies)</p>
<p><strong>Unique Features</strong>:</p>
<ul>
<li>Unbounded storage (no MAX_EVENTS limit)</li>
<li>Tracks best strategy by metric value</li>
<li>Generates comparison table sorted by metric</li>
<li>Includes PNL table with all signals from all strategies</li>
</ul>
<p><strong>Output Structure</strong>:</p>
<pre><code class="markdown"># Walker Comparison Report: my-walker

**Best Strategy:** strategy-A
**Best sharpeRatio:** 2.15

## Top Strategies Comparison

| Rank | Strategy | sharpeRatio | Total Signals | Win Rate | Avg PNL |
|------|----------|-------------|---------------|----------|---------|
| 1    | strategy-A | 2.15      | 45            | 62.22%   | +1.25%  |
| 2    | strategy-B | 1.89      | 38            | 57.89%   | +0.98%  |

## All Signals (PNL Table)

| Strategy | Signal ID | Symbol | Position | PNL (net) | Close Reason |
|----------|-----------|--------|----------|-----------|--------------|
| ...      | ...       | ...    | ...      | ...       | ...          |
</code><button type="button">Copy</button></pre>

<hr>
<a id="performancemarkdownservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">PerformanceMarkdownService<a href="#performancemarkdownservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Purpose</strong>: Profile execution performance with metrics like duration, percentiles, and wait times.</p>
<p><strong>Event Source</strong>: <code>performanceEmitter</code></p>
<p><strong>Storage Key</strong>: <code>symbol:strategyName</code></p>
<p><strong>MAX_EVENTS</strong>: 10000 (higher than other services to capture statistical significance)</p>
<p><strong>Unique Features</strong>:</p>
<ul>
<li>Groups events by <code>metricType</code> (e.g., &quot;getCandles&quot;, &quot;tick&quot;, &quot;backtest&quot;)</li>
<li>Calculates percentiles (P95, P99) for latency analysis</li>
<li>Tracks wait times between consecutive events of same type</li>
<li>Sorts metrics by <code>totalDuration</code> to highlight bottlenecks</li>
</ul>
<p><strong>Statistics Computed</strong>:</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>count</code></td>
<td>Number of samples</td>
</tr>
<tr>
<td><code>totalDuration</code></td>
<td>Sum of all durations (ms)</td>
</tr>
<tr>
<td><code>avgDuration</code></td>
<td>Mean duration (ms)</td>
</tr>
<tr>
<td><code>minDuration</code></td>
<td>Minimum duration (ms)</td>
</tr>
<tr>
<td><code>maxDuration</code></td>
<td>Maximum duration (ms)</td>
</tr>
<tr>
<td><code>stdDev</code></td>
<td>Standard deviation (ms)</td>
</tr>
<tr>
<td><code>median</code></td>
<td>50th percentile (ms)</td>
</tr>
<tr>
<td><code>p95</code></td>
<td>95th percentile (ms)</td>
</tr>
<tr>
<td><code>p99</code></td>
<td>99th percentile (ms)</td>
</tr>
<tr>
<td><code>avgWaitTime</code></td>
<td>Average interval between events (ms)</td>
</tr>
</tbody>
</table>
<hr>
<a id="heatmarkdownservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">HeatMarkdownService<a href="#heatmarkdownservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Purpose</strong>: Generate portfolio-wide heatmap showing per-symbol statistics and aggregated portfolio metrics.</p>
<p><strong>Event Source</strong>: <code>signalEmitter</code> (filtered to <code>action === &quot;closed&quot;</code>)</p>
<p><strong>Storage Key</strong>: <code>strategyName</code> (aggregates across all symbols)</p>
<p><strong>Unique Features</strong>:</p>
<ul>
<li>Groups closed signals by symbol</li>
<li>Calculates per-symbol statistics</li>
<li>Computes portfolio-wide metrics weighted by trade count</li>
<li>Sorts symbols by Sharpe ratio (best performers first)</li>
</ul>
<p><strong>Per-Symbol Statistics</strong>:</p>
<ul>
<li>Total PNL, Sharpe Ratio, Max Drawdown</li>
<li>Profit Factor (sum wins / sum losses)</li>
<li>Expectancy (weighted average of avg win/loss by win rate)</li>
<li>Win/Loss Streaks</li>
</ul>
<p><strong>Portfolio Statistics</strong>:</p>
<ul>
<li><code>portfolioTotalPnl</code>: Sum of all symbols' total PNL</li>
<li><code>portfolioSharpeRatio</code>: Trade-count weighted average of Sharpe ratios</li>
<li><code>portfolioTotalTrades</code>: Total trades across all symbols</li>
</ul>
<hr>
<a id="partialmarkdownservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">PartialMarkdownService<a href="#partialmarkdownservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Purpose</strong>: Track profit/loss milestone events (10%, 20%, 30%, etc) for active signals.</p>
<p><strong>Event Sources</strong>: <code>partialProfitSubject</code>, <code>partialLossSubject</code></p>
<p><strong>Storage Key</strong>: <code>symbol:strategyName</code></p>
<p><strong>Event Data</strong>:</p>
<ul>
<li><code>action</code>: &quot;profit&quot; or &quot;loss&quot;</li>
<li><code>level</code>: PartialLevel (10, 20, 30, 40, 50, 60, 70, 80, 90, 100)</li>
<li><code>symbol</code>, <code>strategyName</code>, <code>signalId</code>, <code>position</code></li>
<li><code>currentPrice</code>, <code>timestamp</code>, <code>backtest</code> flag</li>
</ul>
<p><strong>Statistics Computed</strong>:</p>
<ul>
<li><code>totalEvents</code>: Total milestone events</li>
<li><code>totalProfit</code>: Count of profit milestone events</li>
<li><code>totalLoss</code>: Count of loss milestone events</li>
</ul>
<hr>
<a id="column-configuration-system" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Column Configuration System<a href="#column-configuration-system" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/30-markdown-report-system_4.svg" alt="Mermaid Diagram"></p>
<a id="column-interface" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Column Interface<a href="#column-interface" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-13">Column</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">key</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">;           </span><span class="hl-5">// Unique identifier</span><br/><span class="hl-1">  </span><span class="hl-4">label</span><span class="hl-1">: </span><span class="hl-13">string</span><span class="hl-1">;         </span><span class="hl-5">// Display header</span><br/><span class="hl-1">  </span><span class="hl-0">format</span><span class="hl-1">: (</span><span class="hl-4">data</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">string</span><span class="hl-1">;  </span><span class="hl-5">// Cell formatter</span><br/><span class="hl-1">  </span><span class="hl-0">isVisible</span><span class="hl-1">: () </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-13">boolean</span><span class="hl-1">;  </span><span class="hl-5">// Conditional visibility</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="example-column-definitions" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example Column Definitions<a href="#example-column-definitions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>BacktestMarkdownService</strong> includes columns for signal details:</p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-10">key</span><span class="hl-1">: </span><span class="hl-2">&quot;pnl&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">label</span><span class="hl-1">: </span><span class="hl-2">&quot;PNL (net)&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">format</span><span class="hl-1">: (</span><span class="hl-4">data</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">pnlPercentage</span><span class="hl-1"> = </span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">`</span><span class="hl-7">${</span><span class="hl-4">pnlPercentage</span><span class="hl-9"> </span><span class="hl-1">&gt;</span><span class="hl-9"> </span><span class="hl-6">0</span><span class="hl-9"> </span><span class="hl-1">?</span><span class="hl-9"> </span><span class="hl-2">&quot;+&quot;</span><span class="hl-9"> </span><span class="hl-1">:</span><span class="hl-9"> </span><span class="hl-2">&quot;&quot;</span><span class="hl-7">}${</span><span class="hl-4">pnlPercentage</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-6">2</span><span class="hl-9">)</span><span class="hl-7">}</span><span class="hl-2">%`</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-10">isVisible</span><span class="hl-1">: () </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-7">true</span><span class="hl-1">,</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Note column</strong> respects global configuration:</p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-10">key</span><span class="hl-1">: </span><span class="hl-2">&quot;note&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">label</span><span class="hl-1">: </span><span class="hl-2">&quot;Note&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">format</span><span class="hl-1">: (</span><span class="hl-4">data</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-0">toPlainString</span><span class="hl-1">(</span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">note</span><span class="hl-1"> ?? </span><span class="hl-2">&quot;N/A&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-10">isVisible</span><span class="hl-1">: () </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-8">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-8">CC_REPORT_SHOW_SIGNAL_NOTE</span><span class="hl-1">,</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="file-output-structure" class="tsd-anchor"></a><h2 class="tsd-anchor-link">File Output Structure<a href="#file-output-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/30-markdown-report-system_5.svg" alt="Mermaid Diagram"></p>
<a id="file-creation-process" class="tsd-anchor"></a><h3 class="tsd-anchor-link">File Creation Process<a href="#file-creation-process" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>All markdown services use Node.js filesystem APIs with atomic writes:</p>
<ol>
<li><strong>Create Directory</strong>: <code>mkdir(dir, { recursive: true })</code> ensures parent directories exist</li>
<li><strong>Generate Filename</strong>: Pattern varies by service (e.g., <code>{strategyName}.md</code>, <code>{symbol}_{strategyName}.md</code>)</li>
<li><strong>Write File</strong>: <code>writeFile(filepath, markdown, &quot;utf-8&quot;)</code> writes markdown string</li>
<li><strong>Log Success</strong>: Console log confirms file path</li>
</ol>
<p><strong>Default Paths</strong>:</p>
<table>
<thead>
<tr>
<th>Service</th>
<th>Default Path</th>
<th>Filename Pattern</th>
</tr>
</thead>
<tbody>
<tr>
<td>BacktestMarkdownService</td>
<td><code>./dump/backtest</code></td>
<td><code>{strategyName}.md</code></td>
</tr>
<tr>
<td>LiveMarkdownService</td>
<td><code>./dump/live</code></td>
<td><code>{strategyName}.md</code></td>
</tr>
<tr>
<td>ScheduleMarkdownService</td>
<td><code>./dump/schedule</code></td>
<td><code>{strategyName}.md</code></td>
</tr>
<tr>
<td>WalkerMarkdownService</td>
<td><code>./dump/walker</code></td>
<td><code>{walkerName}.md</code></td>
</tr>
<tr>
<td>PerformanceMarkdownService</td>
<td><code>./dump/performance</code></td>
<td><code>{strategyName}.md</code></td>
</tr>
<tr>
<td>HeatMarkdownService</td>
<td><code>./dump/heatmap</code></td>
<td><code>{strategyName}.md</code></td>
</tr>
<tr>
<td>PartialMarkdownService</td>
<td><code>./dump/partial</code></td>
<td><code>{symbol}_{strategyName}.md</code></td>
</tr>
</tbody>
</table>
<hr>
<a id="public-api-usage" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Public API Usage<a href="#public-api-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="class-based-api" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Class-Based API<a href="#class-based-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Markdown services are accessed through public static methods on report classes:</p>
<p><img src="../media/30-markdown-report-system_6.svg" alt="Mermaid Diagram"></p>
<a id="method-signatures" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Method Signatures<a href="#method-signatures" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Backtest, Live, Schedule, Partial</strong> (symbol + strategyName scope):</p>
<pre><code class="typescript"><span class="hl-5">// Get statistics object</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">BacktestStatistics</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Generate markdown string</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Save to filesystem</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">path</span><span class="hl-1">?: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-5">// Clear accumulated data</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">(</span><span class="hl-4">ctx</span><span class="hl-1">?: { </span><span class="hl-4">symbol:</span><span class="hl-1"> </span><span class="hl-4">string</span><span class="hl-1">; </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1"> }): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Walker</strong> (walkerName scope):</p>
<pre><code class="typescript"><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">walkerName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">metric</span><span class="hl-1">: </span><span class="hl-4">WalkerMetric</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">context</span><span class="hl-1">: { </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-4">string</span><span class="hl-1">; </span><span class="hl-4">frameName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1"> }</span><br/><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">WalkerStatistics</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(...): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(...): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Performance</strong> (symbol + strategyName scope):</p>
<pre><code class="typescript"><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Performance</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">PerformanceStatistics</span><span class="hl-1">&gt;</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Performance</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Performance</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">path</span><span class="hl-1">?: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Heat</strong> (strategyName scope):</p>
<pre><code class="typescript"><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">IHeatmapStatistics</span><span class="hl-1">&gt;</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">path</span><span class="hl-1">?: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">?: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="usage-examples" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage Examples<a href="#usage-examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="example-1-backtest-report-generation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example 1: Backtest Report Generation<a href="#example-1-backtest-report-generation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Backtest</span><span class="hl-1">, </span><span class="hl-4">listenDoneBacktest</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Wait for backtest to complete</span><br/><span class="hl-0">listenDoneBacktest</span><span class="hl-1">(</span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-7">const</span><span class="hl-1"> { </span><span class="hl-8">symbol</span><span class="hl-1">, </span><span class="hl-8">strategyName</span><span class="hl-1"> } = </span><span class="hl-4">event</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Get statistics object</span><br/><span class="hl-1">  </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">stats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Win Rate: </span><span class="hl-7">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">winRate</span><span class="hl-7">}</span><span class="hl-2">%`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Sharpe Ratio: </span><span class="hl-7">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">sharpeRatio</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Generate and save markdown report</span><br/><span class="hl-1">  </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyName</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-5">// Saves to: ./dump/backtest/{strategyName}.md</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="example-2-live-trading-report-with-custom-path" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example 2: Live Trading Report with Custom Path<a href="#example-2-live-trading-report-with-custom-path" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Live</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// During live trading execution</span><br/><span class="hl-0">setInterval</span><span class="hl-1">(</span><span class="hl-7">async</span><span class="hl-1"> () </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">stats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">stats</span><span class="hl-1">.</span><span class="hl-4">totalClosed</span><span class="hl-1"> &gt; </span><span class="hl-6">10</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">// Save to custom directory</span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;./reports/live&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-5">// Saves to: ./reports/live/my-strategy.md</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}, </span><span class="hl-6">60000</span><span class="hl-1">); </span><span class="hl-5">// Every minute</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="example-3-walker-comparison-report" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example 3: Walker Comparison Report<a href="#example-3-walker-comparison-report" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Walker</span><span class="hl-1">, </span><span class="hl-4">listenWalkerComplete</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">listenWalkerComplete</span><span class="hl-1">(</span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">results</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-7">const</span><span class="hl-1"> { </span><span class="hl-8">walkerName</span><span class="hl-1">, </span><span class="hl-8">symbol</span><span class="hl-1">, </span><span class="hl-8">metric</span><span class="hl-1">, </span><span class="hl-8">bestStrategy</span><span class="hl-1"> } = </span><span class="hl-4">results</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Best strategy: </span><span class="hl-7">${</span><span class="hl-4">bestStrategy</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Get detailed results</span><br/><span class="hl-1">  </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">stats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-4">walkerName</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">symbol</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">metric</span><span class="hl-1">,</span><br/><span class="hl-1">    { </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">, </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d&quot;</span><span class="hl-1"> }</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Save comparison report</span><br/><span class="hl-1">  </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">walkerName</span><span class="hl-1">, </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">metric</span><span class="hl-1">, { </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">, </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1d&quot;</span><span class="hl-1"> });</span><br/><span class="hl-1">  </span><span class="hl-5">// Saves to: ./dump/walker/{walkerName}.md</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="example-4-performance-profiling" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example 4: Performance Profiling<a href="#example-4-performance-profiling" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Performance</span><span class="hl-1">, </span><span class="hl-4">listenPerformance</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Monitor performance in real-time</span><br/><span class="hl-0">listenPerformance</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`</span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">metricType</span><span class="hl-7">}</span><span class="hl-2">: </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">duration</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-6">2</span><span class="hl-9">)</span><span class="hl-7">}</span><span class="hl-2">ms`</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// After execution</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">stats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Performance</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Find bottlenecks</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">sortedMetrics</span><span class="hl-1"> = </span><span class="hl-4">Object</span><span class="hl-1">.</span><span class="hl-0">values</span><span class="hl-1">(</span><span class="hl-4">stats</span><span class="hl-1">.</span><span class="hl-4">metricStats</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-0">sort</span><span class="hl-1">((</span><span class="hl-4">a</span><span class="hl-1">, </span><span class="hl-4">b</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> </span><span class="hl-4">b</span><span class="hl-1">.</span><span class="hl-4">totalDuration</span><span class="hl-1"> - </span><span class="hl-4">a</span><span class="hl-1">.</span><span class="hl-4">totalDuration</span><span class="hl-1">);</span><br/><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Slowest operations:&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">sortedMetrics</span><span class="hl-1">.</span><span class="hl-0">slice</span><span class="hl-1">(</span><span class="hl-6">0</span><span class="hl-1">, </span><span class="hl-6">3</span><span class="hl-1">).</span><span class="hl-0">forEach</span><span class="hl-1">(</span><span class="hl-4">m</span><span class="hl-1"> </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`</span><span class="hl-7">${</span><span class="hl-4">m</span><span class="hl-9">.</span><span class="hl-4">metricType</span><span class="hl-7">}</span><span class="hl-2">: </span><span class="hl-7">${</span><span class="hl-4">m</span><span class="hl-9">.</span><span class="hl-4">totalDuration</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-6">2</span><span class="hl-9">)</span><span class="hl-7">}</span><span class="hl-2">ms total`</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Performance</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="example-5-portfolio-heatmap" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example 5: Portfolio Heatmap<a href="#example-5-portfolio-heatmap" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Heat</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Get portfolio-wide statistics</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">heatmap</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Total symbols: </span><span class="hl-7">${</span><span class="hl-4">heatmap</span><span class="hl-9">.</span><span class="hl-4">totalSymbols</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Portfolio PNL: </span><span class="hl-7">${</span><span class="hl-4">heatmap</span><span class="hl-9">.</span><span class="hl-4">portfolioTotalPnl</span><span class="hl-7">}</span><span class="hl-2">%`</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Portfolio Sharpe: </span><span class="hl-7">${</span><span class="hl-4">heatmap</span><span class="hl-9">.</span><span class="hl-4">portfolioSharpeRatio</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Inspect per-symbol breakdown</span><br/><span class="hl-4">heatmap</span><span class="hl-1">.</span><span class="hl-4">symbols</span><span class="hl-1">.</span><span class="hl-0">forEach</span><span class="hl-1">(</span><span class="hl-4">row</span><span class="hl-1"> </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`</span><span class="hl-7">${</span><span class="hl-4">row</span><span class="hl-9">.</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2">: </span><span class="hl-7">${</span><span class="hl-4">row</span><span class="hl-9">.</span><span class="hl-4">totalPnl</span><span class="hl-7">}</span><span class="hl-2">% PNL, </span><span class="hl-7">${</span><span class="hl-4">row</span><span class="hl-9">.</span><span class="hl-4">sharpeRatio</span><span class="hl-7">}</span><span class="hl-2"> Sharpe`</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Heat</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-5">// Saves to: ./dump/heatmap/my-strategy.md</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="service-dependencies" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Service Dependencies<a href="#service-dependencies" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/30-markdown-report-system_7.svg" alt="Mermaid Diagram"></p>
<a id="dependency-details" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Dependency Details<a href="#dependency-details" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>functools-kit Integration</strong>:</p>
<ul>
<li><code>memoize</code>: Cache storage instances by key</li>
<li><code>singleshot</code>: Ensure init() runs once</li>
<li><code>queued</code>: Used in event listeners (not directly in services)</li>
<li><code>str</code>: Format numbers with patterns (used in HeatMarkdownService)</li>
</ul>
<p><strong>LoggerService</strong>:
All markdown services inject <code>LoggerService</code> for structured logging:</p>
<pre><code class="typescript"><span class="hl-4">private</span><span class="hl-1"> </span><span class="hl-4">readonly</span><span class="hl-1"> </span><span class="hl-4">loggerService</span><span class="hl-1"> = </span><span class="hl-0">inject</span><span class="hl-1">&lt;</span><span class="hl-13">LoggerService</span><span class="hl-1">&gt;(</span><span class="hl-8">TYPES</span><span class="hl-1">.</span><span class="hl-4">loggerService</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Event Emitters</strong>:
Services subscribe to specific emitters based on their domain:</p>
<ul>
<li>BacktestMarkdownService â†’ <code>signalBacktestEmitter</code></li>
<li>LiveMarkdownService â†’ <code>signalLiveEmitter</code></li>
<li>ScheduleMarkdownService â†’ <code>signalEmitter</code></li>
<li>WalkerMarkdownService â†’ <code>walkerEmitter</code></li>
<li>PerformanceMarkdownService â†’ <code>performanceEmitter</code></li>
<li>HeatMarkdownService â†’ <code>signalEmitter</code></li>
<li>PartialMarkdownService â†’ <code>partialProfitSubject</code> + <code>partialLossSubject</code></li>
<li>RiskMarkdownService â†’ <code>riskSubject</code></li>
</ul>
<hr>
<a id="error-handling-and-edge-cases" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Error Handling and Edge Cases<a href="#error-handling-and-edge-cases" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="safe-math-implementation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Safe Math Implementation<a href="#safe-math-implementation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>All statistics calculations use <code>isUnsafe()</code> checks to prevent invalid values:</p>
<pre><code class="typescript"><span class="hl-7">function</span><span class="hl-1"> </span><span class="hl-0">isUnsafe</span><span class="hl-1">(</span><span class="hl-4">value</span><span class="hl-1">: </span><span class="hl-13">number</span><span class="hl-1"> | </span><span class="hl-13">null</span><span class="hl-1">): </span><span class="hl-13">boolean</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-7">typeof</span><span class="hl-1"> </span><span class="hl-4">value</span><span class="hl-1"> !== </span><span class="hl-2">&quot;number&quot;</span><span class="hl-1">) </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-7">true</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-0">isNaN</span><span class="hl-1">(</span><span class="hl-4">value</span><span class="hl-1">)) </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-7">true</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (!</span><span class="hl-0">isFinite</span><span class="hl-1">(</span><span class="hl-4">value</span><span class="hl-1">)) </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-7">true</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-7">false</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Usage in statistics calculation</span><br/><span class="hl-10">winRate</span><span class="hl-1">: </span><span class="hl-0">isUnsafe</span><span class="hl-1">(</span><span class="hl-4">winRate</span><span class="hl-1">) ? </span><span class="hl-7">null</span><span class="hl-1"> : </span><span class="hl-4">winRate</span><span class="hl-1">,</span><br/><span class="hl-10">sharpeRatio</span><span class="hl-1">: </span><span class="hl-0">isUnsafe</span><span class="hl-1">(</span><span class="hl-4">sharpeRatio</span><span class="hl-1">) ? </span><span class="hl-7">null</span><span class="hl-1"> : </span><span class="hl-4">sharpeRatio</span><span class="hl-1">,</span>
</code><button type="button">Copy</button></pre>

<p>This ensures reports display <code>&quot;N/A&quot;</code> for undefined/invalid metrics rather than displaying <code>NaN</code> or <code>Infinity</code>.</p>
<hr>
<a id="empty-data-handling" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Empty Data Handling<a href="#empty-data-handling" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>All <code>getData()</code> methods return valid statistics interfaces even when no data exists:</p>
<pre><code class="typescript"><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_signalList</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1"> === </span><span class="hl-6">0</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">signalList:</span><span class="hl-1"> [],</span><br/><span class="hl-1">    </span><span class="hl-4">totalSignals:</span><span class="hl-1"> </span><span class="hl-6">0</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">winCount:</span><span class="hl-1"> </span><span class="hl-6">0</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">lossCount:</span><span class="hl-1"> </span><span class="hl-6">0</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">winRate:</span><span class="hl-1"> </span><span class="hl-7">null</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">avgPnl:</span><span class="hl-1"> </span><span class="hl-7">null</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">totalPnl:</span><span class="hl-1"> </span><span class="hl-7">null</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">stdDev:</span><span class="hl-1"> </span><span class="hl-7">null</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">sharpeRatio:</span><span class="hl-1"> </span><span class="hl-7">null</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">// ... all other metrics as null</span><br/><span class="hl-1">  };</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Reports display informative messages when no data is available:</p>
<pre><code class="markdown"># Backtest Report: my-strategy

No signals closed yet.
</code><button type="button">Copy</button></pre>

<hr>
<a id="memory-bounds-enforcement" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Memory Bounds Enforcement<a href="#memory-bounds-enforcement" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Services protect against memory leaks by enforcing MAX_EVENTS limits:</p>
<pre><code class="typescript"><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">MAX_EVENTS</span><span class="hl-1"> = </span><span class="hl-6">250</span><span class="hl-1">;</span><br/><br/><span class="hl-4">public</span><span class="hl-1"> </span><span class="hl-0">addSignal</span><span class="hl-1">(</span><span class="hl-4">data</span><span class="hl-1">: </span><span class="hl-4">IStrategyTickResultClosed</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_signalList</span><span class="hl-1">.</span><span class="hl-0">unshift</span><span class="hl-1">(</span><span class="hl-4">data</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_signalList</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1"> &gt; </span><span class="hl-8">MAX_EVENTS</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-4">_signalList</span><span class="hl-1">.</span><span class="hl-0">pop</span><span class="hl-1">();  </span><span class="hl-5">// Remove oldest event</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Trade-off</strong>: Older data is discarded when limit is reached. For complete historical analysis, use custom event listeners to store data externally.</p>
<p><strong>Exceptions</strong>: WalkerMarkdownService and RiskMarkdownService do not enforce bounds because they need complete aggregation.</p>
<hr>
<a id="file-system-error-handling" class="tsd-anchor"></a><h3 class="tsd-anchor-link">File System Error Handling<a href="#file-system-error-handling" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>All <code>dump()</code> methods wrap filesystem operations in try-catch blocks:</p>
<pre><code class="typescript"><span class="hl-4">public</span><span class="hl-1"> </span><span class="hl-4">async</span><span class="hl-1"> </span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">, </span><span class="hl-4">path</span><span class="hl-1"> = </span><span class="hl-2">&quot;./dump/backtest&quot;</span><span class="hl-1">): </span><span class="hl-13">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">void</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">  const </span><span class="hl-4">markdown</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-7">this</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  try {</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">dir</span><span class="hl-1"> = </span><span class="hl-0">join</span><span class="hl-1">(</span><span class="hl-4">process</span><span class="hl-1">.</span><span class="hl-0">cwd</span><span class="hl-1">(), </span><span class="hl-4">path</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">mkdir</span><span class="hl-1">(</span><span class="hl-4">dir</span><span class="hl-1">, { </span><span class="hl-4">recursive:</span><span class="hl-1"> </span><span class="hl-7">true</span><span class="hl-1"> });</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">filename</span><span class="hl-1"> = </span><span class="hl-2">`</span><span class="hl-7">${</span><span class="hl-4">strategyName</span><span class="hl-7">}</span><span class="hl-2">.md`</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">filepath</span><span class="hl-1"> = </span><span class="hl-0">join</span><span class="hl-1">(</span><span class="hl-4">dir</span><span class="hl-1">, </span><span class="hl-4">filename</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">writeFile</span><span class="hl-1">(</span><span class="hl-4">filepath</span><span class="hl-1">, </span><span class="hl-4">markdown</span><span class="hl-1">, </span><span class="hl-2">&quot;utf-8&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Backtest report saved: </span><span class="hl-7">${</span><span class="hl-4">filepath</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  } catch (error) {</span><br/><span class="hl-1">    console.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">`Failed to save markdown report:`</span><span class="hl-1">, </span><span class="hl-4">error</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Errors are logged but do not crash the application.</p>
<hr>
<a id="performance-considerations" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Performance Considerations<a href="#performance-considerations" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="memoization-benefits" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Memoization Benefits<a href="#memoization-benefits" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Using <code>memoize</code> for <code>getStorage()</code> provides:</p>
<ol>
<li><strong>Instance Reuse</strong>: Same storage instance returned for same key</li>
<li><strong>Memory Efficiency</strong>: Only one storage per <code>symbol:strategyName</code> pair</li>
<li><strong>O(1) Lookup</strong>: Hash-based key lookup</li>
</ol>
<a id="singleshot-initialization" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Singleshot Initialization<a href="#singleshot-initialization" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Using <code>singleshot</code> for <code>init()</code> ensures:</p>
<ol>
<li><strong>Event subscription happens once</strong>: Prevents duplicate subscriptions</li>
<li><strong>Lazy initialization</strong>: Init only runs when first method is called</li>
<li><strong>Thread-safe</strong>: functools-kit guarantees single execution</li>
</ol>
<a id="data-structure-choices" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Data Structure Choices<a href="#data-structure-choices" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Array with unshift/pop</strong>:</p>
<ul>
<li>Fast insertion at front: O(1) amortized</li>
<li>Fast removal from back: O(1)</li>
<li>Trade-off: Array shifting may be slower than linked list for very large MAX_EVENTS</li>
</ul>
<p><strong>Alternative considered</strong>: Circular buffer for better performance at high volumes.</p>
<hr>
<a id="testing-considerations" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Testing Considerations<a href="#testing-considerations" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="mocking-strategies" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Mocking Strategies<a href="#mocking-strategies" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>To test markdown services in isolation:</p>
<ol>
<li><strong>Mock Event Emitters</strong>: Create test Subject instances</li>
<li><strong>Inject Test Data</strong>: Call <code>addSignal()</code> directly on storage</li>
<li><strong>Assert Statistics</strong>: Validate getData() output</li>
<li><strong>Mock Filesystem</strong>: Use in-memory filesystem or mock writeFile</li>
</ol>
<a id="example-test-pattern" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example Test Pattern<a href="#example-test-pattern" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// Create service instance</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">service</span><span class="hl-1"> = </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">BacktestMarkdownService</span><span class="hl-1">();</span><br/><br/><span class="hl-5">// Get storage instance</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">storage</span><span class="hl-1"> = </span><span class="hl-4">service</span><span class="hl-1">[</span><span class="hl-2">&#39;getStorage&#39;</span><span class="hl-1">](</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;test-strategy&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Inject test data</span><br/><span class="hl-4">storage</span><span class="hl-1">.</span><span class="hl-0">addSignal</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">action:</span><span class="hl-1"> </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">signal:</span><span class="hl-1"> { </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;test-1&quot;</span><span class="hl-1">, </span><span class="hl-4">symbol:</span><span class="hl-1"> </span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;test-strategy&quot;</span><span class="hl-1">, </span><span class="hl-5">/* ... */</span><span class="hl-1"> },</span><br/><span class="hl-1">  </span><span class="hl-4">pnl:</span><span class="hl-1"> { </span><span class="hl-4">pnlPercentage:</span><span class="hl-1"> </span><span class="hl-6">5.0</span><span class="hl-1"> },</span><br/><span class="hl-1">  </span><span class="hl-4">closeReason:</span><span class="hl-1"> </span><span class="hl-2">&quot;take_profit&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">/* ... */</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Assert statistics</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">stats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">service</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;test-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-4">stats</span><span class="hl-1">.</span><span class="hl-4">totalSignals</span><span class="hl-1">).</span><span class="hl-0">toBe</span><span class="hl-1">(</span><span class="hl-6">1</span><span class="hl-1">);</span><br/><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-4">stats</span><span class="hl-1">.</span><span class="hl-4">winCount</span><span class="hl-1">).</span><span class="hl-0">toBe</span><span class="hl-1">(</span><span class="hl-6">1</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="clear-method-for-test-cleanup" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Clear Method for Test Cleanup<a href="#clear-method-for-test-cleanup" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>All services provide <code>clear()</code> method for test isolation:</p>
<pre><code class="typescript"><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">service</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">({ </span><span class="hl-4">symbol:</span><span class="hl-1"> </span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;test-strategy&quot;</span><span class="hl-1"> });</span>
</code><button type="button">Copy</button></pre>

</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#markdown-report-system"><span>Markdown <wbr/>Report <wbr/>System</span></a><ul><li><a href="#purpose-and-scope"><span>Purpose and <wbr/>Scope</span></a></li><li><a href="#system-architecture-overview"><span>System <wbr/>Architecture <wbr/>Overview</span></a></li><li><a href="#markdown-service-catalog"><span>Markdown <wbr/>Service <wbr/>Catalog</span></a></li><li><ul><li><a href="#service-overview-table"><span>Service <wbr/>Overview <wbr/>Table</span></a></li></ul></li><li><a href="#reportstorage-pattern-architecture"><span>Report<wbr/>Storage <wbr/>Pattern <wbr/>Architecture</span></a></li><li><ul><li><a href="#pattern-components"><span>Pattern <wbr/>Components</span></a></li></ul></li><li><a href="#event-flow-and-data-accumulation"><span>Event <wbr/>Flow and <wbr/>Data <wbr/>Accumulation</span></a></li><li><ul><li><a href="#memory-management-strategy"><span>Memory <wbr/>Management <wbr/>Strategy</span></a></li></ul></li><li><a href="#statistics-calculation"><span>Statistics <wbr/>Calculation</span></a></li><li><ul><li><a href="#backtest-and-live-statistics"><span>Backtest and <wbr/>Live <wbr/>Statistics</span></a></li></ul></li><li><a href="#report-specific-implementations"><span>Report-<wbr/>Specific <wbr/>Implementations</span></a></li><li><ul><li><a href="#backtestmarkdownservice"><span>Backtest<wbr/>Markdown<wbr/>Service</span></a></li><li><a href="#livemarkdownservice"><span>Live<wbr/>Markdown<wbr/>Service</span></a></li><li><a href="#schedulemarkdownservice"><span>Schedule<wbr/>Markdown<wbr/>Service</span></a></li><li><a href="#walkermarkdownservice"><span>Walker<wbr/>Markdown<wbr/>Service</span></a></li><li><a href="#performancemarkdownservice"><span>Performance<wbr/>Markdown<wbr/>Service</span></a></li><li><a href="#heatmarkdownservice"><span>Heat<wbr/>Markdown<wbr/>Service</span></a></li><li><a href="#partialmarkdownservice"><span>Partial<wbr/>Markdown<wbr/>Service</span></a></li></ul></li><li><a href="#column-configuration-system"><span>Column <wbr/>Configuration <wbr/>System</span></a></li><li><ul><li><a href="#column-interface"><span>Column <wbr/>Interface</span></a></li><li><a href="#example-column-definitions"><span>Example <wbr/>Column <wbr/>Definitions</span></a></li></ul></li><li><a href="#file-output-structure"><span>File <wbr/>Output <wbr/>Structure</span></a></li><li><ul><li><a href="#file-creation-process"><span>File <wbr/>Creation <wbr/>Process</span></a></li></ul></li><li><a href="#public-api-usage"><span>Public API <wbr/>Usage</span></a></li><li><ul><li><a href="#class-based-api"><span>Class-<wbr/>Based API</span></a></li><li><a href="#method-signatures"><span>Method <wbr/>Signatures</span></a></li></ul></li><li><a href="#usage-examples"><span>Usage <wbr/>Examples</span></a></li><li><ul><li><a href="#example-1-backtest-report-generation"><span>Example 1: <wbr/>Backtest <wbr/>Report <wbr/>Generation</span></a></li><li><a href="#example-2-live-trading-report-with-custom-path"><span>Example 2: <wbr/>Live <wbr/>Trading <wbr/>Report with <wbr/>Custom <wbr/>Path</span></a></li><li><a href="#example-3-walker-comparison-report"><span>Example 3: <wbr/>Walker <wbr/>Comparison <wbr/>Report</span></a></li><li><a href="#example-4-performance-profiling"><span>Example 4: <wbr/>Performance <wbr/>Profiling</span></a></li><li><a href="#example-5-portfolio-heatmap"><span>Example 5: <wbr/>Portfolio <wbr/>Heatmap</span></a></li></ul></li><li><a href="#service-dependencies"><span>Service <wbr/>Dependencies</span></a></li><li><ul><li><a href="#dependency-details"><span>Dependency <wbr/>Details</span></a></li></ul></li><li><a href="#error-handling-and-edge-cases"><span>Error <wbr/>Handling and <wbr/>Edge <wbr/>Cases</span></a></li><li><ul><li><a href="#safe-math-implementation"><span>Safe <wbr/>Math <wbr/>Implementation</span></a></li><li><a href="#empty-data-handling"><span>Empty <wbr/>Data <wbr/>Handling</span></a></li><li><a href="#memory-bounds-enforcement"><span>Memory <wbr/>Bounds <wbr/>Enforcement</span></a></li><li><a href="#file-system-error-handling"><span>File <wbr/>System <wbr/>Error <wbr/>Handling</span></a></li></ul></li><li><a href="#performance-considerations"><span>Performance <wbr/>Considerations</span></a></li><li><ul><li><a href="#memoization-benefits"><span>Memoization <wbr/>Benefits</span></a></li><li><a href="#singleshot-initialization"><span>Singleshot <wbr/>Initialization</span></a></li><li><a href="#data-structure-choices"><span>Data <wbr/>Structure <wbr/>Choices</span></a></li></ul></li><li><a href="#testing-considerations"><span>Testing <wbr/>Considerations</span></a></li><li><ul><li><a href="#mocking-strategies"><span>Mocking <wbr/>Strategies</span></a></li><li><a href="#example-test-pattern"><span>Example <wbr/>Test <wbr/>Pattern</span></a></li><li><a href="#clear-method-for-test-cleanup"><span>Clear <wbr/>Method for <wbr/>Test <wbr/>Cleanup</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
