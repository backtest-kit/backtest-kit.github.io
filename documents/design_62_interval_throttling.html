<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/62_interval_throttling | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_62_interval_throttling.html">design/62_interval_throttling</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="interval-throttling" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Interval Throttling<a href="#interval-throttling" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><a id="purpose-and-scope" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Purpose and Scope<a href="#purpose-and-scope" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This page documents the interval throttling system in backtest-kit, which prevents excessive <code>getSignal()</code> calls by enforcing minimum time delays between signal generation attempts. Interval throttling ensures strategies execute at defined timeframes (e.g., every 5 minutes) rather than on every tick, reducing computational overhead and aligning signal generation with strategy timeframes.</p>
<p>For information about the signal lifecycle after generation, see <a href="design_07_signal_lifecycle_overview.html">Signal Lifecycle Overview</a>. For details on real-time monitoring loops, see <a href="design_61_real-time_monitoring.html">Real-time Monitoring</a>.</p>
<hr>
<a id="interval-types" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Interval Types<a href="#interval-types" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>backtest-kit supports six predefined throttling intervals, each enforcing a minimum time between <code>getSignal()</code> invocations:</p>
<table>
<thead>
<tr>
<th>Interval Value</th>
<th>Duration (Minutes)</th>
<th>Duration (Milliseconds)</th>
<th>Typical Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&quot;1m&quot;</code></td>
<td>1</td>
<td>60,000</td>
<td>High-frequency scalping, rapid signal updates</td>
</tr>
<tr>
<td><code>&quot;3m&quot;</code></td>
<td>3</td>
<td>180,000</td>
<td>Short-term momentum strategies</td>
</tr>
<tr>
<td><code>&quot;5m&quot;</code></td>
<td>5</td>
<td>300,000</td>
<td>Common intraday trading interval</td>
</tr>
<tr>
<td><code>&quot;15m&quot;</code></td>
<td>15</td>
<td>900,000</td>
<td>Medium-term intraday strategies</td>
</tr>
<tr>
<td><code>&quot;30m&quot;</code></td>
<td>30</td>
<td>1,800,000</td>
<td>Swing trading, position management</td>
</tr>
<tr>
<td><code>&quot;1h&quot;</code></td>
<td>60</td>
<td>3,600,000</td>
<td>Long-term position strategies</td>
</tr>
</tbody>
</table>
<hr>
<a id="throttling-mechanism" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Throttling Mechanism<a href="#throttling-mechanism" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="architecture-diagram" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Architecture Diagram<a href="#architecture-diagram" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/62_Interval_Throttling_0.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Interval Throttling Decision Flow</strong></p>
<hr>
<a id="implementation-details" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Implementation Details<a href="#implementation-details" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="throttle-check-logic" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Throttle Check Logic<a href="#throttle-check-logic" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The throttling check occurs in <code>GET_SIGNAL_FN</code> before invoking the user-defined <code>getSignal()</code> function:</p>
<pre><code class="typescript"><span class="hl-0">// From ClientStrategy.ts:336-352</span><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">currentTime</span><span class="hl-2"> = </span><span class="hl-6">self</span><span class="hl-2">.</span><span class="hl-6">params</span><span class="hl-2">.</span><span class="hl-6">execution</span><span class="hl-2">.</span><span class="hl-6">context</span><span class="hl-2">.</span><span class="hl-6">when</span><span class="hl-2">.</span><span class="hl-1">getTime</span><span class="hl-2">();</span><br/><span class="hl-2">{</span><br/><span class="hl-2">  </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">intervalMinutes</span><span class="hl-2"> = </span><span class="hl-8">INTERVAL_MINUTES</span><span class="hl-2">[</span><span class="hl-6">self</span><span class="hl-2">.</span><span class="hl-6">params</span><span class="hl-2">.</span><span class="hl-6">interval</span><span class="hl-2">];</span><br/><span class="hl-2">  </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">intervalMs</span><span class="hl-2"> = </span><span class="hl-6">intervalMinutes</span><span class="hl-2"> * </span><span class="hl-7">60</span><span class="hl-2"> * </span><span class="hl-7">1000</span><span class="hl-2">;</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Check if enough time has passed since last getSignal</span><br/><span class="hl-2">  </span><span class="hl-5">if</span><span class="hl-2"> (</span><br/><span class="hl-2">    </span><span class="hl-6">self</span><span class="hl-2">.</span><span class="hl-6">_lastSignalTimestamp</span><span class="hl-2"> !== </span><span class="hl-3">null</span><span class="hl-2"> &amp;&amp;</span><br/><span class="hl-2">    </span><span class="hl-6">currentTime</span><span class="hl-2"> - </span><span class="hl-6">self</span><span class="hl-2">.</span><span class="hl-6">_lastSignalTimestamp</span><span class="hl-2"> &lt; </span><span class="hl-6">intervalMs</span><br/><span class="hl-2">  ) {</span><br/><span class="hl-2">    </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-3">null</span><span class="hl-2">;</span><br/><span class="hl-2">  }</span><br/><br/><span class="hl-2">  </span><span class="hl-6">self</span><span class="hl-2">.</span><span class="hl-6">_lastSignalTimestamp</span><span class="hl-2"> = </span><span class="hl-6">currentTime</span><span class="hl-2">;</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Key Implementation Points:</strong></p>
<ol>
<li><strong>Time Source</strong>: Uses <code>ExecutionContextService.context.when</code> for temporal consistency</li>
<li><strong>Null on First Call</strong>: <code>_lastSignalTimestamp</code> starts as <code>null</code>, allowing immediate first execution</li>
<li><strong>Millisecond Precision</strong>: Converts minutes to milliseconds for accurate comparison</li>
<li><strong>Early Return</strong>: Returns <code>null</code> immediately if throttled, preventing unnecessary computation</li>
<li><strong>Timestamp Update</strong>: Updates <code>_lastSignalTimestamp</code> only after throttle check passes</li>
</ol>
<hr>
<a id="interval-lookup-table" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Interval Lookup Table<a href="#interval-lookup-table" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>INTERVAL_MINUTES</code> constant maps <code>SignalInterval</code> string values to numeric minute durations:</p>
<table>
<thead>
<tr>
<th>Constant</th>
<th>File Location</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>INTERVAL_MINUTES</code></td>
<td><a href="">src/client/ClientStrategy.ts:34-41</a></td>
<td><code>Record&lt;SignalInterval, number&gt;</code></td>
</tr>
</tbody>
</table>
<hr>
<a id="configuration-in-strategy-schemas" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Configuration in Strategy Schemas<a href="#configuration-in-strategy-schemas" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="schema-definition" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schema Definition<a href="#schema-definition" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Strategies specify their throttling interval via the <code>interval</code> field in <code>IStrategySchema</code>:</p>
<pre><code class="typescript"><span class="hl-0">// From interfaces/Strategy.interface.ts</span><br/><span class="hl-5">export</span><span class="hl-2"> </span><span class="hl-3">interface</span><span class="hl-2"> </span><span class="hl-11">IStrategySchema</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">strategyName</span><span class="hl-2">: </span><span class="hl-11">StrategyName</span><span class="hl-2">;</span><br/><span class="hl-2">  </span><span class="hl-6">interval</span><span class="hl-2">: </span><span class="hl-11">SignalInterval</span><span class="hl-2">;  </span><span class="hl-0">// Throttling interval</span><br/><span class="hl-2">  </span><span class="hl-1">getSignal</span><span class="hl-2">: (</span><span class="hl-6">symbol</span><span class="hl-2">: </span><span class="hl-11">string</span><span class="hl-2">, </span><span class="hl-6">when</span><span class="hl-2">: </span><span class="hl-11">Date</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-11">Promise</span><span class="hl-2">&lt;</span><span class="hl-11">ISignalDto</span><span class="hl-2"> | </span><span class="hl-11">null</span><span class="hl-2">&gt;;</span><br/><span class="hl-2">  </span><span class="hl-0">// ... other fields</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="registration-example" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Registration Example<a href="#registration-example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">// Example from README.md</span><br/><span class="hl-1">addStrategy</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">strategyName:</span><span class="hl-2"> </span><span class="hl-4">&#39;llm-strategy&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">interval:</span><span class="hl-2"> </span><span class="hl-4">&#39;5m&#39;</span><span class="hl-2">,  </span><span class="hl-0">// getSignal() called at most every 5 minutes</span><br/><span class="hl-2">  </span><span class="hl-1">getSignal</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-0">// Strategy logic here</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="behavior-across-execution-modes" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Behavior Across Execution Modes<a href="#behavior-across-execution-modes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="backtest-mode" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Backtest Mode<a href="#backtest-mode" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>In backtest mode, <code>ClientStrategy.tick()</code> is called once per candle iteration. The throttle ensures <code>getSignal()</code> only executes when the time difference between candles exceeds the configured interval:</p>
<p><img src="../media/62_Interval_Throttling_1.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Interval Throttling in Backtest Mode</strong></p>
<hr>
<a id="live-mode" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Live Mode<a href="#live-mode" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>In live mode, <code>ClientStrategy.tick()</code> is called continuously in a loop with <code>TICK_TTL</code> sleep intervals (typically 1 minute). The throttle prevents redundant <code>getSignal()</code> executions between meaningful time boundaries:</p>
<p><img src="../media/62_Interval_Throttling_2.svg" alt="Mermaid Diagram"></p>
<p><strong>Diagram: Interval Throttling in Live Mode Loop</strong></p>
<hr>
<a id="per-instance-state-isolation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Per-Instance State Isolation<a href="#per-instance-state-isolation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Each <code>ClientStrategy</code> instance maintains its own <code>_lastSignalTimestamp</code>:</p>
<pre><code class="typescript"><span class="hl-0">// From ClientStrategy.ts class definition</span><br/><span class="hl-5">export</span><span class="hl-2"> </span><span class="hl-3">class</span><span class="hl-2"> </span><span class="hl-11">ClientStrategy</span><span class="hl-2"> </span><span class="hl-3">implements</span><span class="hl-2"> </span><span class="hl-11">IStrategy</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-3">private</span><span class="hl-2"> </span><span class="hl-6">_lastSignalTimestamp</span><span class="hl-2">: </span><span class="hl-11">number</span><span class="hl-2"> | </span><span class="hl-11">null</span><span class="hl-2"> = </span><span class="hl-3">null</span><span class="hl-2">;</span><br/><span class="hl-2">  </span><span class="hl-3">private</span><span class="hl-2"> </span><span class="hl-6">_isStopped</span><span class="hl-2"> = </span><span class="hl-3">false</span><span class="hl-2">;</span><br/><span class="hl-2">  </span><span class="hl-3">private</span><span class="hl-2"> </span><span class="hl-6">_pendingSignal</span><span class="hl-2">: </span><span class="hl-11">ISignalRow</span><span class="hl-2"> | </span><span class="hl-11">null</span><span class="hl-2"> = </span><span class="hl-3">null</span><span class="hl-2">;</span><br/><span class="hl-2">  </span><span class="hl-3">private</span><span class="hl-2"> </span><span class="hl-6">_scheduledSignal</span><span class="hl-2">: </span><span class="hl-11">IScheduledSignalRow</span><span class="hl-2"> | </span><span class="hl-11">null</span><span class="hl-2"> = </span><span class="hl-3">null</span><span class="hl-2">;</span><br/><span class="hl-2">  </span><span class="hl-0">// ...</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Instance Isolation Guarantees:</strong></p>
<ol>
<li><strong>Symbol-Strategy Pairs</strong>: Each symbol-strategy combination gets isolated throttle state</li>
<li><strong>Backtest vs Live</strong>: Separate instances for backtest and live modes via memoization key <code>symbol:strategyName:backtest</code></li>
<li><strong>No Cross-Contamination</strong>: One strategy's throttle state never affects another</li>
</ol>
<hr>
<a id="relationship-with-other-components" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Relationship with Other Components<a href="#relationship-with-other-components" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="integration-points" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Integration Points<a href="#integration-points" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Component</th>
<th>Relationship</th>
<th>File Reference</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>IStrategySchema</code></td>
<td>Defines <code>interval</code> configuration</td>
<td><a href="">src/interfaces/Strategy.interface.ts:132-151</a></td>
</tr>
<tr>
<td><code>StrategyConnectionService</code></td>
<td>Passes <code>interval</code> to <code>ClientStrategy</code> constructor</td>
<td><a href="">src/lib/services/connection/StrategyConnectionService.ts:123-156</a></td>
</tr>
<tr>
<td><code>ExecutionContextService</code></td>
<td>Provides <code>context.when</code> for time source</td>
<td><a href="">src/lib/services/context/ExecutionContextService.ts</a></td>
</tr>
<tr>
<td><code>GET_SIGNAL_FN</code></td>
<td>Implements throttle logic wrapper</td>
<td><a href="">src/client/ClientStrategy.ts:332-476</a></td>
</tr>
</tbody>
</table>
<hr>
<a id="use-cases-and-best-practices" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Use Cases and Best Practices<a href="#use-cases-and-best-practices" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="interval-selection-guidelines" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Interval Selection Guidelines<a href="#interval-selection-guidelines" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Strategy Type</th>
<th>Recommended Interval</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr>
<td>Scalping</td>
<td><code>&quot;1m&quot;</code></td>
<td>High-frequency entries, rapid market changes</td>
</tr>
<tr>
<td>Day Trading</td>
<td><code>&quot;5m&quot;</code> or <code>&quot;15m&quot;</code></td>
<td>Balance between responsiveness and noise reduction</td>
</tr>
<tr>
<td>Swing Trading</td>
<td><code>&quot;30m&quot;</code> or <code>&quot;1h&quot;</code></td>
<td>Longer-term positions, reduced false signals</td>
</tr>
<tr>
<td>Position Trading</td>
<td><code>&quot;1h&quot;</code></td>
<td>Weekly/monthly timeframes, minimal overhead</td>
</tr>
</tbody>
</table>
<a id="computational-efficiency" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Computational Efficiency<a href="#computational-efficiency" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Longer intervals reduce:</p>
<ul>
<li><strong>LLM API Calls</strong>: Fewer <code>getSignal()</code> invocations mean fewer expensive LLM requests</li>
<li><strong>Indicator Calculations</strong>: Reduced technical indicator recomputation</li>
<li><strong>Network Requests</strong>: Fewer <code>getCandles()</code> fetches (when using live data sources)</li>
<li><strong>CPU Usage</strong>: Less frequent strategy evaluation</li>
</ul>
<hr>
<a id="timing-precision" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Timing Precision<a href="#timing-precision" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="timestamp-sources" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Timestamp Sources<a href="#timestamp-sources" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The throttle compares timestamps from two sources:</p>
<ol>
<li>
<p><strong>Current Time</strong>: <code>ExecutionContextService.context.when.getTime()</code></p>
<ul>
<li><strong>Backtest</strong>: Candle timestamp from historical data</li>
<li><strong>Live</strong>: <code>Date.now()</code> from system clock</li>
</ul>
</li>
<li>
<p><strong>Last Signal Time</strong>: <code>_lastSignalTimestamp</code> (stored in milliseconds)</p>
</li>
</ol>
<a id="boundary-behavior" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Boundary Behavior<a href="#boundary-behavior" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The throttle uses <strong>strict inequality</strong> (<code>&lt;</code>), meaning:</p>
<ul>
<li><strong>Exactly Equal</strong>: If <code>currentTime - lastSignalTimestamp === intervalMs</code>, the throttle <strong>allows</strong> execution</li>
<li><strong>Example</strong>: With <code>interval='5m'</code> and <code>lastSignalTimestamp=00:00:00</code>, the signal at <code>00:05:00</code> will execute (not throttled)</li>
</ul>
<hr>
<a id="testing-coverage" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Testing Coverage<a href="#testing-coverage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The throttle mechanism is validated by multiple test suites:</p>
<table>
<thead>
<tr>
<th>Test Suite</th>
<th>Focus</th>
<th>File Reference</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>timing.test.mjs</code></td>
<td>Interval timing accuracy</td>
<td><a href="">test/e2e/timing.test.mjs</a></td>
</tr>
<tr>
<td><code>defend.test.mjs</code></td>
<td>Edge cases (boundary conditions, multiple signals)</td>
<td><a href="">test/e2e/defend.test.mjs</a></td>
</tr>
<tr>
<td><code>scheduled.test.mjs</code></td>
<td>Throttle with scheduled signals</td>
<td><a href="">test/e2e/scheduled.test.mjs</a></td>
</tr>
</tbody>
</table>
<hr>
<a id="common-pitfalls" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Common Pitfalls<a href="#common-pitfalls" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="pitfall-1-confusing-interval-with-signal-lifetime" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Pitfall 1: Confusing Interval with Signal Lifetime<a href="#pitfall-1-confusing-interval-with-signal-lifetime" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><strong>Interval</strong>: Controls <strong>how often</strong> <code>getSignal()</code> is called (throttling)</li>
<li><strong>minuteEstimatedTime</strong>: Controls <strong>how long</strong> an active signal lives before time expiration</li>
</ul>
<p>These are independent parameters. A strategy with <code>interval='5m'</code> can have <code>minuteEstimatedTime=120</code> (2 hours).</p>
<hr>
<a id="pitfall-2-expecting-sub-interval-updates-in-live-mode" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Pitfall 2: Expecting Sub-Interval Updates in Live Mode<a href="#pitfall-2-expecting-sub-interval-updates-in-live-mode" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>In live mode with <code>interval='5m'</code>, even though <code>tick()</code> runs every minute, <code>getSignal()</code> only executes every 5 minutes. Price checks for active signals still occur every minute (TP/SL monitoring), but <strong>new signal generation is throttled</strong>.</p>
<hr>
<a id="summary" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Summary<a href="#summary" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Interval throttling in backtest-kit enforces minimum time delays between <code>getSignal()</code> calls, preventing excessive strategy evaluations and aligning signal generation with meaningful timeframes. The system uses per-instance <code>_lastSignalTimestamp</code> tracking with temporal consistency via <code>ExecutionContextService</code>, ensuring identical behavior across backtest and live modes while maintaining symbol-strategy isolation.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#interval-throttling"><span>Interval <wbr/>Throttling</span></a><ul><li><a href="#purpose-and-scope"><span>Purpose and <wbr/>Scope</span></a></li><li><a href="#interval-types"><span>Interval <wbr/>Types</span></a></li><li><a href="#throttling-mechanism"><span>Throttling <wbr/>Mechanism</span></a></li><li><ul><li><a href="#architecture-diagram"><span>Architecture <wbr/>Diagram</span></a></li></ul></li><li><a href="#implementation-details"><span>Implementation <wbr/>Details</span></a></li><li><ul><li><a href="#throttle-check-logic"><span>Throttle <wbr/>Check <wbr/>Logic</span></a></li><li><a href="#interval-lookup-table"><span>Interval <wbr/>Lookup <wbr/>Table</span></a></li></ul></li><li><a href="#configuration-in-strategy-schemas"><span>Configuration in <wbr/>Strategy <wbr/>Schemas</span></a></li><li><ul><li><a href="#schema-definition"><span>Schema <wbr/>Definition</span></a></li><li><a href="#registration-example"><span>Registration <wbr/>Example</span></a></li></ul></li><li><a href="#behavior-across-execution-modes"><span>Behavior <wbr/>Across <wbr/>Execution <wbr/>Modes</span></a></li><li><ul><li><a href="#backtest-mode"><span>Backtest <wbr/>Mode</span></a></li><li><a href="#live-mode"><span>Live <wbr/>Mode</span></a></li></ul></li><li><a href="#per-instance-state-isolation"><span>Per-<wbr/>Instance <wbr/>State <wbr/>Isolation</span></a></li><li><a href="#relationship-with-other-components"><span>Relationship with <wbr/>Other <wbr/>Components</span></a></li><li><ul><li><a href="#integration-points"><span>Integration <wbr/>Points</span></a></li></ul></li><li><a href="#use-cases-and-best-practices"><span>Use <wbr/>Cases and <wbr/>Best <wbr/>Practices</span></a></li><li><ul><li><a href="#interval-selection-guidelines"><span>Interval <wbr/>Selection <wbr/>Guidelines</span></a></li><li><a href="#computational-efficiency"><span>Computational <wbr/>Efficiency</span></a></li></ul></li><li><a href="#timing-precision"><span>Timing <wbr/>Precision</span></a></li><li><ul><li><a href="#timestamp-sources"><span>Timestamp <wbr/>Sources</span></a></li><li><a href="#boundary-behavior"><span>Boundary <wbr/>Behavior</span></a></li></ul></li><li><a href="#testing-coverage"><span>Testing <wbr/>Coverage</span></a></li><li><a href="#common-pitfalls"><span>Common <wbr/>Pitfalls</span></a></li><li><ul><li><a href="#pitfall-1-confusing-interval-with-signal-lifetime"><span>Pitfall 1: <wbr/>Confusing <wbr/>Interval with <wbr/>Signal <wbr/>Lifetime</span></a></li><li><a href="#pitfall-2-expecting-sub-interval-updates-in-live-mode"><span>Pitfall 2: <wbr/>Expecting <wbr/>Sub-<wbr/>Interval <wbr/>Updates in <wbr/>Live <wbr/>Mode</span></a></li></ul></li><li><a href="#summary"><span>Summary</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
