<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/36_reporting_and_analytics | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_36_reporting_and_analytics.html">design/36_reporting_and_analytics</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="reporting-and-analytics" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Reporting and Analytics<a href="#reporting-and-analytics" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>This document describes the reporting and analytics capabilities of the backtest-kit framework. The system provides markdown-based reports for both backtest and live trading modes, accumulating signal events and calculating performance statistics.</p>
<p>For information about signal lifecycle and PnL calculations that feed into reports, see <a href="design_23_signal_lifecycle.html">Signal Lifecycle</a>. For details on the public API methods to retrieve reports, see <a href="design_10_backtest_api.html">Backtest API</a> and <a href="design_11_live_trading_api.html">Live Trading API</a>.</p>
<a id="overview" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Overview<a href="#overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The reporting system consists of two specialized services that passively observe signal events and accumulate them for analysis:</p>
<ul>
<li><strong>BacktestMarkdownService</strong>: Accumulates only closed signals from backtest execution</li>
<li><strong>LiveMarkdownService</strong>: Accumulates all tick events (idle, opened, active, closed) from live trading</li>
</ul>
<p>Both services operate independently from the main execution flow, subscribing to signal events via event emitters and maintaining isolated storage per strategy. Reports are generated on-demand and can be exported to markdown files.</p>
<p><img src="../media/36_Reporting_and_Analytics_0.svg" alt="Mermaid Diagram"></p>
<a id="service-architecture" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Service Architecture<a href="#service-architecture" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="backtestmarkdownservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">BacktestMarkdownService<a href="#backtestmarkdownservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>BacktestMarkdownService</code> class is designed for post-execution analysis of backtest results. It only processes closed signals, ignoring opened and active states to focus on completed trades.</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Event Source</strong></td>
<td><code>signalBacktestEmitter</code></td>
</tr>
<tr>
<td><strong>Event Types</strong></td>
<td>Only <code>closed</code> actions</td>
</tr>
<tr>
<td><strong>Storage Model</strong></td>
<td>Accumulates all closed signals chronologically</td>
</tr>
<tr>
<td><strong>Default Output Path</strong></td>
<td><code>./logs/backtest/{strategyName}.md</code></td>
</tr>
<tr>
<td><strong>Initialization</strong></td>
<td>Automatic via <code>singleshot</code> decorator</td>
</tr>
</tbody>
</table>
<p>The service maintains a memoized <code>ReportStorage</code> instance per strategy name, ensuring isolated data collection when multiple strategies run concurrently. The storage accumulates <code>IStrategyTickResultClosed</code> objects in an internal array.</p>
<a id="livemarkdownservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">LiveMarkdownService<a href="#livemarkdownservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>LiveMarkdownService</code> class provides operational visibility into live trading activity. Unlike the backtest service, it captures all tick events to provide a complete audit trail.</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Event Source</strong></td>
<td><code>signalLiveEmitter</code></td>
</tr>
<tr>
<td><strong>Event Types</strong></td>
<td><code>idle</code>, <code>opened</code>, <code>active</code>, <code>closed</code></td>
</tr>
<tr>
<td><strong>Storage Model</strong></td>
<td>Updates existing events by <code>signalId</code> for active/closed</td>
</tr>
<tr>
<td><strong>Default Output Path</strong></td>
<td><code>./logs/live/{strategyName}.md</code></td>
</tr>
<tr>
<td><strong>Initialization</strong></td>
<td>Automatic via <code>singleshot</code> decorator</td>
</tr>
<tr>
<td><strong>Statistics</strong></td>
<td>Win rate, average PNL, W/L counts</td>
</tr>
</tbody>
</table>
<p>The service uses a more sophisticated storage mechanism that replaces existing events with the same <code>signalId</code>, ensuring the report shows the latest state of each signal. This prevents duplicate entries when a signal transitions from <code>active</code> to <code>closed</code>.</p>
<a id="report-structure" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Report Structure<a href="#report-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="column-configuration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Column Configuration<a href="#column-configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Both services define their reports using a <code>Column</code> interface that specifies extraction and formatting logic:</p>
<p><img src="../media/36_Reporting_and_Analytics_1.svg" alt="Mermaid Diagram"></p>
<a id="backtest-report-columns" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Backtest Report Columns<a href="#backtest-report-columns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The backtest report focuses on completed trade analysis with the following columns:</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Format</th>
<th>Source</th>
</tr>
</thead>
<tbody>
<tr>
<td>Signal ID</td>
<td>Plain text</td>
<td><code>data.signal.id</code></td>
</tr>
<tr>
<td>Symbol</td>
<td>Plain text</td>
<td><code>data.signal.symbol</code></td>
</tr>
<tr>
<td>Position</td>
<td>Uppercase</td>
<td><code>data.signal.position</code></td>
</tr>
<tr>
<td>Note</td>
<td>Plain text or &quot;N/A&quot;</td>
<td><code>data.signal.note ?? &quot;N/A&quot;</code></td>
</tr>
<tr>
<td>Open Price</td>
<td>Fixed 8 decimals + &quot; USD&quot;</td>
<td><code>data.signal.priceOpen</code></td>
</tr>
<tr>
<td>Close Price</td>
<td>Fixed 8 decimals + &quot; USD&quot;</td>
<td><code>data.currentPrice</code></td>
</tr>
<tr>
<td>Take Profit</td>
<td>Fixed 8 decimals + &quot; USD&quot;</td>
<td><code>data.signal.priceTakeProfit</code></td>
</tr>
<tr>
<td>Stop Loss</td>
<td>Fixed 8 decimals + &quot; USD&quot;</td>
<td><code>data.signal.priceStopLoss</code></td>
</tr>
<tr>
<td>PNL (net)</td>
<td>Fixed 2 decimals + &quot;%&quot; with sign</td>
<td><code>data.pnl.pnlPercentage</code></td>
</tr>
<tr>
<td>Close Reason</td>
<td>Plain text</td>
<td><code>data.closeReason</code></td>
</tr>
<tr>
<td>Duration (min)</td>
<td>Integer minutes</td>
<td><code>(closeTimestamp - timestamp) / 60000</code></td>
</tr>
<tr>
<td>Open Time</td>
<td>ISO 8601</td>
<td><code>new Date(data.signal.timestamp).toISOString()</code></td>
</tr>
<tr>
<td>Close Time</td>
<td>ISO 8601</td>
<td><code>new Date(data.closeTimestamp).toISOString()</code></td>
</tr>
</tbody>
</table>
<a id="live-report-columns" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Live Report Columns<a href="#live-report-columns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The live trading report includes all event types with these columns:</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Format</th>
<th>Nullable</th>
</tr>
</thead>
<tbody>
<tr>
<td>Timestamp</td>
<td>ISO 8601</td>
<td>No</td>
</tr>
<tr>
<td>Action</td>
<td>Uppercase (IDLE, OPENED, ACTIVE, CLOSED)</td>
<td>No</td>
</tr>
<tr>
<td>Symbol</td>
<td>Plain text or &quot;N/A&quot;</td>
<td>Yes</td>
</tr>
<tr>
<td>Signal ID</td>
<td>Plain text or &quot;N/A&quot;</td>
<td>Yes</td>
</tr>
<tr>
<td>Position</td>
<td>Uppercase or &quot;N/A&quot;</td>
<td>Yes</td>
</tr>
<tr>
<td>Note</td>
<td>Plain text or &quot;N/A&quot;</td>
<td>Yes</td>
</tr>
<tr>
<td>Current Price</td>
<td>Fixed 8 decimals + &quot; USD&quot;</td>
<td>No</td>
</tr>
<tr>
<td>Open Price</td>
<td>Fixed 8 decimals + &quot; USD&quot; or &quot;N/A&quot;</td>
<td>Yes</td>
</tr>
<tr>
<td>Take Profit</td>
<td>Fixed 8 decimals + &quot; USD&quot; or &quot;N/A&quot;</td>
<td>Yes</td>
</tr>
<tr>
<td>Stop Loss</td>
<td>Fixed 8 decimals + &quot; USD&quot; or &quot;N/A&quot;</td>
<td>Yes</td>
</tr>
<tr>
<td>PNL (net)</td>
<td>Fixed 2 decimals + &quot;%&quot; with sign or &quot;N/A&quot;</td>
<td>Yes</td>
</tr>
<tr>
<td>Close Reason</td>
<td>Plain text or &quot;N/A&quot;</td>
<td>Yes</td>
</tr>
<tr>
<td>Duration (min)</td>
<td>Integer minutes or &quot;N/A&quot;</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<p>The nullable columns are only populated for relevant event types (e.g., <code>pnl</code> only exists for <code>closed</code> events).</p>
<a id="data-storage-and-event-processing" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Data Storage and Event Processing<a href="#data-storage-and-event-processing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="reportstorage-implementation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">ReportStorage Implementation<a href="#reportstorage-implementation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Both services use an internal <code>ReportStorage</code> class to manage data accumulation:</p>
<p><img src="../media/36_Reporting_and_Analytics_2.svg" alt="Mermaid Diagram"></p>
<a id="backtest-event-processing" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Backtest Event Processing<a href="#backtest-event-processing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The backtest service implements a simple append-only model:</p>
<pre><code class="typescript"><span class="hl-5">// Simplified logic from BacktestMarkdownService.tick()</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> !== </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-3">return</span><span class="hl-1">; </span><span class="hl-5">// Ignore non-closed events</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">storage</span><span class="hl-1"> = </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-0">getStorage</span><span class="hl-1">(</span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">strategyName</span><span class="hl-1">);</span><br/><span class="hl-4">storage</span><span class="hl-1">.</span><span class="hl-0">addSignal</span><span class="hl-1">(</span><span class="hl-4">data</span><span class="hl-1">); </span><span class="hl-5">// Append to list</span>
</code><button type="button">Copy</button></pre>

<p>Each closed signal is appended to the <code>_signalList</code> array without modification.</p>
<a id="live-event-processing" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Live Event Processing<a href="#live-event-processing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The live service implements an update-or-append model to handle signal state transitions:</p>
<p><img src="../media/36_Reporting_and_Analytics_3.svg" alt="Mermaid Diagram"></p>
<p>This design ensures that each signal appears only once in the final report, showing its most recent state.</p>
<a id="performance-metrics" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Performance Metrics<a href="#performance-metrics" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="live-trading-statistics" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Live Trading Statistics<a href="#live-trading-statistics" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>LiveMarkdownService</code> calculates real-time trading performance metrics when generating reports:</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Calculation</th>
<th>Formula</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Total Events</strong></td>
<td>Count of all events</td>
<td><code>_eventList.length</code></td>
</tr>
<tr>
<td><strong>Closed Signals</strong></td>
<td>Count of closed events</td>
<td><code>_eventList.filter(e =&gt; e.action === &quot;closed&quot;).length</code></td>
</tr>
<tr>
<td><strong>Win Count</strong></td>
<td>Closed events with positive PNL</td>
<td><code>closedEvents.filter(e =&gt; e.pnl &gt; 0).length</code></td>
</tr>
<tr>
<td><strong>Loss Count</strong></td>
<td>Closed events with negative PNL</td>
<td><code>closedEvents.filter(e =&gt; e.pnl &lt; 0).length</code></td>
</tr>
<tr>
<td><strong>Win Rate</strong></td>
<td>Percentage of winning trades</td>
<td><code>(winCount / totalClosed) * 100</code></td>
</tr>
<tr>
<td><strong>Average PNL</strong></td>
<td>Mean PNL across all closed signals</td>
<td><code>sum(pnl) / totalClosed</code></td>
</tr>
</tbody>
</table>
<p>Example report header:</p>
<pre><code><span class="hl-1"># </span><span class="hl-4">Live</span><span class="hl-1"> </span><span class="hl-4">Trading</span><span class="hl-1"> </span><span class="hl-10">Report</span><span class="hl-1">: </span><span class="hl-4">my</span><span class="hl-1">-</span><span class="hl-4">strategy</span><br/><br/><span class="hl-4">Total</span><span class="hl-1"> </span><span class="hl-10">events</span><span class="hl-1">: </span><span class="hl-8">245</span><br/><span class="hl-4">Closed</span><span class="hl-1"> </span><span class="hl-10">signals</span><span class="hl-1">: </span><span class="hl-8">18</span><br/><span class="hl-4">Win</span><span class="hl-1"> </span><span class="hl-10">rate</span><span class="hl-1">: </span><span class="hl-8">61.11</span><span class="hl-1">% (11</span><span class="hl-7">W</span><span class="hl-1"> / 7</span><span class="hl-7">L</span><span class="hl-1">)</span><br/><span class="hl-4">Average</span><span class="hl-1"> </span><span class="hl-10">PNL</span><span class="hl-1">: +</span><span class="hl-8">2.34</span><span class="hl-1">%</span>
</code><button>Copy</button></pre>

<a id="backtest-statistics" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Backtest Statistics<a href="#backtest-statistics" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>BacktestMarkdownService</code> provides a minimal summary showing only the total signal count. Users can derive additional statistics by analyzing the full signal table.</p>
<pre><code><span class="hl-1"># </span><span class="hl-4">Backtest</span><span class="hl-1"> </span><span class="hl-10">Report</span><span class="hl-1">: </span><span class="hl-4">my</span><span class="hl-1">-</span><span class="hl-4">strategy</span><br/><br/><span class="hl-4">Total</span><span class="hl-1"> </span><span class="hl-10">signals</span><span class="hl-1">: </span><span class="hl-8">42</span>
</code><button>Copy</button></pre>

<p>The framework does not calculate win rates or average PNL for backtest reports, as these metrics are better computed by specialized analysis tools that can account for strategy-specific factors.</p>
<a id="public-api-methods" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Public API Methods<a href="#public-api-methods" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="retrieving-reports" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Retrieving Reports<a href="#retrieving-reports" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Both services expose a <code>getReport()</code> method that returns a markdown-formatted string:</p>
<p><img src="../media/36_Reporting_and_Analytics_4.svg" alt="Mermaid Diagram"></p>
<p>Usage examples:</p>
<pre><code class="typescript"><span class="hl-5">// Backtest</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">report</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">report</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Live</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">report</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">report</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="saving-reports-to-disk" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Saving Reports to Disk<a href="#saving-reports-to-disk" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>dump()</code> method writes reports to the file system:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Default Path</th>
<th>Behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Backtest.dump(strategyName, path?)</code></td>
<td><code>./logs/backtest/</code></td>
<td>Creates directory recursively, overwrites existing file</td>
</tr>
<tr>
<td><code>Live.dump(strategyName, path?)</code></td>
<td><code>./logs/live/</code></td>
<td>Creates directory recursively, overwrites existing file</td>
</tr>
</tbody>
</table>
<p>The file name is always <code>{strategyName}.md</code>. The method uses Node.js <code>fs/promises</code> for async file operations:</p>
<pre><code class="typescript"><span class="hl-5">// Internal implementation</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">mkdir</span><span class="hl-1">(</span><span class="hl-4">dir</span><span class="hl-1">, { </span><span class="hl-4">recursive:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1"> });</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">writeFile</span><span class="hl-1">(</span><span class="hl-4">filepath</span><span class="hl-1">, </span><span class="hl-4">markdown</span><span class="hl-1">, </span><span class="hl-2">&quot;utf-8&quot;</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p>Error handling logs failures to console but does not throw exceptions, ensuring that report generation failures don't crash the main application.</p>
<a id="clearing-accumulated-data" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Clearing Accumulated Data<a href="#clearing-accumulated-data" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>clear()</code> method resets accumulated data:</p>
<pre><code class="typescript"><span class="hl-5">// Clear specific strategy</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Clear all strategies</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">();</span>
</code><button type="button">Copy</button></pre>

<p>This method delegates to the memoized <code>getStorage</code> function's <code>clear()</code> method, which removes cached <code>ReportStorage</code> instances. Clearing all strategies removes all cached instances, while clearing a specific strategy only removes that strategy's cache.</p>
<a id="initialization-and-event-subscription" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Initialization and Event Subscription<a href="#initialization-and-event-subscription" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="automatic-initialization" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Automatic Initialization<a href="#automatic-initialization" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Both services use the <code>singleshot</code> decorator from <code>functools-kit</code> to ensure initialization happens exactly once:</p>
<p><img src="../media/36_Reporting_and_Analytics_5.svg" alt="Mermaid Diagram"></p>
<p>The <code>init()</code> method is protected and automatically invoked on first service use. It subscribes the service's <code>tick()</code> method to the appropriate signal emitter.</p>
<a id="event-emitter-binding" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Event Emitter Binding<a href="#event-emitter-binding" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/36_Reporting_and_Analytics_6.svg" alt="Mermaid Diagram"></p>
<p>The emitters are defined in <code>src/config/emitters.ts</code> and use the event system to decouple signal generation from report accumulation.</p>
<a id="markdown-table-formatting" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Markdown Table Formatting<a href="#markdown-table-formatting" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Both services use the <code>str.table()</code> utility from <code>functools-kit</code> to generate markdown tables. The table formatting follows GitHub Flavored Markdown syntax:</p>
<pre><code><span class="hl-1">| </span><span class="hl-4">Column</span><span class="hl-1"> </span><span class="hl-8">1</span><span class="hl-1"> | </span><span class="hl-4">Column</span><span class="hl-1"> </span><span class="hl-8">2</span><span class="hl-1"> | </span><span class="hl-4">Column</span><span class="hl-1"> </span><span class="hl-8">3</span><span class="hl-1"> |</span><br/><span class="hl-1">|----------|----------|----------|</span><br/><span class="hl-1">| </span><span class="hl-4">Value</span><span class="hl-1"> </span><span class="hl-8">1</span><span class="hl-1">  | </span><span class="hl-4">Value</span><span class="hl-1"> </span><span class="hl-8">2</span><span class="hl-1">  | </span><span class="hl-4">Value</span><span class="hl-1"> </span><span class="hl-8">3</span><span class="hl-1">  |</span><br/><span class="hl-1">| </span><span class="hl-4">Value</span><span class="hl-1"> </span><span class="hl-8">4</span><span class="hl-1">  | </span><span class="hl-4">Value</span><span class="hl-1"> </span><span class="hl-8">5</span><span class="hl-1">  | </span><span class="hl-4">Value</span><span class="hl-1"> </span><span class="hl-8">6</span><span class="hl-1">  |</span>
</code><button>Copy</button></pre>

<p>The table generation process:</p>
<ol>
<li>Extract column headers from <code>columns.map(col =&gt; col.label)</code></li>
<li>Map each signal/event to a row using <code>columns.map(col =&gt; col.format(data))</code></li>
<li>Combine into 2D array: <code>[header, ...rows]</code></li>
<li>Pass to <code>str.table()</code> which adds markdown formatting</li>
<li>Wrap in markdown document with title, statistics, and timestamp</li>
</ol>
<a id="integration-with-execution-flow" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Integration with Execution Flow<a href="#integration-with-execution-flow" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The markdown services operate completely independently from the main execution loop:</p>
<p><img src="../media/36_Reporting_and_Analytics_7.svg" alt="Mermaid Diagram"></p>
<p>This architecture ensures that report generation never blocks strategy execution or impacts performance. The event-driven design allows reports to be generated incrementally as signals close, rather than requiring post-processing of execution results.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#reporting-and-analytics"><span>Reporting and <wbr/>Analytics</span></a><ul><li><a href="#overview"><span>Overview</span></a></li><li><a href="#service-architecture"><span>Service <wbr/>Architecture</span></a></li><li><ul><li><a href="#backtestmarkdownservice"><span>Backtest<wbr/>Markdown<wbr/>Service</span></a></li><li><a href="#livemarkdownservice"><span>Live<wbr/>Markdown<wbr/>Service</span></a></li></ul></li><li><a href="#report-structure"><span>Report <wbr/>Structure</span></a></li><li><ul><li><a href="#column-configuration"><span>Column <wbr/>Configuration</span></a></li><li><a href="#backtest-report-columns"><span>Backtest <wbr/>Report <wbr/>Columns</span></a></li><li><a href="#live-report-columns"><span>Live <wbr/>Report <wbr/>Columns</span></a></li></ul></li><li><a href="#data-storage-and-event-processing"><span>Data <wbr/>Storage and <wbr/>Event <wbr/>Processing</span></a></li><li><ul><li><a href="#reportstorage-implementation"><span>Report<wbr/>Storage <wbr/>Implementation</span></a></li><li><a href="#backtest-event-processing"><span>Backtest <wbr/>Event <wbr/>Processing</span></a></li><li><a href="#live-event-processing"><span>Live <wbr/>Event <wbr/>Processing</span></a></li></ul></li><li><a href="#performance-metrics"><span>Performance <wbr/>Metrics</span></a></li><li><ul><li><a href="#live-trading-statistics"><span>Live <wbr/>Trading <wbr/>Statistics</span></a></li><li><a href="#backtest-statistics"><span>Backtest <wbr/>Statistics</span></a></li></ul></li><li><a href="#public-api-methods"><span>Public API <wbr/>Methods</span></a></li><li><ul><li><a href="#retrieving-reports"><span>Retrieving <wbr/>Reports</span></a></li><li><a href="#saving-reports-to-disk"><span>Saving <wbr/>Reports to <wbr/>Disk</span></a></li><li><a href="#clearing-accumulated-data"><span>Clearing <wbr/>Accumulated <wbr/>Data</span></a></li></ul></li><li><a href="#initialization-and-event-subscription"><span>Initialization and <wbr/>Event <wbr/>Subscription</span></a></li><li><ul><li><a href="#automatic-initialization"><span>Automatic <wbr/>Initialization</span></a></li><li><a href="#event-emitter-binding"><span>Event <wbr/>Emitter <wbr/>Binding</span></a></li></ul></li><li><a href="#markdown-table-formatting"><span>Markdown <wbr/>Table <wbr/>Formatting</span></a></li><li><a href="#integration-with-execution-flow"><span>Integration with <wbr/>Execution <wbr/>Flow</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
