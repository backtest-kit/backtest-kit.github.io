<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/46_signal_generation_and_validation | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_46_signal_generation_and_validation.html">design/46_signal_generation_and_validation</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="signal-generation-and-validation" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Signal Generation and Validation<a href="#signal-generation-and-validation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>This page explains how trading signals are generated by user-defined strategies and validated by the framework before execution. Signal validation ensures financial safety by rejecting signals with invalid prices, insufficient profit margins, excessive risk, or unrealistic lifetimes.</p>
<p><strong>Scope</strong>: This page covers the <code>GET_SIGNAL_FN</code> wrapper, <code>VALIDATE_SIGNAL_FN</code> validation logic, signal augmentation from <code>ISignalDto</code> to <code>ISignalRow</code>, and global configuration parameters controlling validation thresholds. For signal lifecycle management after validation, see <a href="design_45_signal_states.html">Signal States</a>. For risk management validation, see <a href="design_65_risk_validation.html">Risk Validation</a>.</p>
<hr>
<a id="signal-generation-flow" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Signal Generation Flow<a href="#signal-generation-flow" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>When a strategy's <code>tick()</code> method executes, the framework calls the user's <code>getSignal()</code> function through the <code>GET_SIGNAL_FN</code> wrapper, which orchestrates signal generation, validation, and augmentation.</p>
<a id="end-to-end-signal-generation-pipeline" class="tsd-anchor"></a><h3 class="tsd-anchor-link">End-to-End Signal Generation Pipeline<a href="#end-to-end-signal-generation-pipeline" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/46_Signal_Generation_and_Validation_0.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="signal-data-structures" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Signal Data Structures<a href="#signal-data-structures" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The framework transforms user-provided <code>ISignalDto</code> objects into validated <code>ISignalRow</code> objects through augmentation with auto-generated metadata.</p>
<a id="interface-comparison" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Interface Comparison<a href="#interface-comparison" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Field</th>
<th>ISignalDto</th>
<th>ISignalRow</th>
<th>IScheduledSignalRow</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>Optional</td>
<td><strong>Required</strong> (UUID v4)</td>
<td><strong>Required</strong></td>
<td>Auto-generated if not provided</td>
</tr>
<tr>
<td><code>position</code></td>
<td><strong>Required</strong></td>
<td><strong>Required</strong></td>
<td><strong>Required</strong></td>
<td>Trade direction: <code>&quot;long&quot;</code> or <code>&quot;short&quot;</code></td>
</tr>
<tr>
<td><code>priceOpen</code></td>
<td>Optional</td>
<td><strong>Required</strong></td>
<td><strong>Required</strong></td>
<td>Entry price (current VWAP if omitted)</td>
</tr>
<tr>
<td><code>priceTakeProfit</code></td>
<td><strong>Required</strong></td>
<td><strong>Required</strong></td>
<td><strong>Required</strong></td>
<td>Take profit target price</td>
</tr>
<tr>
<td><code>priceStopLoss</code></td>
<td><strong>Required</strong></td>
<td><strong>Required</strong></td>
<td><strong>Required</strong></td>
<td>Stop loss exit price</td>
</tr>
<tr>
<td><code>minuteEstimatedTime</code></td>
<td><strong>Required</strong></td>
<td><strong>Required</strong></td>
<td><strong>Required</strong></td>
<td>Expected signal lifetime in minutes</td>
</tr>
<tr>
<td><code>note</code></td>
<td>Optional</td>
<td>Optional</td>
<td>Optional</td>
<td>Human-readable description</td>
</tr>
<tr>
<td><code>symbol</code></td>
<td>-</td>
<td><strong>Required</strong></td>
<td><strong>Required</strong></td>
<td>Trading pair (e.g., &quot;BTCUSDT&quot;)</td>
</tr>
<tr>
<td><code>exchangeName</code></td>
<td>-</td>
<td><strong>Required</strong></td>
<td><strong>Required</strong></td>
<td>Exchange identifier</td>
</tr>
<tr>
<td><code>strategyName</code></td>
<td>-</td>
<td><strong>Required</strong></td>
<td><strong>Required</strong></td>
<td>Strategy identifier</td>
</tr>
<tr>
<td><code>scheduledAt</code></td>
<td>-</td>
<td><strong>Required</strong></td>
<td><strong>Required</strong></td>
<td>Signal creation timestamp (ms)</td>
</tr>
<tr>
<td><code>pendingAt</code></td>
<td>-</td>
<td><strong>Required</strong></td>
<td><strong>Required</strong></td>
<td>Position activation timestamp (ms)</td>
</tr>
<tr>
<td><code>_isScheduled</code></td>
<td>-</td>
<td><strong>Required</strong></td>
<td><strong>Required</strong></td>
<td>Runtime marker for scheduled signals</td>
</tr>
</tbody>
</table>
<p><strong>Key Differences</strong>:</p>
<ul>
<li><code>ISignalDto</code>: User-facing DTO returned by <code>getSignal()</code></li>
<li><code>ISignalRow</code>: Framework-augmented signal with execution context</li>
<li><code>IScheduledSignalRow</code>: Extends <code>ISignalRow</code> with guaranteed <code>priceOpen</code> (delayed entry signal)</li>
</ul>
<a id="augmentation-example" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Augmentation Example<a href="#augmentation-example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/46_Signal_Generation_and_Validation_1.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="validate_signal_fn-validation-checks" class="tsd-anchor"></a><h2 class="tsd-anchor-link">VALIDATE_SIGNAL_FN Validation Checks<a href="#validate_signal_fn-validation-checks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>VALIDATE_SIGNAL_FN</code> performs comprehensive validation of signal parameters to prevent financial losses from invalid trades. All validation checks throw descriptive errors that are caught by <code>GET_SIGNAL_FN</code>'s <code>trycatch</code> wrapper.</p>
<a id="validation-architecture" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Validation Architecture<a href="#validation-architecture" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/46_Signal_Generation_and_Validation_2.svg" alt="Mermaid Diagram"></p>
<a id="validation-check-catalog" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Validation Check Catalog<a href="#validation-check-catalog" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><a id="1-safety-checks-naninfinity-protection" class="tsd-anchor"></a><h4 class="tsd-anchor-link">1. Safety Checks (NaN/Infinity Protection)<a href="#1-safety-checks-naninfinity-protection" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Prevents calculation explosions from non-finite values.</p>
<pre><code class="typescript"><span class="hl-5">// Lines 43-58</span><br/><span class="hl-3">if</span><span class="hl-1"> (!</span><span class="hl-0">isFinite</span><span class="hl-1">(</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">)) {</span><br/><span class="hl-1">  </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-2">`priceOpen must be a finite number, got </span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceOpen</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span><br/><span class="hl-3">if</span><span class="hl-1"> (!</span><span class="hl-0">isFinite</span><span class="hl-1">(</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceTakeProfit</span><span class="hl-1">)) {</span><br/><span class="hl-1">  </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-2">`priceTakeProfit must be a finite number, got </span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceTakeProfit</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span><br/><span class="hl-3">if</span><span class="hl-1"> (!</span><span class="hl-0">isFinite</span><span class="hl-1">(</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceStopLoss</span><span class="hl-1">)) {</span><br/><span class="hl-1">  </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-2">`priceStopLoss must be a finite number, got </span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceStopLoss</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Rationale</strong>: <code>NaN</code> or <code>Infinity</code> in prices causes all PnL calculations to become <code>NaN</code>, corrupting backtest results.</p>
<a id="2-positive-price-checks" class="tsd-anchor"></a><h4 class="tsd-anchor-link">2. Positive Price Checks<a href="#2-positive-price-checks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Ensures all prices are positive numbers (physically possible prices).</p>
<pre><code class="typescript"><span class="hl-5">// Lines 61-71</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-0">isFinite</span><span class="hl-1">(</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">) &amp;&amp; </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1"> &lt;= </span><span class="hl-8">0</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-2">`priceOpen must be positive, got </span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceOpen</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-0">isFinite</span><span class="hl-1">(</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceTakeProfit</span><span class="hl-1">) &amp;&amp; </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceTakeProfit</span><span class="hl-1"> &lt;= </span><span class="hl-8">0</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-2">`priceTakeProfit must be positive, got </span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceTakeProfit</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-0">isFinite</span><span class="hl-1">(</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceStopLoss</span><span class="hl-1">) &amp;&amp; </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceStopLoss</span><span class="hl-1"> &lt;= </span><span class="hl-8">0</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-2">`priceStopLoss must be positive, got </span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceStopLoss</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Rationale</strong>: Negative or zero prices are impossible on exchanges and cause undefined behavior in price calculations.</p>
<a id="3-position-specific-logic-validation" class="tsd-anchor"></a><h4 class="tsd-anchor-link">3. Position-Specific Logic Validation<a href="#3-position-specific-logic-validation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Validates TP/SL relationship to <code>priceOpen</code> based on trade direction.</p>
<a id="long-position-rules" class="tsd-anchor"></a><h5 class="tsd-anchor-link">Long Position Rules<a href="#long-position-rules" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h5><pre><code class="typescript"><span class="hl-5">// Lines 74-110</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">position</span><span class="hl-1"> === </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-5">// TP must be ABOVE priceOpen (profit on price increase)</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceTakeProfit</span><span class="hl-1"> &lt;= </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-2">`Long: priceTakeProfit (</span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceTakeProfit</span><span class="hl-6">}</span><span class="hl-2">) must be &gt; priceOpen (</span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceOpen</span><span class="hl-6">}</span><span class="hl-2">)`</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// SL must be BELOW priceOpen (limit loss on price decrease)</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceStopLoss</span><span class="hl-1"> &gt;= </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-2">`Long: priceStopLoss (</span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceStopLoss</span><span class="hl-6">}</span><span class="hl-2">) must be &lt; priceOpen (</span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceOpen</span><span class="hl-6">}</span><span class="hl-2">)`</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Rationale</strong>: Long positions profit when price increases, so TP must be higher than entry price, and SL must be lower to cut losses.</p>
<a id="short-position-rules" class="tsd-anchor"></a><h5 class="tsd-anchor-link">Short Position Rules<a href="#short-position-rules" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h5><pre><code class="typescript"><span class="hl-5">// Lines 114-150</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">position</span><span class="hl-1"> === </span><span class="hl-2">&quot;short&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-5">// TP must be BELOW priceOpen (profit on price decrease)</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceTakeProfit</span><span class="hl-1"> &gt;= </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-2">`Short: priceTakeProfit (</span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceTakeProfit</span><span class="hl-6">}</span><span class="hl-2">) must be &lt; priceOpen (</span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceOpen</span><span class="hl-6">}</span><span class="hl-2">)`</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// SL must be ABOVE priceOpen (limit loss on price increase)</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceStopLoss</span><span class="hl-1"> &lt;= </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-2">`Short: priceStopLoss (</span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceStopLoss</span><span class="hl-6">}</span><span class="hl-2">) must be &gt; priceOpen (</span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceOpen</span><span class="hl-6">}</span><span class="hl-2">)`</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Rationale</strong>: Short positions profit when price decreases, so TP must be lower than entry price, and SL must be higher to cut losses.</p>
<a id="4-minimum-takeprofit-distance-fee-coverage" class="tsd-anchor"></a><h4 class="tsd-anchor-link">4. Minimum TakeProfit Distance (Fee Coverage)<a href="#4-minimum-takeprofit-distance-fee-coverage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Ensures TakeProfit is far enough from entry to cover trading fees and slippage.</p>
<pre><code class="typescript"><span class="hl-5">// Lines 87-97 (Long example)</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">tpDistancePercent</span><span class="hl-1"> = ((</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceTakeProfit</span><span class="hl-1"> - </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">) / </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">) * </span><span class="hl-8">100</span><span class="hl-1">;</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">tpDistancePercent</span><span class="hl-1"> &lt; </span><span class="hl-7">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-7">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-2">`Long: TakeProfit too close to priceOpen (</span><span class="hl-6">${</span><span class="hl-4">tpDistancePercent</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-8">3</span><span class="hl-9">)</span><span class="hl-6">}</span><span class="hl-2">%). `</span><span class="hl-1"> +</span><br/><span class="hl-1">    </span><span class="hl-2">`Minimum distance: </span><span class="hl-6">${</span><span class="hl-7">GLOBAL_CONFIG</span><span class="hl-9">.</span><span class="hl-7">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</span><span class="hl-6">}</span><span class="hl-2">% to cover trading fees. `</span><span class="hl-1"> +</span><br/><span class="hl-1">    </span><span class="hl-2">`Current: TP=</span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceTakeProfit</span><span class="hl-6">}</span><span class="hl-2">, Open=</span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceOpen</span><span class="hl-6">}</span><span class="hl-2">`</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Default Configuration</strong>: <code>CC_MIN_TAKEPROFIT_DISTANCE_PERCENT = 0.1%</code></p>
<p><strong>Rationale</strong>: Trading fees (0.1% entry + 0.1% exit) plus slippage require minimum 0.2-0.3% profit margin to avoid net losses on winning trades.</p>
<p><strong>Example Rejection</strong>:</p>
<ul>
<li><code>priceOpen = 42000</code>, <code>priceTakeProfit = 42010</code> → Distance = 0.024% → <strong>REJECTED</strong></li>
<li>Net PnL after fees: 0.024% - 0.2% = <strong>-0.176% loss despite &quot;winning&quot; trade</strong></li>
</ul>
<a id="5-maximum-stoploss-distance-catastrophic-loss-prevention" class="tsd-anchor"></a><h4 class="tsd-anchor-link">5. Maximum StopLoss Distance (Catastrophic Loss Prevention)<a href="#5-maximum-stoploss-distance-catastrophic-loss-prevention" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Limits maximum loss per signal to protect capital from extreme StopLoss values.</p>
<pre><code class="typescript"><span class="hl-5">// Lines 100-110 (Long example)</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">slDistancePercent</span><span class="hl-1"> = ((</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1"> - </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceStopLoss</span><span class="hl-1">) / </span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">priceOpen</span><span class="hl-1">) * </span><span class="hl-8">100</span><span class="hl-1">;</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">slDistancePercent</span><span class="hl-1"> &gt; </span><span class="hl-7">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-7">CC_MAX_STOPLOSS_DISTANCE_PERCENT</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-2">`Long: StopLoss too far from priceOpen (</span><span class="hl-6">${</span><span class="hl-4">slDistancePercent</span><span class="hl-9">.</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-8">3</span><span class="hl-9">)</span><span class="hl-6">}</span><span class="hl-2">%). `</span><span class="hl-1"> +</span><br/><span class="hl-1">    </span><span class="hl-2">`Maximum distance: </span><span class="hl-6">${</span><span class="hl-7">GLOBAL_CONFIG</span><span class="hl-9">.</span><span class="hl-7">CC_MAX_STOPLOSS_DISTANCE_PERCENT</span><span class="hl-6">}</span><span class="hl-2">% to protect capital. `</span><span class="hl-1"> +</span><br/><span class="hl-1">    </span><span class="hl-2">`Current: SL=</span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceStopLoss</span><span class="hl-6">}</span><span class="hl-2">, Open=</span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">priceOpen</span><span class="hl-6">}</span><span class="hl-2">`</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Default Configuration</strong>: <code>CC_MAX_STOPLOSS_DISTANCE_PERCENT = 20%</code></p>
<p><strong>Rationale</strong>: Prevents single trades from causing catastrophic portfolio drawdowns. A 50% loss requires 100% gain to recover.</p>
<p><strong>Example Rejection</strong>:</p>
<ul>
<li><code>priceOpen = 42000</code>, <code>priceStopLoss = 20000</code> → Distance = 52.4% → <strong>REJECTED</strong></li>
<li>Single trade could lose &gt;50% of position value</li>
</ul>
<a id="6-maximum-signal-lifetime-eternal-signal-prevention" class="tsd-anchor"></a><h4 class="tsd-anchor-link">6. Maximum Signal Lifetime (Eternal Signal Prevention)<a href="#6-maximum-signal-lifetime-eternal-signal-prevention" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Prevents signals from blocking risk limits indefinitely.</p>
<pre><code class="typescript"><span class="hl-5">// Lines 161-170</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">minuteEstimatedTime</span><span class="hl-1"> &gt; </span><span class="hl-7">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-7">CC_MAX_SIGNAL_LIFETIME_MINUTES</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">days</span><span class="hl-1"> = (</span><span class="hl-4">signal</span><span class="hl-1">.</span><span class="hl-4">minuteEstimatedTime</span><span class="hl-1"> / </span><span class="hl-8">60</span><span class="hl-1"> / </span><span class="hl-8">24</span><span class="hl-1">).</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-8">1</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">maxDays</span><span class="hl-1"> = (</span><span class="hl-7">GLOBAL_CONFIG</span><span class="hl-1">.</span><span class="hl-7">CC_MAX_SIGNAL_LIFETIME_MINUTES</span><span class="hl-1"> / </span><span class="hl-8">60</span><span class="hl-1"> / </span><span class="hl-8">24</span><span class="hl-1">).</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">errors</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-2">`minuteEstimatedTime too large (</span><span class="hl-6">${</span><span class="hl-4">signal</span><span class="hl-9">.</span><span class="hl-4">minuteEstimatedTime</span><span class="hl-6">}</span><span class="hl-2"> minutes = </span><span class="hl-6">${</span><span class="hl-4">days</span><span class="hl-6">}</span><span class="hl-2"> days). `</span><span class="hl-1"> +</span><br/><span class="hl-1">    </span><span class="hl-2">`Maximum: </span><span class="hl-6">${</span><span class="hl-7">GLOBAL_CONFIG</span><span class="hl-9">.</span><span class="hl-7">CC_MAX_SIGNAL_LIFETIME_MINUTES</span><span class="hl-6">}</span><span class="hl-2"> minutes (</span><span class="hl-6">${</span><span class="hl-4">maxDays</span><span class="hl-6">}</span><span class="hl-2"> days) to prevent strategy deadlock. `</span><span class="hl-1"> +</span><br/><span class="hl-1">    </span><span class="hl-2">`Eternal signals block risk limits and prevent new trades.`</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Default Configuration</strong>: <code>CC_MAX_SIGNAL_LIFETIME_MINUTES = 1440</code> (1 day)</p>
<p><strong>Rationale</strong>: Active signals count against <code>maxConcurrentPositions</code> risk limits. A signal with <code>minuteEstimatedTime = 50000</code> (34 days) blocks the risk slot for over a month, preventing new trades.</p>
<p><strong>Example Rejection</strong>:</p>
<ul>
<li><code>minuteEstimatedTime = 50000</code> minutes (34.7 days) → <strong>REJECTED</strong></li>
<li>Strategy would be unable to open new positions for &gt;1 month</li>
</ul>
<hr>
<a id="get_signal_fn-orchestration" class="tsd-anchor"></a><h2 class="tsd-anchor-link">GET_SIGNAL_FN Orchestration<a href="#get_signal_fn-orchestration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>GET_SIGNAL_FN</code> wrapper coordinates signal generation, validation, and error handling through a <code>trycatch</code> wrapper with automatic error emission.</p>
<a id="get_signal_fn-control-flow" class="tsd-anchor"></a><h3 class="tsd-anchor-link">GET_SIGNAL_FN Control Flow<a href="#get_signal_fn-control-flow" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/46_Signal_Generation_and_Validation_3.svg" alt="Mermaid Diagram"></p>
<a id="interval-throttling" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Interval Throttling<a href="#interval-throttling" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>INTERVAL_MINUTES</code> map converts <code>SignalInterval</code> strings to milliseconds for throttling:</p>
<pre><code class="typescript"><span class="hl-5">// Lines 31-38</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">INTERVAL_MINUTES</span><span class="hl-1">: </span><span class="hl-10">Record</span><span class="hl-1">&lt;</span><span class="hl-10">SignalInterval</span><span class="hl-1">, </span><span class="hl-10">number</span><span class="hl-1">&gt; = {</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;1m&quot;</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-8">1</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;3m&quot;</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-8">3</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-8">5</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;15m&quot;</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-8">15</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;30m&quot;</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-8">30</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">&quot;1h&quot;</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-8">60</span><span class="hl-1">,</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<p><strong>Logic</strong> (lines 196-208):</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">intervalMinutes</span><span class="hl-1"> = </span><span class="hl-7">INTERVAL_MINUTES</span><span class="hl-1">[</span><span class="hl-4">self</span><span class="hl-1">.</span><span class="hl-4">params</span><span class="hl-1">.</span><span class="hl-4">interval</span><span class="hl-1">];</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">intervalMs</span><span class="hl-1"> = </span><span class="hl-4">intervalMinutes</span><span class="hl-1"> * </span><span class="hl-8">60</span><span class="hl-1"> * </span><span class="hl-8">1000</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Only call getSignal if enough time has passed</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">self</span><span class="hl-1">.</span><span class="hl-4">_lastSignalTimestamp</span><span class="hl-1"> !== </span><span class="hl-6">null</span><span class="hl-1"> &amp;&amp; </span><br/><span class="hl-1">    </span><span class="hl-4">currentTime</span><span class="hl-1"> - </span><span class="hl-4">self</span><span class="hl-1">.</span><span class="hl-4">_lastSignalTimestamp</span><span class="hl-1"> &lt; </span><span class="hl-4">intervalMs</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-6">null</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">self</span><span class="hl-1">.</span><span class="hl-4">_lastSignalTimestamp</span><span class="hl-1"> = </span><span class="hl-4">currentTime</span><span class="hl-1">;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Purpose</strong>: Prevents excessive API calls and ensures strategies generate signals at specified intervals (e.g., <code>interval: &quot;5m&quot;</code> → max 1 signal per 5 minutes).</p>
<a id="error-handling-strategy" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Error Handling Strategy<a href="#error-handling-strategy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>trycatch</code> wrapper (lines 187-283) catches validation errors and prevents crashes:</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">GET_SIGNAL_FN</span><span class="hl-1"> = </span><span class="hl-0">trycatch</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">self</span><span class="hl-1">: </span><span class="hl-10">ClientStrategy</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-10">ISignalRow</span><span class="hl-1"> | </span><span class="hl-10">IScheduledSignalRow</span><span class="hl-1"> | </span><span class="hl-10">null</span><span class="hl-1">&gt; </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// ... signal generation logic ...</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-4">defaultValue:</span><span class="hl-1"> </span><span class="hl-6">null</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">fallback</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">error</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">backtest</span><span class="hl-1">.</span><span class="hl-4">loggerService</span><span class="hl-1">.</span><span class="hl-0">warn</span><span class="hl-1">(</span><span class="hl-2">&quot;ClientStrategy exception thrown&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">        </span><span class="hl-4">error:</span><span class="hl-1"> </span><span class="hl-0">errorData</span><span class="hl-1">(</span><span class="hl-4">error</span><span class="hl-1">),</span><br/><span class="hl-1">        </span><span class="hl-4">message:</span><span class="hl-1"> </span><span class="hl-0">getErrorMessage</span><span class="hl-1">(</span><span class="hl-4">error</span><span class="hl-1">),</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-4">errorEmitter</span><span class="hl-1">.</span><span class="hl-0">next</span><span class="hl-1">(</span><span class="hl-4">error</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Behavior</strong>:</p>
<ul>
<li><strong>Validation errors</strong> → Logged, emitted to <code>errorEmitter</code>, returns <code>null</code></li>
<li><strong>User function errors</strong> → Same handling (logged + emitted + null)</li>
<li><strong>Framework continues execution</strong> without crashing</li>
</ul>
<p><strong>Observability</strong>: Errors are emitted to <code>errorEmitter</code> for monitoring via <code>listenError()</code> event listener.</p>
<hr>
<a id="scheduled-vs-immediate-signals" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Scheduled vs Immediate Signals<a href="#scheduled-vs-immediate-signals" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Signals can be immediate (open at current price) or scheduled (wait for specific entry price).</p>
<a id="signal-type-decision-tree" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Signal Type Decision Tree<a href="#signal-type-decision-tree" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/46_Signal_Generation_and_Validation_4.svg" alt="Mermaid Diagram"></p>
<a id="immediate-signal-example" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Immediate Signal Example<a href="#immediate-signal-example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// User returns ISignalDto without priceOpen</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-11">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-8">42000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceStopLoss</span><span class="hl-1">: </span><span class="hl-8">40000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-8">60</span><span class="hl-1">,</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Framework augments to ISignalRow (lines 256-269)</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-11">id</span><span class="hl-1">: </span><span class="hl-2">&quot;a1b2c3d4-e5f6-7890-abcd-ef1234567890&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceOpen</span><span class="hl-1">: </span><span class="hl-8">41000</span><span class="hl-1">,  </span><span class="hl-5">// ← currentPrice from VWAP</span><br/><span class="hl-1">  </span><span class="hl-11">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-8">42000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceStopLoss</span><span class="hl-1">: </span><span class="hl-8">40000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-8">60</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">symbol</span><span class="hl-1">: </span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">exchangeName</span><span class="hl-1">: </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">strategyName</span><span class="hl-1">: </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">scheduledAt</span><span class="hl-1">: </span><span class="hl-8">1704067200000</span><span class="hl-1">,  </span><span class="hl-5">// ← Same timestamp</span><br/><span class="hl-1">  </span><span class="hl-11">pendingAt</span><span class="hl-1">: </span><span class="hl-8">1704067200000</span><span class="hl-1">,    </span><span class="hl-5">// ← Same timestamp (immediate entry)</span><br/><span class="hl-1">  </span><span class="hl-11">_isScheduled</span><span class="hl-1">: </span><span class="hl-6">false</span><span class="hl-1">,</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Behavior</strong>: Position opens immediately at current VWAP price. Both <code>scheduledAt</code> and <code>pendingAt</code> are identical.</p>
<a id="scheduled-signal-example" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Scheduled Signal Example<a href="#scheduled-signal-example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// User returns ISignalDto with priceOpen</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-11">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceOpen</span><span class="hl-1">: </span><span class="hl-8">41000</span><span class="hl-1">,  </span><span class="hl-5">// ← User specifies entry price</span><br/><span class="hl-1">  </span><span class="hl-11">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-8">42000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceStopLoss</span><span class="hl-1">: </span><span class="hl-8">40000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-8">60</span><span class="hl-1">,</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Framework augments to IScheduledSignalRow (lines 234-251)</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-11">id</span><span class="hl-1">: </span><span class="hl-2">&quot;a1b2c3d4-e5f6-7890-abcd-ef1234567890&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceOpen</span><span class="hl-1">: </span><span class="hl-8">41000</span><span class="hl-1">,  </span><span class="hl-5">// ← User&#39;s specified price</span><br/><span class="hl-1">  </span><span class="hl-11">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-8">42000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceStopLoss</span><span class="hl-1">: </span><span class="hl-8">40000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-8">60</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">symbol</span><span class="hl-1">: </span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">exchangeName</span><span class="hl-1">: </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">strategyName</span><span class="hl-1">: </span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">scheduledAt</span><span class="hl-1">: </span><span class="hl-8">1704067200000</span><span class="hl-1">,  </span><span class="hl-5">// ← Creation time</span><br/><span class="hl-1">  </span><span class="hl-11">pendingAt</span><span class="hl-1">: </span><span class="hl-8">1704067200000</span><span class="hl-1">,    </span><span class="hl-5">// ← Temporary (updated on activation)</span><br/><span class="hl-1">  </span><span class="hl-11">_isScheduled</span><span class="hl-1">: </span><span class="hl-6">true</span><span class="hl-1">,</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// On activation (lines 510-515)</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-5">// ... same fields ...</span><br/><span class="hl-1">  </span><span class="hl-11">pendingAt</span><span class="hl-1">: </span><span class="hl-8">1704067800000</span><span class="hl-1">,  </span><span class="hl-5">// ← Updated to activation time (+10min)</span><br/><span class="hl-1">  </span><span class="hl-11">_isScheduled</span><span class="hl-1">: </span><span class="hl-6">false</span><span class="hl-1">,       </span><span class="hl-5">// ← Converted to regular signal</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Behavior</strong>: Signal waits until market price reaches <code>priceOpen</code>, then activates. The <code>pendingAt</code> timestamp is updated at activation time to accurately track position duration.</p>
<p><strong>Timeout</strong>: Scheduled signals cancel after <code>CC_SCHEDULE_AWAIT_MINUTES</code> (default: 120 minutes) if price never reaches <code>priceOpen</code>.</p>
<hr>
<a id="configuration-parameters" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Configuration Parameters<a href="#configuration-parameters" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Global configuration parameters control validation thresholds. These can be modified via <code>setConfig()</code> to customize validation behavior.</p>
<a id="validation-configuration-table" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Validation Configuration Table<a href="#validation-configuration-table" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Unit</th>
<th>Purpose</th>
<th>Validation Target</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CC_MIN_TAKEPROFIT_DISTANCE_PERCENT</code></td>
<td><code>0.1</code></td>
<td>%</td>
<td>Minimum TP-priceOpen distance</td>
<td>Fee coverage check</td>
</tr>
<tr>
<td><code>CC_MAX_STOPLOSS_DISTANCE_PERCENT</code></td>
<td><code>20</code></td>
<td>%</td>
<td>Maximum SL-priceOpen distance</td>
<td>Catastrophic loss prevention</td>
</tr>
<tr>
<td><code>CC_MAX_SIGNAL_LIFETIME_MINUTES</code></td>
<td><code>1440</code></td>
<td>minutes</td>
<td>Maximum signal lifetime</td>
<td>Eternal signal prevention</td>
</tr>
<tr>
<td><code>CC_SCHEDULE_AWAIT_MINUTES</code></td>
<td><code>120</code></td>
<td>minutes</td>
<td>Scheduled signal timeout</td>
<td>Scheduled signal cancellation</td>
</tr>
</tbody>
</table>
<a id="configuration-usage-example" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Configuration Usage Example<a href="#configuration-usage-example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">setConfig</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Customize validation thresholds</span><br/><span class="hl-0">setConfig</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-8">0.3</span><span class="hl-1">,  </span><span class="hl-5">// Require 0.3% profit margin</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MAX_STOPLOSS_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-8">10</span><span class="hl-1">,     </span><span class="hl-5">// Limit max loss to 10%</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MAX_SIGNAL_LIFETIME_MINUTES:</span><span class="hl-1"> </span><span class="hl-8">720</span><span class="hl-1">,      </span><span class="hl-5">// Max 12-hour signal lifetime</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Effect</strong>: All subsequent signal validations use the updated thresholds.</p>
<p><strong>Testing Strategy</strong>: Test suites disable validation for legacy tests by setting permissive values:</p>
<pre><code class="typescript"><span class="hl-5">// test/config/setup.mjs:36-41</span><br/><span class="hl-0">setConfig</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MIN_TAKEPROFIT_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-8">0</span><span class="hl-1">,      </span><span class="hl-5">// No TP distance check</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MAX_STOPLOSS_DISTANCE_PERCENT:</span><span class="hl-1"> </span><span class="hl-8">100</span><span class="hl-1">,      </span><span class="hl-5">// Allow any SL</span><br/><span class="hl-1">  </span><span class="hl-4">CC_MAX_SIGNAL_LIFETIME_MINUTES:</span><span class="hl-1"> </span><span class="hl-8">999999</span><span class="hl-1">,     </span><span class="hl-5">// No lifetime limit</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="validation-error-examples" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Validation Error Examples<a href="#validation-error-examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This section demonstrates common validation failures and their error messages.</p>
<a id="example-1-micro-profit-eaten-by-fees" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example 1: Micro-Profit Eaten by Fees<a href="#example-1-micro-profit-eaten-by-fees" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// User&#39;s getSignal returns:</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-11">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceOpen</span><span class="hl-1">: </span><span class="hl-8">42000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-8">42010</span><span class="hl-1">,  </span><span class="hl-5">// Only +0.024% profit</span><br/><span class="hl-1">  </span><span class="hl-11">priceStopLoss</span><span class="hl-1">: </span><span class="hl-8">41000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-8">60</span><span class="hl-1">,</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// VALIDATE_SIGNAL_FN throws:</span><br/><span class="hl-5">// &quot;Long: TakeProfit too close to priceOpen (0.024%). </span><br/><span class="hl-5">//  Minimum distance: 0.1% to cover trading fees. </span><br/><span class="hl-5">//  Current: TP=42010, Open=42000&quot;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Why Rejected</strong>: Profit of 0.024% cannot cover trading fees (0.1% entry + 0.1% exit = 0.2%). Net result would be -0.176% loss despite hitting TP.</p>
<a id="example-2-catastrophic-stoploss" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example 2: Catastrophic StopLoss<a href="#example-2-catastrophic-stoploss" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// User&#39;s getSignal returns:</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-11">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceOpen</span><span class="hl-1">: </span><span class="hl-8">42000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-8">43000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceStopLoss</span><span class="hl-1">: </span><span class="hl-8">20000</span><span class="hl-1">,  </span><span class="hl-5">// -52.4% loss!</span><br/><span class="hl-1">  </span><span class="hl-11">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-8">60</span><span class="hl-1">,</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// VALIDATE_SIGNAL_FN throws:</span><br/><span class="hl-5">// &quot;Long: StopLoss too far from priceOpen (52.381%). </span><br/><span class="hl-5">//  Maximum distance: 20% to protect capital. </span><br/><span class="hl-5">//  Current: SL=20000, Open=42000&quot;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Why Rejected</strong>: Single trade could lose &gt;50% of position value, requiring &gt;100% gain to recover.</p>
<a id="example-3-eternal-signal" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example 3: Eternal Signal<a href="#example-3-eternal-signal" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// User&#39;s getSignal returns:</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-11">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceOpen</span><span class="hl-1">: </span><span class="hl-8">42000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-8">43000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceStopLoss</span><span class="hl-1">: </span><span class="hl-8">41000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-8">50000</span><span class="hl-1">,  </span><span class="hl-5">// 34.7 days!</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// VALIDATE_SIGNAL_FN throws:</span><br/><span class="hl-5">// &quot;minuteEstimatedTime too large (50000 minutes = 34.7 days). </span><br/><span class="hl-5">//  Maximum: 1440 minutes (1 days) to prevent strategy deadlock. </span><br/><span class="hl-5">//  Eternal signals block risk limits and prevent new trades.&quot;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Why Rejected</strong>: Signal would occupy risk limit slot for &gt;1 month, preventing new trades.</p>
<a id="example-4-nan-price" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example 4: NaN Price<a href="#example-4-nan-price" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// User&#39;s getSignal returns:</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-11">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceOpen</span><span class="hl-1">: </span><span class="hl-6">NaN</span><span class="hl-1">,  </span><span class="hl-5">// Invalid!</span><br/><span class="hl-1">  </span><span class="hl-11">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-8">43000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceStopLoss</span><span class="hl-1">: </span><span class="hl-8">41000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-8">60</span><span class="hl-1">,</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// VALIDATE_SIGNAL_FN throws:</span><br/><span class="hl-5">// &quot;priceOpen must be a finite number, got NaN (number)&quot;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Why Rejected</strong>: NaN propagates through all calculations, corrupting PnL results.</p>
<a id="example-5-invalid-long-position-logic" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example 5: Invalid Long Position Logic<a href="#example-5-invalid-long-position-logic" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// User&#39;s getSignal returns:</span><br/><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-11">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceOpen</span><span class="hl-1">: </span><span class="hl-8">41000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">priceTakeProfit</span><span class="hl-1">: </span><span class="hl-8">40000</span><span class="hl-1">,  </span><span class="hl-5">// TP BELOW priceOpen!</span><br/><span class="hl-1">  </span><span class="hl-11">priceStopLoss</span><span class="hl-1">: </span><span class="hl-8">39000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">minuteEstimatedTime</span><span class="hl-1">: </span><span class="hl-8">60</span><span class="hl-1">,</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// VALIDATE_SIGNAL_FN throws:</span><br/><span class="hl-5">// &quot;Long: priceTakeProfit (40000) must be &gt; priceOpen (41000)&quot;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Why Rejected</strong>: Long positions profit when price increases. TP must be above entry price.</p>
<hr>
<a id="integration-with-clientstrategy" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Integration with ClientStrategy<a href="#integration-with-clientstrategy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>GET_SIGNAL_FN</code> is called from <code>ClientStrategy.tick()</code> method during strategy execution.</p>
<a id="clientstrategytick-call-chain" class="tsd-anchor"></a><h3 class="tsd-anchor-link">ClientStrategy.tick() Call Chain<a href="#clientstrategytick-call-chain" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/46_Signal_Generation_and_Validation_5.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="summary" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Summary<a href="#summary" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Signal generation and validation in backtest-kit ensures financial safety through:</p>
<ol>
<li><strong>GET_SIGNAL_FN Wrapper</strong>: Orchestrates signal generation, interval throttling, risk checks, and validation</li>
<li><strong>VALIDATE_SIGNAL_FN Logic</strong>: Comprehensive validation covering price safety, position logic, distance constraints, and lifetime limits</li>
<li><strong>Configuration Flexibility</strong>: Tunable thresholds via <code>GLOBAL_CONFIG</code> parameters</li>
<li><strong>Scheduled Signals</strong>: Support for delayed entry at specific prices with timeout handling</li>
<li><strong>Error Resilience</strong>: Automatic error handling prevents crashes while maintaining observability</li>
</ol>
<p><strong>Key Validation Checks</strong>:</p>
<ul>
<li>✅ Finite prices (no NaN/Infinity)</li>
<li>✅ Positive prices (no negative/zero)</li>
<li>✅ Position-specific logic (TP/SL direction)</li>
<li>✅ Fee coverage (TP distance ≥ 0.1%)</li>
<li>✅ Loss limits (SL distance ≤ 20%)</li>
<li>✅ Lifetime constraints (≤ 1440 minutes)</li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#signal-generation-and-validation"><span>Signal <wbr/>Generation and <wbr/>Validation</span></a><ul><li><a href="#signal-generation-flow"><span>Signal <wbr/>Generation <wbr/>Flow</span></a></li><li><ul><li><a href="#end-to-end-signal-generation-pipeline"><span>End-<wbr/>to-<wbr/>End <wbr/>Signal <wbr/>Generation <wbr/>Pipeline</span></a></li></ul></li><li><a href="#signal-data-structures"><span>Signal <wbr/>Data <wbr/>Structures</span></a></li><li><ul><li><a href="#interface-comparison"><span>Interface <wbr/>Comparison</span></a></li><li><a href="#augmentation-example"><span>Augmentation <wbr/>Example</span></a></li></ul></li><li><a href="#validate_signal_fn-validation-checks"><span>VALIDATE_<wbr/>SIGNAL_<wbr/>FN <wbr/>Validation <wbr/>Checks</span></a></li><li><ul><li><a href="#validation-architecture"><span>Validation <wbr/>Architecture</span></a></li><li><a href="#validation-check-catalog"><span>Validation <wbr/>Check <wbr/>Catalog</span></a></li><li><ul><li><a href="#1-safety-checks-naninfinity-protection"><span>1. <wbr/>Safety <wbr/>Checks (<wbr/>Na<wbr/>N/<wbr/>Infinity <wbr/>Protection)</span></a></li><li><a href="#2-positive-price-checks"><span>2. <wbr/>Positive <wbr/>Price <wbr/>Checks</span></a></li><li><a href="#3-position-specific-logic-validation"><span>3. <wbr/>Position-<wbr/>Specific <wbr/>Logic <wbr/>Validation</span></a></li><li><ul><li><a href="#long-position-rules"><span>Long <wbr/>Position <wbr/>Rules</span></a></li><li><a href="#short-position-rules"><span>Short <wbr/>Position <wbr/>Rules</span></a></li></ul></li><li><a href="#4-minimum-takeprofit-distance-fee-coverage"><span>4. <wbr/>Minimum <wbr/>Take<wbr/>Profit <wbr/>Distance (<wbr/>Fee <wbr/>Coverage)</span></a></li><li><a href="#5-maximum-stoploss-distance-catastrophic-loss-prevention"><span>5. <wbr/>Maximum <wbr/>Stop<wbr/>Loss <wbr/>Distance (<wbr/>Catastrophic <wbr/>Loss <wbr/>Prevention)</span></a></li><li><a href="#6-maximum-signal-lifetime-eternal-signal-prevention"><span>6. <wbr/>Maximum <wbr/>Signal <wbr/>Lifetime (<wbr/>Eternal <wbr/>Signal <wbr/>Prevention)</span></a></li></ul></li></ul></li><li><a href="#get_signal_fn-orchestration"><span>GET_<wbr/>SIGNAL_<wbr/>FN <wbr/>Orchestration</span></a></li><li><ul><li><a href="#get_signal_fn-control-flow"><span>GET_<wbr/>SIGNAL_<wbr/>FN <wbr/>Control <wbr/>Flow</span></a></li><li><a href="#interval-throttling"><span>Interval <wbr/>Throttling</span></a></li><li><a href="#error-handling-strategy"><span>Error <wbr/>Handling <wbr/>Strategy</span></a></li></ul></li><li><a href="#scheduled-vs-immediate-signals"><span>Scheduled vs <wbr/>Immediate <wbr/>Signals</span></a></li><li><ul><li><a href="#signal-type-decision-tree"><span>Signal <wbr/>Type <wbr/>Decision <wbr/>Tree</span></a></li><li><a href="#immediate-signal-example"><span>Immediate <wbr/>Signal <wbr/>Example</span></a></li><li><a href="#scheduled-signal-example"><span>Scheduled <wbr/>Signal <wbr/>Example</span></a></li></ul></li><li><a href="#configuration-parameters"><span>Configuration <wbr/>Parameters</span></a></li><li><ul><li><a href="#validation-configuration-table"><span>Validation <wbr/>Configuration <wbr/>Table</span></a></li><li><a href="#configuration-usage-example"><span>Configuration <wbr/>Usage <wbr/>Example</span></a></li></ul></li><li><a href="#validation-error-examples"><span>Validation <wbr/>Error <wbr/>Examples</span></a></li><li><ul><li><a href="#example-1-micro-profit-eaten-by-fees"><span>Example 1: <wbr/>Micro-<wbr/>Profit <wbr/>Eaten by <wbr/>Fees</span></a></li><li><a href="#example-2-catastrophic-stoploss"><span>Example 2: <wbr/>Catastrophic <wbr/>Stop<wbr/>Loss</span></a></li><li><a href="#example-3-eternal-signal"><span>Example 3: <wbr/>Eternal <wbr/>Signal</span></a></li><li><a href="#example-4-nan-price"><span>Example 4: <wbr/>Na<wbr/>N <wbr/>Price</span></a></li><li><a href="#example-5-invalid-long-position-logic"><span>Example 5: <wbr/>Invalid <wbr/>Long <wbr/>Position <wbr/>Logic</span></a></li></ul></li><li><a href="#integration-with-clientstrategy"><span>Integration with <wbr/>Client<wbr/>Strategy</span></a></li><li><ul><li><a href="#clientstrategytick-call-chain"><span>Client<wbr/>Strategy.tick() <wbr/>Call <wbr/>Chain</span></a></li></ul></li><li><a href="#summary"><span>Summary</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
