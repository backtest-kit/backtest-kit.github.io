<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/25_exchange_schemas | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_25_exchange_schemas.html">design/25_exchange_schemas</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="exchange-schemas" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Exchange Schemas<a href="#exchange-schemas" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>Exchange schemas define data source interfaces for fetching historical market data and formatting prices/quantities according to exchange-specific precision rules. They provide the abstraction layer between the framework's signal processing logic and external data sources (APIs, databases, CSV files, etc.).</p>
<p>This page covers the structure and registration of exchange schemas. For information about the runtime exchange client implementation, see <a href="design_32_clientexchange.html">ClientExchange</a>. For utility functions that use registered exchanges, see <a href="design_21_exchange_functions.html">Exchange Functions</a>.</p>
<a id="overview" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Overview<a href="#overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>An exchange schema registered via <code>addExchange()</code> must implement the <code>IExchangeSchema</code> interface, which defines three core responsibilities:</p>
<ol>
<li><strong>Candle Data Fetching</strong> - Retrieve historical OHLCV data via <code>getCandles()</code></li>
<li><strong>Price Formatting</strong> - Format prices to exchange precision via <code>formatPrice()</code></li>
<li><strong>Quantity Formatting</strong> - Format quantities to exchange precision via <code>formatQuantity()</code></li>
</ol>
<p>The framework uses these methods internally for backtesting (historical data iteration) and live trading (VWAP calculation, TP/SL monitoring). The exchange schema does not contain business logic—it is a pure data access interface. Runtime logic is handled by <code>ClientExchange</code>.</p>
<a id="exchange-schema-structure" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Exchange Schema Structure<a href="#exchange-schema-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/25_Exchange_Schemas_0.svg" alt="Mermaid Diagram"></p>
<p><strong>Required Fields:</strong></p>
<ul>
<li><strong>exchangeName</strong> - Unique identifier for this exchange (type: <code>ExchangeName</code> = <code>string</code>)</li>
<li><strong>getCandles</strong> - Function to fetch historical candle data</li>
<li><strong>formatPrice</strong> - Function to format prices according to exchange precision rules</li>
<li><strong>formatQuantity</strong> - Function to format quantities according to exchange precision rules</li>
</ul>
<p><strong>Optional Fields:</strong></p>
<ul>
<li><strong>note</strong> - Developer documentation string</li>
<li><strong>callbacks</strong> - Lifecycle event callbacks for candle data events</li>
</ul>
<a id="registration-flow" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Registration Flow<a href="#registration-flow" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/25_Exchange_Schemas_1.svg" alt="Mermaid Diagram"></p>
<p>The registration process follows this sequence:</p>
<ol>
<li><strong>User calls <code>addExchange(exchangeSchema)</code></strong> - Provides schema configuration</li>
<li><strong>ValidationService validates</strong> - Checks schema structure, required methods exist</li>
<li><strong>SchemaService stores</strong> - Uses <code>ToolRegistry</code> pattern to store schema by <code>exchangeName</code></li>
<li><strong>Logger records</strong> - Logs registration via <code>loggerService.info()</code></li>
</ol>
<p>Once registered, the schema becomes available for use in backtest and live execution modes. The framework uses <code>ExchangeConnectionService</code> to lazily instantiate <code>ClientExchange</code> instances from the stored schema.</p>
<a id="required-methods" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Required Methods<a href="#required-methods" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="getcandles-method" class="tsd-anchor"></a><h3 class="tsd-anchor-link">getCandles Method<a href="#getcandles-method" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>getCandles()</code> method is the primary data source interface for the framework. It must return an array of OHLCV candles sorted chronologically.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-12">getCandles</span><span class="hl-1">: (</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-4">CandleInterval</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">since</span><span class="hl-1">: </span><span class="hl-4">Date</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">limit</span><span class="hl-1">: </span><span class="hl-4">number</span><br/><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">ICandleData</span><span class="hl-1">[]&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>symbol</code></td>
<td><code>string</code></td>
<td>Trading pair symbol (e.g., <code>&quot;BTCUSDT&quot;</code>)</td>
</tr>
<tr>
<td><code>interval</code></td>
<td><code>CandleInterval</code></td>
<td>Candle timeframe (<code>&quot;1m&quot;</code> | <code>&quot;3m&quot;</code> | <code>&quot;5m&quot;</code> | <code>&quot;15m&quot;</code> | <code>&quot;30m&quot;</code> | <code>&quot;1h&quot;</code> | <code>&quot;2h&quot;</code> | <code>&quot;4h&quot;</code> | <code>&quot;6h&quot;</code> | <code>&quot;8h&quot;</code>)</td>
</tr>
<tr>
<td><code>since</code></td>
<td><code>Date</code></td>
<td>Start date for candle fetching</td>
</tr>
<tr>
<td><code>limit</code></td>
<td><code>number</code></td>
<td>Maximum number of candles to return</td>
</tr>
</tbody>
</table>
<p><strong>Return Value:</strong></p>
<p>Array of <code>ICandleData</code> objects with fields:</p>
<ul>
<li><code>timestamp</code> - Unix milliseconds when candle opened</li>
<li><code>open</code> - Opening price</li>
<li><code>high</code> - Highest price during period</li>
<li><code>low</code> - Lowest price during period</li>
<li><code>close</code> - Closing price</li>
<li><code>volume</code> - Trading volume</li>
</ul>
<p><strong>Usage Context:</strong></p>
<ul>
<li><strong>Backtest Mode</strong> - Called once per strategy tick to fetch historical candles backward from <code>executionContext.when</code></li>
<li><strong>Live Mode</strong> - Called for VWAP calculation (last 5 1-minute candles) and TP/SL monitoring</li>
<li><strong>Fast-Forward Backtest</strong> - Called once to fetch large candle array for <code>strategy.backtest()</code></li>
</ul>
<a id="formatprice-method" class="tsd-anchor"></a><h3 class="tsd-anchor-link">formatPrice Method<a href="#formatprice-method" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>formatPrice()</code> method formats raw price values to exchange-specific precision rules. This ensures displayed prices match exchange conventions.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-12">formatPrice</span><span class="hl-1">: (</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">price</span><span class="hl-1">: </span><span class="hl-4">number</span><br/><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>symbol</code></td>
<td><code>string</code></td>
<td>Trading pair symbol (e.g., <code>&quot;BTCUSDT&quot;</code>)</td>
</tr>
<tr>
<td><code>price</code></td>
<td><code>number</code></td>
<td>Raw price value to format</td>
</tr>
</tbody>
</table>
<p><strong>Return Value:</strong></p>
<p>Formatted price string respecting exchange precision (e.g., <code>&quot;50123.45&quot;</code> for BTC with 2 decimal places).</p>
<p><strong>Usage Context:</strong></p>
<ul>
<li>Formatting prices in markdown reports</li>
<li>Displaying prices in callbacks</li>
<li>Logging formatted price values</li>
</ul>
<a id="formatquantity-method" class="tsd-anchor"></a><h3 class="tsd-anchor-link">formatQuantity Method<a href="#formatquantity-method" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>formatQuantity()</code> method formats raw quantity values to exchange-specific precision rules. This ensures displayed quantities match exchange conventions.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-12">formatQuantity</span><span class="hl-1">: (</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">quantity</span><span class="hl-1">: </span><span class="hl-4">number</span><br/><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>symbol</code></td>
<td><code>string</code></td>
<td>Trading pair symbol (e.g., <code>&quot;BTCUSDT&quot;</code>)</td>
</tr>
<tr>
<td><code>quantity</code></td>
<td><code>number</code></td>
<td>Raw quantity value to format</td>
</tr>
</tbody>
</table>
<p><strong>Return Value:</strong></p>
<p>Formatted quantity string respecting exchange precision (e.g., <code>&quot;0.00123456&quot;</code> for BTC with 8 decimal places).</p>
<p><strong>Usage Context:</strong></p>
<ul>
<li>Formatting quantities in markdown reports</li>
<li>Displaying quantities in callbacks</li>
<li>Logging formatted quantity values</li>
</ul>
<a id="optional-callbacks" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Optional Callbacks<a href="#optional-callbacks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>callbacks</code> field allows registering lifecycle event handlers. Currently, only <code>onCandleData</code> is supported.</p>
<a id="oncandledata-callback" class="tsd-anchor"></a><h3 class="tsd-anchor-link">onCandleData Callback<a href="#oncandledata-callback" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Called immediately after <code>getCandles()</code> completes successfully. Useful for logging, debugging, or caching candle data.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-12">onCandleData</span><span class="hl-1">: (</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-4">string</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval</span><span class="hl-1">: </span><span class="hl-4">CandleInterval</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">since</span><span class="hl-1">: </span><span class="hl-4">Date</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">limit</span><span class="hl-1">: </span><span class="hl-4">number</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">data</span><span class="hl-1">: </span><span class="hl-4">ICandleData</span><span class="hl-1">[]</span><br/><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-6">void</span>
</code><button type="button">Copy</button></pre>

<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>symbol</code></td>
<td><code>string</code></td>
<td>Trading pair symbol</td>
</tr>
<tr>
<td><code>interval</code></td>
<td><code>CandleInterval</code></td>
<td>Requested candle interval</td>
</tr>
<tr>
<td><code>since</code></td>
<td><code>Date</code></td>
<td>Requested start date</td>
</tr>
<tr>
<td><code>limit</code></td>
<td><code>number</code></td>
<td>Requested limit</td>
</tr>
<tr>
<td><code>data</code></td>
<td><code>ICandleData[]</code></td>
<td>Fetched candle data array</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-0">addExchange</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getCandles</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> { </span><span class="hl-5">/* ... */</span><span class="hl-1"> },</span><br/><span class="hl-1">  </span><span class="hl-0">formatPrice</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">price</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-0">formatQuantity</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">quantity</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-8">8</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onCandleData</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Fetched </span><span class="hl-6">${</span><span class="hl-4">data</span><span class="hl-9">.</span><span class="hl-4">length</span><span class="hl-6">}</span><span class="hl-2"> candles for </span><span class="hl-6">${</span><span class="hl-4">symbol</span><span class="hl-6">}</span><span class="hl-2"> </span><span class="hl-6">${</span><span class="hl-4">interval</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="runtime-integration" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Runtime Integration<a href="#runtime-integration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/25_Exchange_Schemas_2.svg" alt="Mermaid Diagram"></p>
<p><strong>Flow:</strong></p>
<ol>
<li><strong>Schema Registration</strong> - User calls <code>addExchange(schema)</code>, stored in <code>ExchangeSchemaService</code></li>
<li><strong>Lazy Instantiation</strong> - <code>ExchangeConnectionService.get(exchangeName)</code> creates memoized <code>ClientExchange</code> instance</li>
<li><strong>Dependency Injection</strong> - Framework injects <code>IExchangeParams</code> with schema, logger, and execution context</li>
<li><strong>Runtime Operations</strong> - <code>ClientExchange</code> delegates to schema methods, adds VWAP calculation logic</li>
</ol>
<p><strong>Key Distinction:</strong></p>
<ul>
<li><code>IExchangeSchema</code> - User-defined data access interface (no business logic)</li>
<li><code>IExchange</code> - Runtime interface implemented by <code>ClientExchange</code> (adds VWAP, forward/backward candle fetching)</li>
</ul>
<p>The <code>ClientExchange</code> class wraps the schema methods and adds framework-specific functionality like VWAP calculation and context-aware candle fetching. It uses <code>executionContext.when</code> to determine the current timestamp for fetching candles backward (past data) or forward (future data for backtesting).</p>
<a id="context-propagation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Context Propagation<a href="#context-propagation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The exchange schema methods do not receive explicit context parameters. Instead, context flows implicitly through <code>ExecutionContextService</code>:</p>
<p><img src="../media/25_Exchange_Schemas_3.svg" alt="Mermaid Diagram"></p>
<p><strong>Context Fields Used:</strong></p>
<ul>
<li><code>executionContext.when</code> - Used to calculate <code>since</code> parameter for <code>getCandles()</code></li>
<li><code>executionContext.symbol</code> - Passed directly to schema methods</li>
<li><code>executionContext.backtest</code> - Determines whether to fetch backward (backtest) or forward (live)</li>
</ul>
<p>The schema implementation does not need to be aware of this context—it simply receives parameters and returns data. The framework handles all context-aware logic in <code>ClientExchange</code>.</p>
<a id="common-integration-patterns" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Common Integration Patterns<a href="#common-integration-patterns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="ccxt-exchange-integration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">CCXT Exchange Integration<a href="#ccxt-exchange-integration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">ccxt</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;ccxt&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">exchange</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-4">ccxt</span><span class="hl-1">.</span><span class="hl-0">binance</span><span class="hl-1">();</span><br/><br/><span class="hl-0">addExchange</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance-ccxt&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getCandles</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">ohlcv</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">fetchOHLCV</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-4">symbol</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">interval</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">since</span><span class="hl-1">.</span><span class="hl-0">getTime</span><span class="hl-1">(),</span><br/><span class="hl-1">      </span><span class="hl-4">limit</span><br/><span class="hl-1">    );</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">ohlcv</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(([</span><span class="hl-4">timestamp</span><span class="hl-1">, </span><span class="hl-4">open</span><span class="hl-1">, </span><span class="hl-4">high</span><span class="hl-1">, </span><span class="hl-4">low</span><span class="hl-1">, </span><span class="hl-4">close</span><span class="hl-1">, </span><span class="hl-4">volume</span><span class="hl-1">]) </span><span class="hl-6">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">      </span><span class="hl-4">timestamp</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">open</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">high</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">low</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">close</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">volume</span><br/><span class="hl-1">    }));</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">formatPrice</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">market</span><span class="hl-1"> = </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">market</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">priceToPrecision</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">formatQuantity</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">market</span><span class="hl-1"> = </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">market</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">exchange</span><span class="hl-1">.</span><span class="hl-0">amountToPrecision</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="database-integration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Database Integration<a href="#database-integration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Database</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;./db&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">db</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Database</span><span class="hl-1">(</span><span class="hl-2">&#39;./candles.db&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-0">addExchange</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;sqlite-candles&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getCandles</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">db</span><span class="hl-1">.</span><span class="hl-0">query</span><span class="hl-1">(</span><span class="hl-2">`</span><br/><span class="hl-2">      SELECT timestamp, open, high, low, close, volume</span><br/><span class="hl-2">      FROM candles</span><br/><span class="hl-2">      WHERE symbol = ? AND interval = ? AND timestamp &gt;= ?</span><br/><span class="hl-2">      ORDER BY timestamp ASC</span><br/><span class="hl-2">      LIMIT ?</span><br/><span class="hl-2">    `</span><span class="hl-1">, [</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">.</span><span class="hl-0">getTime</span><span class="hl-1">(), </span><span class="hl-4">limit</span><span class="hl-1">]);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">formatPrice</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// Get precision from metadata table</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> { </span><span class="hl-7">pricePrecision</span><span class="hl-1"> } = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">db</span><span class="hl-1">.</span><span class="hl-0">getSymbolInfo</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">price</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-4">pricePrecision</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">formatQuantity</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> { </span><span class="hl-7">quantityPrecision</span><span class="hl-1"> } = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">db</span><span class="hl-1">.</span><span class="hl-0">getSymbolInfo</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">quantity</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-4">quantityPrecision</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="csv-file-integration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">CSV File Integration<a href="#csv-file-integration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">readCSV</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;./csv-reader&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">addExchange</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;csv-historical&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getCandles</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">allCandles</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">readCSV</span><span class="hl-1">(</span><span class="hl-2">`./data/</span><span class="hl-6">${</span><span class="hl-4">symbol</span><span class="hl-6">}</span><span class="hl-2">_</span><span class="hl-6">${</span><span class="hl-4">interval</span><span class="hl-6">}</span><span class="hl-2">.csv`</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">filtered</span><span class="hl-1"> = </span><span class="hl-4">allCandles</span><span class="hl-1">.</span><span class="hl-0">filter</span><span class="hl-1">(</span><span class="hl-4">c</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">c</span><span class="hl-1">.</span><span class="hl-4">timestamp</span><span class="hl-1"> &gt;= </span><span class="hl-4">since</span><span class="hl-1">.</span><span class="hl-0">getTime</span><span class="hl-1">());</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">filtered</span><span class="hl-1">.</span><span class="hl-0">slice</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">formatPrice</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">price</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">price</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-0">formatQuantity</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">quantity</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">quantity</span><span class="hl-1">.</span><span class="hl-0">toFixed</span><span class="hl-1">(</span><span class="hl-8">8</span><span class="hl-1">)</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="validation-rules" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Validation Rules<a href="#validation-rules" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>ExchangeValidationService</code> enforces these validation rules during registration:</p>
<ol>
<li><strong>exchangeName must be unique</strong> - Cannot register duplicate exchange names</li>
<li><strong>getCandles must be a function</strong> - Required method must exist and be callable</li>
<li><strong>formatPrice must be a function</strong> - Required method must exist and be callable</li>
<li><strong>formatQuantity must be a function</strong> - Required method must exist and be callable</li>
<li><strong>callbacks must be an object</strong> - If provided, must be valid object with valid function properties</li>
</ol>
<p>Validation errors are thrown synchronously from <code>addExchange()</code> to provide immediate feedback.</p>
<a id="listing-registered-exchanges" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Listing Registered Exchanges<a href="#listing-registered-exchanges" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Use <code>listExchanges()</code> to retrieve all registered exchange schemas:</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">listExchanges</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;backtest-kit&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">exchanges</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">listExchanges</span><span class="hl-1">();</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">exchanges</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">e</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">e</span><span class="hl-1">.</span><span class="hl-4">exchangeName</span><span class="hl-1">));</span><br/><span class="hl-5">// [&quot;binance&quot;, &quot;coinbase&quot;, &quot;sqlite-candles&quot;]</span>
</code><button type="button">Copy</button></pre>

<p>This is useful for:</p>
<ul>
<li>Building dynamic UIs that list available exchanges</li>
<li>Debugging registration issues</li>
<li>Generating documentation from registered schemas</li>
<li>Validating that required exchanges are registered before execution</li>
</ul>
<a id="best-practices" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Best Practices<a href="#best-practices" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><strong>1. Cache candle data when possible</strong> - Avoid redundant API calls by implementing caching in <code>getCandles()</code>:</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">candleCache</span><span class="hl-1"> = </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">Map</span><span class="hl-1">();</span><br/><br/><span class="hl-12">getCandles</span><span class="hl-1">: </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">key</span><span class="hl-1"> = </span><span class="hl-2">`</span><span class="hl-6">${</span><span class="hl-4">symbol</span><span class="hl-6">}</span><span class="hl-2">:</span><span class="hl-6">${</span><span class="hl-4">interval</span><span class="hl-6">}</span><span class="hl-2">:</span><span class="hl-6">${</span><span class="hl-4">since</span><span class="hl-9">.</span><span class="hl-0">getTime</span><span class="hl-9">()</span><span class="hl-6">}</span><span class="hl-2">:</span><span class="hl-6">${</span><span class="hl-4">limit</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (!</span><span class="hl-4">candleCache</span><span class="hl-1">.</span><span class="hl-0">has</span><span class="hl-1">(</span><span class="hl-4">key</span><span class="hl-1">)) {</span><br/><span class="hl-1">    </span><span class="hl-4">candleCache</span><span class="hl-1">.</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-4">key</span><span class="hl-1">, </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">fetchFromAPI</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">));</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">candleCache</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-4">key</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>2. Handle rate limiting</strong> - Implement exponential backoff for API-based exchanges to avoid rate limit errors.</p>
<p><strong>3. Validate candle data</strong> - Ensure returned candles are sorted chronologically and contain valid OHLCV values.</p>
<p><strong>4. Use callbacks for observability</strong> - Implement <code>onCandleData</code> to log data fetching for debugging:</p>
<pre><code class="typescript"><span class="hl-12">callbacks</span><span class="hl-1">: {</span><br/><span class="hl-1">  </span><span class="hl-12">onCandleData</span><span class="hl-1">: (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">since</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">logger</span><span class="hl-1">.</span><span class="hl-0">debug</span><span class="hl-1">(</span><span class="hl-2">`[Exchange] Fetched </span><span class="hl-6">${</span><span class="hl-4">data</span><span class="hl-9">.</span><span class="hl-4">length</span><span class="hl-6">}</span><span class="hl-2">/</span><span class="hl-6">${</span><span class="hl-4">limit</span><span class="hl-6">}</span><span class="hl-2"> candles for </span><span class="hl-6">${</span><span class="hl-4">symbol</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>5. Keep schemas stateless</strong> - Exchange schemas should not maintain state. Store state in external services (databases, caches) and keep the schema as a pure interface.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#exchange-schemas"><span>Exchange <wbr/>Schemas</span></a><ul><li><a href="#overview"><span>Overview</span></a></li><li><a href="#exchange-schema-structure"><span>Exchange <wbr/>Schema <wbr/>Structure</span></a></li><li><a href="#registration-flow"><span>Registration <wbr/>Flow</span></a></li><li><a href="#required-methods"><span>Required <wbr/>Methods</span></a></li><li><ul><li><a href="#getcandles-method"><span>get<wbr/>Candles <wbr/>Method</span></a></li><li><a href="#formatprice-method"><span>format<wbr/>Price <wbr/>Method</span></a></li><li><a href="#formatquantity-method"><span>format<wbr/>Quantity <wbr/>Method</span></a></li></ul></li><li><a href="#optional-callbacks"><span>Optional <wbr/>Callbacks</span></a></li><li><ul><li><a href="#oncandledata-callback"><span>on<wbr/>Candle<wbr/>Data <wbr/>Callback</span></a></li></ul></li><li><a href="#runtime-integration"><span>Runtime <wbr/>Integration</span></a></li><li><a href="#context-propagation"><span>Context <wbr/>Propagation</span></a></li><li><a href="#common-integration-patterns"><span>Common <wbr/>Integration <wbr/>Patterns</span></a></li><li><ul><li><a href="#ccxt-exchange-integration"><span>CCXT <wbr/>Exchange <wbr/>Integration</span></a></li><li><a href="#database-integration"><span>Database <wbr/>Integration</span></a></li><li><a href="#csv-file-integration"><span>CSV <wbr/>File <wbr/>Integration</span></a></li></ul></li><li><a href="#validation-rules"><span>Validation <wbr/>Rules</span></a></li><li><a href="#listing-registered-exchanges"><span>Listing <wbr/>Registered <wbr/>Exchanges</span></a></li><li><a href="#best-practices"><span>Best <wbr/>Practices</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
