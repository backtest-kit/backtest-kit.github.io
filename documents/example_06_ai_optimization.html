<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>example/06_ai_optimization | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="example_06_ai_optimization.html">example/06_ai_optimization</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="ai-strategy-optimization" class="tsd-anchor"></a><h1 class="tsd-anchor-link">AI Strategy Optimization<a href="#ai-strategy-optimization" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>This guide explains how to use the Optimizer system in backtest-kit to generate trading strategies using Large Language Models (LLMs). You'll learn how to set up Ollama, create data sources, and generate fully executable strategies.</p>
<a id="what-is-optimizer" class="tsd-anchor"></a><h2 class="tsd-anchor-link">What is Optimizer?<a href="#what-is-optimizer" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Optimizer is a meta-level strategy generation system that uses LLMs to create trading logic based on historical data. Unlike Backtest, Live, and Walker modes which execute existing strategies, Optimizer creates new strategies by analyzing data and generating code.</p>
<a id="key-features" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Key Features<a href="#key-features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li>ðŸ¤– <strong>LLM Generation</strong> - Uses Ollama to synthesize strategies</li>
<li>ðŸ“Š <strong>Multi-source Data</strong> - Collects data from various sources</li>
<li>ðŸ“… <strong>Multiple Time Ranges</strong> - Generates strategy variants for different periods</li>
<li>ðŸ”„ <strong>Walker Integration</strong> - Automatic comparison of generated strategies</li>
<li>ðŸ’¾ <strong>Fully Executable Code</strong> - Generates ready-to-run <code>.mjs</code> files</li>
</ul>
<hr>
<a id="installing-ollama" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Installing Ollama<a href="#installing-ollama" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="step-1-install-ollama" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Step 1: Install Ollama<a href="#step-1-install-ollama" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Windows:</strong></p>
<pre><code class="bash"><span class="hl-0"># Download installer from official website</span><br/><span class="hl-1">https://ollama.ai/download/windows</span><br/><br/><span class="hl-0"># Or use winget</span><br/><span class="hl-1">winget</span><span class="hl-2"> </span><span class="hl-4">install</span><span class="hl-2"> </span><span class="hl-4">Ollama.Ollama</span>
</code><button type="button">Copy</button></pre>

<p><strong>macOS:</strong></p>
<pre><code class="bash"><span class="hl-0"># Use Homebrew</span><br/><span class="hl-1">brew</span><span class="hl-2"> </span><span class="hl-4">install</span><span class="hl-2"> </span><span class="hl-4">ollama</span>
</code><button type="button">Copy</button></pre>

<p><strong>Linux:</strong></p>
<pre><code class="bash"><span class="hl-0"># Use curl</span><br/><span class="hl-1">curl</span><span class="hl-2"> </span><span class="hl-3">-fsSL</span><span class="hl-2"> </span><span class="hl-4">https://ollama.ai/install.sh</span><span class="hl-2"> | </span><span class="hl-1">sh</span>
</code><button type="button">Copy</button></pre>

<a id="step-2-install-model" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Step 2: Install Model<a href="#step-2-install-model" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="bash"><span class="hl-0"># Start Ollama server (if not started automatically)</span><br/><span class="hl-1">ollama</span><span class="hl-2"> </span><span class="hl-4">serve</span><br/><br/><span class="hl-0"># Install deepseek-v3.1 model (recommended for trading strategies)</span><br/><span class="hl-1">ollama</span><span class="hl-2"> </span><span class="hl-4">pull</span><span class="hl-2"> </span><span class="hl-4">deepseek-v3.1</span><br/><br/><span class="hl-0"># Or use other models</span><br/><span class="hl-1">ollama</span><span class="hl-2"> </span><span class="hl-4">pull</span><span class="hl-2"> </span><span class="hl-4">llama3</span><br/><span class="hl-1">ollama</span><span class="hl-2"> </span><span class="hl-4">pull</span><span class="hl-2"> </span><span class="hl-4">mistral</span>
</code><button type="button">Copy</button></pre>

<a id="step-3-verify-installation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Step 3: Verify Installation<a href="#step-3-verify-installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="bash"><span class="hl-0"># Test the model</span><br/><span class="hl-1">ollama</span><span class="hl-2"> </span><span class="hl-4">run</span><span class="hl-2"> </span><span class="hl-4">deepseek-v3.1</span><br/><span class="hl-2">&gt;&gt;&gt; </span><span class="hl-1">Hello,</span><span class="hl-2"> </span><span class="hl-4">are</span><span class="hl-2"> </span><span class="hl-4">you</span><span class="hl-2"> </span><span class="hl-4">working?</span><br/><span class="hl-2">&gt;&gt;&gt; (</span><span class="hl-1">Ctrl+D</span><span class="hl-2"> </span><span class="hl-4">to</span><span class="hl-2"> </span><span class="hl-4">exit</span><span class="hl-2">)</span>
</code><button type="button">Copy</button></pre>

<a id="step-4-configure-environment-variables" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Step 4: Configure Environment Variables<a href="#step-4-configure-environment-variables" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="bash"><span class="hl-0"># In .env file</span><br/><span class="hl-6">OLLAMA_HOST</span><span class="hl-2">=</span><span class="hl-4">http://localhost:11434</span><br/><span class="hl-6">OLLAMA_MODEL</span><span class="hl-2">=</span><span class="hl-4">deepseek-v3.1</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="optimizer-system-architecture" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Optimizer System Architecture<a href="#optimizer-system-architecture" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/06-ai-optimization_0.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="creating-an-optimizer" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Creating an Optimizer<a href="#creating-an-optimizer" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="basic-configuration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Basic Configuration<a href="#basic-configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">addOptimizer</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-1">addOptimizer</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;crypto-optimizer&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">note:</span><span class="hl-2"> </span><span class="hl-4">&quot;Strategy generator for cryptocurrencies&quot;</span><span class="hl-2">,</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Training time ranges</span><br/><span class="hl-2">  </span><span class="hl-6">rangeTrain:</span><span class="hl-2"> [</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-01-01&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">      </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-01-15&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-02-01&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">      </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-02-15&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  ],</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Testing time range</span><br/><span class="hl-2">  </span><span class="hl-6">rangeTest:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-03-01&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">    </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-03-15&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">  },</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Data sources</span><br/><span class="hl-2">  </span><span class="hl-6">source:</span><span class="hl-2"> [</span><br/><span class="hl-2">    </span><span class="hl-0">// Data sources here</span><br/><span class="hl-2">  ],</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// Prompt generator</span><br/><span class="hl-2">  </span><span class="hl-1">getPrompt</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">messages</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-0">// Prompt generation logic here</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="data-sources" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Data Sources<a href="#data-sources" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Data sources are functions that extract information for LLM training.</p>
<a id="example-1-news-source" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example 1: News Source<a href="#example-1-news-source" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">addOptimizer</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-1">addOptimizer</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;news-based-optimizer&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">rangeTrain:</span><span class="hl-2"> [</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-01-01&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">      </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-01-31&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  ],</span><br/><span class="hl-2">  </span><span class="hl-6">rangeTest:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-02-01&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">    </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-02-28&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">  },</span><br/><br/><span class="hl-2">  </span><span class="hl-0">// News source</span><br/><span class="hl-2">  </span><span class="hl-6">source:</span><span class="hl-2"> [</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-6">name:</span><span class="hl-2"> </span><span class="hl-4">&quot;crypto-news&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-1">fetch</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> ({ </span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">startDate</span><span class="hl-2">, </span><span class="hl-6">endDate</span><span class="hl-2">, </span><span class="hl-6">limit</span><span class="hl-2">, </span><span class="hl-6">offset</span><span class="hl-2"> }) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">// Call news API</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">response</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">fetch</span><span class="hl-2">(</span><br/><span class="hl-2">          </span><span class="hl-4">`https://api.cryptonews.com/v1/news?`</span><span class="hl-2"> +</span><br/><span class="hl-2">          </span><span class="hl-4">`symbol=</span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">&amp;`</span><span class="hl-2"> +</span><br/><span class="hl-2">          </span><span class="hl-4">`start=</span><span class="hl-3">${</span><span class="hl-6">startDate</span><span class="hl-9">.</span><span class="hl-1">getTime</span><span class="hl-9">()</span><span class="hl-3">}</span><span class="hl-4">&amp;`</span><span class="hl-2"> +</span><br/><span class="hl-2">          </span><span class="hl-4">`end=</span><span class="hl-3">${</span><span class="hl-6">endDate</span><span class="hl-9">.</span><span class="hl-1">getTime</span><span class="hl-9">()</span><span class="hl-3">}</span><span class="hl-4">&amp;`</span><span class="hl-2"> +</span><br/><span class="hl-2">          </span><span class="hl-4">`limit=</span><span class="hl-3">${</span><span class="hl-6">limit</span><span class="hl-3">}</span><span class="hl-4">&amp;`</span><span class="hl-2"> +</span><br/><span class="hl-2">          </span><span class="hl-4">`offset=</span><span class="hl-3">${</span><span class="hl-6">offset</span><span class="hl-3">}</span><span class="hl-4">`</span><br/><span class="hl-2">        );</span><br/><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">news</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">response</span><span class="hl-2">.</span><span class="hl-1">json</span><span class="hl-2">();</span><br/><br/><span class="hl-2">        </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-6">news</span><span class="hl-2">.</span><span class="hl-6">articles</span><span class="hl-2">.</span><span class="hl-1">map</span><span class="hl-2">(</span><span class="hl-6">article</span><span class="hl-2"> </span><span class="hl-3">=&gt;</span><span class="hl-2"> ({</span><br/><span class="hl-2">          </span><span class="hl-6">id:</span><span class="hl-2"> </span><span class="hl-6">article</span><span class="hl-2">.</span><span class="hl-6">id</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">title:</span><span class="hl-2"> </span><span class="hl-6">article</span><span class="hl-2">.</span><span class="hl-6">title</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">content:</span><span class="hl-2"> </span><span class="hl-6">article</span><span class="hl-2">.</span><span class="hl-6">content</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">timestamp:</span><span class="hl-2"> </span><span class="hl-6">article</span><span class="hl-2">.</span><span class="hl-6">publishedAt</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">sentiment:</span><span class="hl-2"> </span><span class="hl-6">article</span><span class="hl-2">.</span><span class="hl-6">sentiment</span><span class="hl-2">,</span><br/><span class="hl-2">        }));</span><br/><span class="hl-2">      },</span><br/><br/><span class="hl-2">      </span><span class="hl-0">// Format for user message</span><br/><span class="hl-2">      </span><span class="hl-1">user</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">, </span><span class="hl-6">sourceName</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">`Here are news about </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">:</span><span class="hl-14">\n\n</span><span class="hl-4">`</span><span class="hl-2"> +</span><br/><span class="hl-2">          </span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-1">map</span><span class="hl-2">(</span><span class="hl-6">article</span><span class="hl-2"> </span><span class="hl-3">=&gt;</span><br/><span class="hl-2">            </span><span class="hl-4">`[</span><span class="hl-3">${</span><span class="hl-3">new</span><span class="hl-9"> </span><span class="hl-1">Date</span><span class="hl-9">(</span><span class="hl-6">article</span><span class="hl-9">.</span><span class="hl-6">timestamp</span><span class="hl-9">).</span><span class="hl-1">toISOString</span><span class="hl-9">()</span><span class="hl-3">}</span><span class="hl-4">] </span><span class="hl-3">${</span><span class="hl-6">article</span><span class="hl-9">.</span><span class="hl-6">title</span><span class="hl-3">}</span><span class="hl-14">\n</span><span class="hl-4">`</span><span class="hl-2"> +</span><br/><span class="hl-2">            </span><span class="hl-4">`Sentiment: </span><span class="hl-3">${</span><span class="hl-6">article</span><span class="hl-9">.</span><span class="hl-6">sentiment</span><span class="hl-3">}</span><span class="hl-14">\n</span><span class="hl-4">`</span><span class="hl-2"> +</span><br/><span class="hl-2">            </span><span class="hl-4">`</span><span class="hl-3">${</span><span class="hl-6">article</span><span class="hl-9">.</span><span class="hl-6">content</span><span class="hl-9">.</span><span class="hl-1">substring</span><span class="hl-9">(</span><span class="hl-7">0</span><span class="hl-9">, </span><span class="hl-7">200</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-4">...</span><span class="hl-14">\n</span><span class="hl-4">`</span><br/><span class="hl-2">          ).</span><span class="hl-1">join</span><span class="hl-2">(</span><span class="hl-4">&#39;</span><span class="hl-14">\n</span><span class="hl-4">&#39;</span><span class="hl-2">);</span><br/><span class="hl-2">      },</span><br/><br/><span class="hl-2">      </span><span class="hl-0">// Format for assistant response</span><br/><span class="hl-2">      </span><span class="hl-1">assistant</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">, </span><span class="hl-6">sourceName</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">positiveSentiment</span><span class="hl-2"> = </span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-1">filter</span><span class="hl-2">(</span><span class="hl-6">a</span><span class="hl-2"> </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-6">a</span><span class="hl-2">.</span><span class="hl-6">sentiment</span><span class="hl-2"> &gt; </span><span class="hl-7">0</span><span class="hl-2">).</span><span class="hl-6">length</span><span class="hl-2">;</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">negativeSentiment</span><span class="hl-2"> = </span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-1">filter</span><span class="hl-2">(</span><span class="hl-6">a</span><span class="hl-2"> </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-6">a</span><span class="hl-2">.</span><span class="hl-6">sentiment</span><span class="hl-2"> &lt; </span><span class="hl-7">0</span><span class="hl-2">).</span><span class="hl-6">length</span><span class="hl-2">;</span><br/><br/><span class="hl-2">        </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">`Analyzed </span><span class="hl-3">${</span><span class="hl-6">data</span><span class="hl-9">.</span><span class="hl-6">length</span><span class="hl-3">}</span><span class="hl-4"> news articles about </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">.</span><span class="hl-14">\n</span><span class="hl-4">`</span><span class="hl-2"> +</span><br/><span class="hl-2">          </span><span class="hl-4">`Positive: </span><span class="hl-3">${</span><span class="hl-6">positiveSentiment</span><span class="hl-3">}</span><span class="hl-4">, Negative: </span><span class="hl-3">${</span><span class="hl-6">negativeSentiment</span><span class="hl-3">}</span><span class="hl-4">.</span><span class="hl-14">\n</span><span class="hl-4">`</span><span class="hl-2"> +</span><br/><span class="hl-2">          </span><span class="hl-4">`Overall sentiment: </span><span class="hl-3">${</span><span class="hl-6">positiveSentiment</span><span class="hl-9"> </span><span class="hl-2">&gt;</span><span class="hl-9"> </span><span class="hl-6">negativeSentiment</span><span class="hl-9"> </span><span class="hl-2">?</span><span class="hl-9"> </span><span class="hl-4">&#39;bullish&#39;</span><span class="hl-9"> </span><span class="hl-2">:</span><span class="hl-9"> </span><span class="hl-4">&#39;bearish&#39;</span><span class="hl-3">}</span><span class="hl-4">.`</span><span class="hl-2">;</span><br/><span class="hl-2">      },</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  ],</span><br/><br/><span class="hl-2">  </span><span class="hl-1">getPrompt</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">messages</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">`Based on the analyzed news, create a trading strategy for </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">.`</span><span class="hl-2">;</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="example-2-technical-indicators-source" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Example 2: Technical Indicators Source<a href="#example-2-technical-indicators-source" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">SMA</span><span class="hl-2">, </span><span class="hl-6">RSI</span><span class="hl-2">, </span><span class="hl-6">MACD</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;technicalindicators&quot;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">addOptimizer</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-1">addOptimizer</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;technical-optimizer&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">rangeTrain:</span><span class="hl-2"> [</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-01-01&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">      </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-01-31&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  ],</span><br/><span class="hl-2">  </span><span class="hl-6">rangeTest:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-02-01&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">    </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-02-28&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">  },</span><br/><br/><span class="hl-2">  </span><span class="hl-6">source:</span><span class="hl-2"> [</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-6">name:</span><span class="hl-2"> </span><span class="hl-4">&quot;technical-indicators&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-1">fetch</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> ({ </span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">startDate</span><span class="hl-2">, </span><span class="hl-6">endDate</span><span class="hl-2">, </span><span class="hl-6">limit</span><span class="hl-2">, </span><span class="hl-6">offset</span><span class="hl-2"> }) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">// Get historical candles</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">exchange</span><span class="hl-2"> = </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-6">ccxt</span><span class="hl-2">.</span><span class="hl-1">binance</span><span class="hl-2">();</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">ohlcv</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">exchange</span><span class="hl-2">.</span><span class="hl-1">fetchOHLCV</span><span class="hl-2">(</span><br/><span class="hl-2">          </span><span class="hl-6">symbol</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-4">&quot;1h&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">startDate</span><span class="hl-2">.</span><span class="hl-1">getTime</span><span class="hl-2">(),</span><br/><span class="hl-2">          </span><span class="hl-7">100</span><br/><span class="hl-2">        );</span><br/><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">closes</span><span class="hl-2"> = </span><span class="hl-6">ohlcv</span><span class="hl-2">.</span><span class="hl-1">map</span><span class="hl-2">(</span><span class="hl-6">c</span><span class="hl-2"> </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-6">c</span><span class="hl-2">[</span><span class="hl-7">4</span><span class="hl-2">]);</span><br/><br/><span class="hl-2">        </span><span class="hl-0">// Calculate indicators</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">sma20</span><span class="hl-2"> = </span><span class="hl-8">SMA</span><span class="hl-2">.</span><span class="hl-1">calculate</span><span class="hl-2">({ </span><span class="hl-6">period:</span><span class="hl-2"> </span><span class="hl-7">20</span><span class="hl-2">, </span><span class="hl-6">values:</span><span class="hl-2"> </span><span class="hl-6">closes</span><span class="hl-2"> });</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">sma50</span><span class="hl-2"> = </span><span class="hl-8">SMA</span><span class="hl-2">.</span><span class="hl-1">calculate</span><span class="hl-2">({ </span><span class="hl-6">period:</span><span class="hl-2"> </span><span class="hl-7">50</span><span class="hl-2">, </span><span class="hl-6">values:</span><span class="hl-2"> </span><span class="hl-6">closes</span><span class="hl-2"> });</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">rsi</span><span class="hl-2"> = </span><span class="hl-8">RSI</span><span class="hl-2">.</span><span class="hl-1">calculate</span><span class="hl-2">({ </span><span class="hl-6">period:</span><span class="hl-2"> </span><span class="hl-7">14</span><span class="hl-2">, </span><span class="hl-6">values:</span><span class="hl-2"> </span><span class="hl-6">closes</span><span class="hl-2"> });</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">macd</span><span class="hl-2"> = </span><span class="hl-8">MACD</span><span class="hl-2">.</span><span class="hl-1">calculate</span><span class="hl-2">({</span><br/><span class="hl-2">          </span><span class="hl-6">values:</span><span class="hl-2"> </span><span class="hl-6">closes</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">fastPeriod:</span><span class="hl-2"> </span><span class="hl-7">12</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">slowPeriod:</span><span class="hl-2"> </span><span class="hl-7">26</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">signalPeriod:</span><span class="hl-2"> </span><span class="hl-7">9</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">SimpleMAOscillator:</span><span class="hl-2"> </span><span class="hl-3">false</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">SimpleMASignal:</span><span class="hl-2"> </span><span class="hl-3">false</span><span class="hl-2">,</span><br/><span class="hl-2">        });</span><br/><br/><span class="hl-2">        </span><span class="hl-5">return</span><span class="hl-2"> [{</span><br/><span class="hl-2">          </span><span class="hl-6">id:</span><span class="hl-2"> </span><span class="hl-4">`</span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">-</span><span class="hl-3">${</span><span class="hl-6">startDate</span><span class="hl-9">.</span><span class="hl-1">getTime</span><span class="hl-9">()</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">symbol</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">timestamp:</span><span class="hl-2"> </span><span class="hl-6">Date</span><span class="hl-2">.</span><span class="hl-1">now</span><span class="hl-2">(),</span><br/><span class="hl-2">          </span><span class="hl-6">indicators:</span><span class="hl-2"> {</span><br/><span class="hl-2">            </span><span class="hl-6">sma20:</span><span class="hl-2"> </span><span class="hl-6">sma20</span><span class="hl-2">[</span><span class="hl-6">sma20</span><span class="hl-2">.</span><span class="hl-6">length</span><span class="hl-2"> - </span><span class="hl-7">1</span><span class="hl-2">],</span><br/><span class="hl-2">            </span><span class="hl-6">sma50:</span><span class="hl-2"> </span><span class="hl-6">sma50</span><span class="hl-2">[</span><span class="hl-6">sma50</span><span class="hl-2">.</span><span class="hl-6">length</span><span class="hl-2"> - </span><span class="hl-7">1</span><span class="hl-2">],</span><br/><span class="hl-2">            </span><span class="hl-6">rsi:</span><span class="hl-2"> </span><span class="hl-6">rsi</span><span class="hl-2">[</span><span class="hl-6">rsi</span><span class="hl-2">.</span><span class="hl-6">length</span><span class="hl-2"> - </span><span class="hl-7">1</span><span class="hl-2">],</span><br/><span class="hl-2">            </span><span class="hl-6">macd:</span><span class="hl-2"> </span><span class="hl-6">macd</span><span class="hl-2">[</span><span class="hl-6">macd</span><span class="hl-2">.</span><span class="hl-6">length</span><span class="hl-2"> - </span><span class="hl-7">1</span><span class="hl-2">],</span><br/><span class="hl-2">          },</span><br/><span class="hl-2">          </span><span class="hl-6">candles:</span><span class="hl-2"> </span><span class="hl-6">ohlcv</span><span class="hl-2">.</span><span class="hl-1">slice</span><span class="hl-2">(-</span><span class="hl-7">24</span><span class="hl-2">),</span><br/><span class="hl-2">        }];</span><br/><span class="hl-2">      },</span><br/><br/><span class="hl-2">      </span><span class="hl-1">user</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">, </span><span class="hl-6">sourceName</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">latest</span><span class="hl-2"> = </span><span class="hl-6">data</span><span class="hl-2">[</span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-6">length</span><span class="hl-2"> - </span><span class="hl-7">1</span><span class="hl-2">];</span><br/><span class="hl-2">        </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">`Current indicators for </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">:</span><span class="hl-14">\n</span><span class="hl-4">`</span><span class="hl-2"> +</span><br/><span class="hl-2">          </span><span class="hl-4">`SMA(20): </span><span class="hl-3">${</span><span class="hl-6">latest</span><span class="hl-9">.</span><span class="hl-6">indicators</span><span class="hl-9">.</span><span class="hl-6">sma20</span><span class="hl-9">?.</span><span class="hl-1">toFixed</span><span class="hl-9">(</span><span class="hl-7">2</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-14">\n</span><span class="hl-4">`</span><span class="hl-2"> +</span><br/><span class="hl-2">          </span><span class="hl-4">`SMA(50): </span><span class="hl-3">${</span><span class="hl-6">latest</span><span class="hl-9">.</span><span class="hl-6">indicators</span><span class="hl-9">.</span><span class="hl-6">sma50</span><span class="hl-9">?.</span><span class="hl-1">toFixed</span><span class="hl-9">(</span><span class="hl-7">2</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-14">\n</span><span class="hl-4">`</span><span class="hl-2"> +</span><br/><span class="hl-2">          </span><span class="hl-4">`RSI(14): </span><span class="hl-3">${</span><span class="hl-6">latest</span><span class="hl-9">.</span><span class="hl-6">indicators</span><span class="hl-9">.</span><span class="hl-6">rsi</span><span class="hl-9">?.</span><span class="hl-1">toFixed</span><span class="hl-9">(</span><span class="hl-7">2</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-14">\n</span><span class="hl-4">`</span><span class="hl-2"> +</span><br/><span class="hl-2">          </span><span class="hl-4">`MACD: </span><span class="hl-3">${</span><span class="hl-6">latest</span><span class="hl-9">.</span><span class="hl-6">indicators</span><span class="hl-9">.</span><span class="hl-6">macd</span><span class="hl-9">?.</span><span class="hl-8">MACD</span><span class="hl-9">?.</span><span class="hl-1">toFixed</span><span class="hl-9">(</span><span class="hl-7">2</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-14">\n</span><span class="hl-4">`</span><span class="hl-2"> +</span><br/><span class="hl-2">          </span><span class="hl-4">`Signal: </span><span class="hl-3">${</span><span class="hl-6">latest</span><span class="hl-9">.</span><span class="hl-6">indicators</span><span class="hl-9">.</span><span class="hl-6">macd</span><span class="hl-9">?.</span><span class="hl-6">signal</span><span class="hl-9">?.</span><span class="hl-1">toFixed</span><span class="hl-9">(</span><span class="hl-7">2</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">;</span><br/><span class="hl-2">      },</span><br/><br/><span class="hl-2">      </span><span class="hl-1">assistant</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">, </span><span class="hl-6">sourceName</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">latest</span><span class="hl-2"> = </span><span class="hl-6">data</span><span class="hl-2">[</span><span class="hl-6">data</span><span class="hl-2">.</span><span class="hl-6">length</span><span class="hl-2"> - </span><span class="hl-7">1</span><span class="hl-2">];</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">trend</span><span class="hl-2"> = </span><span class="hl-6">latest</span><span class="hl-2">.</span><span class="hl-6">indicators</span><span class="hl-2">.</span><span class="hl-6">sma20</span><span class="hl-2"> &gt; </span><span class="hl-6">latest</span><span class="hl-2">.</span><span class="hl-6">indicators</span><span class="hl-2">.</span><span class="hl-6">sma50</span><span class="hl-2"> ? </span><span class="hl-4">&quot;uptrend&quot;</span><span class="hl-2"> : </span><span class="hl-4">&quot;downtrend&quot;</span><span class="hl-2">;</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">rsiStatus</span><span class="hl-2"> = </span><span class="hl-6">latest</span><span class="hl-2">.</span><span class="hl-6">indicators</span><span class="hl-2">.</span><span class="hl-6">rsi</span><span class="hl-2"> &gt; </span><span class="hl-7">70</span><span class="hl-2"> ? </span><span class="hl-4">&quot;overbought&quot;</span><span class="hl-2"> : </span><span class="hl-6">latest</span><span class="hl-2">.</span><span class="hl-6">indicators</span><span class="hl-2">.</span><span class="hl-6">rsi</span><span class="hl-2"> &lt; </span><span class="hl-7">30</span><span class="hl-2"> ? </span><span class="hl-4">&quot;oversold&quot;</span><span class="hl-2"> : </span><span class="hl-4">&quot;neutral&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-2">        </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">`Indicator analysis:</span><span class="hl-14">\n</span><span class="hl-4">Trend: </span><span class="hl-3">${</span><span class="hl-6">trend</span><span class="hl-3">}</span><span class="hl-14">\n</span><span class="hl-4">RSI: </span><span class="hl-3">${</span><span class="hl-6">rsiStatus</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">;</span><br/><span class="hl-2">      },</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  ],</span><br/><br/><span class="hl-2">  </span><span class="hl-1">getPrompt</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">messages</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">`Based on technical indicators, create a strategy for trading </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">.`</span><span class="hl-2"> +</span><br/><span class="hl-2">      </span><span class="hl-4">`Use a combination of SMA crossovers, RSI for overbought/oversold zones,`</span><span class="hl-2"> +</span><br/><span class="hl-2">      </span><span class="hl-4">`and MACD for trend confirmation.`</span><span class="hl-2">;</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="prompt-generator" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Prompt Generator<a href="#prompt-generator" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>getPrompt</code> function receives all collected information and creates the final instruction for the LLM.</p>
<pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">addOptimizer</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">Ollama</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;ollama&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-1">addOptimizer</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;advanced-optimizer&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">rangeTrain:</span><span class="hl-2"> [</span><span class="hl-0">/* ... */</span><span class="hl-2">],</span><br/><span class="hl-2">  </span><span class="hl-6">rangeTest:</span><span class="hl-2"> {</span><span class="hl-0">/* ... */</span><span class="hl-2">},</span><br/><span class="hl-2">  </span><span class="hl-6">source:</span><span class="hl-2"> [</span><span class="hl-0">/* ... */</span><span class="hl-2">],</span><br/><br/><span class="hl-2">  </span><span class="hl-1">getPrompt</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">messages</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-0">// messages - array of all messages from data sources</span><br/><br/><span class="hl-2">    </span><span class="hl-0">// Can use LLM to generate prompt</span><br/><span class="hl-2">    </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">ollama</span><span class="hl-2"> = </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Ollama</span><span class="hl-2">({ </span><span class="hl-6">host:</span><span class="hl-2"> </span><span class="hl-6">process</span><span class="hl-2">.</span><span class="hl-6">env</span><span class="hl-2">.</span><span class="hl-8">OLLAMA_HOST</span><span class="hl-2"> });</span><br/><br/><span class="hl-2">    </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">summaryResponse</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">ollama</span><span class="hl-2">.</span><span class="hl-1">chat</span><span class="hl-2">({</span><br/><span class="hl-2">      </span><span class="hl-6">model:</span><span class="hl-2"> </span><span class="hl-6">process</span><span class="hl-2">.</span><span class="hl-6">env</span><span class="hl-2">.</span><span class="hl-8">OLLAMA_MODEL</span><span class="hl-2"> || </span><span class="hl-4">&quot;deepseek-v3.1&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-6">messages:</span><span class="hl-2"> [</span><br/><span class="hl-2">        {</span><br/><span class="hl-2">          </span><span class="hl-6">role:</span><span class="hl-2"> </span><span class="hl-4">&quot;user&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">content:</span><span class="hl-2"> </span><span class="hl-4">&quot;Analyze the following market information and create a brief summary:</span><span class="hl-14">\n\n</span><span class="hl-4">&quot;</span><span class="hl-2"> +</span><br/><span class="hl-2">            </span><span class="hl-6">messages</span><span class="hl-2">.</span><span class="hl-1">map</span><span class="hl-2">(</span><span class="hl-6">m</span><span class="hl-2"> </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-4">`</span><span class="hl-3">${</span><span class="hl-6">m</span><span class="hl-9">.</span><span class="hl-6">role</span><span class="hl-3">}</span><span class="hl-4">: </span><span class="hl-3">${</span><span class="hl-6">m</span><span class="hl-9">.</span><span class="hl-6">content</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">).</span><span class="hl-1">join</span><span class="hl-2">(</span><span class="hl-4">&#39;</span><span class="hl-14">\n\n</span><span class="hl-4">&#39;</span><span class="hl-2">)</span><br/><span class="hl-2">        },</span><br/><span class="hl-2">      ],</span><br/><span class="hl-2">    });</span><br/><br/><span class="hl-2">    </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">summary</span><span class="hl-2"> = </span><span class="hl-6">summaryResponse</span><span class="hl-2">.</span><span class="hl-6">message</span><span class="hl-2">.</span><span class="hl-6">content</span><span class="hl-2">;</span><br/><br/><span class="hl-2">    </span><span class="hl-0">// Create final strategy prompt</span><br/><span class="hl-2">    </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">`You are a cryptocurrency trading expert.</span><br/><br/><span class="hl-4">Based on the following market analysis:</span><br/><span class="hl-3">${</span><span class="hl-6">summary</span><span class="hl-3">}</span><br/><br/><span class="hl-4">Create a trading strategy for </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4"> with the following characteristics:</span><br/><br/><span class="hl-4">1. ENTRY DIRECTION: Determine when to open LONG or SHORT positions</span><br/><span class="hl-4">2. ENTRY POINT: Determine optimal entry price (use priceOpen if delayed entry is needed)</span><br/><span class="hl-4">3. TAKE-PROFIT: Target price for profit taking (minimum +2% from entry)</span><br/><span class="hl-4">4. STOP-LOSS: Protective level (maximum -1.5% from entry)</span><br/><span class="hl-4">5. TIME TO LIVE: Maximum position holding time in minutes</span><br/><br/><span class="hl-4">IMPORTANT: Risk/reward ratio must be at least 1:2.</span><br/><br/><span class="hl-4">Return result in JSON format:</span><br/><span class="hl-4">{</span><br/><span class="hl-4">  &quot;position&quot;: &quot;long&quot; | &quot;short&quot; | &quot;wait&quot;,</span><br/><span class="hl-4">  &quot;priceOpen&quot;: number | undefined,</span><br/><span class="hl-4">  &quot;priceTakeProfit&quot;: number,</span><br/><span class="hl-4">  &quot;priceStopLoss&quot;: number,</span><br/><span class="hl-4">  &quot;minuteEstimatedTime&quot;: number</span><br/><span class="hl-4">}</span><br/><br/><span class="hl-4">If there&#39;s no clear signal, use &quot;position&quot;: &quot;wait&quot;.`</span><span class="hl-2">;</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="running-optimization" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Running Optimization<a href="#running-optimization" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="method-1-getting-data" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Method 1: Getting Data<a href="#method-1-getting-data" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">Optimizer</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-0">// Collect data and generate strategies</span><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">strategies</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">Optimizer</span><span class="hl-2">.</span><span class="hl-1">getData</span><span class="hl-2">(</span><span class="hl-4">&quot;BTCUSDT&quot;</span><span class="hl-2">, {</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;crypto-optimizer&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Generated strategies: </span><span class="hl-3">${</span><span class="hl-6">strategies</span><span class="hl-9">.</span><span class="hl-6">length</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><br/><span class="hl-6">strategies</span><span class="hl-2">.</span><span class="hl-1">forEach</span><span class="hl-2">((</span><span class="hl-6">strategy</span><span class="hl-2">, </span><span class="hl-6">index</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`</span><span class="hl-14">\n</span><span class="hl-4">Strategy </span><span class="hl-3">${</span><span class="hl-6">index</span><span class="hl-9"> </span><span class="hl-2">+</span><span class="hl-9"> </span><span class="hl-7">1</span><span class="hl-3">}</span><span class="hl-4">:`</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`  Name: </span><span class="hl-3">${</span><span class="hl-6">strategy</span><span class="hl-9">.</span><span class="hl-6">name</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`  Symbol: </span><span class="hl-3">${</span><span class="hl-6">strategy</span><span class="hl-9">.</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`  Prompt:</span><span class="hl-14">\n</span><span class="hl-3">${</span><span class="hl-6">strategy</span><span class="hl-9">.</span><span class="hl-6">strategy</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="method-2-generating-code" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Method 2: Generating Code<a href="#method-2-generating-code" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">Optimizer</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-0">// Generate full executable code</span><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">code</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">Optimizer</span><span class="hl-2">.</span><span class="hl-1">getCode</span><span class="hl-2">(</span><span class="hl-4">&quot;BTCUSDT&quot;</span><span class="hl-2">, {</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;crypto-optimizer&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">&quot;Generated code:&quot;</span><span class="hl-2">);</span><br/><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-6">code</span><span class="hl-2">);</span><br/><br/><span class="hl-0">// Code includes:</span><br/><span class="hl-0">// - Imports and setup</span><br/><span class="hl-0">// - LLM helper functions</span><br/><span class="hl-0">// - Exchange setup</span><br/><span class="hl-0">// - Training and testing frames</span><br/><span class="hl-0">// - Generated strategies</span><br/><span class="hl-0">// - Walker configuration for comparison</span><br/><span class="hl-0">// - Event listeners and launch</span>
</code><button type="button">Copy</button></pre>

<a id="method-3-dumping-to-file" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Method 3: Dumping to File<a href="#method-3-dumping-to-file" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">Optimizer</span><span class="hl-2">, </span><span class="hl-6">listenOptimizerProgress</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-0">// Monitor progress</span><br/><span class="hl-1">listenOptimizerProgress</span><span class="hl-2">((</span><span class="hl-6">event</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">percent</span><span class="hl-2"> = (</span><span class="hl-6">event</span><span class="hl-2">.</span><span class="hl-6">progress</span><span class="hl-2"> * </span><span class="hl-7">100</span><span class="hl-2">).</span><span class="hl-1">toFixed</span><span class="hl-2">(</span><span class="hl-7">1</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Progress: </span><span class="hl-3">${</span><span class="hl-6">percent</span><span class="hl-3">}</span><span class="hl-4">% - </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">comment</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// Save generated code to file</span><br/><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">Optimizer</span><span class="hl-2">.</span><span class="hl-1">dump</span><span class="hl-2">(</span><span class="hl-4">&quot;BTCUSDT&quot;</span><span class="hl-2">, {</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;crypto-optimizer&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// File saved to: ./dump/optimizer/crypto-optimizer_BTCUSDT.mjs</span><br/><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">&quot;Code saved to ./dump/optimizer/crypto-optimizer_BTCUSDT.mjs&quot;</span><span class="hl-2">);</span><br/><br/><span class="hl-0">// Now you can run the generated strategy:</span><br/><span class="hl-0">// node ./dump/optimizer/crypto-optimizer_BTCUSDT.mjs</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="generated-code-structure" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Generated Code Structure<a href="#generated-code-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Optimizer generates a fully ready-to-execute <code>.mjs</code> file with the following structure:</p>
<pre><code class="javascript"><span class="hl-0">#!/usr/bin/env node</span><br/><br/><span class="hl-0">// 1. Imports</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">Ollama</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;ollama&quot;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> </span><span class="hl-6">ccxt</span><span class="hl-2"> </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;ccxt&quot;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">addExchange</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">addFrame</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">addStrategy</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">addWalker</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">Walker</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">listenWalkerProgress</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">listenDoneWalker</span><span class="hl-2">,</span><br/><span class="hl-2">} </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-0">// 2. Constants</span><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">OLLAMA_HOST</span><span class="hl-2"> = </span><span class="hl-6">process</span><span class="hl-2">.</span><span class="hl-6">env</span><span class="hl-2">.</span><span class="hl-8">OLLAMA_HOST</span><span class="hl-2"> || </span><span class="hl-4">&quot;http://localhost:11434&quot;</span><span class="hl-2">;</span><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">OLLAMA_MODEL</span><span class="hl-2"> = </span><span class="hl-6">process</span><span class="hl-2">.</span><span class="hl-6">env</span><span class="hl-2">.</span><span class="hl-8">OLLAMA_MODEL</span><span class="hl-2"> || </span><span class="hl-4">&quot;deepseek-v3.1&quot;</span><span class="hl-2">;</span><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">ollama</span><span class="hl-2"> = </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Ollama</span><span class="hl-2">({ </span><span class="hl-6">host:</span><span class="hl-2"> </span><span class="hl-8">OLLAMA_HOST</span><span class="hl-2"> });</span><br/><br/><span class="hl-0">// 3. Helper functions for LLM</span><br/><span class="hl-3">async</span><span class="hl-2"> </span><span class="hl-3">function</span><span class="hl-2"> </span><span class="hl-1">text</span><span class="hl-2">(</span><span class="hl-6">messages</span><span class="hl-2">) { </span><span class="hl-0">/* ... */</span><span class="hl-2"> }</span><br/><span class="hl-3">async</span><span class="hl-2"> </span><span class="hl-3">function</span><span class="hl-2"> </span><span class="hl-1">json</span><span class="hl-2">(</span><span class="hl-6">messages</span><span class="hl-2">) { </span><span class="hl-0">/* ... */</span><span class="hl-2"> }</span><br/><span class="hl-3">async</span><span class="hl-2"> </span><span class="hl-3">function</span><span class="hl-2"> </span><span class="hl-1">dumpJson</span><span class="hl-2">(</span><span class="hl-6">resultId</span><span class="hl-2">, </span><span class="hl-6">history</span><span class="hl-2">, </span><span class="hl-6">result</span><span class="hl-2">) { </span><span class="hl-0">/* ... */</span><span class="hl-2"> }</span><br/><br/><span class="hl-0">// 4. Exchange setup</span><br/><span class="hl-1">addExchange</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">exchangeName:</span><span class="hl-2"> </span><span class="hl-4">&quot;a7x3k_exchange&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-1">getCandles</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">interval</span><span class="hl-2">, </span><span class="hl-6">since</span><span class="hl-2">, </span><span class="hl-6">limit</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> { </span><span class="hl-0">/* ... */</span><span class="hl-2"> },</span><br/><span class="hl-2">  </span><span class="hl-1">formatPrice</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">price</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> { </span><span class="hl-0">/* ... */</span><span class="hl-2"> },</span><br/><span class="hl-2">  </span><span class="hl-1">formatQuantity</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">quantity</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> { </span><span class="hl-0">/* ... */</span><span class="hl-2"> },</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// 5. Training frames</span><br/><span class="hl-1">addFrame</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">frameName:</span><span class="hl-2"> </span><span class="hl-4">&quot;a7x3k_train_frame-1&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">interval:</span><span class="hl-2"> </span><span class="hl-4">&quot;5m&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-01-01&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">  </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-01-15&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-1">addFrame</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">frameName:</span><span class="hl-2"> </span><span class="hl-4">&quot;a7x3k_train_frame-2&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">interval:</span><span class="hl-2"> </span><span class="hl-4">&quot;5m&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-02-01&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">  </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-02-15&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// 6. Testing frame</span><br/><span class="hl-1">addFrame</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">frameName:</span><span class="hl-2"> </span><span class="hl-4">&quot;a7x3k_test_frame&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">interval:</span><span class="hl-2"> </span><span class="hl-4">&quot;5m&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-03-01&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">  </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-03-15&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// 7. Generated strategies</span><br/><span class="hl-1">addStrategy</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">strategyName:</span><span class="hl-2"> </span><span class="hl-4">&quot;a7x3k_strategy-1&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">interval:</span><span class="hl-2"> </span><span class="hl-4">&quot;5m&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-1">getSignal</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-0">// Multi-timeframe analysis</span><br/><span class="hl-2">    </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">messages</span><span class="hl-2"> = [];</span><br/><br/><span class="hl-2">    </span><span class="hl-0">// Load candles from different timeframes</span><br/><span class="hl-2">    </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">microTermCandles</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">getCandles</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-4">&quot;1m&quot;</span><span class="hl-2">, </span><span class="hl-7">30</span><span class="hl-2">);</span><br/><span class="hl-2">    </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">mainTermCandles</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">getCandles</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-4">&quot;5m&quot;</span><span class="hl-2">, </span><span class="hl-7">24</span><span class="hl-2">);</span><br/><span class="hl-2">    </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">shortTermCandles</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">getCandles</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-4">&quot;15m&quot;</span><span class="hl-2">, </span><span class="hl-7">24</span><span class="hl-2">);</span><br/><span class="hl-2">    </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">mediumTermCandles</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">getCandles</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-4">&quot;1h&quot;</span><span class="hl-2">, </span><span class="hl-7">24</span><span class="hl-2">);</span><br/><br/><span class="hl-2">    </span><span class="hl-0">// Analyze each timeframe</span><br/><span class="hl-2">    </span><span class="hl-6">messages</span><span class="hl-2">.</span><span class="hl-1">push</span><span class="hl-2">(</span><br/><span class="hl-2">      { </span><span class="hl-6">role:</span><span class="hl-2"> </span><span class="hl-4">&quot;user&quot;</span><span class="hl-2">, </span><span class="hl-6">content:</span><span class="hl-2"> </span><span class="hl-4">&quot;Analyze 1h candles...&quot;</span><span class="hl-2"> },</span><br/><span class="hl-2">      { </span><span class="hl-6">role:</span><span class="hl-2"> </span><span class="hl-4">&quot;assistant&quot;</span><span class="hl-2">, </span><span class="hl-6">content:</span><span class="hl-2"> </span><span class="hl-4">&quot;1h trend analyzed&quot;</span><span class="hl-2"> }</span><br/><span class="hl-2">    );</span><br/><br/><span class="hl-2">    </span><span class="hl-0">// ... analysis of other timeframes ...</span><br/><br/><span class="hl-2">    </span><span class="hl-0">// Generate signal</span><br/><span class="hl-2">    </span><span class="hl-6">messages</span><span class="hl-2">.</span><span class="hl-1">push</span><span class="hl-2">({</span><br/><span class="hl-2">      </span><span class="hl-6">role:</span><span class="hl-2"> </span><span class="hl-4">&quot;user&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-6">content:</span><span class="hl-2"> </span><span class="hl-4">&quot;Generate trading signal: &quot;</span><span class="hl-2"> + </span><span class="hl-6">strategyPrompt</span><br/><span class="hl-2">    });</span><br/><br/><span class="hl-2">    </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">result</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">json</span><span class="hl-2">(</span><span class="hl-6">messages</span><span class="hl-2">);</span><br/><span class="hl-2">    </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">dumpJson</span><span class="hl-2">(</span><span class="hl-4">&quot;strategy-1&quot;</span><span class="hl-2">, </span><span class="hl-6">messages</span><span class="hl-2">, </span><span class="hl-6">result</span><span class="hl-2">);</span><br/><br/><span class="hl-2">    </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-6">result</span><span class="hl-2">;</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// 8. Walker configuration for comparison</span><br/><span class="hl-1">addWalker</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">walkerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;a7x3k_walker&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">exchangeName:</span><span class="hl-2"> </span><span class="hl-4">&quot;a7x3k_exchange&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">frameName:</span><span class="hl-2"> </span><span class="hl-4">&quot;a7x3k_test_frame&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">strategies:</span><span class="hl-2"> [</span><br/><span class="hl-2">    { </span><span class="hl-6">strategyName:</span><span class="hl-2"> </span><span class="hl-4">&quot;a7x3k_strategy-1&quot;</span><span class="hl-2">, </span><span class="hl-6">symbols:</span><span class="hl-2"> [</span><span class="hl-4">&quot;BTCUSDT&quot;</span><span class="hl-2">] },</span><br/><span class="hl-2">    { </span><span class="hl-6">strategyName:</span><span class="hl-2"> </span><span class="hl-4">&quot;a7x3k_strategy-2&quot;</span><span class="hl-2">, </span><span class="hl-6">symbols:</span><span class="hl-2"> [</span><span class="hl-4">&quot;BTCUSDT&quot;</span><span class="hl-2">] },</span><br/><span class="hl-2">  ],</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// 9. Event listeners and launch</span><br/><span class="hl-1">listenWalkerProgress</span><span class="hl-2">((</span><span class="hl-6">event</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Progress: </span><span class="hl-3">${</span><span class="hl-9">(</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">progress</span><span class="hl-9"> </span><span class="hl-2">*</span><span class="hl-9"> </span><span class="hl-7">100</span><span class="hl-9">).</span><span class="hl-1">toFixed</span><span class="hl-9">(</span><span class="hl-7">1</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-4">%`</span><span class="hl-2">);</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-1">listenDoneWalker</span><span class="hl-2">(</span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">event</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">&quot;Strategy comparison completed&quot;</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">Walker</span><span class="hl-2">.</span><span class="hl-1">dump</span><span class="hl-2">(</span><span class="hl-6">event</span><span class="hl-2">.</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">event</span><span class="hl-2">.</span><span class="hl-6">walkerName</span><span class="hl-2">);</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// Launch Walker</span><br/><span class="hl-6">Walker</span><span class="hl-2">.</span><span class="hl-1">background</span><span class="hl-2">(</span><span class="hl-4">&quot;BTCUSDT&quot;</span><span class="hl-2">, {</span><br/><span class="hl-2">  </span><span class="hl-6">walkerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;a7x3k_walker&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="multi-timeframe-analysis" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Multi-timeframe Analysis<a href="#multi-timeframe-analysis" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Generated strategies use a 4-phase analysis pattern:</p>
<p><img src="../media/06-ai-optimization_1.svg" alt="Mermaid Diagram"></p>
<hr>
<a id="progress-monitoring" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Progress Monitoring<a href="#progress-monitoring" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">listenOptimizerProgress</span><span class="hl-2">, </span><span class="hl-6">Optimizer</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-0">// Detailed monitoring</span><br/><span class="hl-1">listenOptimizerProgress</span><span class="hl-2">((</span><span class="hl-6">event</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">&quot;</span><span class="hl-14">\n</span><span class="hl-4">=== Optimization Progress ===&quot;</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Symbol: </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Optimizer: </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">optimizerName</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Progress: </span><span class="hl-3">${</span><span class="hl-9">(</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">progress</span><span class="hl-9"> </span><span class="hl-2">*</span><span class="hl-9"> </span><span class="hl-7">100</span><span class="hl-9">).</span><span class="hl-1">toFixed</span><span class="hl-9">(</span><span class="hl-7">1</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-4">%`</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Status: </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">comment</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`Timestamp: </span><span class="hl-3">${</span><span class="hl-3">new</span><span class="hl-9"> </span><span class="hl-1">Date</span><span class="hl-9">(</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">timestamp</span><span class="hl-9">).</span><span class="hl-1">toISOString</span><span class="hl-9">()</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// Launch with monitoring</span><br/><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">Optimizer</span><span class="hl-2">.</span><span class="hl-1">dump</span><span class="hl-2">(</span><span class="hl-4">&quot;BTCUSDT&quot;</span><span class="hl-2">, {</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;crypto-optimizer&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="complete-example-advanced-optimizer" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Complete Example: Advanced Optimizer<a href="#complete-example-advanced-optimizer" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="typescript"><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">config</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;dotenv&quot;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> </span><span class="hl-6">ccxt</span><span class="hl-2"> </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;ccxt&quot;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> { </span><span class="hl-6">Ollama</span><span class="hl-2"> } </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;ollama&quot;</span><span class="hl-2">;</span><br/><span class="hl-5">import</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-6">setLogger</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">addOptimizer</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">Optimizer</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">listenOptimizerProgress</span><span class="hl-2">,</span><br/><span class="hl-2">} </span><span class="hl-5">from</span><span class="hl-2"> </span><span class="hl-4">&quot;backtest-kit&quot;</span><span class="hl-2">;</span><br/><br/><span class="hl-0">// Load environment variables</span><br/><span class="hl-1">config</span><span class="hl-2">();</span><br/><br/><span class="hl-0">// Setup logger</span><br/><span class="hl-1">setLogger</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">log:</span><span class="hl-2"> </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-6">log</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">debug:</span><span class="hl-2"> </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-6">debug</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">info:</span><span class="hl-2"> </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-6">info</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">warn:</span><span class="hl-2"> </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-6">warn</span><span class="hl-2">,</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// Create optimizer</span><br/><span class="hl-1">addOptimizer</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;advanced-crypto-optimizer&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">note:</span><span class="hl-2"> </span><span class="hl-4">&quot;Advanced strategy generator with multiple data sources&quot;</span><span class="hl-2">,</span><br/><br/><span class="hl-2">  </span><span class="hl-6">rangeTrain:</span><span class="hl-2"> [</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-01-01&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">      </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-01-15&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-01-16&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">      </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-01-31&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-02-01&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">      </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-02-15&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  ],</span><br/><br/><span class="hl-2">  </span><span class="hl-6">rangeTest:</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-03-01&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">    </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-03-31&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">  },</span><br/><br/><span class="hl-2">  </span><span class="hl-6">source:</span><span class="hl-2"> [</span><br/><span class="hl-2">    </span><span class="hl-0">// Source 1: Technical indicators</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-6">name:</span><span class="hl-2"> </span><span class="hl-4">&quot;technical-analysis&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-1">fetch</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> ({ </span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">startDate</span><span class="hl-2">, </span><span class="hl-6">endDate</span><span class="hl-2">, </span><span class="hl-6">limit</span><span class="hl-2">, </span><span class="hl-6">offset</span><span class="hl-2"> }) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">exchange</span><span class="hl-2"> = </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-6">ccxt</span><span class="hl-2">.</span><span class="hl-1">binance</span><span class="hl-2">();</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">ohlcv</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">exchange</span><span class="hl-2">.</span><span class="hl-1">fetchOHLCV</span><span class="hl-2">(</span><br/><span class="hl-2">          </span><span class="hl-6">symbol</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-4">&quot;1h&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">startDate</span><span class="hl-2">.</span><span class="hl-1">getTime</span><span class="hl-2">(),</span><br/><span class="hl-2">          </span><span class="hl-7">100</span><br/><span class="hl-2">        );</span><br/><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">closes</span><span class="hl-2"> = </span><span class="hl-6">ohlcv</span><span class="hl-2">.</span><span class="hl-1">map</span><span class="hl-2">(</span><span class="hl-6">c</span><span class="hl-2"> </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-6">c</span><span class="hl-2">[</span><span class="hl-7">4</span><span class="hl-2">]);</span><br/><br/><span class="hl-2">        </span><span class="hl-5">return</span><span class="hl-2"> [{</span><br/><span class="hl-2">          </span><span class="hl-6">id:</span><span class="hl-2"> </span><span class="hl-4">`tech-</span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">-</span><span class="hl-3">${</span><span class="hl-6">startDate</span><span class="hl-9">.</span><span class="hl-1">getTime</span><span class="hl-9">()</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">timestamp:</span><span class="hl-2"> </span><span class="hl-6">Date</span><span class="hl-2">.</span><span class="hl-1">now</span><span class="hl-2">(),</span><br/><span class="hl-2">          </span><span class="hl-6">candles:</span><span class="hl-2"> </span><span class="hl-6">ohlcv</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">indicators:</span><span class="hl-2"> {</span><br/><span class="hl-2">            </span><span class="hl-0">// Calculate indicators</span><br/><span class="hl-2">            </span><span class="hl-6">sma20:</span><span class="hl-2"> </span><span class="hl-1">calculateSMA</span><span class="hl-2">(</span><span class="hl-6">closes</span><span class="hl-2">, </span><span class="hl-7">20</span><span class="hl-2">),</span><br/><span class="hl-2">            </span><span class="hl-6">rsi:</span><span class="hl-2"> </span><span class="hl-1">calculateRSI</span><span class="hl-2">(</span><span class="hl-6">closes</span><span class="hl-2">, </span><span class="hl-7">14</span><span class="hl-2">),</span><br/><span class="hl-2">            </span><span class="hl-6">macd:</span><span class="hl-2"> </span><span class="hl-1">calculateMACD</span><span class="hl-2">(</span><span class="hl-6">closes</span><span class="hl-2">),</span><br/><span class="hl-2">          },</span><br/><span class="hl-2">        }];</span><br/><span class="hl-2">      },</span><br/><span class="hl-2">      </span><span class="hl-1">user</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">`Technical analysis for </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">:</span><span class="hl-14">\n</span><span class="hl-3">${</span><span class="hl-8">JSON</span><span class="hl-9">.</span><span class="hl-1">stringify</span><span class="hl-9">(</span><span class="hl-6">data</span><span class="hl-9">[</span><span class="hl-7">0</span><span class="hl-9">].</span><span class="hl-6">indicators</span><span class="hl-9">, </span><span class="hl-3">null</span><span class="hl-9">, </span><span class="hl-7">2</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">;</span><br/><span class="hl-2">      },</span><br/><span class="hl-2">      </span><span class="hl-1">assistant</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> () </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">&quot;Technical analysis completed.&quot;</span><span class="hl-2">;</span><br/><span class="hl-2">      },</span><br/><span class="hl-2">    },</span><br/><br/><span class="hl-2">    </span><span class="hl-0">// Source 2: Trading volume</span><br/><span class="hl-2">    {</span><br/><span class="hl-2">      </span><span class="hl-6">name:</span><span class="hl-2"> </span><span class="hl-4">&quot;volume-analysis&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-1">fetch</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> ({ </span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">startDate</span><span class="hl-2">, </span><span class="hl-6">endDate</span><span class="hl-2"> }) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">exchange</span><span class="hl-2"> = </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-6">ccxt</span><span class="hl-2">.</span><span class="hl-1">binance</span><span class="hl-2">();</span><br/><span class="hl-2">        </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">trades</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">exchange</span><span class="hl-2">.</span><span class="hl-1">fetchTrades</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">startDate</span><span class="hl-2">.</span><span class="hl-1">getTime</span><span class="hl-2">(), </span><span class="hl-7">1000</span><span class="hl-2">);</span><br/><br/><span class="hl-2">        </span><span class="hl-5">return</span><span class="hl-2"> [{</span><br/><span class="hl-2">          </span><span class="hl-6">id:</span><span class="hl-2"> </span><span class="hl-4">`volume-</span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">-</span><span class="hl-3">${</span><span class="hl-6">startDate</span><span class="hl-9">.</span><span class="hl-1">getTime</span><span class="hl-9">()</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">totalVolume:</span><span class="hl-2"> </span><span class="hl-6">trades</span><span class="hl-2">.</span><span class="hl-1">reduce</span><span class="hl-2">((</span><span class="hl-6">sum</span><span class="hl-2">, </span><span class="hl-6">t</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-6">sum</span><span class="hl-2"> + </span><span class="hl-6">t</span><span class="hl-2">.</span><span class="hl-6">amount</span><span class="hl-2">, </span><span class="hl-7">0</span><span class="hl-2">),</span><br/><span class="hl-2">          </span><span class="hl-6">avgPrice:</span><span class="hl-2"> </span><span class="hl-6">trades</span><span class="hl-2">.</span><span class="hl-1">reduce</span><span class="hl-2">((</span><span class="hl-6">sum</span><span class="hl-2">, </span><span class="hl-6">t</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-6">sum</span><span class="hl-2"> + </span><span class="hl-6">t</span><span class="hl-2">.</span><span class="hl-6">price</span><span class="hl-2">, </span><span class="hl-7">0</span><span class="hl-2">) / </span><span class="hl-6">trades</span><span class="hl-2">.</span><span class="hl-6">length</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">buyPressure:</span><span class="hl-2"> </span><span class="hl-6">trades</span><span class="hl-2">.</span><span class="hl-1">filter</span><span class="hl-2">(</span><span class="hl-6">t</span><span class="hl-2"> </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-6">t</span><span class="hl-2">.</span><span class="hl-6">side</span><span class="hl-2"> === </span><span class="hl-4">&quot;buy&quot;</span><span class="hl-2">).</span><span class="hl-6">length</span><span class="hl-2"> / </span><span class="hl-6">trades</span><span class="hl-2">.</span><span class="hl-6">length</span><span class="hl-2">,</span><br/><span class="hl-2">        }];</span><br/><span class="hl-2">      },</span><br/><span class="hl-2">      </span><span class="hl-1">user</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">data</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">`Volume analysis for </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">: Buy pressure </span><span class="hl-3">${</span><span class="hl-9">(</span><span class="hl-6">data</span><span class="hl-9">[</span><span class="hl-7">0</span><span class="hl-9">].</span><span class="hl-6">buyPressure</span><span class="hl-9"> </span><span class="hl-2">*</span><span class="hl-9"> </span><span class="hl-7">100</span><span class="hl-9">).</span><span class="hl-1">toFixed</span><span class="hl-9">(</span><span class="hl-7">1</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-4">%`</span><span class="hl-2">;</span><br/><span class="hl-2">      },</span><br/><span class="hl-2">      </span><span class="hl-1">assistant</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> () </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">&quot;Volume analysis completed.&quot;</span><span class="hl-2">;</span><br/><span class="hl-2">      },</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">  ],</span><br/><br/><span class="hl-2">  </span><span class="hl-1">getPrompt</span><span class="hl-6">:</span><span class="hl-2"> </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">messages</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">    </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">ollama</span><span class="hl-2"> = </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Ollama</span><span class="hl-2">({ </span><span class="hl-6">host:</span><span class="hl-2"> </span><span class="hl-6">process</span><span class="hl-2">.</span><span class="hl-6">env</span><span class="hl-2">.</span><span class="hl-8">OLLAMA_HOST</span><span class="hl-2"> });</span><br/><br/><span class="hl-2">    </span><span class="hl-0">// Generate summary with LLM</span><br/><span class="hl-2">    </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">summaryResponse</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">ollama</span><span class="hl-2">.</span><span class="hl-1">chat</span><span class="hl-2">({</span><br/><span class="hl-2">      </span><span class="hl-6">model:</span><span class="hl-2"> </span><span class="hl-4">&quot;deepseek-v3.1&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">      </span><span class="hl-6">messages:</span><span class="hl-2"> [</span><br/><span class="hl-2">        {</span><br/><span class="hl-2">          </span><span class="hl-6">role:</span><span class="hl-2"> </span><span class="hl-4">&quot;user&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">          </span><span class="hl-6">content:</span><span class="hl-2"> </span><span class="hl-4">&quot;Create a brief market analysis summary:</span><span class="hl-14">\n\n</span><span class="hl-4">&quot;</span><span class="hl-2"> +</span><br/><span class="hl-2">            </span><span class="hl-6">messages</span><span class="hl-2">.</span><span class="hl-1">map</span><span class="hl-2">(</span><span class="hl-6">m</span><span class="hl-2"> </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-4">`</span><span class="hl-3">${</span><span class="hl-6">m</span><span class="hl-9">.</span><span class="hl-6">role</span><span class="hl-3">}</span><span class="hl-4">: </span><span class="hl-3">${</span><span class="hl-6">m</span><span class="hl-9">.</span><span class="hl-6">content</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">).</span><span class="hl-1">join</span><span class="hl-2">(</span><span class="hl-4">&#39;</span><span class="hl-14">\n\n</span><span class="hl-4">&#39;</span><span class="hl-2">)</span><br/><span class="hl-2">        },</span><br/><span class="hl-2">      ],</span><br/><span class="hl-2">    });</span><br/><br/><span class="hl-2">    </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">summary</span><span class="hl-2"> = </span><span class="hl-6">summaryResponse</span><span class="hl-2">.</span><span class="hl-6">message</span><span class="hl-2">.</span><span class="hl-6">content</span><span class="hl-2">;</span><br/><br/><span class="hl-2">    </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">`You are a cryptocurrency trading expert.</span><br/><br/><span class="hl-4">MARKET ANALYSIS:</span><br/><span class="hl-3">${</span><span class="hl-6">summary</span><span class="hl-3">}</span><br/><br/><span class="hl-4">TASK: Create a trading strategy for </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">.</span><br/><br/><span class="hl-4">REQUIREMENTS:</span><br/><span class="hl-4">1. Use a combination of technical indicators and volume analysis</span><br/><span class="hl-4">2. Define clear entry conditions (LONG/SHORT)</span><br/><span class="hl-4">3. Set take-profit at minimum +2% from entry</span><br/><span class="hl-4">4. Set stop-loss at maximum -1.5% from entry</span><br/><span class="hl-4">5. Risk/reward ratio must be at least 1:2</span><br/><br/><span class="hl-4">RESPONSE FORMAT (JSON):</span><br/><span class="hl-4">{</span><br/><span class="hl-4">  &quot;position&quot;: &quot;long&quot; | &quot;short&quot; | &quot;wait&quot;,</span><br/><span class="hl-4">  &quot;priceOpen&quot;: number | undefined,</span><br/><span class="hl-4">  &quot;priceTakeProfit&quot;: number,</span><br/><span class="hl-4">  &quot;priceStopLoss&quot;: number,</span><br/><span class="hl-4">  &quot;minuteEstimatedTime&quot;: number</span><br/><span class="hl-4">}`</span><span class="hl-2">;</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// Monitor progress</span><br/><span class="hl-1">listenOptimizerProgress</span><span class="hl-2">((</span><span class="hl-6">event</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">percent</span><span class="hl-2"> = (</span><span class="hl-6">event</span><span class="hl-2">.</span><span class="hl-6">progress</span><span class="hl-2"> * </span><span class="hl-7">100</span><span class="hl-2">).</span><span class="hl-1">toFixed</span><span class="hl-2">(</span><span class="hl-7">1</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`[</span><span class="hl-3">${</span><span class="hl-6">percent</span><span class="hl-3">}</span><span class="hl-4">%] </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">comment</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-0">// Launch generation</span><br/><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">&quot;Starting AI strategy optimization...</span><span class="hl-14">\n</span><span class="hl-4">&quot;</span><span class="hl-2">);</span><br/><br/><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">Optimizer</span><span class="hl-2">.</span><span class="hl-1">dump</span><span class="hl-2">(</span><span class="hl-4">&quot;BTCUSDT&quot;</span><span class="hl-2">, {</span><br/><span class="hl-2">  </span><span class="hl-6">optimizerName:</span><span class="hl-2"> </span><span class="hl-4">&quot;advanced-crypto-optimizer&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">&quot;</span><span class="hl-14">\n</span><span class="hl-4">âœ“ Generation completed!&quot;</span><span class="hl-2">);</span><br/><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">&quot;Generated file: ./dump/optimizer/advanced-crypto-optimizer_BTCUSDT.mjs&quot;</span><span class="hl-2">);</span><br/><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">&quot;</span><span class="hl-14">\n</span><span class="hl-4">Run the generated strategy:&quot;</span><span class="hl-2">);</span><br/><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">&quot;node ./dump/optimizer/advanced-crypto-optimizer_BTCUSDT.mjs&quot;</span><span class="hl-2">);</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="running-the-generated-strategy" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Running the Generated Strategy<a href="#running-the-generated-strategy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="bash"><span class="hl-0"># After generation, run the file</span><br/><span class="hl-1">node</span><span class="hl-2"> </span><span class="hl-4">./dump/optimizer/advanced-crypto-optimizer_BTCUSDT.mjs</span><br/><br/><span class="hl-0"># Output:</span><br/><span class="hl-0"># Starting Walker for strategy comparison...</span><br/><span class="hl-0"># [10.0%] Executing strategy advanced-crypto-optimizer-strategy-1</span><br/><span class="hl-0"># [20.0%] Executing strategy advanced-crypto-optimizer-strategy-2</span><br/><span class="hl-0"># [30.0%] Executing strategy advanced-crypto-optimizer-strategy-3</span><br/><span class="hl-0"># ...</span><br/><span class="hl-0"># [100%] Comparison completed</span><br/><span class="hl-0"># Report saved: ./dump/walker/advanced-crypto-optimizer_walker.md</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="recommendations" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Recommendations<a href="#recommendations" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="1-model-selection" class="tsd-anchor"></a><h3 class="tsd-anchor-link">1. Model Selection<a href="#1-model-selection" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">// For quick prototyping</span><br/><span class="hl-8">OLLAMA_MODEL</span><span class="hl-2">=</span><span class="hl-6">llama3</span><br/><br/><span class="hl-0">// For advanced analysis (recommended)</span><br/><span class="hl-8">OLLAMA_MODEL</span><span class="hl-2">=</span><span class="hl-6">deepseek</span><span class="hl-2">-</span><span class="hl-6">v3</span><span class="hl-2">.</span><span class="hl-7">1</span><br/><br/><span class="hl-0">// For balanced speed and quality</span><br/><span class="hl-8">OLLAMA_MODEL</span><span class="hl-2">=</span><span class="hl-6">mistral</span>
</code><button type="button">Copy</button></pre>

<a id="2-training-data-size" class="tsd-anchor"></a><h3 class="tsd-anchor-link">2. Training Data Size<a href="#2-training-data-size" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">// Minimum 2 training ranges</span><br/><span class="hl-10">rangeTrain</span><span class="hl-2">: [</span><br/><span class="hl-2">  { </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-01-01&quot;</span><span class="hl-2">), </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-01-15&quot;</span><span class="hl-2">) },</span><br/><span class="hl-2">  { </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-02-01&quot;</span><span class="hl-2">), </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-02-15&quot;</span><span class="hl-2">) },</span><br/><span class="hl-2">]</span><br/><br/><span class="hl-0">// Optimal 3-5 ranges</span><br/><span class="hl-10">rangeTrain</span><span class="hl-2">: [</span><br/><span class="hl-2">  </span><span class="hl-0">// January</span><br/><span class="hl-2">  </span><span class="hl-0">// February</span><br/><span class="hl-2">  </span><span class="hl-0">// March</span><br/><span class="hl-2">  </span><span class="hl-0">// April</span><br/><span class="hl-2">  </span><span class="hl-0">// May</span><br/><span class="hl-2">]</span>
</code><button type="button">Copy</button></pre>

<a id="3-prompt-quality" class="tsd-anchor"></a><h3 class="tsd-anchor-link">3. Prompt Quality<a href="#3-prompt-quality" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">// Bad prompt</span><br/><span class="hl-10">getPrompt</span><span class="hl-2">: </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">messages</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">&quot;Create a strategy&quot;</span><span class="hl-2">;</span><br/><span class="hl-2">}</span><br/><br/><span class="hl-0">// Good prompt</span><br/><span class="hl-10">getPrompt</span><span class="hl-2">: </span><span class="hl-3">async</span><span class="hl-2"> (</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-6">messages</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-5">return</span><span class="hl-2"> </span><span class="hl-4">`You are a trading expert for </span><span class="hl-3">${</span><span class="hl-6">symbol</span><span class="hl-3">}</span><span class="hl-4">.</span><br/><br/><span class="hl-4">Based on the following analysis: </span><span class="hl-3">${</span><span class="hl-6">summary</span><span class="hl-3">}</span><br/><br/><span class="hl-4">Create a strategy with the following characteristics:</span><br/><span class="hl-4">- Clear entry conditions</span><br/><span class="hl-4">- TP minimum +2%</span><br/><span class="hl-4">- SL maximum -1.5%</span><br/><span class="hl-4">- R/R ratio minimum 1:2</span><br/><br/><span class="hl-4">Response format: JSON...`</span><span class="hl-2">;</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="conclusion" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Conclusion<a href="#conclusion" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The Optimizer system in backtest-kit provides a powerful tool for generating trading strategies using AI. By combining multiple data sources, multi-timeframe analysis, and advanced LLM models, you can create, test, and compare strategies automatically.</p>
<a id="next-steps" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Next Steps<a href="#next-steps" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>After obtaining an optimal trading strategy:</p>
<ol>
<li><strong><a href="example_07_llm_trading.html">LLM Trading with Structured JSON Output</a></strong> - using LLMs as interpreters for natural language trading strategies</li>
</ol>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#ai-strategy-optimization"><span>AI <wbr/>Strategy <wbr/>Optimization</span></a><ul><li><a href="#what-is-optimizer"><span>What is <wbr/>Optimizer?</span></a></li><li><ul><li><a href="#key-features"><span>Key <wbr/>Features</span></a></li></ul></li><li><a href="#installing-ollama"><span>Installing <wbr/>Ollama</span></a></li><li><ul><li><a href="#step-1-install-ollama"><span>Step 1: <wbr/>Install <wbr/>Ollama</span></a></li><li><a href="#step-2-install-model"><span>Step 2: <wbr/>Install <wbr/>Model</span></a></li><li><a href="#step-3-verify-installation"><span>Step 3: <wbr/>Verify <wbr/>Installation</span></a></li><li><a href="#step-4-configure-environment-variables"><span>Step 4: <wbr/>Configure <wbr/>Environment <wbr/>Variables</span></a></li></ul></li><li><a href="#optimizer-system-architecture"><span>Optimizer <wbr/>System <wbr/>Architecture</span></a></li><li><a href="#creating-an-optimizer"><span>Creating an <wbr/>Optimizer</span></a></li><li><ul><li><a href="#basic-configuration"><span>Basic <wbr/>Configuration</span></a></li></ul></li><li><a href="#data-sources"><span>Data <wbr/>Sources</span></a></li><li><ul><li><a href="#example-1-news-source"><span>Example 1: <wbr/>News <wbr/>Source</span></a></li><li><a href="#example-2-technical-indicators-source"><span>Example 2: <wbr/>Technical <wbr/>Indicators <wbr/>Source</span></a></li></ul></li><li><a href="#prompt-generator"><span>Prompt <wbr/>Generator</span></a></li><li><a href="#running-optimization"><span>Running <wbr/>Optimization</span></a></li><li><ul><li><a href="#method-1-getting-data"><span>Method 1: <wbr/>Getting <wbr/>Data</span></a></li><li><a href="#method-2-generating-code"><span>Method 2: <wbr/>Generating <wbr/>Code</span></a></li><li><a href="#method-3-dumping-to-file"><span>Method 3: <wbr/>Dumping to <wbr/>File</span></a></li></ul></li><li><a href="#generated-code-structure"><span>Generated <wbr/>Code <wbr/>Structure</span></a></li><li><a href="#multi-timeframe-analysis"><span>Multi-<wbr/>timeframe <wbr/>Analysis</span></a></li><li><a href="#progress-monitoring"><span>Progress <wbr/>Monitoring</span></a></li><li><a href="#complete-example-advanced-optimizer"><span>Complete <wbr/>Example: <wbr/>Advanced <wbr/>Optimizer</span></a></li><li><a href="#running-the-generated-strategy"><span>Running the <wbr/>Generated <wbr/>Strategy</span></a></li><li><a href="#recommendations"><span>Recommendations</span></a></li><li><ul><li><a href="#1-model-selection"><span>1. <wbr/>Model <wbr/>Selection</span></a></li><li><a href="#2-training-data-size"><span>2. <wbr/>Training <wbr/>Data <wbr/>Size</span></a></li><li><a href="#3-prompt-quality"><span>3. <wbr/>Prompt <wbr/>Quality</span></a></li></ul></li><li><a href="#conclusion"><span>Conclusion</span></a></li><li><a href="#next-steps"><span>Next <wbr/>Steps</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
