<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>demo/backtest/readme | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="demo_backtest_readme.html">demo/backtest/readme</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="ai-powered-backtest-demo" class="tsd-anchor"></a><h1 class="tsd-anchor-link">AI-Powered Backtest Demo<a href="#ai-powered-backtest-demo" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><blockquote>
<p>Link to <a href="https://github.com/tripolskypetr/backtest-kit/tree/master/demo/backtest">the source code</a></p>
</blockquote>
<p>LLM-driven trading strategy with multi-timeframe analysis and automated backtesting using backtest-kit framework.</p>
<a id="purpose" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Purpose<a href="#purpose" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Demonstrates AI-powered trading strategy capabilities for:</p>
<ul>
<li>Real-time multi-timeframe candle analysis (1h, 15m, 5m, 1m)</li>
<li>LLM-based signal generation with structured output</li>
<li>Automated backtesting with performance metrics</li>
<li>Debug logging for LLM conversations and signals</li>
</ul>
<a id="key-features" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Key Features<a href="#key-features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>
<p><strong>Multi-Timeframe Analysis</strong>: 4-level market structure analysis</p>
<ul>
<li>Medium-term (1h candles): 24h trend analysis</li>
<li>Short-term (15m candles): 24 candles for swing structure</li>
<li>Main-term (5m candles): 24 candles for entry timing</li>
<li>Micro-term (1m candles): 30 candles for precise entries</li>
</ul>
</li>
<li>
<p><strong>LLM Integration</strong>: Ollama-powered signal generation (deepseek-v3.1:671b)</p>
</li>
<li>
<p><strong>Structured Output</strong>: JSON schema validation for trading signals</p>
</li>
<li>
<p><strong>Debug Logging</strong>: Automatic conversation and signal dumping via <code>dumpSignal()</code></p>
</li>
<li>
<p><strong>Progress Tracking</strong>: Real-time backtest progress monitoring</p>
</li>
<li>
<p><strong>Performance Reports</strong>: Automated markdown report generation</p>
</li>
</ul>
<a id="technology-stack" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Technology Stack<a href="#technology-stack" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Runtime</strong>: Node.js (ES Modules)</li>
<li><strong>Framework</strong>: backtest-kit 1.4.3</li>
<li><strong>AI Provider</strong>: Ollama (deepseek-v3.1:671b model)</li>
<li><strong>Exchange</strong>: Binance via CCXT</li>
<li><strong>UUID</strong>: uuid for unique result tracking</li>
</ul>
<a id="project-structure" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Project Structure<a href="#project-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code><span class="hl-6">demo</span><span class="hl-2">/</span><span class="hl-6">backtest</span><span class="hl-2">/</span><br/><span class="hl-2">‚îú‚îÄ‚îÄ </span><span class="hl-6">src</span><span class="hl-2">/</span><br/><span class="hl-2">‚îÇ   ‚îú‚îÄ‚îÄ </span><span class="hl-6">index</span><span class="hl-2">.</span><span class="hl-6">mjs</span><span class="hl-2">              # </span><span class="hl-6">Main</span><span class="hl-2"> </span><span class="hl-6">backtest</span><span class="hl-2"> </span><span class="hl-6">configuration</span><br/><span class="hl-2">‚îÇ   ‚îî‚îÄ‚îÄ </span><span class="hl-6">utils</span><span class="hl-2">/</span><br/><span class="hl-2">‚îÇ       ‚îú‚îÄ‚îÄ </span><span class="hl-6">json</span><span class="hl-2">.</span><span class="hl-6">mjs</span><span class="hl-2">           # </span><span class="hl-8">LLM</span><span class="hl-2"> </span><span class="hl-8">API</span><span class="hl-2"> </span><span class="hl-1">client</span><span class="hl-2"> (</span><span class="hl-6">Ollama</span><span class="hl-2">)</span><br/><span class="hl-2">‚îÇ       ‚îî‚îÄ‚îÄ </span><span class="hl-6">messages</span><span class="hl-2">.</span><span class="hl-6">mjs</span><span class="hl-2">       # </span><span class="hl-6">Multi</span><span class="hl-2">-</span><span class="hl-6">timeframe</span><span class="hl-2"> </span><span class="hl-6">message</span><span class="hl-2"> </span><span class="hl-6">builder</span><br/><span class="hl-2">‚îú‚îÄ‚îÄ </span><span class="hl-6">package</span><span class="hl-2">.</span><span class="hl-6">json</span><span class="hl-2">               # </span><span class="hl-6">Dependencies</span><span class="hl-2"> </span><span class="hl-6">and</span><span class="hl-2"> </span><span class="hl-6">scripts</span><br/><span class="hl-2">‚îî‚îÄ‚îÄ </span><span class="hl-8">README</span><span class="hl-2">.</span><span class="hl-6">md</span><span class="hl-2">                  # </span><span class="hl-6">This</span><span class="hl-2"> </span><span class="hl-6">file</span>
</code><button>Copy</button></pre>

<a id="installation-and-setup" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Installation and Setup<a href="#installation-and-setup" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="bash"><span class="hl-0"># Navigate to project directory</span><br/><span class="hl-1">cd</span><span class="hl-2"> </span><span class="hl-4">demo/backtest</span><br/><br/><span class="hl-0"># Install dependencies</span><br/><span class="hl-1">npm</span><span class="hl-2"> </span><span class="hl-4">install</span><br/><br/><span class="hl-0"># Set environment variables</span><br/><span class="hl-3">export</span><span class="hl-2"> </span><span class="hl-6">OLLAMA_API_KEY</span><span class="hl-2">=</span><span class="hl-6">your_ollama_api_key</span><br/><br/><span class="hl-0"># Run backtest</span><br/><span class="hl-1">npm</span><span class="hl-2"> </span><span class="hl-4">start</span>
</code><button type="button">Copy</button></pre>

<a id="configuration" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Configuration<a href="#configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="environment-variables" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Environment Variables<a href="#environment-variables" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Create a <code>.env</code> file or set environment variables:</p>
<pre><code class="env">OLLAMA_API_KEY=your_ollama_api_key
</code><button type="button">Copy</button></pre>

<a id="backtest-configuration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Backtest Configuration<a href="#backtest-configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The demo is pre-configured for BTCUSDT with:</p>
<ul>
<li><strong>Backtest Period</strong>: December 1, 2025 (full day)</li>
<li><strong>Symbol</strong>: BTCUSDT</li>
<li><strong>Strategy Interval</strong>: 5m (signal generation frequency)</li>
<li><strong>Frame Interval</strong>: 1m (tick resolution)</li>
<li><strong>Exchange</strong>: Binance (via CCXT)</li>
</ul>
<a id="signal-generation-rules" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Signal Generation Rules<a href="#signal-generation-rules" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>LLM follows strict rules for signal generation:</p>
<ol>
<li>
<p><strong>Position Types</strong>:</p>
<ul>
<li><code>position='wait'</code>: No clear signal, wait for better conditions</li>
<li><code>position='long'</code>: Bullish signal, price expected to rise</li>
<li><code>position='short'</code>: Bearish signal, price expected to fall</li>
</ul>
</li>
<li>
<p><strong>Entry Price</strong> (<code>priceOpen</code>):</p>
<ul>
<li>Can be current market price for immediate entry</li>
<li>Can be limit order price for delayed entry</li>
<li>Must have technical justification</li>
</ul>
</li>
<li>
<p><strong>Exit Levels</strong>:</p>
<ul>
<li>LONG: <code>priceTakeProfit &gt; priceOpen &gt; priceStopLoss</code></li>
<li>SHORT: <code>priceStopLoss &gt; priceOpen &gt; priceTakeProfit</code></li>
<li>Levels based on S/R, Fibonacci, Bollinger Bands</li>
</ul>
</li>
<li>
<p><strong>Time Estimate</strong> (<code>minuteEstimatedTime</code>):</p>
<ul>
<li>Expected time to reach TP (max 360 minutes)</li>
<li>Calculated from ATR, ADX, MACD, Momentum</li>
</ul>
</li>
</ol>
<a id="usage-examples" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage Examples<a href="#usage-examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="basic-usage" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Basic Usage<a href="#basic-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Run the backtest:</p>
<pre><code class="bash"><span class="hl-1">npm</span><span class="hl-2"> </span><span class="hl-4">start</span>
</code><button type="button">Copy</button></pre>

<p>Output:</p>
<pre><code><span class="hl-10">Progress</span><span class="hl-2">: </span><span class="hl-7">25.00</span><span class="hl-2">%</span><br/><span class="hl-10">Processed</span><span class="hl-2">: </span><span class="hl-7">360</span><span class="hl-2"> / </span><span class="hl-7">1440</span><br/><span class="hl-10">Progress</span><span class="hl-2">: </span><span class="hl-7">50.00</span><span class="hl-2">%</span><br/><span class="hl-10">Processed</span><span class="hl-2">: </span><span class="hl-7">720</span><span class="hl-2"> / </span><span class="hl-7">1440</span><br/><span class="hl-10">Progress</span><span class="hl-2">: </span><span class="hl-7">75.00</span><span class="hl-2">%</span><br/><span class="hl-10">Processed</span><span class="hl-2">: </span><span class="hl-7">1080</span><span class="hl-2"> / </span><span class="hl-7">1440</span><br/><span class="hl-10">Progress</span><span class="hl-2">: </span><span class="hl-7">100.00</span><span class="hl-2">%</span><br/><span class="hl-10">Processed</span><span class="hl-2">: </span><span class="hl-7">1440</span><span class="hl-2"> / </span><span class="hl-7">1440</span><br/><span class="hl-6">Backtest</span><span class="hl-2"> </span><span class="hl-10">completed</span><span class="hl-2">: </span><span class="hl-8">BTCUSDT</span>
</code><button>Copy</button></pre>

<p>Generated files:</p>
<ul>
<li><code>./dump/backtest/test_strategy.md</code> - Performance report</li>
<li><code>./dump/strategy/{uuid}/</code> - LLM conversation logs (one per signal)</li>
</ul>
<a id="analyzing-results" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Analyzing Results<a href="#analyzing-results" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>After backtest completes, check performance report:</p>
<pre><code class="bash"><span class="hl-1">cat</span><span class="hl-2"> </span><span class="hl-4">./dump/backtest/test_strategy.md</span>
</code><button type="button">Copy</button></pre>

<p>Example output:</p>
<pre><code class="markdown"># Backtest Report: test_strategy

| Signal ID | Symbol   | Position | Open Price | Close Price | PNL (net) | Close Reason |
|-----------|----------|----------|------------|-------------|-----------|--------------|
| signal-1  | BTCUSDT  | LONG     | 50000 USD  | 51000 USD   | +2.00%    | take_profit  |
| signal-2  | BTCUSDT  | SHORT    | 51500 USD  | 50500 USD   | +1.94%    | take_profit  |

**Total signals:** 15
**Win rate:** 73.33% (11W / 4L)
**Average PNL:** +0.85%
**Sharpe Ratio:** 1.234
</code><button type="button">Copy</button></pre>

<a id="debugging-llm-conversations" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Debugging LLM Conversations<a href="#debugging-llm-conversations" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Each signal generates debug logs in <code>./dump/strategy/{uuid}/</code>:</p>
<pre><code><span class="hl-2">./</span><span class="hl-6">dump</span><span class="hl-2">/</span><span class="hl-6">strategy</span><span class="hl-2">/</span><span class="hl-6">a1b2c3d4</span><span class="hl-2">-</span><span class="hl-6">e5f6</span><span class="hl-2">-</span><span class="hl-7">7890</span><span class="hl-2">-</span><span class="hl-6">abcd</span><span class="hl-2">-</span><span class="hl-6">ef1234567890</span><span class="hl-2">/</span><br/><span class="hl-2">‚îú‚îÄ‚îÄ 00</span><span class="hl-6">_system_prompt</span><span class="hl-2">.</span><span class="hl-6">md</span><span class="hl-2">       # </span><span class="hl-6">System</span><span class="hl-2"> </span><span class="hl-6">instructions</span><br/><span class="hl-2">‚îú‚îÄ‚îÄ 01</span><span class="hl-6">_user_message</span><span class="hl-2">.</span><span class="hl-6">md</span><span class="hl-2">         # 1</span><span class="hl-6">h</span><span class="hl-2"> </span><span class="hl-6">candles</span><span class="hl-2"> </span><span class="hl-6">analysis</span><br/><span class="hl-2">‚îú‚îÄ‚îÄ 02</span><span class="hl-6">_assistant_message</span><span class="hl-2">.</span><span class="hl-6">md</span><span class="hl-2">    # </span><span class="hl-8">LLM</span><span class="hl-2"> </span><span class="hl-6">acknowledgment</span><br/><span class="hl-2">‚îú‚îÄ‚îÄ 03</span><span class="hl-6">_user_message</span><span class="hl-2">.</span><span class="hl-6">md</span><span class="hl-2">         # 15</span><span class="hl-6">m</span><span class="hl-2"> </span><span class="hl-6">candles</span><span class="hl-2"> </span><span class="hl-6">analysis</span><br/><span class="hl-2">‚îú‚îÄ‚îÄ 04</span><span class="hl-6">_assistant_message</span><span class="hl-2">.</span><span class="hl-6">md</span><span class="hl-2">    # </span><span class="hl-8">LLM</span><span class="hl-2"> </span><span class="hl-6">acknowledgment</span><br/><span class="hl-2">‚îú‚îÄ‚îÄ 05</span><span class="hl-6">_user_message</span><span class="hl-2">.</span><span class="hl-6">md</span><span class="hl-2">         # 5</span><span class="hl-6">m</span><span class="hl-2"> </span><span class="hl-6">candles</span><span class="hl-2"> </span><span class="hl-6">analysis</span><br/><span class="hl-2">‚îú‚îÄ‚îÄ 06</span><span class="hl-6">_assistant_message</span><span class="hl-2">.</span><span class="hl-6">md</span><span class="hl-2">    # </span><span class="hl-8">LLM</span><span class="hl-2"> </span><span class="hl-6">acknowledgment</span><br/><span class="hl-2">‚îú‚îÄ‚îÄ 07</span><span class="hl-6">_user_message</span><span class="hl-2">.</span><span class="hl-6">md</span><span class="hl-2">         # 1</span><span class="hl-6">m</span><span class="hl-2"> </span><span class="hl-6">candles</span><span class="hl-2"> </span><span class="hl-6">analysis</span><br/><span class="hl-2">‚îú‚îÄ‚îÄ 08</span><span class="hl-6">_assistant_message</span><span class="hl-2">.</span><span class="hl-6">md</span><span class="hl-2">    # </span><span class="hl-8">LLM</span><span class="hl-2"> </span><span class="hl-6">acknowledgment</span><br/><span class="hl-2">‚îú‚îÄ‚îÄ 09</span><span class="hl-6">_user_message</span><span class="hl-2">.</span><span class="hl-6">md</span><span class="hl-2">         # </span><span class="hl-6">Signal</span><span class="hl-2"> </span><span class="hl-6">generation</span><span class="hl-2"> </span><span class="hl-6">request</span><br/><span class="hl-2">‚îî‚îÄ‚îÄ 10</span><span class="hl-6">_llm_output</span><span class="hl-2">.</span><span class="hl-6">md</span><span class="hl-2">           # </span><span class="hl-6">Final</span><span class="hl-2"> </span><span class="hl-6">signal</span><span class="hl-2"> </span><span class="hl-5">with</span><span class="hl-2"> </span><span class="hl-8">JSON</span>
</code><button>Copy</button></pre>

<a id="customizing-symbols" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Customizing Symbols<a href="#customizing-symbols" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Modify <code>src/index.mjs</code> to analyze different cryptocurrencies:</p>
<pre><code class="javascript"><span class="hl-6">Backtest</span><span class="hl-2">.</span><span class="hl-1">background</span><span class="hl-2">(</span><span class="hl-4">&quot;ETHUSDT&quot;</span><span class="hl-2">, {  </span><span class="hl-0">// Change symbol</span><br/><span class="hl-2">  </span><span class="hl-6">strategyName:</span><span class="hl-2"> </span><span class="hl-4">&quot;test_strategy&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">exchangeName:</span><span class="hl-2"> </span><span class="hl-4">&quot;test_exchange&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">frameName:</span><span class="hl-2"> </span><span class="hl-4">&quot;test_frame&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="adjusting-time-periods" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Adjusting Time Periods<a href="#adjusting-time-periods" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Edit backtest period in <code>src/index.mjs</code>:</p>
<pre><code class="javascript"><span class="hl-1">addFrame</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">frameName:</span><span class="hl-2"> </span><span class="hl-4">&quot;test_frame&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">interval:</span><span class="hl-2"> </span><span class="hl-4">&quot;1m&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-6">startDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-12-15T00:00:00.000Z&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">  </span><span class="hl-6">endDate:</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-1">Date</span><span class="hl-2">(</span><span class="hl-4">&quot;2025-12-15T23:59:59.000Z&quot;</span><span class="hl-2">),</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="how-it-works" class="tsd-anchor"></a><h2 class="tsd-anchor-link">How It Works<a href="#how-it-works" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="phase-1-multi-timeframe-data-collection" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Phase 1: Multi-Timeframe Data Collection<a href="#phase-1-multi-timeframe-data-collection" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>For each signal generation (every 5 minutes):</p>
<ol>
<li>Fetches 1h candles (24 candles, ~24h lookback)</li>
<li>Fetches 15m candles (24 candles, ~6h lookback)</li>
<li>Fetches 5m candles (24 candles, ~2h lookback)</li>
<li>Fetches 1m candles (30 candles, ~30min lookback)</li>
<li>Formats data into human-readable OHLCV strings</li>
</ol>
<a id="phase-2-llm-conversation-building" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Phase 2: LLM Conversation Building<a href="#phase-2-llm-conversation-building" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Creates structured conversation:</p>
<ol>
<li><strong>User</strong>: Provides 1h candles with symbol name</li>
<li><strong>Assistant</strong>: Acknowledges trend analysis</li>
<li><strong>User</strong>: Provides 15m candles</li>
<li><strong>Assistant</strong>: Acknowledges swing structure analysis</li>
<li><strong>User</strong>: Provides 5m candles</li>
<li><strong>Assistant</strong>: Acknowledges main timeframe analysis</li>
<li><strong>User</strong>: Provides 1m candles</li>
<li><strong>Assistant</strong>: Acknowledges microstructure analysis</li>
<li><strong>User</strong>: Requests final trading signal</li>
<li><strong>LLM</strong>: Returns structured JSON signal</li>
</ol>
<a id="phase-3-signal-generation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Phase 3: Signal Generation<a href="#phase-3-signal-generation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>LLM analyzes all timeframes and returns:</p>
<pre><code class="json"><span class="hl-2">{</span><br/><span class="hl-2">  </span><span class="hl-13">&quot;position&quot;</span><span class="hl-2">: </span><span class="hl-4">&quot;long&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-13">&quot;note&quot;</span><span class="hl-2">: </span><span class="hl-4">&quot;Strong bullish momentum on 1h, breakout on 5m...&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-13">&quot;priceOpen&quot;</span><span class="hl-2">: </span><span class="hl-7">50000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-13">&quot;priceTakeProfit&quot;</span><span class="hl-2">: </span><span class="hl-7">51000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-13">&quot;priceStopLoss&quot;</span><span class="hl-2">: </span><span class="hl-7">49000</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-13">&quot;minuteEstimatedTime&quot;</span><span class="hl-2">: </span><span class="hl-7">120</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<a id="phase-4-debug-logging" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Phase 4: Debug Logging<a href="#phase-4-debug-logging" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><code>dumpSignal()</code> saves:</p>
<ul>
<li>Complete conversation history (messages array)</li>
<li>Final LLM output (signal JSON)</li>
<li>Unique UUID for tracking each signal</li>
<li>Files in <code>./dump/strategy/{uuid}/</code> directory</li>
</ul>
<a id="phase-5-backtesting-execution" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Phase 5: Backtesting Execution<a href="#phase-5-backtesting-execution" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Framework validates and executes signal:</p>
<ol>
<li>Validates signal structure (TP/SL logic, prices, timestamps)</li>
<li>Simulates order execution at <code>priceOpen</code></li>
<li>Tracks price movement until TP/SL hit or timeout</li>
<li>Records PNL and close reason</li>
<li>Emits events for progress tracking</li>
</ol>
<a id="phase-6-report-generation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Phase 6: Report Generation<a href="#phase-6-report-generation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>After backtest completes:</p>
<ol>
<li>Aggregates all closed signals</li>
<li>Calculates performance metrics</li>
<li>Generates markdown report</li>
<li>Saves to <code>./dump/backtest/{strategyName}.md</code></li>
</ol>
<a id="llm-prompt-engineering" class="tsd-anchor"></a><h2 class="tsd-anchor-link">LLM Prompt Engineering<a href="#llm-prompt-engineering" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="system-prompt-strategy" class="tsd-anchor"></a><h3 class="tsd-anchor-link">System Prompt Strategy<a href="#system-prompt-strategy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-2">{</span><br/><span class="hl-2">  </span><span class="hl-10">role</span><span class="hl-2">: </span><span class="hl-4">&quot;system&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">content</span><span class="hl-2">: </span><span class="hl-4">`</span><br/><span class="hl-4">    –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç–æ—Ä–≥–æ–≤—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –∏ –≤–µ—Ä–Ω–∏ —Ç–æ—Ä–≥–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª.</span><br/><br/><span class="hl-4">    –ü–†–ê–í–ò–õ–ê –û–¢–ö–†–´–¢–ò–Ø –ü–û–ó–ò–¶–ò–ô:</span><br/><span class="hl-4">    1. –¢–ò–ü–´ –ü–û–ó–ò–¶–ò–ô:</span><br/><span class="hl-4">       - position=&#39;wait&#39;: –Ω–µ—Ç —á–µ—Ç–∫–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞</span><br/><span class="hl-4">       - position=&#39;long&#39;: –±—ã—á–∏–π —Å–∏–≥–Ω–∞–ª</span><br/><span class="hl-4">       - position=&#39;short&#39;: –º–µ–¥–≤–µ–∂–∏–π —Å–∏–≥–Ω–∞–ª</span><br/><br/><span class="hl-4">    2. –¶–ï–ù–ê –í–•–û–î–ê (priceOpen):</span><br/><span class="hl-4">       - –¢–µ–∫—É—â–∞—è —Ä—ã–Ω–æ—á–Ω–∞—è –∏–ª–∏ –æ—Ç–ª–æ–∂–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞</span><br/><span class="hl-4">       - –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –ø–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É –∞–Ω–∞–ª–∏–∑—É</span><br/><br/><span class="hl-4">    3. –£–†–û–í–ù–ò –í–´–•–û–î–ê:</span><br/><span class="hl-4">       - LONG: priceTakeProfit &gt; priceOpen &gt; priceStopLoss</span><br/><span class="hl-4">       - SHORT: priceStopLoss &gt; priceOpen &gt; priceTakeProfit</span><br/><span class="hl-4">       - –ù–∞ –æ—Å–Ω–æ–≤–µ Fibonacci, S/R, Bollinger</span><br/><br/><span class="hl-4">    4. –í–†–ï–ú–ï–ù–ù–´–ï –†–ê–ú–ö–ò:</span><br/><span class="hl-4">       - minuteEstimatedTime: –º–∞–∫—Å 360 –º–∏–Ω—É—Ç</span><br/><span class="hl-4">       - –†–∞—Å—á–µ—Ç –ø–æ ATR, ADX, MACD, Momentum</span><br/><span class="hl-4">  `</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<p>This encourages:</p>
<ul>
<li>Conservative signal generation (wait when uncertain)</li>
<li>Technically justified entry/exit levels</li>
<li>Realistic time estimates</li>
<li>Risk-aware position sizing</li>
</ul>
<a id="user-prompt-strategy" class="tsd-anchor"></a><h3 class="tsd-anchor-link">User Prompt Strategy<a href="#user-prompt-strategy" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Final request emphasizes caution:</p>
<pre><code><span class="hl-6">–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π</span><span class="hl-2"> </span><span class="hl-6">–≤—Å–µ</span><span class="hl-2"> </span><span class="hl-6">—Ç–∞–π–º—Ñ—Ä–µ–π–º—ã</span><span class="hl-2"> </span><span class="hl-6">–∏</span><span class="hl-2"> </span><span class="hl-6">—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π</span><span class="hl-2"> </span><span class="hl-6">—Ç–æ—Ä–≥–æ–≤—ã–π</span><span class="hl-2"> </span><span class="hl-6">—Å–∏–≥–Ω–∞–ª</span><span class="hl-2">.</span><br/><span class="hl-6">–û—Ç–∫—Ä—ã–≤–∞–π</span><span class="hl-2"> </span><span class="hl-6">–ø–æ–∑–∏—Ü–∏—é</span><span class="hl-2"> </span><span class="hl-8">–¢–û–õ–¨–ö–û</span><span class="hl-2"> </span><span class="hl-6">–ø—Ä–∏</span><span class="hl-2"> </span><span class="hl-6">—á–µ—Ç–∫–æ–º</span><span class="hl-2"> </span><span class="hl-6">—Å–∏–≥–Ω–∞–ª–µ</span><span class="hl-2">.</span><br/><br/><span class="hl-6">–ï—Å–ª–∏</span><span class="hl-2"> </span><span class="hl-6">—Å–∏–≥–Ω–∞–ª—ã</span><span class="hl-2"> </span><span class="hl-6">–ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤—ã</span><span class="hl-2"> </span><span class="hl-6">–∏–ª–∏</span><span class="hl-2"> </span><span class="hl-6">—Ç—Ä–µ–Ω–¥</span><span class="hl-2"> </span><span class="hl-6">—Å–ª–∞–±—ã–π</span><span class="hl-2"> </span><span class="hl-6">—Ç–æ</span><span class="hl-2"> </span><span class="hl-10">position</span><span class="hl-2">: </span><span class="hl-6">wait</span>
</code><button>Copy</button></pre>

<p>This prevents:</p>
<ul>
<li>Overtrading in unclear market conditions</li>
<li>Entry without multi-timeframe confirmation</li>
<li>Ignoring conflicting signals</li>
</ul>
<a id="performance-metrics" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Performance Metrics<a href="#performance-metrics" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Backtest evaluates strategy by:</p>
<ul>
<li><strong>Total Signals</strong>: Number of closed positions</li>
<li><strong>Win Rate</strong>: Percentage of profitable trades (higher is better)</li>
<li><strong>Average PNL</strong>: Mean profit/loss per trade (higher is better)</li>
<li><strong>Total PNL</strong>: Cumulative profit/loss (higher is better)</li>
<li><strong>Sharpe Ratio</strong>: Risk-adjusted returns (higher is better)</li>
<li><strong>Annualized Sharpe Ratio</strong>: Sharpe √ó ‚àö365 (higher is better)</li>
<li><strong>Certainty Ratio</strong>: avgWin / |avgLoss| (higher is better)</li>
<li><strong>Expected Yearly Returns</strong>: Annualized profit estimate (higher is better)</li>
<li><strong>Standard Deviation</strong>: Volatility metric (lower is better)</li>
</ul>
<a id="economic-benefits" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Economic Benefits<a href="#economic-benefits" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Automated Decision Making</strong>: LLM analyzes 4 timeframes simultaneously</li>
<li><strong>Reproducible Signals</strong>: Same input ‚Üí same output (deterministic)</li>
<li><strong>Audit Trail</strong>: Complete conversation logs for every signal</li>
<li><strong>Performance Validation</strong>: Historical backtesting before live trading</li>
<li><strong>Risk Management</strong>: Strict TP/SL validation and position sizing</li>
<li><strong>Time Efficiency</strong>: Seconds vs. hours of manual chart analysis</li>
</ul>
<a id="advanced-customization" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Advanced Customization<a href="#advanced-customization" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="adding-new-timeframes" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Adding New Timeframes<a href="#adding-new-timeframes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-0">// In utils/messages.mjs</span><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">longTermCandles</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-1">getCandles</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">, </span><span class="hl-4">&quot;4h&quot;</span><span class="hl-2">, </span><span class="hl-7">24</span><span class="hl-2">);</span><br/><br/><span class="hl-6">messages</span><span class="hl-2">.</span><span class="hl-1">push</span><span class="hl-2">(</span><br/><span class="hl-2">  {</span><br/><span class="hl-2">    </span><span class="hl-6">role:</span><span class="hl-2"> </span><span class="hl-4">&quot;user&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-6">content:</span><span class="hl-2"> </span><span class="hl-4">`–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Å–≤–µ—á–∏ 4h:</span><span class="hl-14">\n</span><span class="hl-3">${</span><span class="hl-1">formatCandles</span><span class="hl-9">(</span><span class="hl-6">longTermCandles</span><span class="hl-9">, </span><span class="hl-4">&quot;4h&quot;</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-4">`</span><br/><span class="hl-2">  },</span><br/><span class="hl-2">  {</span><br/><span class="hl-2">    </span><span class="hl-6">role:</span><span class="hl-2"> </span><span class="hl-4">&quot;assistant&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-6">content:</span><span class="hl-2"> </span><span class="hl-4">&quot;–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π —Ç—Ä–µ–Ω–¥ 4h –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω&quot;</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">);</span>
</code><button type="button">Copy</button></pre>

<a id="changing-llm-model" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Changing LLM Model<a href="#changing-llm-model" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-0">// In utils/json.mjs</span><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">response</span><span class="hl-2"> = </span><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-6">ollama</span><span class="hl-2">.</span><span class="hl-1">chat</span><span class="hl-2">({</span><br/><span class="hl-2">  </span><span class="hl-6">model:</span><span class="hl-2"> </span><span class="hl-4">&quot;llama3.3:70b&quot;</span><span class="hl-2">,  </span><span class="hl-0">// Use different model</span><br/><span class="hl-2">  </span><span class="hl-6">messages:</span><span class="hl-2"> [...]</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="custom-signal-schema" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Custom Signal Schema<a href="#custom-signal-schema" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-0">// In utils/json.mjs - modify format property</span><br/><span class="hl-10">format</span><span class="hl-2">: {</span><br/><span class="hl-2">  </span><span class="hl-10">type</span><span class="hl-2">: </span><span class="hl-4">&quot;object&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-10">properties</span><span class="hl-2">: {</span><br/><span class="hl-2">    </span><span class="hl-10">position</span><span class="hl-2">: { </span><span class="hl-10">type</span><span class="hl-2">: </span><span class="hl-4">&quot;string&quot;</span><span class="hl-2">, </span><span class="hl-10">enum</span><span class="hl-2">: [</span><span class="hl-4">&quot;wait&quot;</span><span class="hl-2">, </span><span class="hl-4">&quot;long&quot;</span><span class="hl-2">, </span><span class="hl-4">&quot;short&quot;</span><span class="hl-2">] },</span><br/><span class="hl-2">    </span><span class="hl-10">note</span><span class="hl-2">: { </span><span class="hl-10">type</span><span class="hl-2">: </span><span class="hl-4">&quot;string&quot;</span><span class="hl-2"> },</span><br/><span class="hl-2">    </span><span class="hl-10">confidence</span><span class="hl-2">: { </span><span class="hl-10">type</span><span class="hl-2">: </span><span class="hl-4">&quot;number&quot;</span><span class="hl-2">, </span><span class="hl-10">minimum</span><span class="hl-2">: </span><span class="hl-7">0</span><span class="hl-2">, </span><span class="hl-10">maximum</span><span class="hl-2">: </span><span class="hl-7">1</span><span class="hl-2"> },  </span><span class="hl-0">// Add confidence</span><br/><span class="hl-2">    </span><span class="hl-0">// ... existing fields</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<a id="custom-event-handlers" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Custom Event Handlers<a href="#custom-event-handlers" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-0">// In src/index.mjs</span><br/><span class="hl-1">listenSignalBacktest</span><span class="hl-2">((</span><span class="hl-6">event</span><span class="hl-2">) </span><span class="hl-3">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-5">if</span><span class="hl-2"> (</span><span class="hl-6">event</span><span class="hl-2">.</span><span class="hl-6">action</span><span class="hl-2"> === </span><span class="hl-4">&quot;opened&quot;</span><span class="hl-2">) {</span><br/><span class="hl-2">    </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`üìà Opened </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">signal</span><span class="hl-9">.</span><span class="hl-6">position</span><span class="hl-3">}</span><span class="hl-4"> at </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">signal</span><span class="hl-9">.</span><span class="hl-6">priceOpen</span><span class="hl-3">}</span><span class="hl-4">`</span><span class="hl-2">);</span><br/><span class="hl-2">  } </span><span class="hl-5">else</span><span class="hl-2"> </span><span class="hl-5">if</span><span class="hl-2"> (</span><span class="hl-6">event</span><span class="hl-2">.</span><span class="hl-6">action</span><span class="hl-2"> === </span><span class="hl-4">&quot;closed&quot;</span><span class="hl-2">) {</span><br/><span class="hl-2">    </span><span class="hl-6">console</span><span class="hl-2">.</span><span class="hl-1">log</span><span class="hl-2">(</span><span class="hl-4">`üí∞ Closed with PNL: </span><span class="hl-3">${</span><span class="hl-6">event</span><span class="hl-9">.</span><span class="hl-6">pnl</span><span class="hl-9">.</span><span class="hl-6">pnlPercentage</span><span class="hl-9">.</span><span class="hl-1">toFixed</span><span class="hl-9">(</span><span class="hl-7">2</span><span class="hl-9">)</span><span class="hl-3">}</span><span class="hl-4">%`</span><span class="hl-2">);</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">});</span>
</code><button type="button">Copy</button></pre>

<a id="parallel-backtesting" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Parallel Backtesting<a href="#parallel-backtesting" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="javascript"><span class="hl-0">// Test multiple symbols simultaneously</span><br/><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">symbols</span><span class="hl-2"> = [</span><span class="hl-4">&quot;BTCUSDT&quot;</span><span class="hl-2">, </span><span class="hl-4">&quot;ETHUSDT&quot;</span><span class="hl-2">, </span><span class="hl-4">&quot;SOLUSDT&quot;</span><span class="hl-2">];</span><br/><br/><span class="hl-5">for</span><span class="hl-2"> (</span><span class="hl-3">const</span><span class="hl-2"> </span><span class="hl-8">symbol</span><span class="hl-2"> </span><span class="hl-3">of</span><span class="hl-2"> </span><span class="hl-6">symbols</span><span class="hl-2">) {</span><br/><span class="hl-2">  </span><span class="hl-6">Backtest</span><span class="hl-2">.</span><span class="hl-1">background</span><span class="hl-2">(</span><span class="hl-6">symbol</span><span class="hl-2">, {</span><br/><span class="hl-2">    </span><span class="hl-6">strategyName:</span><span class="hl-2"> </span><span class="hl-4">&quot;test_strategy&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-6">exchangeName:</span><span class="hl-2"> </span><span class="hl-4">&quot;test_exchange&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">    </span><span class="hl-6">frameName:</span><span class="hl-2"> </span><span class="hl-4">&quot;test_frame&quot;</span><span class="hl-2">,</span><br/><span class="hl-2">  });</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<a id="troubleshooting" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Troubleshooting<a href="#troubleshooting" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="common-issues" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Common Issues<a href="#common-issues" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>Issue</strong>: <code>OLLAMA_API_KEY is not defined</code></p>
<pre><code class="bash"><span class="hl-0"># Solution: Set environment variable</span><br/><span class="hl-3">export</span><span class="hl-2"> </span><span class="hl-6">OLLAMA_API_KEY</span><span class="hl-2">=</span><span class="hl-6">your_key</span>
</code><button type="button">Copy</button></pre>

<p><strong>Issue</strong>: <code>Rate limit exceeded</code></p>
<pre><code class="javascript"><span class="hl-0">// Solution: Add delay between requests in utils/json.mjs</span><br/><span class="hl-5">await</span><span class="hl-2"> </span><span class="hl-3">new</span><span class="hl-2"> </span><span class="hl-11">Promise</span><span class="hl-2">(</span><span class="hl-6">resolve</span><span class="hl-2"> </span><span class="hl-3">=&gt;</span><span class="hl-2"> </span><span class="hl-1">setTimeout</span><span class="hl-2">(</span><span class="hl-6">resolve</span><span class="hl-2">, </span><span class="hl-7">1000</span><span class="hl-2">));</span>
</code><button type="button">Copy</button></pre>

<p><strong>Issue</strong>: <code>Invalid signal structure</code></p>
<pre><code class="javascript"><span class="hl-0">// Solution: Check LLM output format matches schema</span><br/><span class="hl-0">// Verify all required fields are present in JSON response</span>
</code><button type="button">Copy</button></pre>

<p><strong>Issue</strong>: <code>No signals generated (all 'wait')</code></p>
<pre><code class="javascript"><span class="hl-0">// Solution: Adjust prompt to be more aggressive</span><br/><span class="hl-0">// Or check if market data has sufficient volatility</span>
</code><button type="button">Copy</button></pre>

<a id="related-projects" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Related Projects<a href="#related-projects" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><a href="https://github.com/tripolskypetr/backtest-kit">backtest-kit</a> - Trading framework</li>
<li><a href="https://github.com/tripolskypetr/node-ccxt-dumper">node-ccxt-dumper</a> - Historical data API</li>
<li><a href="https://ollama.com">ollama</a> - Local LLM inference</li>
<li><a href="https://github.com/ccxt/ccxt">ccxt</a> - Cryptocurrency exchange API</li>
</ul>
<a id="next-steps" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Next Steps<a href="#next-steps" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><ol>
<li><strong>Optimize Strategy</strong>: Analyze debug logs to improve prompts</li>
<li><strong>Add Indicators</strong>: Calculate RSI, MACD, Bollinger Bands before LLM</li>
<li><strong>Live Trading</strong>: Use <code>Live.background()</code> for real-time execution</li>
<li><strong>Strategy Comparison</strong>: Run Walker to compare different prompts</li>
<li><strong>Portfolio Trading</strong>: Extend to multiple symbols with risk limits</li>
</ol>
<a id="license" class="tsd-anchor"></a><h2 class="tsd-anchor-link">License<a href="#license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>MIT ¬© <a href="https://github.com/tripolskypetr">tripolskypetr</a></p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#ai-powered-backtest-demo"><span>AI-<wbr/>Powered <wbr/>Backtest <wbr/>Demo</span></a><ul><li><a href="#purpose"><span>Purpose</span></a></li><li><a href="#key-features"><span>Key <wbr/>Features</span></a></li><li><a href="#technology-stack"><span>Technology <wbr/>Stack</span></a></li><li><a href="#project-structure"><span>Project <wbr/>Structure</span></a></li><li><a href="#installation-and-setup"><span>Installation and <wbr/>Setup</span></a></li><li><a href="#configuration"><span>Configuration</span></a></li><li><ul><li><a href="#environment-variables"><span>Environment <wbr/>Variables</span></a></li><li><a href="#backtest-configuration"><span>Backtest <wbr/>Configuration</span></a></li><li><a href="#signal-generation-rules"><span>Signal <wbr/>Generation <wbr/>Rules</span></a></li></ul></li><li><a href="#usage-examples"><span>Usage <wbr/>Examples</span></a></li><li><ul><li><a href="#basic-usage"><span>Basic <wbr/>Usage</span></a></li><li><a href="#analyzing-results"><span>Analyzing <wbr/>Results</span></a></li><li><a href="#debugging-llm-conversations"><span>Debugging LLM <wbr/>Conversations</span></a></li><li><a href="#customizing-symbols"><span>Customizing <wbr/>Symbols</span></a></li><li><a href="#adjusting-time-periods"><span>Adjusting <wbr/>Time <wbr/>Periods</span></a></li></ul></li><li><a href="#how-it-works"><span>How <wbr/>It <wbr/>Works</span></a></li><li><ul><li><a href="#phase-1-multi-timeframe-data-collection"><span>Phase 1: <wbr/>Multi-<wbr/>Timeframe <wbr/>Data <wbr/>Collection</span></a></li><li><a href="#phase-2-llm-conversation-building"><span>Phase 2: LLM <wbr/>Conversation <wbr/>Building</span></a></li><li><a href="#phase-3-signal-generation"><span>Phase 3: <wbr/>Signal <wbr/>Generation</span></a></li><li><a href="#phase-4-debug-logging"><span>Phase 4: <wbr/>Debug <wbr/>Logging</span></a></li><li><a href="#phase-5-backtesting-execution"><span>Phase 5: <wbr/>Backtesting <wbr/>Execution</span></a></li><li><a href="#phase-6-report-generation"><span>Phase 6: <wbr/>Report <wbr/>Generation</span></a></li></ul></li><li><a href="#llm-prompt-engineering"><span>LLM <wbr/>Prompt <wbr/>Engineering</span></a></li><li><ul><li><a href="#system-prompt-strategy"><span>System <wbr/>Prompt <wbr/>Strategy</span></a></li><li><a href="#user-prompt-strategy"><span>User <wbr/>Prompt <wbr/>Strategy</span></a></li></ul></li><li><a href="#performance-metrics"><span>Performance <wbr/>Metrics</span></a></li><li><a href="#economic-benefits"><span>Economic <wbr/>Benefits</span></a></li><li><a href="#advanced-customization"><span>Advanced <wbr/>Customization</span></a></li><li><ul><li><a href="#adding-new-timeframes"><span>Adding <wbr/>New <wbr/>Timeframes</span></a></li><li><a href="#changing-llm-model"><span>Changing LLM <wbr/>Model</span></a></li><li><a href="#custom-signal-schema"><span>Custom <wbr/>Signal <wbr/>Schema</span></a></li><li><a href="#custom-event-handlers"><span>Custom <wbr/>Event <wbr/>Handlers</span></a></li><li><a href="#parallel-backtesting"><span>Parallel <wbr/>Backtesting</span></a></li></ul></li><li><a href="#troubleshooting"><span>Troubleshooting</span></a></li><li><ul><li><a href="#common-issues"><span>Common <wbr/>Issues</span></a></li></ul></li><li><a href="#related-projects"><span>Related <wbr/>Projects</span></a></li><li><a href="#next-steps"><span>Next <wbr/>Steps</span></a></li><li><a href="#license"><span>License</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
