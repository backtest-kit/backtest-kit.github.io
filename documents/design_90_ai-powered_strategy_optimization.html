<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/90_ai-powered_strategy_optimization | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_90_ai-powered_strategy_optimization.html">design/90_ai-powered_strategy_optimization</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="ai-powered-strategy-optimization" class="tsd-anchor"></a><h1 class="tsd-anchor-link">AI-Powered Strategy Optimization<a href="#ai-powered-strategy-optimization" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><a id="purpose-and-scope" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Purpose and Scope<a href="#purpose-and-scope" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The AI-Powered Strategy Optimization system enables automated generation of executable trading strategies using Large Language Models (LLMs). This document provides an overview of the optimizer's architecture, configuration, and execution flow. For detailed information about specific subsystems, see:</p>
<ul>
<li><a href="design_91_optimizer_architecture.html">Optimizer Architecture</a> - Internal components and code generation pipeline</li>
<li><a href="design_92_data_collection_pipeline.html">Data Collection Pipeline</a> - Data fetching, pagination, and deduplication</li>
<li><a href="design_93_llm_integration.html">LLM Integration</a> - Ollama integration and prompt engineering</li>
<li><a href="design_94_strategy_code_generation.html">Strategy Code Generation</a> - Template system and code assembly</li>
<li><a href="design_95_training_vs_testing_ranges.html">Training vs Testing Ranges</a> - Date range configuration for optimization</li>
</ul>
<a id="system-overview" class="tsd-anchor"></a><h2 class="tsd-anchor-link">System Overview<a href="#system-overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The Optimizer generates complete, executable trading strategy code by analyzing historical market data through LLMs. The system collects data from configurable sources across multiple time ranges, builds multi-timeframe conversation context, and leverages Ollama's deepseek-v3.1:671b model to synthesize trading strategies. The output is a ready-to-execute <code>.mjs</code> file containing strategies, exchange configurations, frames, and a Walker for performance comparison.</p>
<p><strong>Key Capabilities:</strong></p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data Collection</strong></td>
<td>Paginated fetching with deduplication from multiple sources</td>
</tr>
<tr>
<td><strong>Multi-Timeframe Analysis</strong></td>
<td>Progressive context building (1h → 15m → 5m → 1m)</td>
</tr>
<tr>
<td><strong>LLM Code Generation</strong></td>
<td>JSON-structured signal output with validation</td>
</tr>
<tr>
<td><strong>Template System</strong></td>
<td>Modular code generation with customizable templates</td>
</tr>
<tr>
<td><strong>Automated Testing</strong></td>
<td>Generated Walker for immediate strategy comparison</td>
</tr>
</tbody>
</table>
<p>The optimizer bridges raw market data to production-ready strategies through a four-stage pipeline: data collection, prompt construction, LLM inference, and code assembly.</p>
<a id="architecture-components" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Architecture Components<a href="#architecture-components" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><img src="../media/90_AI-Powered_Strategy_Optimization_0.svg" alt="Mermaid Diagram"></p>
<p><strong>Component Responsibilities:</strong></p>
<table>
<thead>
<tr>
<th>Component</th>
<th>File</th>
<th>Responsibility</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>OptimizerUtils</strong></td>
<td><a href="">src/classes/Optimizer.ts:32-121</a></td>
<td>Public API facade for optimizer operations</td>
</tr>
<tr>
<td><strong>OptimizerGlobalService</strong></td>
<td><a href="">src/lib/services/global/OptimizerGlobalService.ts:21-102</a></td>
<td>Validation entry point, delegates to ConnectionService</td>
</tr>
<tr>
<td><strong>OptimizerConnectionService</strong></td>
<td><a href="">src/lib/services/connection/OptimizerConnectionService.ts:41-172</a></td>
<td>Memoized instance creation with template merging</td>
</tr>
<tr>
<td><strong>OptimizerSchemaService</strong></td>
<td><a href="">src/lib/services/schema/OptimizerSchemaService.ts:13-95</a></td>
<td>Immutable schema storage via ToolRegistry</td>
</tr>
<tr>
<td><strong>OptimizerTemplateService</strong></td>
<td><a href="">src/lib/services/template/OptimizerTemplateService.ts:27-713</a></td>
<td>Default code generation templates</td>
</tr>
<tr>
<td><strong>ClientOptimizer</strong></td>
<td><a href="">src/client/ClientOptimizer.ts:397-445</a></td>
<td>Core business logic for data and code generation</td>
</tr>
</tbody>
</table>
<a id="configuration-schema" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Configuration Schema<a href="#configuration-schema" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>IOptimizerSchema</code> defines the complete optimizer configuration. Registration is performed via the <code>addOptimizer</code> function (see <a href="design_08_component_registration.html">Component Registration</a>).</p>
<p><img src="../media/90_AI-Powered_Strategy_Optimization_1.svg" alt="Mermaid Diagram"></p>
<p><strong>Schema Fields:</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>optimizerName</code></td>
<td>string</td>
<td>Yes</td>
<td>Unique identifier for registry lookup</td>
</tr>
<tr>
<td><code>rangeTrain</code></td>
<td>IOptimizerRange[]</td>
<td>Yes</td>
<td>Training time ranges for strategy generation</td>
</tr>
<tr>
<td><code>rangeTest</code></td>
<td>IOptimizerRange</td>
<td>Yes</td>
<td>Testing time range for Walker validation</td>
</tr>
<tr>
<td><code>source</code></td>
<td>Source[]</td>
<td>Yes</td>
<td>Data sources for LLM context building</td>
</tr>
<tr>
<td><code>getPrompt</code></td>
<td>function</td>
<td>Yes</td>
<td>Generates strategy logic from conversation history</td>
</tr>
<tr>
<td><code>template</code></td>
<td>Partial&lt;IOptimizerTemplate&gt;</td>
<td>No</td>
<td>Custom code generation overrides</td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td>Partial&lt;IOptimizerCallbacks&gt;</td>
<td>No</td>
<td>Lifecycle hooks for monitoring</td>
</tr>
</tbody>
</table>
<p><strong>Data Source Configuration:</strong></p>
<pre><code class="typescript"><span class="hl-5">// Simple source - just a fetch function</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-0">simpleFetch</span><span class="hl-1">: </span><span class="hl-11">IOptimizerSourceFn</span><span class="hl-1"> = </span><span class="hl-7">async</span><span class="hl-1"> ({ </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">, </span><span class="hl-4">offset</span><span class="hl-1"> }) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">fetchDataFromDatabase</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">, </span><span class="hl-4">offset</span><span class="hl-1">);</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-5">// Complex source - with custom message formatters</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">complexSource</span><span class="hl-1">: </span><span class="hl-11">IOptimizerSource</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-results&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">fetch</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> ({ </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">, </span><span class="hl-4">offset</span><span class="hl-1"> }) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">fetchBacktestResults</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">, </span><span class="hl-4">offset</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">user</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">, </span><span class="hl-4">name</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">`Analyze these </span><span class="hl-7">${</span><span class="hl-4">data</span><span class="hl-9">.</span><span class="hl-4">length</span><span class="hl-7">}</span><span class="hl-2"> backtest results for </span><span class="hl-7">${</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2">:</span><span class="hl-14">\n</span><span class="hl-7">${</span><span class="hl-8">JSON</span><span class="hl-9">.</span><span class="hl-0">stringify</span><span class="hl-9">(</span><span class="hl-4">data</span><span class="hl-9">)</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">assistant</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">, </span><span class="hl-4">name</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">`Analyzed </span><span class="hl-7">${</span><span class="hl-4">data</span><span class="hl-9">.</span><span class="hl-4">length</span><span class="hl-7">}</span><span class="hl-2"> results. Key patterns identified.`</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<a id="execution-flow" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Execution Flow<a href="#execution-flow" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The optimizer executes through three primary methods: <code>getData()</code>, <code>getCode()</code>, and <code>dump()</code>. Each builds upon the previous.</p>
<p><img src="../media/90_AI-Powered_Strategy_Optimization_2.svg" alt="Mermaid Diagram"></p>
<p><strong>Step-by-Step Process:</strong></p>
<ol>
<li><strong>Registration</strong> - <code>addOptimizer()</code> validates schema and stores in registry</li>
<li><strong>Validation</strong> - <code>OptimizerValidationService</code> confirms optimizer exists</li>
<li><strong>Instantiation</strong> - <code>OptimizerConnectionService</code> creates memoized <code>ClientOptimizer</code></li>
<li><strong>Data Collection</strong> - Iterates <code>rangeTrain</code>, fetches from each <code>source</code> with pagination</li>
<li><strong>Message Formatting</strong> - Builds user/assistant message pairs via formatters</li>
<li><strong>Prompt Generation</strong> - Calls <code>getPrompt()</code> with complete conversation history</li>
<li><strong>Code Assembly</strong> - Generates imports, helpers, components via templates</li>
<li><strong>File Export</strong> - Writes <code>{optimizerName}_{symbol}.mjs</code> to filesystem</li>
</ol>
<a id="public-api-usage" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Public API Usage<a href="#public-api-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>Optimizer</code> singleton provides three methods for strategy generation:</p>
<p><img src="../media/90_AI-Powered_Strategy_Optimization_3.svg" alt="Mermaid Diagram"></p>
<p><strong>Example Usage:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addOptimizer</span><span class="hl-1">, </span><span class="hl-4">Optimizer</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// 1. Register optimizer configuration</span><br/><span class="hl-0">addOptimizer</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">optimizerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;btc-momentum-v1&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">rangeTrain:</span><span class="hl-1"> [</span><br/><span class="hl-1">    { </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-01&quot;</span><span class="hl-1">), </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-01-31&quot;</span><span class="hl-1">) },</span><br/><span class="hl-1">    { </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-02-01&quot;</span><span class="hl-1">), </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-02-28&quot;</span><span class="hl-1">) }</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-4">rangeTest:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-03-01&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">    </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-03-31&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-4">source:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-7">async</span><span class="hl-1"> ({ </span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">, </span><span class="hl-4">offset</span><span class="hl-1"> }) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">// Fetch historical candles or indicators</span><br/><span class="hl-1">      </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">fetchIndicators</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">startDate</span><span class="hl-1">, </span><span class="hl-4">endDate</span><span class="hl-1">, </span><span class="hl-4">limit</span><span class="hl-1">, </span><span class="hl-4">offset</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-0">getPrompt</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">messages</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// Generate strategy logic prompt</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">&quot;Купить на пробое RSI 30, продать на RSI 70. Стоп-лосс 2%, тейк-профит 4%.&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// 2. Get strategy data (intermediate result)</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">strategies</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Optimizer</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">optimizerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;btc-momentum-v1&quot;</span><br/><span class="hl-1">});</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">strategies</span><span class="hl-1">); </span><span class="hl-5">// Array of strategy metadata with conversation history</span><br/><br/><span class="hl-5">// 3. Generate executable code</span><br/><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">code</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Optimizer</span><span class="hl-1">.</span><span class="hl-0">getCode</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">optimizerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;btc-momentum-v1&quot;</span><br/><span class="hl-1">});</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">code</span><span class="hl-1">); </span><span class="hl-5">// Complete .mjs file content</span><br/><br/><span class="hl-5">// 4. Save to file</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Optimizer</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">optimizerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;btc-momentum-v1&quot;</span><br/><span class="hl-1">}, </span><span class="hl-2">&quot;./strategies&quot;</span><span class="hl-1">);</span><br/><span class="hl-5">// Creates: ./strategies/btc-momentum-v1_BTCUSDT.mjs</span>
</code><button type="button">Copy</button></pre>

<p><strong>Method Comparison:</strong></p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Purpose</th>
<th>Output</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>getData()</code></td>
<td>Fetch data and build conversation history</td>
<td><code>IOptimizerStrategy[]</code></td>
<td>Inspect intermediate data, debug prompts</td>
</tr>
<tr>
<td><code>getCode()</code></td>
<td>Generate complete executable code</td>
<td><code>string</code></td>
<td>Preview code before saving, custom post-processing</td>
</tr>
<tr>
<td><code>dump()</code></td>
<td>Generate and save code to file</td>
<td><code>void</code></td>
<td>Production usage, automated workflows</td>
</tr>
</tbody>
</table>
<a id="generated-code-structure" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Generated Code Structure<a href="#generated-code-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The optimizer outputs a complete <code>.mjs</code> file with all required components. The file is immediately executable via Node.js.</p>
<p><strong>Generated File Structure:</strong></p>
<p><img src="../media/90_AI-Powered_Strategy_Optimization_4.svg" alt="Mermaid Diagram"></p>
<p><strong>Code Section Mapping:</strong></p>
<table>
<thead>
<tr>
<th>Section</th>
<th>Template Method</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Shebang + Imports</td>
<td><code>getTopBanner()</code></td>
<td><a href="">src/lib/services/template/OptimizerTemplateService.ts:36-66</a></td>
</tr>
<tr>
<td>dumpJson()</td>
<td><code>getJsonDumpTemplate()</code></td>
<td><a href="">src/lib/services/template/OptimizerTemplateService.ts:452-546</a></td>
</tr>
<tr>
<td>text()</td>
<td><code>getTextTemplate()</code></td>
<td><a href="">src/lib/services/template/OptimizerTemplateService.ts:555-612</a></td>
</tr>
<tr>
<td>json()</td>
<td><code>getJsonTemplate()</code></td>
<td><a href="">src/lib/services/template/OptimizerTemplateService.ts:629-712</a></td>
</tr>
<tr>
<td>addExchange()</td>
<td><code>getExchangeTemplate()</code></td>
<td><a href="">src/lib/services/template/OptimizerTemplateService.ts:314-342</a></td>
</tr>
<tr>
<td>addFrame()</td>
<td><code>getFrameTemplate()</code></td>
<td><a href="">src/lib/services/template/OptimizerTemplateService.ts:354-385</a></td>
</tr>
<tr>
<td>addStrategy()</td>
<td><code>getStrategyTemplate()</code></td>
<td><a href="">src/lib/services/template/OptimizerTemplateService.ts:168-304</a></td>
</tr>
<tr>
<td>addWalker()</td>
<td><code>getWalkerTemplate()</code></td>
<td><a href="">src/lib/services/template/OptimizerTemplateService.ts:122-157</a></td>
</tr>
<tr>
<td>Walker.background()</td>
<td><code>getLauncherTemplate()</code></td>
<td><a href="">src/lib/services/template/OptimizerTemplateService.ts:395-443</a></td>
</tr>
</tbody>
</table>
<p><strong>Strategy Template Highlights:</strong></p>
<p>The <code>getStrategyTemplate()</code> generates a strategy with multi-timeframe analysis:</p>
<ol>
<li><strong>Data Loading</strong> - Fetches 1h, 15m, 5m, 1m candles via <code>getCandles()</code></li>
<li><strong>Progressive Analysis</strong> - Builds conversation with 5 message pairs</li>
<li><strong>LLM Invocation</strong> - Calls <code>json(messages)</code> for structured signal output</li>
<li><strong>Debug Logging</strong> - Dumps conversation to <code>./dump/strategy/{uuid}/</code></li>
</ol>
<p>The generated signal schema enforces:</p>
<ul>
<li><code>position</code>: &quot;wait&quot; | &quot;long&quot; | &quot;short&quot;</li>
<li><code>priceOpen</code>, <code>priceTakeProfit</code>, <code>priceStopLoss</code>: entry/exit prices</li>
<li><code>minuteEstimatedTime</code>: expected trade duration (max 360 minutes)</li>
<li><code>note</code>: strategy explanation</li>
</ul>
<a id="template-customization" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Template Customization<a href="#template-customization" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The template system allows partial overrides for custom code generation. Override any of the 11 template methods via the <code>template</code> field in <code>IOptimizerSchema</code>.</p>
<p><strong>Template Methods:</strong></p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Default Behavior</th>
<th>Common Customizations</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>getTopBanner()</code></td>
<td>Standard imports (Ollama, ccxt, backtest-kit)</td>
<td>Add custom dependencies, environment variables</td>
</tr>
<tr>
<td><code>getUserMessage()</code></td>
<td>&quot;Прочитай данные и скажи ОК&quot;</td>
<td>Format data differently, add analysis instructions</td>
</tr>
<tr>
<td><code>getAssistantMessage()</code></td>
<td>&quot;ОК&quot;</td>
<td>Add contextual acknowledgments</td>
</tr>
<tr>
<td><code>getStrategyTemplate()</code></td>
<td>Multi-timeframe (1h→15m→5m→1m)</td>
<td>Change timeframes, add custom indicators</td>
</tr>
<tr>
<td><code>getTextTemplate()</code></td>
<td>deepseek-v3.1:671b text mode</td>
<td>Use different model, modify system prompt</td>
</tr>
<tr>
<td><code>getJsonTemplate()</code></td>
<td>Signal schema with position/prices</td>
<td>Change schema, add custom fields</td>
</tr>
<tr>
<td><code>getExchangeTemplate()</code></td>
<td>CCXT Binance</td>
<td>Use different exchange, add authentication</td>
</tr>
<tr>
<td><code>getFrameTemplate()</code></td>
<td>Standard frame config</td>
<td>Add custom intervals</td>
</tr>
<tr>
<td><code>getWalkerTemplate()</code></td>
<td>Standard walker</td>
<td>Change comparison metrics</td>
</tr>
<tr>
<td><code>getLauncherTemplate()</code></td>
<td>Full event listeners</td>
<td>Add custom listeners, modify output</td>
</tr>
<tr>
<td><code>getJsonDumpTemplate()</code></td>
<td>Dump to ./dump/strategy</td>
<td>Change output directory, format</td>
</tr>
</tbody>
</table>
<p><strong>Example Customization:</strong></p>
<pre><code class="typescript"><span class="hl-0">addOptimizer</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">optimizerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;custom-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">// ... other fields ...</span><br/><span class="hl-1">  </span><span class="hl-4">template:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// Override strategy template to use custom timeframes</span><br/><span class="hl-1">    </span><span class="hl-0">getStrategyTemplate</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">strategyName</span><span class="hl-1">, </span><span class="hl-4">interval</span><span class="hl-1">, </span><span class="hl-4">prompt</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">`</span><br/><span class="hl-2">        addStrategy({</span><br/><span class="hl-2">          strategyName: &quot;</span><span class="hl-7">${</span><span class="hl-4">strategyName</span><span class="hl-7">}</span><span class="hl-2">&quot;,</span><br/><span class="hl-2">          interval: &quot;</span><span class="hl-7">${</span><span class="hl-4">interval</span><span class="hl-7">}</span><span class="hl-2">&quot;,</span><br/><span class="hl-2">          getSignal: async (symbol) =&gt; {</span><br/><span class="hl-2">            // Custom logic: only use 4h and 1h timeframes</span><br/><span class="hl-2">            const longTermCandles = await getCandles(symbol, &quot;4h&quot;, 24);</span><br/><span class="hl-2">            const mediumTermCandles = await getCandles(symbol, &quot;1h&quot;, 48);</span><br/><span class="hl-2">            </span><br/><span class="hl-2">            const messages = [</span><br/><span class="hl-2">              { role: &quot;user&quot;, content: formatCandles(longTermCandles) },</span><br/><span class="hl-2">              { role: &quot;assistant&quot;, content: &quot;Long-term trend analyzed&quot; },</span><br/><span class="hl-2">              { role: &quot;user&quot;, content: formatCandles(mediumTermCandles) },</span><br/><span class="hl-2">              { role: &quot;assistant&quot;, content: &quot;Medium-term trend analyzed&quot; },</span><br/><span class="hl-2">              { role: &quot;user&quot;, content: &quot;</span><span class="hl-7">${</span><span class="hl-4">prompt</span><span class="hl-7">}</span><span class="hl-2">&quot; }</span><br/><span class="hl-2">            ];</span><br/><span class="hl-2">            </span><br/><span class="hl-2">            return await json(messages);</span><br/><span class="hl-2">          }</span><br/><span class="hl-2">        });</span><br/><span class="hl-2">      `</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="progress-monitoring" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Progress Monitoring<a href="#progress-monitoring" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The optimizer emits progress events via <code>progressOptimizerEmitter</code> for real-time monitoring during data collection.</p>
<p><strong>Progress Event Structure:</strong></p>
<pre><code class="typescript"><span class="hl-7">interface</span><span class="hl-1"> </span><span class="hl-11">ProgressOptimizerContract</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">optimizerName</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;     </span><span class="hl-5">// Optimizer identifier</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-11">string</span><span class="hl-1">;            </span><span class="hl-5">// Trading pair</span><br/><span class="hl-1">  </span><span class="hl-4">totalSources</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;      </span><span class="hl-5">// rangeTrain.length * source.length</span><br/><span class="hl-1">  </span><span class="hl-4">processedSources</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;  </span><span class="hl-5">// Completed sources</span><br/><span class="hl-1">  </span><span class="hl-4">progress</span><span class="hl-1">: </span><span class="hl-11">number</span><span class="hl-1">;          </span><span class="hl-5">// 0.0 to 1.0</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Monitoring Example:</strong></p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">listenOptimizerProgress</span><span class="hl-1">, </span><span class="hl-4">Optimizer</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Subscribe to progress events</span><br/><span class="hl-0">listenOptimizerProgress</span><span class="hl-1">((</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Optimizer: </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">optimizerName</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Symbol: </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">symbol</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Progress: </span><span class="hl-7">${</span><span class="hl-9">(</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">progress</span><span class="hl-9"> </span><span class="hl-1">*</span><span class="hl-9"> </span><span class="hl-6">100</span><span class="hl-9">).</span><span class="hl-0">toFixed</span><span class="hl-9">(</span><span class="hl-6">2</span><span class="hl-9">)</span><span class="hl-7">}</span><span class="hl-2">%`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Processed: </span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">processedSources</span><span class="hl-7">}</span><span class="hl-2">/</span><span class="hl-7">${</span><span class="hl-4">event</span><span class="hl-9">.</span><span class="hl-4">totalSources</span><span class="hl-7">}</span><span class="hl-2"> sources`</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Start optimization</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Optimizer</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, { </span><span class="hl-4">optimizerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;my-optimizer&quot;</span><span class="hl-1"> });</span>
</code><button type="button">Copy</button></pre>

<p>Progress events are emitted:</p>
<ol>
<li>At the start of processing each source (before fetch)</li>
<li>After completing all sources (progress = 1.0)</li>
</ol>
<a id="use-cases-and-patterns" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Use Cases and Patterns<a href="#use-cases-and-patterns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><strong>Common Use Cases:</strong></p>
<ol>
<li><strong>Automated Strategy Discovery</strong> - Generate strategies from historical patterns</li>
<li><strong>Parameter Optimization</strong> - Test multiple variations across training ranges</li>
<li><strong>Strategy Refinement</strong> - Iteratively improve strategies with additional data sources</li>
<li><strong>Ensemble Strategies</strong> - Generate multiple strategies for portfolio diversification</li>
<li><strong>Market Regime Analysis</strong> - Generate different strategies for different market conditions</li>
</ol>
<p><strong>Recommended Patterns:</strong></p>
<pre><code class="typescript"><span class="hl-5">// Pattern 1: Multiple Training Periods</span><br/><span class="hl-0">addOptimizer</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">optimizerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;quarterly-strategies&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">rangeTrain:</span><span class="hl-1"> [</span><br/><span class="hl-1">    { </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-Q1-start&quot;</span><span class="hl-1">), </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-Q1-end&quot;</span><span class="hl-1">) },</span><br/><span class="hl-1">    { </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-Q2-start&quot;</span><span class="hl-1">), </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-Q2-end&quot;</span><span class="hl-1">) },</span><br/><span class="hl-1">    { </span><span class="hl-4">startDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-Q3-start&quot;</span><span class="hl-1">), </span><span class="hl-4">endDate:</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-2">&quot;2024-Q3-end&quot;</span><span class="hl-1">) }</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">// Each range generates a separate strategy variant</span><br/><span class="hl-1">  </span><span class="hl-5">// ...</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Pattern 2: Multiple Data Sources</span><br/><span class="hl-0">addOptimizer</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">optimizerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;multi-source-strategy&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">source:</span><span class="hl-1"> [</span><br/><span class="hl-1">    { </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;candles&quot;</span><span class="hl-1">, </span><span class="hl-4">fetch:</span><span class="hl-1"> </span><span class="hl-4">fetchCandles</span><span class="hl-1"> },</span><br/><span class="hl-1">    { </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;indicators&quot;</span><span class="hl-1">, </span><span class="hl-4">fetch:</span><span class="hl-1"> </span><span class="hl-4">fetchIndicators</span><span class="hl-1"> },</span><br/><span class="hl-1">    { </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;sentiment&quot;</span><span class="hl-1">, </span><span class="hl-4">fetch:</span><span class="hl-1"> </span><span class="hl-4">fetchSentiment</span><span class="hl-1"> },</span><br/><span class="hl-1">    { </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;orderbook&quot;</span><span class="hl-1">, </span><span class="hl-4">fetch:</span><span class="hl-1"> </span><span class="hl-4">fetchOrderbook</span><span class="hl-1"> }</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">// LLM sees all sources in conversation</span><br/><span class="hl-1">  </span><span class="hl-5">// ...</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Pattern 3: Custom Lifecycle Hooks</span><br/><span class="hl-0">addOptimizer</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">optimizerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;monitored-optimizer&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">callbacks:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">onSourceData</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">sourceName</span><span class="hl-1">, </span><span class="hl-4">data</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Fetched </span><span class="hl-7">${</span><span class="hl-4">data</span><span class="hl-9">.</span><span class="hl-4">length</span><span class="hl-7">}</span><span class="hl-2"> rows from </span><span class="hl-7">${</span><span class="hl-4">sourceName</span><span class="hl-7">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">onData</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">strategyData</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">// Validate generated strategies</span><br/><span class="hl-1">      </span><span class="hl-3">for</span><span class="hl-1"> (</span><span class="hl-7">const</span><span class="hl-1"> </span><span class="hl-8">strategy</span><span class="hl-1"> </span><span class="hl-7">of</span><span class="hl-1"> </span><span class="hl-4">strategyData</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">strategy</span><span class="hl-1">.</span><span class="hl-4">strategy</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1"> &lt; </span><span class="hl-6">100</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-3">throw</span><span class="hl-1"> </span><span class="hl-7">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><span class="hl-2">&quot;Strategy prompt too short&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">onCode</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">code</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">// Run static analysis, linting</span><br/><span class="hl-1">      </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">validateGeneratedCode</span><span class="hl-1">(</span><span class="hl-4">code</span><span class="hl-1">);</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">onDump</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-7">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">, </span><span class="hl-4">filepath</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">// Upload to storage, send notifications</span><br/><span class="hl-1">      </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">uploadToS3</span><span class="hl-1">(</span><span class="hl-4">filepath</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">// ...</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="integration-with-walker" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Integration with Walker<a href="#integration-with-walker" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The generated code includes a Walker configuration that automatically compares all generated strategies on the test range. This enables immediate performance evaluation without manual setup.</p>
<p><strong>Walker Integration Flow:</strong></p>
<p><img src="../media/90_AI-Powered_Strategy_Optimization_5.svg" alt="Mermaid Diagram"></p>
<p>The generated launcher code includes:</p>
<ul>
<li><code>listenWalkerProgress()</code> - Monitor comparison progress</li>
<li><code>listenWalkerComplete()</code> - Receive best strategy results</li>
<li><code>Walker.dump()</code> - Export comparison statistics</li>
</ul>
<p><strong>Generated Walker Structure:</strong></p>
<pre><code class="javascript"><span class="hl-5">// Generated by getWalkerTemplate()</span><br/><span class="hl-0">addWalker</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">walkerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;{prefix}_walker&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;{prefix}_exchange&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;{prefix}_test_frame&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">strategies:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;{prefix}_strategy-1&quot;</span><span class="hl-1">,  </span><span class="hl-5">// From rangeTrain[0]</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;{prefix}_strategy-2&quot;</span><span class="hl-1">,  </span><span class="hl-5">// From rangeTrain[1]</span><br/><span class="hl-1">    </span><span class="hl-2">&quot;{prefix}_strategy-3&quot;</span><span class="hl-1">   </span><span class="hl-5">// From rangeTrain[2]</span><br/><span class="hl-1">  ]</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Generated by getLauncherTemplate()</span><br/><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, { </span><span class="hl-4">walkerName:</span><span class="hl-1"> </span><span class="hl-2">&quot;{prefix}_walker&quot;</span><span class="hl-1"> });</span><br/><br/><span class="hl-0">listenWalkerComplete</span><span class="hl-1">((</span><span class="hl-4">results</span><span class="hl-1">) </span><span class="hl-7">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Best strategy:&quot;</span><span class="hl-1">, </span><span class="hl-4">results</span><span class="hl-1">.</span><span class="hl-4">bestStrategy</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Sharpe Ratio:&quot;</span><span class="hl-1">, </span><span class="hl-4">results</span><span class="hl-1">.</span><span class="hl-4">bestSharpeRatio</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">Walker</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-4">results</span><span class="hl-1">.</span><span class="hl-4">walkerName</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#ai-powered-strategy-optimization"><span>AI-<wbr/>Powered <wbr/>Strategy <wbr/>Optimization</span></a><ul><li><a href="#purpose-and-scope"><span>Purpose and <wbr/>Scope</span></a></li><li><a href="#system-overview"><span>System <wbr/>Overview</span></a></li><li><a href="#architecture-components"><span>Architecture <wbr/>Components</span></a></li><li><a href="#configuration-schema"><span>Configuration <wbr/>Schema</span></a></li><li><a href="#execution-flow"><span>Execution <wbr/>Flow</span></a></li><li><a href="#public-api-usage"><span>Public API <wbr/>Usage</span></a></li><li><a href="#generated-code-structure"><span>Generated <wbr/>Code <wbr/>Structure</span></a></li><li><a href="#template-customization"><span>Template <wbr/>Customization</span></a></li><li><a href="#progress-monitoring"><span>Progress <wbr/>Monitoring</span></a></li><li><a href="#use-cases-and-patterns"><span>Use <wbr/>Cases and <wbr/>Patterns</span></a></li><li><a href="#integration-with-walker"><span>Integration with <wbr/>Walker</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
