<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/20_schedule_api | backtest-kit</title><meta name="description" content="Documentation for backtest-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">backtest-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">backtest-kit</a></li><li><a href="design_20_schedule_api.html">design/20_schedule_api</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="schedule-api" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Schedule API<a href="#schedule-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>The Schedule API provides statistical tracking and reporting for <strong>scheduled signals</strong> (limit orders) in the backtest-kit framework. This API specifically monitors signals that specify a <code>priceOpen</code> entry point and tracks whether they activate or get cancelled before execution.</p>
<p>For tracking standard opened/closed signals, see <a href="design_17_backtest_api.html">4.3 Backtest API</a> and <a href="design_18_live_trading_api.html">4.4 Live Trading API</a>. For comprehensive signal lifecycle concepts, see <a href="design_07_signal_lifecycle_overview.html">2.2 Signal Lifecycle Overview</a> and <a href="design_47_scheduled_signals.html">8.3 Scheduled Signals</a>.</p>
<hr>
<a id="overview" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Overview<a href="#overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The Schedule API monitors the lifecycle of <strong>scheduled signals</strong>—signals that wait for market price to reach a specific entry point (<code>priceOpen</code>) before activating. Unlike regular signals that execute immediately at current market price, scheduled signals remain in a pending state until either:</p>
<ol>
<li><strong>Activation</strong>: Price reaches <code>priceOpen</code>, signal transitions to opened state</li>
<li><strong>Cancellation</strong>: Timeout expires or stop loss hit before activation</li>
</ol>
<p>This API accumulates two event types per strategy:</p>
<ul>
<li><strong>Scheduled events</strong>: When a new scheduled signal is created</li>
<li><strong>Cancelled events</strong>: When a scheduled signal fails to activate</li>
</ul>
<p>The primary metric provided is the <strong>cancellation rate</strong>—the percentage of scheduled signals that never activate. A high cancellation rate indicates aggressive entry prices that rarely execute.</p>
<hr>
<a id="data-structures" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Data Structures<a href="#data-structures" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="schedulestatistics-interface" class="tsd-anchor"></a><h3 class="tsd-anchor-link">ScheduleStatistics Interface<a href="#schedulestatistics-interface" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>ScheduleStatistics</code> interface returned by <code>Schedule.getData()</code> provides comprehensive metrics about scheduled signal behavior:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>eventList</code></td>
<td><code>ScheduledEvent[]</code></td>
<td>Array of all scheduled/cancelled events with full details</td>
</tr>
<tr>
<td><code>totalEvents</code></td>
<td><code>number</code></td>
<td>Total count of all events (scheduled + cancelled)</td>
</tr>
<tr>
<td><code>totalScheduled</code></td>
<td><code>number</code></td>
<td>Count of scheduled signal creation events</td>
</tr>
<tr>
<td><code>totalCancelled</code></td>
<td><code>number</code></td>
<td>Count of cancelled signal events</td>
</tr>
<tr>
<td><code>cancellationRate</code></td>
<td><code>number | null</code></td>
<td>Percentage of scheduled signals that cancelled (0-100), null if no scheduled signals</td>
</tr>
<tr>
<td><code>avgWaitTime</code></td>
<td><code>number | null</code></td>
<td>Average minutes between scheduled and cancelled timestamps, null if no cancelled signals</td>
</tr>
</tbody>
</table>
<p><strong>Safe Math</strong>: All calculated metrics return <code>null</code> when calculation would produce invalid results (e.g., division by zero).</p>
<a id="scheduledevent-interface" class="tsd-anchor"></a><h3 class="tsd-anchor-link">ScheduledEvent Interface<a href="#scheduledevent-interface" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Each event in <code>eventList</code> represents a point-in-time snapshot of a scheduled signal:</p>
<pre><code class="typescript"><span class="hl-6">interface</span><span class="hl-1"> </span><span class="hl-10">ScheduledEvent</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">timestamp</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;           </span><span class="hl-5">// scheduledAt for scheduled, closeTimestamp for cancelled</span><br/><span class="hl-1">  </span><span class="hl-4">action</span><span class="hl-1">: </span><span class="hl-2">&quot;scheduled&quot;</span><span class="hl-1"> | </span><span class="hl-2">&quot;cancelled&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">symbol</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;              </span><span class="hl-5">// e.g., &quot;BTCUSDT&quot;</span><br/><span class="hl-1">  </span><span class="hl-4">signalId</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">;            </span><span class="hl-5">// UUID v4</span><br/><span class="hl-1">  </span><span class="hl-4">position</span><span class="hl-1">: </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1"> | </span><span class="hl-2">&quot;short&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">note</span><span class="hl-1">?: </span><span class="hl-10">string</span><span class="hl-1">;               </span><span class="hl-5">// Optional user description</span><br/><span class="hl-1">  </span><span class="hl-4">currentPrice</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;        </span><span class="hl-5">// VWAP at event time</span><br/><span class="hl-1">  </span><span class="hl-4">priceOpen</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;           </span><span class="hl-5">// Entry price signal is waiting for</span><br/><span class="hl-1">  </span><span class="hl-4">takeProfit</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;          </span><span class="hl-5">// TP target</span><br/><span class="hl-1">  </span><span class="hl-4">stopLoss</span><span class="hl-1">: </span><span class="hl-10">number</span><span class="hl-1">;            </span><span class="hl-5">// SL exit</span><br/><span class="hl-1">  </span><span class="hl-4">closeTimestamp</span><span class="hl-1">?: </span><span class="hl-10">number</span><span class="hl-1">;     </span><span class="hl-5">// Only for cancelled events</span><br/><span class="hl-1">  </span><span class="hl-4">duration</span><span class="hl-1">?: </span><span class="hl-10">number</span><span class="hl-1">;           </span><span class="hl-5">// Minutes waited (only for cancelled)</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="public-api-methods" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Public API Methods<a href="#public-api-methods" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>Schedule</code> singleton provides four methods for interacting with scheduled signal data. All methods are asynchronous and work with per-strategy storage.</p>
<a id="schedulegetdata" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schedule.getData()<a href="#schedulegetdata" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Retrieves statistical data for a strategy's scheduled signals.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">StrategyName</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">ScheduleStatistics</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Parameters:</strong></p>
<ul>
<li><code>strategyName</code> - Unique strategy identifier</li>
</ul>
<p><strong>Returns:</strong> <code>Promise&lt;ScheduleStatistics&gt;</code> with all metrics and event list</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-2">&quot;limit-order-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Cancellation rate: </span><span class="hl-6">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">cancellationRate</span><span class="hl-6">}</span><span class="hl-2">%`</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Avg wait time: </span><span class="hl-6">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">avgWaitTime</span><span class="hl-6">}</span><span class="hl-2"> minutes`</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="schedulegetreport" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schedule.getReport()<a href="#schedulegetreport" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Generates a markdown-formatted report with tabular event data and summary statistics.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">StrategyName</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">string</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Parameters:</strong></p>
<ul>
<li><code>strategyName</code> - Unique strategy identifier</li>
</ul>
<p><strong>Returns:</strong> <code>Promise&lt;string&gt;</code> containing markdown table and statistics footer</p>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">markdown</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">getReport</span><span class="hl-1">(</span><span class="hl-2">&quot;limit-order-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">markdown</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="scheduledump" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schedule.dump()<a href="#scheduledump" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Saves the markdown report to disk.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-4">StrategyName</span><span class="hl-1">, </span><span class="hl-4">path</span><span class="hl-1">?: </span><span class="hl-4">string</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-6">void</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Parameters:</strong></p>
<ul>
<li><code>strategyName</code> - Unique strategy identifier</li>
<li><code>path</code> - Optional directory path (default: <code>&quot;./logs/schedule&quot;</code>)</li>
</ul>
<p><strong>Behavior:</strong></p>
<ul>
<li>Creates directory if it doesn't exist</li>
<li>Writes file as <code>{strategyName}.md</code></li>
<li>Logs success/failure to console</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-5">// Default path: ./logs/schedule/limit-order-strategy.md</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;limit-order-strategy&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Custom path: ./reports/schedule/limit-order-strategy.md</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;limit-order-strategy&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;./reports/schedule&quot;</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="scheduleclear" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Schedule.clear()<a href="#scheduleclear" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Clears accumulated event data from memory.</p>
<p><strong>Signature:</strong></p>
<pre><code class="typescript"><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">?: </span><span class="hl-4">StrategyName</span><span class="hl-1">): </span><span class="hl-10">Promise</span><span class="hl-1">&lt;</span><span class="hl-6">void</span><span class="hl-1">&gt;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Parameters:</strong></p>
<ul>
<li><code>strategyName</code> - Optional strategy name to clear specific strategy data</li>
</ul>
<p><strong>Behavior:</strong></p>
<ul>
<li>If <code>strategyName</code> provided: Clears only that strategy's data</li>
<li>If omitted: Clears all strategies' data</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="typescript"><span class="hl-5">// Clear specific strategy</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">(</span><span class="hl-2">&quot;limit-order-strategy&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Clear all strategies</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">clear</span><span class="hl-1">();</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="service-architecture" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Service Architecture<a href="#service-architecture" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The Schedule API follows the framework's layered service architecture with specialized markdown reporting components.</p>
<p><img src="../media/20_Schedule_API_0.svg" alt="Mermaid Diagram"></p>
<p><strong>Architecture Layers:</strong></p>
<ol>
<li><strong>Public API Layer</strong> (<a href="">src/classes/Schedule.ts</a>): Singleton wrapper providing simplified method names and logging</li>
<li><strong>Service Layer</strong> (<a href="">src/lib/services/markdown/ScheduleMarkdownService.ts</a>): Event subscription, storage management, statistics calculation</li>
<li><strong>Storage Layer</strong>: Per-strategy <code>ReportStorage</code> instances created via memoization</li>
<li><strong>Event System</strong>: Subject-based pub-sub for signal event propagation</li>
</ol>
<p><strong>Key Design Patterns:</strong></p>
<ul>
<li><strong>Memoization</strong>: One <code>ReportStorage</code> instance per strategy name (<a href="">src/lib/services/markdown/ScheduleMarkdownService.ts:382-385</a>)</li>
<li><strong>Singleshot initialization</strong>: Event subscription happens once (<a href="">src/lib/services/markdown/ScheduleMarkdownService.ts:528-531</a>)</li>
<li><strong>Event-driven accumulation</strong>: No polling, pure reactive data collection</li>
</ul>
<hr>
<a id="event-flow-and-data-accumulation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Event Flow and Data Accumulation<a href="#event-flow-and-data-accumulation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The following diagram shows how scheduled signal events flow from strategy execution through the event system to the Schedule API's storage.</p>
<p><img src="../media/20_Schedule_API_1.svg" alt="Mermaid Diagram"></p>
<p><strong>Event Processing Rules:</strong></p>
<ol>
<li>
<p><strong>Scheduled Events</strong> (<a href="">src/lib/services/markdown/ScheduleMarkdownService.ts:176-194</a>):</p>
<ul>
<li>Appended to <code>_eventList</code></li>
<li>Trimmed if exceeds <code>MAX_EVENTS = 250</code></li>
</ul>
</li>
<li>
<p><strong>Cancelled Events</strong> (<a href="">src/lib/services/markdown/ScheduleMarkdownService.ts:202-237</a>):</p>
<ul>
<li><strong>Replace</strong> existing event with same <code>signalId</code> if found</li>
<li>Otherwise append as new event</li>
<li>Includes <code>duration</code> (minutes between scheduled and cancelled)</li>
</ul>
</li>
</ol>
<p><strong>Memory Management:</strong></p>
<ul>
<li>Fixed maximum of 250 events per strategy (<a href="">src/lib/services/markdown/ScheduleMarkdownService.ts:161</a>)</li>
<li>FIFO removal: oldest events dropped when limit exceeded</li>
<li>Separate storage per strategy via memoization key</li>
</ul>
<hr>
<a id="statistics-calculation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Statistics Calculation<a href="#statistics-calculation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>ReportStorage.getData()</code> method computes all metrics from the accumulated event list using safe mathematical operations.</p>
<p><strong>Calculation Logic:</strong></p>
<pre><code class="typescript"><span class="hl-5">// Cancellation Rate</span><br/><span class="hl-4">cancellationRate</span><span class="hl-1"> = (</span><span class="hl-4">totalCancelled</span><span class="hl-1"> / </span><span class="hl-4">totalScheduled</span><span class="hl-1">) * </span><span class="hl-8">100</span><br/><span class="hl-5">// Returns null if totalScheduled === 0</span><br/><br/><span class="hl-5">// Average Wait Time (for cancelled signals only)</span><br/><span class="hl-4">avgWaitTime</span><span class="hl-1"> = </span><span class="hl-0">sum</span><span class="hl-1">(</span><span class="hl-4">cancelledEvents</span><span class="hl-1">.</span><span class="hl-4">duration</span><span class="hl-1">) / </span><span class="hl-4">totalCancelled</span><br/><span class="hl-5">// Returns null if totalCancelled === 0</span>
</code><button type="button">Copy</button></pre>

<p><strong>Safe Math Implementation:</strong>
All calculated values return <code>null</code> when the denominator would be zero, preventing <code>NaN</code> or <code>Infinity</code> results in reports.</p>
<p><strong>Empty Data Handling:</strong>
When no events exist, <code>getData()</code> returns:</p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-12">eventList</span><span class="hl-1">: [],</span><br/><span class="hl-1">  </span><span class="hl-12">totalEvents</span><span class="hl-1">: </span><span class="hl-8">0</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-12">totalScheduled</span><span class="hl-1">: </span><span class="hl-8">0</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-12">totalCancelled</span><span class="hl-1">: </span><span class="hl-8">0</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-12">cancellationRate</span><span class="hl-1">: </span><span class="hl-6">null</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-12">avgWaitTime</span><span class="hl-1">: </span><span class="hl-6">null</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="report-generation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Report Generation<a href="#report-generation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The markdown report contains a table of all events followed by summary statistics.</p>
<a id="report-structure" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Report Structure<a href="#report-structure" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/20_Schedule_API_2.svg" alt="Mermaid Diagram"></p>
<p><strong>Table Columns:</strong></p>
<p>The markdown table includes 11 columns defined in the <code>columns</code> array (<a href="">src/lib/services/markdown/ScheduleMarkdownService.ts:101-158</a>):</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Timestamp</td>
<td>ISO 8601 timestamp</td>
<td><code>2024-01-01T12:00:00.000Z</code></td>
</tr>
<tr>
<td>Action</td>
<td>Event type</td>
<td><code>SCHEDULED</code> or <code>CANCELLED</code></td>
</tr>
<tr>
<td>Symbol</td>
<td>Trading pair</td>
<td><code>BTCUSDT</code></td>
</tr>
<tr>
<td>Signal ID</td>
<td>UUID v4 identifier</td>
<td><code>a1b2c3d4-...</code></td>
</tr>
<tr>
<td>Position</td>
<td>Trade direction</td>
<td><code>LONG</code> or <code>SHORT</code></td>
</tr>
<tr>
<td>Note</td>
<td>User description</td>
<td><code>Breakout entry</code></td>
</tr>
<tr>
<td>Current Price</td>
<td>VWAP at event time</td>
<td><code>50000.12345678 USD</code></td>
</tr>
<tr>
<td>Entry Price</td>
<td>Scheduled priceOpen</td>
<td><code>49500.00000000 USD</code></td>
</tr>
<tr>
<td>Take Profit</td>
<td>TP target</td>
<td><code>52000.00000000 USD</code></td>
</tr>
<tr>
<td>Stop Loss</td>
<td>SL exit</td>
<td><code>48000.00000000 USD</code></td>
</tr>
<tr>
<td>Wait Time (min)</td>
<td>Minutes waited (cancelled only)</td>
<td><code>45</code> or <code>N/A</code></td>
</tr>
</tbody>
</table>
<p><strong>Statistics Footer:</strong></p>
<pre><code class="markdown">**Total events:** 10
**Scheduled signals:** 7
**Cancelled signals:** 3
**Cancellation rate:** 42.86% (lower is better)
**Average wait time (cancelled):** 38.50 minutes
</code><button type="button">Copy</button></pre>

<hr>
<a id="initialization-and-event-subscription" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Initialization and Event Subscription<a href="#initialization-and-event-subscription" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <code>ScheduleMarkdownService</code> automatically subscribes to signal events when first accessed using the singleshot pattern.</p>
<p><strong>Initialization Flow:</strong></p>
<pre><code class="typescript"><span class="hl-5">// ScheduleMarkdownService.init() - singleshot pattern</span><br/><span class="hl-4">protected</span><span class="hl-1"> </span><span class="hl-4">init</span><span class="hl-1"> = </span><span class="hl-0">singleshot</span><span class="hl-1">(</span><span class="hl-6">async</span><span class="hl-1"> () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">loggerService</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;scheduleMarkdownService init&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">signalEmitter</span><span class="hl-1">.</span><span class="hl-0">subscribe</span><span class="hl-1">(</span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">tick</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p><strong>Subscription Details:</strong></p>
<ul>
<li>Subscribes to <code>signalEmitter</code> (general event stream)</li>
<li>Filters for <code>action === &quot;scheduled&quot;</code> and <code>action === &quot;cancelled&quot;</code> (<a href="">src/lib/services/markdown/ScheduleMarkdownService.ts:408-412</a>)</li>
<li>Ignores <code>opened</code>, <code>active</code>, <code>closed</code>, and <code>idle</code> events</li>
<li>Subscription persists for application lifetime</li>
</ul>
<p><strong>Automatic Invocation:</strong>
The <code>init()</code> method is called automatically when:</p>
<ol>
<li><code>Schedule.getData()</code> is invoked</li>
<li><code>Schedule.getReport()</code> is invoked</li>
<li><code>Schedule.dump()</code> is invoked</li>
</ol>
<p>No manual initialization required by users.</p>
<hr>
<a id="usage-patterns" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage Patterns<a href="#usage-patterns" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="basic-usage-track-cancellation-rate" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Basic Usage: Track Cancellation Rate<a href="#basic-usage-track-cancellation-rate" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">addStrategy</span><span class="hl-1">, </span><span class="hl-4">Backtest</span><span class="hl-1">, </span><span class="hl-4">Schedule</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Strategy with aggressive entry prices</span><br/><span class="hl-0">addStrategy</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;limit-scalper&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">interval:</span><span class="hl-1"> </span><span class="hl-2">&quot;5m&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">getSignal</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-6">async</span><span class="hl-1"> (</span><span class="hl-4">symbol</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">price</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">getAveragePrice</span><span class="hl-1">(</span><span class="hl-4">symbol</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">position:</span><span class="hl-1"> </span><span class="hl-2">&quot;long&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">priceOpen:</span><span class="hl-1"> </span><span class="hl-4">price</span><span class="hl-1"> - </span><span class="hl-8">100</span><span class="hl-1">,  </span><span class="hl-5">// Entry 100 below current</span><br/><span class="hl-1">      </span><span class="hl-4">priceTakeProfit:</span><span class="hl-1"> </span><span class="hl-4">price</span><span class="hl-1"> + </span><span class="hl-8">500</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">priceStopLoss:</span><span class="hl-1"> </span><span class="hl-4">price</span><span class="hl-1"> - </span><span class="hl-8">200</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">minuteEstimatedTime:</span><span class="hl-1"> </span><span class="hl-8">60</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Run backtest</span><br/><span class="hl-3">for</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">_</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;limit-scalper&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">frameName:</span><span class="hl-1"> </span><span class="hl-2">&quot;1week-test&quot;</span><br/><span class="hl-1">})) {}</span><br/><br/><span class="hl-5">// Check cancellation rate</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-2">&quot;limit-scalper&quot;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Cancellation rate: </span><span class="hl-6">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">cancellationRate</span><span class="hl-6">}</span><span class="hl-2">%`</span><span class="hl-1">);</span><br/><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">stats</span><span class="hl-1">.</span><span class="hl-4">cancellationRate</span><span class="hl-1"> &gt; </span><span class="hl-8">80</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">warn</span><span class="hl-1">(</span><span class="hl-2">&quot;Entry prices too aggressive - 80% never activate&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="advanced-usage-multi-symbol-analysis" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Advanced Usage: Multi-Symbol Analysis<a href="#advanced-usage-multi-symbol-analysis" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Schedule</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">symbols</span><span class="hl-1"> = [</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;ETHUSDT&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;SOLUSDT&quot;</span><span class="hl-1">];</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">strategyName</span><span class="hl-1"> = </span><span class="hl-2">&quot;limit-scalper&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Run backtests for all symbols...</span><br/><span class="hl-5">// (Schedule automatically tracks all scheduled signals)</span><br/><br/><span class="hl-5">// Analyze cancellation patterns</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">);</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">cancelledBySymbol</span><span class="hl-1"> = </span><span class="hl-4">stats</span><span class="hl-1">.</span><span class="hl-4">eventList</span><br/><span class="hl-1">  .</span><span class="hl-0">filter</span><span class="hl-1">(</span><span class="hl-4">e</span><span class="hl-1"> </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-4">e</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;cancelled&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-0">reduce</span><span class="hl-1">((</span><span class="hl-4">acc</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">acc</span><span class="hl-1">[</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1">] = (</span><span class="hl-4">acc</span><span class="hl-1">[</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">symbol</span><span class="hl-1">] || </span><span class="hl-8">0</span><span class="hl-1">) + </span><span class="hl-8">1</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">acc</span><span class="hl-1">;</span><br/><span class="hl-1">  }, {});</span><br/><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Cancellations by symbol:&quot;</span><span class="hl-1">, </span><span class="hl-4">cancelledBySymbol</span><span class="hl-1">);</span><br/><br/><span class="hl-5">// Generate report</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-4">strategyName</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="continuous-monitoring-in-live-trading" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Continuous Monitoring in Live Trading<a href="#continuous-monitoring-in-live-trading" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">Live</span><span class="hl-1">, </span><span class="hl-4">Schedule</span><span class="hl-1">, </span><span class="hl-4">listenSignalLive</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;backtest-kit&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// Start live trading with scheduled signals</span><br/><span class="hl-4">Live</span><span class="hl-1">.</span><span class="hl-0">background</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">strategyName:</span><span class="hl-1"> </span><span class="hl-2">&quot;limit-scalper&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">exchangeName:</span><span class="hl-1"> </span><span class="hl-2">&quot;binance&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">// Monitor cancellation rate every 5 minutes</span><br/><span class="hl-0">setInterval</span><span class="hl-1">(</span><span class="hl-6">async</span><span class="hl-1"> () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">stats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-2">&quot;limit-scalper&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Live stats:</span><br/><span class="hl-2">    Scheduled: </span><span class="hl-6">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">totalScheduled</span><span class="hl-6">}</span><br/><span class="hl-2">    Cancelled: </span><span class="hl-6">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">totalCancelled</span><span class="hl-6">}</span><br/><span class="hl-2">    Rate: </span><span class="hl-6">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">cancellationRate</span><span class="hl-6">}</span><span class="hl-2">%</span><br/><span class="hl-2">    Avg wait: </span><span class="hl-6">${</span><span class="hl-4">stats</span><span class="hl-9">.</span><span class="hl-4">avgWaitTime</span><span class="hl-6">}</span><span class="hl-2"> min</span><br/><span class="hl-2">  `</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><br/><span class="hl-1">  </span><span class="hl-5">// Auto-save report</span><br/><span class="hl-1">  </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">dump</span><span class="hl-1">(</span><span class="hl-2">&quot;limit-scalper&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">}, </span><span class="hl-8">5</span><span class="hl-1"> * </span><span class="hl-8">60</span><span class="hl-1"> * </span><span class="hl-8">1000</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<hr>
<a id="relationship-to-signal-lifecycle" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Relationship to Signal Lifecycle<a href="#relationship-to-signal-lifecycle" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The Schedule API fits into the broader signal lifecycle as follows:</p>
<p><img src="../media/20_Schedule_API_3.svg" alt="Mermaid Diagram"></p>
<p><strong>API Specialization:</strong></p>
<ul>
<li><strong>Schedule API</strong>: Tracks pre-activation events (<code>scheduled</code>, <code>cancelled</code>)</li>
<li><strong>Backtest/Live APIs</strong>: Track post-activation events (<code>opened</code>, <code>active</code>, <code>closed</code>)</li>
<li><strong>Complete picture</strong>: Use both APIs together for full lifecycle visibility</li>
</ul>
<hr>
<a id="storage-and-memory-considerations" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Storage and Memory Considerations<a href="#storage-and-memory-considerations" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="per-strategy-isolation" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Per-Strategy Isolation<a href="#per-strategy-isolation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Each strategy maintains its own isolated <code>ReportStorage</code> instance via memoization:</p>
<pre><code class="typescript"><span class="hl-4">private</span><span class="hl-1"> </span><span class="hl-4">getStorage</span><span class="hl-1"> = </span><span class="hl-0">memoize</span><span class="hl-1">&lt;(</span><span class="hl-4">strategyName</span><span class="hl-1">: </span><span class="hl-10">string</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-10">ReportStorage</span><span class="hl-1">&gt;(</span><br/><span class="hl-1">  ([</span><span class="hl-4">strategyName</span><span class="hl-1">]) </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-2">`</span><span class="hl-6">${</span><span class="hl-4">strategyName</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">,</span><br/><span class="hl-1">  () </span><span class="hl-6">=&gt;</span><span class="hl-1"> </span><span class="hl-6">new</span><span class="hl-1"> </span><span class="hl-0">ReportStorage</span><span class="hl-1">()</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Implications:</strong></p>
<ul>
<li>No data cross-contamination between strategies</li>
<li>Multiple strategies can run concurrently without interference</li>
<li>Clearing one strategy's data doesn't affect others</li>
</ul>
<a id="event-list-size-limits" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Event List Size Limits<a href="#event-list-size-limits" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The <code>_eventList</code> array has a fixed maximum size:</p>
<pre><code class="typescript"><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">MAX_EVENTS</span><span class="hl-1"> = </span><span class="hl-8">250</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// In addScheduledEvent/addCancelledEvent</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">_eventList</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1"> &gt; </span><span class="hl-7">MAX_EVENTS</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-4">_eventList</span><span class="hl-1">.</span><span class="hl-0">shift</span><span class="hl-1">();  </span><span class="hl-5">// Remove oldest event</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Behavior:</strong></p>
<ul>
<li>Maximum 250 events stored per strategy</li>
<li>FIFO eviction when limit exceeded</li>
<li>Prevents unbounded memory growth in long-running processes</li>
<li>Lost events don't affect statistics calculation (windowed view)</li>
</ul>
<p><strong>Consideration for Live Trading:</strong>
In production live trading with high signal frequency, 250 events may represent only recent history. Periodic dumps preserve complete historical data.</p>
<hr>
<a id="testing-and-validation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Testing and Validation<a href="#testing-and-validation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The test suite validates all Schedule API functionality:</p>
<a id="test-coverage" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Test Coverage<a href="#test-coverage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Test Case</th>
<th>Purpose</th>
<th>File Reference</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Schedule.getData returns ScheduleStatistics structure</code></td>
<td>Validates interface contract</td>
<td><a href="">test/spec/scheduled.test.mjs:15-82</a></td>
</tr>
<tr>
<td><code>Schedule.getData calculates cancellation rate</code></td>
<td>Verifies metric calculation</td>
<td><a href="">test/spec/scheduled.test.mjs:84-154</a></td>
</tr>
<tr>
<td><code>Schedule.getData returns null for unsafe math</code></td>
<td>Tests safe math with empty data</td>
<td><a href="">test/spec/scheduled.test.mjs:156-209</a></td>
</tr>
<tr>
<td><code>Schedule.getData tracks lifecycle</code></td>
<td>Validates event accumulation</td>
<td><a href="">test/spec/scheduled.test.mjs:211-289</a></td>
</tr>
</tbody>
</table>
<p><strong>Key Assertions:</strong></p>
<ul>
<li><code>ScheduleStatistics</code> structure has all required fields</li>
<li>Metrics return <code>null</code> for invalid calculations</li>
<li>Events accumulate correctly in <code>eventList</code></li>
<li>Callbacks (<code>onSchedule</code>, <code>onCancel</code>) fire appropriately</li>
</ul>
<hr>
<a id="integration-with-other-apis" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Integration with Other APIs<a href="#integration-with-other-apis" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="complementary-to-backtestlive-apis" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Complementary to Backtest/Live APIs<a href="#complementary-to-backtestlive-apis" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-5">// Track both scheduled AND opened/closed signals</span><br/><span class="hl-3">for</span><span class="hl-1"> </span><span class="hl-3">await</span><span class="hl-1"> (</span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">result</span><span class="hl-1"> </span><span class="hl-6">of</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-2">&quot;BTCUSDT&quot;</span><span class="hl-1">, </span><span class="hl-4">context</span><span class="hl-1">)) {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">action</span><span class="hl-1"> === </span><span class="hl-2">&quot;closed&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">// Backtest API tracks this</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Position closed:&quot;</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">pnl</span><span class="hl-1">.</span><span class="hl-4">pnlPercentage</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// After backtest completes</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">backtestStats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Backtest</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">scheduleStats</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">Schedule</span><span class="hl-1">.</span><span class="hl-0">getData</span><span class="hl-1">(</span><span class="hl-2">&quot;my-strategy&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`</span><br/><span class="hl-2">  Opened signals: </span><span class="hl-6">${</span><span class="hl-4">backtestStats</span><span class="hl-9">.</span><span class="hl-4">totalSignals</span><span class="hl-6">}</span><br/><span class="hl-2">  Scheduled signals: </span><span class="hl-6">${</span><span class="hl-4">scheduleStats</span><span class="hl-9">.</span><span class="hl-4">totalScheduled</span><span class="hl-6">}</span><br/><span class="hl-2">  Cancelled signals: </span><span class="hl-6">${</span><span class="hl-4">scheduleStats</span><span class="hl-9">.</span><span class="hl-4">totalCancelled</span><span class="hl-6">}</span><br/><span class="hl-2">  </span><br/><span class="hl-2">  Entry success rate: </span><span class="hl-6">${</span><span class="hl-9">(</span><span class="hl-8">1</span><span class="hl-9"> </span><span class="hl-1">-</span><span class="hl-9"> </span><span class="hl-4">scheduleStats</span><span class="hl-9">.</span><span class="hl-4">cancellationRate</span><span class="hl-1">/</span><span class="hl-8">100</span><span class="hl-9">) </span><span class="hl-1">*</span><span class="hl-9"> </span><span class="hl-8">100</span><span class="hl-6">}</span><span class="hl-2">%</span><br/><span class="hl-2">`</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="works-in-both-execution-modes" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Works in Both Execution Modes<a href="#works-in-both-execution-modes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The Schedule API functions identically in backtest and live modes:</p>
<table>
<thead>
<tr>
<th>Execution Mode</th>
<th>Signal Detection</th>
<th>Cancellation Detection</th>
</tr>
</thead>
<tbody>
<tr>
<td>Backtest</td>
<td>Fast-forward candle iteration detects priceOpen activation</td>
<td>Timeout or SL hit during candle processing</td>
</tr>
<tr>
<td>Live</td>
<td>VWAP monitoring detects priceOpen activation</td>
<td>Timeout or SL hit during real-time monitoring</td>
</tr>
</tbody>
</table>
<p><strong>Event emission</strong> uses the same emitters in both modes, so Schedule API receives identical event structures.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#schedule-api"><span>Schedule API</span></a><ul><li><a href="#overview"><span>Overview</span></a></li><li><a href="#data-structures"><span>Data <wbr/>Structures</span></a></li><li><ul><li><a href="#schedulestatistics-interface"><span>Schedule<wbr/>Statistics <wbr/>Interface</span></a></li><li><a href="#scheduledevent-interface"><span>Scheduled<wbr/>Event <wbr/>Interface</span></a></li></ul></li><li><a href="#public-api-methods"><span>Public API <wbr/>Methods</span></a></li><li><ul><li><a href="#schedulegetdata"><span>Schedule.get<wbr/>Data()</span></a></li><li><a href="#schedulegetreport"><span>Schedule.get<wbr/>Report()</span></a></li><li><a href="#scheduledump"><span>Schedule.dump()</span></a></li><li><a href="#scheduleclear"><span>Schedule.clear()</span></a></li></ul></li><li><a href="#service-architecture"><span>Service <wbr/>Architecture</span></a></li><li><a href="#event-flow-and-data-accumulation"><span>Event <wbr/>Flow and <wbr/>Data <wbr/>Accumulation</span></a></li><li><a href="#statistics-calculation"><span>Statistics <wbr/>Calculation</span></a></li><li><a href="#report-generation"><span>Report <wbr/>Generation</span></a></li><li><ul><li><a href="#report-structure"><span>Report <wbr/>Structure</span></a></li></ul></li><li><a href="#initialization-and-event-subscription"><span>Initialization and <wbr/>Event <wbr/>Subscription</span></a></li><li><a href="#usage-patterns"><span>Usage <wbr/>Patterns</span></a></li><li><ul><li><a href="#basic-usage-track-cancellation-rate"><span>Basic <wbr/>Usage: <wbr/>Track <wbr/>Cancellation <wbr/>Rate</span></a></li><li><a href="#advanced-usage-multi-symbol-analysis"><span>Advanced <wbr/>Usage: <wbr/>Multi-<wbr/>Symbol <wbr/>Analysis</span></a></li><li><a href="#continuous-monitoring-in-live-trading"><span>Continuous <wbr/>Monitoring in <wbr/>Live <wbr/>Trading</span></a></li></ul></li><li><a href="#relationship-to-signal-lifecycle"><span>Relationship to <wbr/>Signal <wbr/>Lifecycle</span></a></li><li><a href="#storage-and-memory-considerations"><span>Storage and <wbr/>Memory <wbr/>Considerations</span></a></li><li><ul><li><a href="#per-strategy-isolation"><span>Per-<wbr/>Strategy <wbr/>Isolation</span></a></li><li><a href="#event-list-size-limits"><span>Event <wbr/>List <wbr/>Size <wbr/>Limits</span></a></li></ul></li><li><a href="#testing-and-validation"><span>Testing and <wbr/>Validation</span></a></li><li><ul><li><a href="#test-coverage"><span>Test <wbr/>Coverage</span></a></li></ul></li><li><a href="#integration-with-other-apis"><span>Integration with <wbr/>Other APIs</span></a></li><li><ul><li><a href="#complementary-to-backtestlive-apis"><span>Complementary to <wbr/>Backtest/<wbr/>Live APIs</span></a></li><li><a href="#works-in-both-execution-modes"><span>Works in <wbr/>Both <wbr/>Execution <wbr/>Modes</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">backtest-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105455585', 'ym');

    ym(105455585, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/105455585" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3MQZEBBDDR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3MQZEBBDDR');
</script>
